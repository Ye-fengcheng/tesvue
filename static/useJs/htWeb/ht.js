!function(O,P,Q){"use strict";var v="ht";if(!O[v]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),O.performance&&O.performance.now||function(){var Z=Date.now();O.performance||(O.performance={}),O.performance.now=function(){return Date.now()-Z}}();for(var X=Date.now(),y=16,Z=["ms","moz","webkit","o"],g=0;g<Z.length&&!O.requestAnimationFrame;++g)O.requestAnimationFrame=O[Z[g]+"RequestAnimationFrame"],O.cancelAnimationFrame=O[Z[g]+"CancelAnimationFrame"]||O[Z[g]+"CancelRequestAnimationFrame"];O.requestAnimationFrame||(O.requestAnimationFrame=function(h){var J=Date.now(),Q=y+X-J;return 0>Q&&(Q=0),X=J,O.setTimeout(function(){X=Date.now(),h(performance.now())},Q)}),O.cancelAnimationFrame||(O.cancelAnimationFrame=function(w){return O.clearTimeout(w)})}();var U,R,K,I,a=O.document,q=null,i=O[v]={},r=O[v+"config"],E=i.Default=r&&r.Default||{},X=i.Style=r&&r.Style||{},W=i.Color=r&&r.Color||{},w=i.IsGetter=r&&r.IsGetter||{},c=Math,H=c.round,l=c.floor,z=c.ceil,Z=c.sqrt,M=c.max,f=c.min,C=c.abs,g=c.cos,d=c.acos,x=c.sin,F=c.pow,L=c.asin,A=c.PI,G=2*A,V=A/2,t=c.tan,B=c.atan2,p=c.random,j=!1,T=!1,m=O.parseInt||global.parseInt,N="2017-09-15",$=function(){try{return O.navigator.platform.indexOf("Win")>-1}catch(E){}}(),n=function(A){return A*A},u=O.setTimeout,y=O.clearTimeout,s=O.location,b=O.navigator?O.navigator.userAgent.toLowerCase():"",Y=function(K){return K.test(b)},h=Y(/msie/)||Y(/trident/),o=Y(/msie 10/),D=Y(/edge/),J=Y(/firefox/),_=Y(/mac/),e=E.isTouchable===Q?$?!1:a?"ontouchend"in a:!1:E.isTouchable,S="default",Hb="single",Uq="multiple",Fn="front",xn="back",Ff="left",Gr="right",nr="top",Xg="bottom",uq="center",Mm="eye",Er="middle",cc="east",ng="west",od="north",gn="none",jm="px",Af="absolute",jp="border",on="triangle",wb="rect",Zj="circle",_n="cylinder",fl="shape",Og="items",Vn="normal",dm="remove",Hn="clear",kk="width",ri="height",Lg="ingroup",jc="check",Ve="uncheck",Vb="radio",Hq="radioOn",Sq="radioOff",Ko="points",Qh="values",Um="series",gm="body",or="label",Rg="label2",js="note",pl="note2",jl="icons",Sn="labelFont",Xr="labelColor",mb="labelSelectColor",ho="note.expanded",Mr="note2.expanded",$q="edge.expanded",Sr="edge.points",Li="edge.type",oh="rotation",bs="getRotation",so="setRotation",cl="hidden",hd="visible",Be="tuv",er="no",Pi="select",co="currentSubGraph",os="selectBackground",Pd="autoMakeVisible",us="autoHideScrollBar",wl="scrollBarColor",Yl="scrollBarSize",Fc="indent",jg="rowHeight",gf="columnLineColor",bg="rowLineColor",Jo="columnLineVisible",rs="rowLineVisible",Rm="visibleFunc",vf="expandIcon",Yj="collapseIcon",bf="checkMode",ik="sortFunc",Eq="editable",Km="batchEditable",ur="tristate",_p="asc",xi="desc",xm="position",ls="elevation",iq="children",cf="translateX",rf="translateY",Nn="dataModel",Lb="maxSize",tm="shape3d",Ci="shape3d.resolution",ff="shape3d.visible",Ai="shape3d.from.visible",de="shape3d.to.visible",sl="shape3d.top.visible",jj="shape3d.bottom.visible",Se="repeat.uv.length",_f="serializeValue",yh="deserializeValue",li="centerUniform",kc="rgba(255,255,255,0)",mp="style",ad="attr",zn="field",Qo="string",Zp="boolean",fc="color",Vr="int",Vq="number",De="ew-resize",Kn="ns-resize",ee="pointer",Wr="auto",ke="mousedown",yk="mousemove",Dr="mouseup",ge="mouseout",Ik="touchstart",ch="touchmove",nk="touchend",Cn="keydown",bj="keyup",Jb=J?"DOMMouseScroll":"mousewheel",yf=e?[Ik,ch,nk,Cn,bj,"keypress","input","contextmenu"]:[Cn,bj,"keypress","input",ke,yk,Dr,ge,Jb,"contextmenu","mouseenter","mouseleave","mouseover"],rm=q,Im=q,lh=q,Qi=Dr.length,Lq=function(){lh&&(y(lh.timeout),lh=q)},Oc=function(){lh&&vp(lh.e,lh.info)};O.addEventListener&&(e||(O.addEventListener(ge,function(){Lq()},!1),O.addEventListener(Jb,function(){Ur()},!1)),O.addEventListener(bj,function(B){91===B.keyCode?qn={}:delete qn[B.keyCode]},!0),O.addEventListener(Cn,function(R){qn[R.keyCode]=!0},!0));var ac,So,Oe,Cf=!1,Zd=q,Ol=function(T,y){var V=u(function(){T(),delete Zd[V],lg(Zd)&&(Zd=q)},y);return V},Vj=q,ue=q,uc={},Dd={},sk={},kb={},Wn={},qn={},Zi={},Ti={},qq={},te=/.json$/,hr=/^data:image\/svg\+xml/,Ig={},Wm=[],Hg={},Lh=q,Mo=q,Fe=function(){},Yb=function(){throw"Oops!"},Jp=[0,0,0],Nl=[0,0,0,0],Cm={x:0,y:0,width:0,height:0},Fb=q,vi=q,wj=q,Qg=function(w){vi&&!w._72O&&(wj||(wj={}),wj[w._72O=ei()]=w),ac!=q?Me()<.05&&I&&!So&&(yr=Lq):yr=$r},an=function(J,x,L,y){vi||(vi={});var S=vi[J];if(S){if(S.url===x)return;S.image?(S.image.onload=Fe,S.image.onerror=Fe):S.request&&(S.request.onload=Fe,S.request.onerror=Fe)}if(te.test(x)){var M=new XMLHttpRequest;if(vi[J]={request:M,url:x},M.overrideMimeType("text/plain"),x=E.beforeLoadURL(x),x.data){var N=E.parse(x.data);fr(J,N),E.handleImageLoaded(J,N)}else M.open("GET",encodeURI(x),!0),M.onload=function(w){if(200===this.status||0===this.status){var Y=E.parse(w.target.response);fr(J,Y),E.handleImageLoaded(J,Y)}else fr(J,E.handleUnfoundImage(J,x)||q)},M.onerror=function(){fr(J,E.handleUnfoundImage(J,x)||q)},M.send(null)}else{var N=new Image;vi[J]={image:N,url:x},h&&(x.toLowerCase().indexOf(".svg")>0||hr.test(x))?(a.body.appendChild(N),N.style.visibility="hidden",N.onload=function(){u(function(){if(L&&(N.width=L),y&&(N.height=y),!N.width||!N.height){var g=N.width||N.clientWidth,U=N.height||N.clientHeight;N.width=g,N.height=U}E.handleImageLoaded(J,N),fr(J,N),a.body.removeChild(N),N.style.visibility=""},180)},N.onerror=function(){fr(J,E.handleUnfoundImage(J,x)||q),a.body.removeChild(N),N.style.visibility=""}):(N.onload=function(){L&&(N.width=L),y&&(N.height=y),E.handleImageLoaded(J,N),fr(J,N)},N.onerror=function(){fr(J,E.handleUnfoundImage(J,x)||q)}),/^data:image/.test(x)||(x=E.beforeLoadURL(x),/^data:image/.test(x)||(x=E.appendTimeStamp(x),x=encodeURI(x))),N.src=x}},fr=function(h,j){if(Dd[h]=j,delete vi[h],lg(vi)&&(vi=q,wj)){for(var t in wj){var f=wj[t];f._2O&&(f._2O={}),f.invalidateAll&&f.invalidateAll(Q,"imageLoaded",h),f.redraw&&f.redraw(),f.iv(),delete f._72O}wj=q}if(j&&wj)for(var t in wj){var f=wj[t];f.invalidateAll&&f.invalidateAll(Q,"imageLoading",h),f.redraw&&f.redraw(),f.iv()}},Bm=function(){return O.performance&&O.performance.now?O.performance.now():Date.now()},Yq=function(s,H){H?y(s):O.cancelAnimationFrame(s)},Gk=function(y,i,J){return{width:y,height:i,comps:Rn(J)?J:[J]}},se=function($,o){return{type:Zj,rect:[$,o,1.6,1.6],borderWidth:1,borderColor:jr,gradient:Tq,gradientColor:Te,background:jr}},xc=function(W,a){return Gk(16,16,{type:on,rect:[4,4,10,8],background:W,rotation:a?1.57:3.14})},ic=function(X,W){return Gk(16,16,{type:on,rect:[4,4,8,7],background:X,rotation:W?3.14:0})},bd=function(y){var I=y._orientation;return"horizontal"===I||"h"===I},$f=function(V){var P=q||4,w=q||1,n=q||1;0>P?P=0:P>.25&&(P=.25);var r,y,d,T,J,j,a,E=.5,i=[],m=[],L=[],Y=G/n,o=G/w,X=E-P;for(y=0;w>=y;y++)for(T=-A+y*o,j=g(T),J=x(T),r=0;n>=r;r++)d=r*Y,a=X+P*j,i.push(g(d)*a,J*P,-x(d)*a),(R=V)&&m.push(r/n,1-y/w);for(y=0;w>y;y++){var z=y*(n+1),s=(y+1)*(n+1);for(r=0;n>r;r++)L.push(z+r,s+r+1,s+r,z+r,z+r+1,s+r+1),qi.z=ep.z=V}},sm=function(o){var C=2,w=0;for(var P in o)P.length===C&&m(P,32)===vc&&(Lh=Mo=o[P]),w++;return w},gp=function(V,x,l,d){return l||(l=e?5:3,l/=d||1),{x:V-l,y:x-l,width:2*l,height:2*l}},lb=function(U,n,E,l){var j=this;n||(n=e?5:3,E=20,l=20);var w={x:U,y:n,width:E,height:l};if(E)for(var Q=0;E>Q;Q++)if(3===E)l=20;else for(var T=0;l>T;T++)j=O?O:E;var M={x:A,y:2*A};if(vg(w,M)){var q=ri[0]+nr[0]+Hn[1];Rq[Mm]=j[q],j[q]=Mh[Mm]}},Bf=function(d){return(/ble$/.test(d)||/ed$/.test(d)||w[d]?"is":"get")+d.charAt(0).toUpperCase()+d.slice(1)},Mh=function(O){return"set"+O.charAt(0).toUpperCase()+O.slice(1)},Gg=function(u){return typeof u===Qo||u instanceof String},wm=function(d){return typeof d===Vq},$r=function(f){return typeof f===Zp},qc=function(d){return d&&"object"==typeof d},Xo=function(_){return"function"==typeof _},Rn=function(j){return j instanceof Array},rk=function(z){return z instanceof up},qb=function(t){return Rn(t)?new up(t):t},Bj=function(L){return L instanceof Mf},Rf=function(A){return A instanceof Co},Gd=function(b){return b instanceof xb},as=function(v,A){if(!(v instanceof i.Group))return!1;if(!A)return v.isExpanded();var K=A.getDataUI(v);return K&&K._88I?!0:!1},no=function(Q){return Q instanceof ye},fm=function(P){return P&&"IFRAME"===P.tagName},Do=function(l){return l==q||E.numberDigits==q?l:parseFloat(l.toFixed(E.numberDigits))},Ck=function(U,p,E){var Q,t=p.length;if(E)for(var c=0;E>c;c++)if(3===t)U.push(p[0]),U.push(p[1]),U.push(p[2]);else for(Q=0;t>Q;Q++)U.push(p[Q]);else if(3===t)U.push(p[0]),U.push(p[1]),U.push(p[2]);else for(Q=0;t>Q;Q++)U.push(p[Q])},df=function(s){return s?qc(s)?s:{}:!1},Ij=function(y,R,o){var i,I=qc(y)?y:y.prototype;for(i in R)o&&I[i]!==Q||(I[i]=R[i]);return y},ce=function(e){return String.fromCharCode(e)},Or=function(H){for(var Y,y=0,$="";y<H.length;y++)Y=H[H.length-1-y],"%"===Y?Y="'":"a"===Y?Y='"':"]"===Y&&(Y="\\"),$+=ce(Y.charCodeAt(0)-1);return $},Pj=function(R,s,B){R.superClass.constructor.apply(s,B)},lg=function(r){for(var O in r)return!1;return!0},ae=function(W){return W?0===W.length:!0},nq=function(f,Y){return f===Y?!0:f.x===Y.x&&f.y===Y.y&&f.width===Y.width&&f.height===Y.height},ts=function(C,A,k){return A>C?A:C>k?k:C},ms=function(A){return 0>A?-1:A>0?1:0},Me=function(){var p=1e4*x(Qi++);return p-l(p)},km=function(K,V,D){return ql(K.x,K.y,V.x,V.y,D.x,D.y,D.x+D.width,D.y,!0)||ql(K.x,K.y,V.x,V.y,D.x+D.width,D.y,D.x+D.width,D.y+D.height,!0)||ql(K.x,K.y,V.x,V.y,D.x+D.width,D.y+D.height,D.x,D.y+D.height,!0)||ql(K.x,K.y,V.x,V.y,D.x,D.y+D.height,D.x,D.y,!0)},ql=function(c,N,y,L,p,U,T,V,G){var t=(T-p)*(N-U)-(V-U)*(c-p),w=(V-U)*(y-c)-(T-p)*(L-N);if(0!==w){var S=t/w,d=c+S*(y-c),C=N+S*(L-N);return G&&(d+Tl<f(c,y)||d-Tl>M(c,y)||d+Tl<f(p,T)||d-Tl>M(p,T)||C+Tl<f(N,L)||C-Tl>M(N,L)||C+Tl<f(U,V)||C-Tl>M(U,V))?q:[d,C]}return q},tg=function(Y,v,z){if(Y&&z)if(v){if(v===mp)return Y.getStyle(z);if(v===ad)return Y.getAttr(z);if(v===zn)return Y[z]}else if(z=Bf(z),Y[z])return Y[z]();return Q},Jf=function(w,B,b,s){if(w&&b)if(B){if(B===mp)w.s(b,s);else if(B===ad)w.a(b,s);else if(B===zn){var O=w[b];w[b]=s,w.fp("f:"+b,O,s)}}else b=Mh(b),w[b]&&w[b](s)},mm=function(V,R,S){return R&&"top"!==R?"bottom"===R?{x:V.x,y:V.y,width:V.width,height:V.height*S}:"right"===R?{x:V.x,y:V.y,width:V.width*S,height:V.height}:"left"===R?{x:V.x+V.width*(1-S),y:V.y,width:V.width*S,height:V.height}:void 0:{x:V.x,y:V.y+V.height*(1-S),width:V.width,height:V.height*S}},ag=function(j,T,q,f,I){T&&Kc(j,q,f,1,I,T)},si=function(P,Y,n,m){var o=1-P;return o*o*Y+2*P*o*n+P*P*m},qi=function(F,M,q,S,Q){var w=1-F;return w*w*w*M+3*w*w*F*q+3*w*F*F*S+F*F*F*Q},fs=function(F){var Z,G,f,a,d=0;return F.forEach(function(Y){if(Z=Y.length,Z>0)for(G=Y[0],a=1;Z>a;a++)f=Y[a],d+=Ip(G,f),G=f}),d},xr=function(j,z,m){var L="__"+j,s=function(C){m.interactiveDisabled||m["handle_"+j](C)};m[L]||(m[L]=s,z.addEventListener(j,s,!1))},$m=function($,o,q){var X="__"+$,C=q[X];C&&(o.removeEventListener($,C,!1),delete q[X])},af=function(r,m){var I="_"+m;r[Bf(m)]=function(){return this[I]},r[Mh(m)]=function(X){var i=this[I];this[I]=X,this.fp(m,i,X)}},Ec=function($){return P.create($)},bh=function(u){if(!u.element){var F,G;(F=u.textField)?G=Kp(Tp.TextField,F):(F=u.textArea)?G=Kp(Tp.TextArea,F):(F=u.button)?G=Kp(Tp.Button,F):(F=u.comboBox)?G=Kp(Tp.ComboBox,F):(F=u.checkBox)?G=Kp(Tp.CheckBox,F):(F=u.radioButton)?G=Kp(Tp.RadioButton,F):(F=u.slider)?G=Kp(Tp.Slider,F):(F=u.colorPicker)?G=Kp(Tp.ColorPicker,F):(F=u.image)&&(G=Kp(Tp.Image,F)),G&&(u.element=G)}},wk=function(Z,D){var J=ao(Z);return J._ht=D,J},ao=function(C,M){var V=a.createElement("div"),r=V.style;return V.tabIndex=-1,V.onkeydown=br,r.msTouchAction=gn,Gc(V,q,0),e&&r.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",q),C&&(r.overflow=cl),M&&gd(M,V),V},ld=function(G,Z){var m=a.createElement("canvas"),P=m.style;return P.msTouchAction=gn,Z||(P.pointerEvents=gn),Gc(m,q,0),G&&gd(G,m),m},Gc=function(Z,M,V){var U=Z.style;U.border=M?M+" solid 1px":0,U.outline=0,U.padding=V?"0 "+V+jm:0,Ne(Z)},Ne=function($){var E=$.style;E.position=Af,E.margin=0,E.setProperty("box-sizing","border-box",q),E.setProperty("-moz-box-sizing","border-box",q)},Pm=function(L,F,b,r){r||(r=Zl),F!=q&&(L.width=F*r,L.style.width=F+jm),b!=q&&(L.height=b*r,L.style.height=b+jm)},gd=function(g,h,d){g.appendChild(h),d&&(h.style.position=Af)},$o=function(I,g){g.split||(g+="");for(var a,$=g.split("\n"),r=0,x=$.length,p=0;x>p;p++){var Q=wr(I.font,$[p]);Q.width>r&&(r=Q.width),a||(a=Q.height)}return I.ss=$,{width:r,height:a*x}},th=function($,w,g,G,F,I){var d=w.length;if(1===d)Lm($,w[0],g,G,F);else for(var u=g.height/d,J={x:g.x,y:g.y,width:g.width,height:u},k=0;k<w.length;k++)I?Wp($,w[k],G,F,J.x,J.y,J.width,J.height,I):Lm($,w[k],J,G,F),J.y+=u},Lm=function(J,j,L,c,S){J.font=c?c:fe,J.fillStyle=S?S:ne,J.textAlign=uq,J.textBaseline=Er;var d,Y;L?L.width===Q?(d=L.x,Y=L.y):(d=L.x+L.width/2,Y=L.y+L.height/2):(d=0,Y=0),J.fillText(j,H(d),H(Y))},td=function(F){F.getView&&(F=F.getView());var z=F.offsetWidth||F.scrollWidth;return!z&&F.style.width&&(z=m(F.style.width)),z},dp=function(X){X.getView&&(X=X.getView());var P=X.offsetHeight||X.scrollHeight;return!P&&X.style.height&&(P=m(X.style.height)),P},Pc=function(){var X=function(H){br(H),H.stopPropagation()},z=e?[Ik]:[Cn,ke,Jb];return function(q){var D=ao(),m=D.style;return m.backgroundColor=E.disabledBackground,q&&(m.backgroundImage="url("+q+")",m.backgroundPosition="50% 50%",m.backgroundRepeat="no-repeat no-repeat"),z.forEach(function(f){D.addEventListener(f,X)}),D}}(),Pg=function(F){var $=F.getContext("2d");return $.save(),$.lineCap=qf,$.lineJoin=un,$},yr=function(h,Y,U,Z){_e(h,Y*Zl,U*Zl),Z*=Zl,1!==Z&&h.scale(Z,Z)},_e=function(I,f,k){I.translate(f,k)},zq=function(x,U){U&&x.rotate(U)},Qe=function(H,E,A){E===Q&&(E=1),A===Q&&(A=1),(1!==E||1!==A)&&H.scale(E,A)},oj=function(P){if(a.activeElement!==P)if(e)P.focus();else{var s=Zg(),q=s.target;P.focus(),q.scrollLeft=s.left,q.scrollTop=s.top}},cs=function(v){return v&&v.getView?v.getView():v},Mj=function($,M,O,s,j){if(2===arguments.length&&(O=M.y,s=M.width,j=M.height,M=M.x),$.isSelfViewEvent)$.setX(M),$.setY(O),$.setWidth(s),$.setHeight(j);else{var T=cs($),k=T.style;if((a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)!==T)M!==Q&&(k.left=M+jm),O!==Q&&(k.top=O+jm),s!==Q&&(k.width=s+jm),j!==Q&&(k.height=j+jm);else{var R=E.getWindowInfo();k.left=(M=R.left)+jm,k.top=(O=R.top)+jm,k.width=(s=R.width)+jm,k.height=(j=R.height)+jm}$.endEditing&&!e&&$.endEditing(),$.redraw&&$.redraw(),$.invalidate&&$.invalidate(),$.onLayouted&&$.onLayouted(M,O,s,j),$.fireViewEvent&&$.fireViewEvent("layout")}},Mq=function(l){var J=l.touches[0];return J?J:l.changedTouches[0]},wc=function(b){return e?Mq(b).target:b.target},ef=function(z){E.popup&&E.popup.close(),E.popup=z},Cc=q,Uc=function(p){Cc.handleWindowTouchMove(p)},Up=function(X){Cc.handleWindowTouchEnd(X),O.removeEventListener(ch,Uc,!1),O.removeEventListener(nk,Up,!1),Cc=q},Ng=function(N){Cc.handleWindowMouseMove(N)},bk=function(s){Cc.handleWindowMouseUp(s),O.removeEventListener(yk,Ng,!1),O.removeEventListener(Dr,bk,!1),Cc=q},Yn=function(C){return 1===Ed(C)},sj=function(O,Q){return Q?Q.keyCode===O:qn[O]},uk=function(u){return ki(u)&&sj(65,u)},Ii=function(W){return sj(46,W)||sj(8,W)},Nc=function(x){return function(Q){return Q?Q.keyCode===x:qn[x]}},vc=573,zj=[65,83,68,87,37,38,39,40,32,13,27],Pe=Nc(zj[0]),To=Nc(zj[1]),Nf=Nc(zj[2]),fj=Nc(zj[3]),Bn=Nc(zj[4]),Br=Nc(zj[5]),fn=Nc(zj[6]),Dp=Nc(zj[7]),Rb=Nc(zj[8]),mh=Nc(zj[9]),hj=Nc(zj[10]),Om={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ii=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,11,11],Xc=q,dh=q,nd=function(O,a){Xc||(Xc=ld()),Pm(Xc,O,a,1);var c=Pg(Xc);return c.clearRect(0,0,O,a),c},Ji=function(){var b,j={};return function(W){var E,T=j[W];return T||(b||(b=ld(),Pm(b,1,1,1)),E=b.getContext("2d"),E.clearRect(0,0,1,1),Kc(E,0,0,1,1,W),T=E.getImageData(0,0,1,1).data,T=j[W]=[T[0],T[1],T[2],T[3]]),T}}(),Yg=function(Z){if(!Gg(Z))return Z;var i=Ji(Z);return i.CA||(i.CA=[i[0]/255,i[1]/255,i[2]/255,i[3]/255]),i.CA},xp=function(R,K,H,Y,w){var O=ld();O.width=H,O.height=Y;var y=O.getContext("2d");y.drawImage(R,0,0,H,Y);try{for(var W=y.getImageData(0,0,H,Y),p=W.data,l=0,M=p.length;M>l;l+=4){var d=p[l+0],U=p[l+1],g=p[l+2],Q=p[l+3];"override_a"===w?p[l+3]=255*K[3]:"override_rgb"===w?(p[l+0]=255*K[0],p[l+1]=255*K[1],p[l+2]=255*K[2]):"override"===w?(p[l+0]=255*K[0],p[l+1]=255*K[1],p[l+2]=255*K[2],p[l+3]=255*K[3]):(p[l+0]=K[0]*d,p[l+1]=K[1]*U,p[l+2]=K[2]*g,p[l+3]=K[3]*Q)}y.putImageData(W,0,0)}catch(h){return R}return O},Rq=function(G,b,D){return b&&(b="miter"===D?8*b+20:b+1,G&&Eg(G,b)),b},ok=function(C,p){if(p){var Y=new He(p),B=C.width/2,J=C.height/2,P=Yd([Y.tf(-B,-J),Y.tf(B,-J),Y.tf(B,J),Y.tf(-B,J)]);return P.x+=C.x+B,P.y+=C.y+J,P}return C},fd=function(M,V,A,d,k,P,D,y){d*=Math.PI/180;var f={x:Math.cos(d)*(M.x-D.x)/2+Math.sin(d)*(M.y-D.y)/2,y:-Math.sin(d)*(M.x-D.x)/2+Math.cos(d)*(M.y-D.y)/2},C=Math.pow(f.x,2)/Math.pow(V,2)+Math.pow(f.y,2)/Math.pow(A,2);C>1&&(V*=Math.sqrt(C),A*=Math.sqrt(C));var q=(k==P?-1:1)*Math.sqrt((Math.pow(V,2)*Math.pow(A,2)-Math.pow(V,2)*Math.pow(f.y,2)-Math.pow(A,2)*Math.pow(f.x,2))/(Math.pow(V,2)*Math.pow(f.y,2)+Math.pow(A,2)*Math.pow(f.x,2)));isNaN(q)&&(q=0);var B={x:q*V*f.y/A,y:q*-A*f.x/V},X={x:(M.x+D.x)/2+Math.cos(d)*B.x-Math.sin(d)*B.y,y:(M.y+D.y)/2+Math.sin(d)*B.x+Math.cos(d)*B.y},H=function(f){return Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2))},Q=function(L,M){return(L[0]*M[0]+L[1]*M[1])/(H(L)*H(M))},u=function(x,X){return(x[0]*X[1]<x[1]*X[0]?-1:1)*Math.acos(Q(x,X))},l=u([1,0],[(f.x-B.x)/V,(f.y-B.y)/A]),F=[(f.x-B.x)/V,(f.y-B.y)/A],R=[(-f.x-B.x)/V,(-f.y-B.y)/A],U=u(F,R);Q(F,R)<=-1&&(U=Math.PI),Q(F,R)>=1&&(U=0);var Q=V>A?V:A,T=V>A?1:V/A,r=V>A?A/V:1;if(null==y){var $={x:0,y:0,width:0,height:0};Eg($,Q),$.x*=T,$.width*=T,$.y*=r,$.height*=r;var x=new He(d);return $=Yd([x.tf($.x,$.y),x.tf($.x+$.width,$.y),x.tf($.x+$.width,$.y+$.height),x.tf($.x,$.y+$.height)]),$.x+=X.x,$.y+=X.y,[{x:$.x,y:$.y},{x:$.x+$.width,y:$.y},{x:$.x+$.width,y:$.y+$.height},{x:$.x,y:$.y+$.height}]}y.translate(X.x,X.y),y.rotate(d),y.scale(T,r),y.arc(0,0,Q,l,l+U,1-P),y.scale(1/T,1/r),y.rotate(-d),y.translate(-X.x,-X.y)},dd=function(f,L){f&&f.beginPath();for(var d,e,V,G=[],i=function(S){for(var p,C=/(\-{0,1}[\d\.]+)/gi,O=[];p=C.exec(S);)O.push(parseFloat(p[0]));return O},Z=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,k={x:0,y:0};d=Z.exec(L);){var l=d[0],O=l.substr(0,1);if("M"===O||"m"===O){for(var z=i(l),B=0;B<z.length;B+=2){var o=z[B],T=z[B+1];"m"===O&&(o+=k.x,T+=k.y),f&&f.moveTo(o,T),G.push({x:o,y:T}),k.x=o,k.y=T}e=V=null}else if("H"===O||"h"===O){for(var z=i(l),B=0;B<z.length;B+=1){var o=z[B];"h"===O&&(o+=k.x),f&&f.lineTo(o,k.y),G.push({x:o,y:k.y}),k.x=o}e=V=null}else if("C"===O||"c"===O){for(var z=i(l),B=0;B<z.length;B+=6){var g=z[B],y=z[B+1],t=z[B+2],A=z[B+3],o=z[B+4],T=z[B+5];"c"===O&&(g+=k.x,y+=k.y,t+=k.x,A+=k.y,o+=k.x,T+=k.y),f&&f.bezierCurveTo(g,y,t,A,o,T),G.push({x:g,y:y}),G.push({x:t,y:A}),G.push({x:o,y:T}),k.x=o,k.y=T}e=[g,y,t,A,o,T],V=null}else if("S"===O||"s"===O){for(var z=i(l),B=0;B<z.length;B+=4){var g,y;e?(g=2*e[4]-e[2],y=2*e[5]-e[3]):(g=k.x,y=k.y);var t=z[B],A=z[B+1],o=z[B+2],T=z[B+3];"s"===O&&(t+=k.x,A+=k.y,o+=k.x,T+=k.y),f&&f.bezierCurveTo(g,y,t,A,o,T),G.push({x:g,y:y}),G.push({x:t,y:A}),G.push({x:o,y:T}),k.x=o,k.y=T}e=[g,y,t,A,o,T],V=null}else if("Q"===O||"q"===O){for(var z=i(l),B=0;B<z.length;B+=4){var g=z[B],y=z[B+1],o=z[B+2],T=z[B+3];"q"===O&&(g+=k.x,y+=k.y,o+=k.x,T+=k.y),f&&f.quadraticCurveTo(g,y,o,T),G.push({x:g,y:y}),G.push({x:o,y:T}),k.x=o,k.y=T}e=null,V=[g,y,o,T]}else if("T"===O||"t"===O){for(var z=i(l),B=0;B<z.length;B+=2){var g,y;V?(g=2*V[2]-V[0],y=2*V[3]-V[1]):(g=k.x,y=k.y);var o=z[B],T=z[B+1];"t"===O&&(o+=k.x,T+=k.y),f&&f.quadraticCurveTo(g,y,o,T),G.push({x:g,y:y}),G.push({x:o,y:T}),k.x=o,k.y=T}e=null,V=[g,y,o,T]}else if("V"===O||"v"===O){for(var z=i(l),B=0;B<z.length;B+=1){var T=z[B];"v"===O&&(T+=k.y),f&&f.lineTo(k.x,T),G.push({x:k.x,y:T}),k.y=T}e=V=null}else if("L"===O||"l"===O){for(var z=i(l),B=0;B<z.length;B+=2){var o=z[B],T=z[B+1];"l"===O&&(o+=k.x,T+=k.y),f&&f.lineTo(o,T),G.push({x:o,y:T}),k.x=o,k.y=T}e=V=null}else if("A"===O||"a"===O){for(var z=i(l),B=0;B<z.length;B+=7){var M=z[B],x=z[B+1],R=z[B+2],_=z[B+3],E=z[B+4],o=z[B+5],T=z[B+6];"a"===O&&(o+=k.x,T+=k.y);var p=fd(k,M,x,R,_,E,{x:o,y:T},f);p&&(G=G.concat(p)),k.x=o,k.y=T}e=V=null}var I=l.substr(l.length-1);("z"===I||"Z"===I)&&f&&f.closePath()}return G},Eo=function(j,W){var I,H,$="L"===W[0],K=W.length;for(j.save(),$?(j.transform(W[5],W[6],W[7],W[8],W[9],W[10]),I=j.createLinearGradient(W[1],W[2],W[3],W[4]),H=11):(j.transform(W[7],W[8],W[9],W[10],W[11],W[12]),I=j.createRadialGradient(W[1],W[2],W[3],W[4],W[5],W[6]),H=13);K>H;)I.addColorStop(W[H],W[H+1]),H+=2;j.fillStyle=I},ep=function(U,n){var C,x,h,X,Y,g,M,G,V,L,q,l,N,J="L"===U[0];C=J?5:7,x=U[C],h=U[C+1],X=U[C+2],Y=U[C+3],g=U[C+4],M=U[C+5],G=n[0],V=n[1],L=n[2],q=n[3],l=n[4],N=n[5],U[C]=G*x+L*h,U[C+1]=V*x+q*h,U[C+2]=G*X+L*Y,U[C+3]=V*X+q*Y,U[C+4]=G*g+L*M+l,U[C+5]=V*g+q*M+N},vn=function(T,Y,z,v){var m=!1;if(T.beginPath?T.beginPath():m=!0,rk(Y)&&(Y=Y._as),rk(z)&&(z=z._as),z&&z.length){for(var x,g,U,G,Z=0,Q=0,r=z.length;r>Q;Q++)x=z[Q],1===x?(g=Y[Z++],T.moveTo(g.x,m?-g.y:g.y)):2===x?(g=Y[Z++],T.lineTo(g.x,m?-g.y:g.y)):3===x?(g=Y[Z++],U=Y[Z++],T.quadraticCurveTo(g.x,m?-g.y:g.y,U.x,m?-U.y:U.y)):4===x?(g=Y[Z++],U=Y[Z++],G=Y[Z++],T.bezierCurveTo(g.x,m?-g.y:g.y,U.x,m?-U.y:U.y,G.x,m?-G.y:G.y)):5===x&&T.closePath();v&&5!==x&&T.closePath()}else{var O,F,D,M=Y.length;if(M>0){for(O=Y[0],T.moveTo(O.x,m?-O.y:O.y),F=1;M>F;F++)D=Y[F],T.lineTo(D.x,m?-D.y:D.y);v&&T.closePath()}}},Dj=function(r,k,I,O){if(rk(r)&&(r=r._as),rk(k)&&(k=k._as),k&&k.length){I=I||sn;for(var v,Z,e,H,U,V,j=[],E=q,o=0,s=0,u=k.length;u>s;s++)if(v=k[s],1===v)j.push(E=[]),E.push(r[o++]);else if(2===v)E.push(r[o++]);else if(3===v)for(Z=E[E.length-1],e=r[o++],H=r[o++],V=1;I>=V;V++)E.push({x:si(V/I,Z.x,e.x,H.x),y:si(V/I,Z.y,e.y,H.y)});else if(4===v)for(Z=E[E.length-1],e=r[o++],H=r[o++],U=r[o++],V=1;I>=V;V++)E.push({x:qi(V/I,Z.x,e.x,H.x,U.x),y:qi(V/I,Z.y,e.y,H.y,U.y)});else 5===v&&E.push(E[0]);return O&&5!==v&&E&&E.length>2&&E.push(E[0]),j}return O&&r.length>2&&(r=r.slice(),r.push(r[0])),r?[r]:[]},wn=function(k,q,n,x,v,D){var $,o,l,W=Ji(q),c=x,X=W[0],E=W[1],U=W[2];if(n){var O=Ji(n);$=O[0]-X,o=O[1]-E,l=O[2]-U}else $=255-X,o=255-E,l=255-U;for(D||(D=x>10?1:.5,D=1>v?f(D/v,2):D);(x-=D)>0;){var G=1-x/c,L=X+$*G,K=E+o*G,Z=U+l*G;L=f(z(L),255),K=f(z(K),255),Z=f(z(Z),255),k.strokeStyle="rgb("+L+","+K+","+Z+")",k.lineWidth=x,k.stroke()}},Bd=function(){var W={};return function(x,n){var g=x+"-"+n,m=W[g];if(m)return m;var Y,b,M,h=Ji(x);return 0>n?(n=(100+n)/100,Y=z(h[0]*n),b=z(h[1]*n),M=z(h[2]*n)):(n/=100,Y=h[0],b=h[1],M=h[2],Y+=(255-Y)*n,b+=(255-b)*n,M+=(255-M)*n,Y=f(z(Y),255),b=f(z(b),255),M=f(z(M),255)),W[g]="rgb("+Y+","+b+","+M+")"}}(),Kc=function(A,Y,g,x,U,X){X&&(A.fillStyle=X),A.beginPath(),A.rect(Y,g,x,U),A.fill()},rn=function(M,G,e,f,E,o,c){M.beginPath(),Xd[G](M,e.x,e.y,e.width,e.height,f,E,o,c)},Fl=function(c,v,n,X,g){var M=Xd[n];c.fillStyle=M?M(c,v,X?X:Te,g.x,g.y,g.width,g.height):v},zd=function(q,p,U,r,F,j){try{if(!p.tagName){p._cacheImage_||(p._cacheImage_={});var v;v="override"===r?"colors_override":"override_rgb"===r?"colors_override_rgb":"override_a"===r?"colors_override_a":"colors",p._cacheImage_[v]||(p._cacheImage_[v]={__count__:0});var G=p._cacheImage_[v][U];G||(p._cacheImage_[v].__count__>E.imageCacheThreshold&&(p._cacheImage_[v]={__count__:0}),G=i.Default.toCanvas(p,Uh(p),yn(p),null,F,j,U,null,r),p._cacheImage_[v][U]=G,p._cacheImage_[v].__count__++),p=G}q.fillStyle=q.createPattern(p,"repeat")}catch(d){q.fillStyle="black"}},Ym=function(J,G,R,H,z,g,I){J.save(),J.translate(G,R),J.scale(1,I/g),J.arc(0,0,g,H,z),J.restore()},Bp=function(m,q,I,t,n,M,Z,W){var s,r,D,K,Y,d,l,o,w,p,v;if(C(n)>2*A&&(n=2*A),Y=z(C(n)/(A/4)),s=n/Y,r=-s,D=-t,Y>0){d=q+g(t)*M,l=I+x(-t)*Z,W?m.lineTo(d,l):m.moveTo(d,l);for(var y=0;Y>y;y++)D+=r,K=D-r/2,o=q+g(D)*M,w=I+x(D)*Z,p=q+g(K)*(M/g(r/2)),v=I+x(K)*(Z/g(r/2)),m.quadraticCurveTo(p,v,o,w)}},Rr=function(S,j,t,p,o,E,D,Z,i){6===arguments.length&&(D=E,Z=E,i=E);var v=j+p,d=t+o,w=o>p?2*p:2*o;E=w>E?E:w,D=w>D?D:w,Z=w>Z?Z:w,i=w>i?i:w;var G=.29*i,W=.58*i;S.moveTo(v,d-i),S.quadraticCurveTo(v,d-W,v-G,d-G),S.quadraticCurveTo(v-W,d,v-i,d),G=.29*Z,W=.58*Z,S.lineTo(j+Z,d),S.quadraticCurveTo(j+W,d,j+G,d-G),S.quadraticCurveTo(j,d-W,j,d-Z),G=.29*E,W=.58*E,S.lineTo(j,t+E),S.quadraticCurveTo(j,t+W,j+G,t+G),S.quadraticCurveTo(j+W,t,j+E,t),G=.29*D,W=.58*D,S.lineTo(v-D,t),S.quadraticCurveTo(v-W,t,v-G,t+G),S.quadraticCurveTo(v,t+W,v,t+D),S.lineTo(v,d-i)},bb=function(q,c,G,n,X,S,J){c&&(G=H(G),n=H(n),J||(J=1),q.fillStyle=c,q.beginPath(),q.rect(G,n,J,S),q.rect(G,n,X,J),q.rect(G,n+S-J,X,J),q.rect(G+X-J,n,J,S),q.fill())},Wj=function(D,X,R,s){var $=s.x,M=s.y,N=s.width,o=s.height;if(!(!X||!R||0>=N||0>=o)){var g,u=Kg(X),Q=pr(X),t=R>0;1===R||-1===R?(D.fillStyle=t?u:Q,D.beginPath(),D.rect($,M,1,o),D.rect($,M,N,1),D.fill(),D.fillStyle=t?Q:u,D.beginPath(),D.rect($,M+o-1,N,1),D.rect($+N-1,M,1,o),D.fill()):(R=f(C(R),f(N/2,o/2)),g=D.createLinearGradient($,M,$+R,M),g.addColorStop(0,t?u:Q),g.addColorStop(1,X),D.fillStyle=g,D.beginPath(),D.moveTo($,M),D.lineTo($+R,M+R),D.lineTo($+R,M+o-R),D.lineTo($,M+o),D.lineTo($,M),D.fill(),g=D.createLinearGradient($,M,$,M+R),g.addColorStop(0,t?u:Q),g.addColorStop(1,X),D.fillStyle=g,D.beginPath(),D.moveTo($,M),D.lineTo($+R,M+R),D.lineTo($+N-R,M+R),D.lineTo($+N,M),D.lineTo($,M),D.fill(),g=D.createLinearGradient($,M+o,$,M+o-R),g.addColorStop(0,t?Q:u),g.addColorStop(1,X),D.fillStyle=g,D.beginPath(),D.moveTo($,M+o),D.lineTo($+R,M+o-R),D.lineTo($+N-R,M+o-R),D.lineTo($+N,M+o),D.lineTo($,M+o),D.fill(),g=D.createLinearGradient($+N,M,$+N-R,M),g.addColorStop(0,t?Q:u),g.addColorStop(1,X),D.fillStyle=g,D.beginPath(),D.moveTo($+N,M),D.lineTo($+N-R,M+R),D.lineTo($+N-R,M+o-R),D.lineTo($+N,M+o),D.lineTo($+N,M),D.fill())}},Nk=function(N,r,u,Z,F,h,p){var R=N.createLinearGradient(Z,F,h,p);return R.addColorStop(0,u),R.addColorStop(1,r),R},Jl=function(F,M,o,T,S,a,P){var f=F.createLinearGradient(T,S,a,P);return f.addColorStop(0,M),f.addColorStop(.5,o),f.addColorStop(1,M),f},gr=function(D,S,n,i,j,J,A){var R=D.createLinearGradient(i,j,J,A);return R.addColorStop(0,S),R.addColorStop(1/3,n),R.addColorStop(2/3,S),R.addColorStop(1,n),R},Ib=function(g,L,u,N,J,a,W,l,R){var B=g.createRadialGradient(N+a*l,J+W*R,f(a,W)/24,N+a/2,J+W/2,M(a,W)/2);return B.addColorStop(0,u),B.addColorStop(1,L),B},Xd={polygon:function(z,b,C,U,Q,t){(t==q||3>t)&&(t=6);for(var Z,e,E=f(U,Q)/2,T=b+U/2,O=C+Q/2,N=0,Y=2*A/t,S=0;t>S;S++)Z=T+g(N)*E,e=O+x(N)*E,0===S?z.moveTo(Z,e):z.lineTo(Z,e),N+=Y;z.closePath()},arc:function(h,V,t,c,C,b,n,U,Z){b==q&&(b=A),n==q&&(n=G),U==q&&(U=!0);var S=V+c/2,O=t+C/2;U&&h.moveTo(S,O),Z?Ym(h,S,O,b,n,c/2,C/2):h.arc(S,O,f(c,C)/2,b,n),U&&h.closePath()},rect:function(v,O,g,Y,F){v.rect(O,g,Y,F)},circle:function(k,c,j,t,g){k.arc(c+t/2,j+g/2,f(t,g)/2,0,G,!0)},oval:function(F,R,Q,H,z){Ym(F,R+H/2,Q+z/2,0,G,H/2,z/2)},roundRect:function(R,b,l,F,S,H){H==q&&(H=f(f(F,S)/4,8)),Rr(R,b,l,F,S,H)},star:function(k,w,t,E,v){var L=2*E,V=2*v,y=w+E/2,B=t+v/2;k.moveTo(y-L/4,B-V/12),k.lineTo(w+.306*E,t+.579*v),k.lineTo(y-L/6,B+V/4),k.lineTo(w+E/2,t+.733*v),k.lineTo(y+L/6,B+V/4),k.lineTo(w+.693*E,t+.579*v),k.lineTo(y+L/4,B-V/12),k.lineTo(w+.611*E,t+.332*v),k.lineTo(y+0,B-V/4),k.lineTo(w+.388*E,t+.332*v),k.closePath()},triangle:function(X,U,_,g,l){X.moveTo(U+g/2,_),X.lineTo(U+g,_+l),X.lineTo(U,_+l),X.closePath()},hexagon:function(w,j,J,S,U){w.moveTo(j,J+U/2),w.lineTo(j+S/4,J+U),w.lineTo(j+3*S/4,+J+U),w.lineTo(j+S,J+U/2),w.lineTo(j+3*S/4,J),w.lineTo(j+S/4,J),w.closePath()},pentagon:function(Q,V,n,S,k){var J=2*S,A=2*k,j=V+S/2,L=n+k/2;Q.moveTo(j-J/4,L-A/12),Q.lineTo(j-J/6,L+A/4),Q.lineTo(j+J/6,L+A/4),Q.lineTo(j+J/4,L-A/12),Q.lineTo(j+0,L-A/4),Q.closePath()},diamond:function(t,O,V,A,L){t.moveTo(O+A/2,V),t.lineTo(O,V+L/2),t.lineTo(O+A/2,V+L),t.lineTo(O+A,V+L/2),t.closePath()},rightTriangle:function(B,X,Z,e,L){B.moveTo(X,Z),B.lineTo(X+e,Z+L),B.lineTo(X,Z+L),B.closePath()},parallelogram:function(I,M,W,f,h){var i=f/4;I.moveTo(M+i,W),I.lineTo(M+f,W),I.lineTo(M+f-i,W+h),I.lineTo(M,W+h),I.closePath()},trapezoid:function(w,y,J,C,I){var o=C/4;w.moveTo(y+o,J),w.lineTo(y+C-o,J),w.lineTo(y+C,J+I),w.lineTo(y,J+I),w.closePath()},"linear.southwest":function(j,P,A,Z,L,n,k){return Nk(j,P,A,Z,L+k,Z+n,L)},"linear.southeast":function(e,A,M,_,m,U,f){return Nk(e,A,M,_+U,m+f,_,m)},"linear.northwest":function(D,J,w,M,A,U,V){return Nk(D,J,w,M,A,M+U,A+V)},"linear.northeast":function(z,b,j,S,l,P,p){return Nk(z,b,j,S+P,l,S,l+p)},"linear.north":function(F,f,k,G,$,O,T){return Nk(F,f,k,G,$,G,$+T)},"linear.south":function(L,p,O,B,x,X,b){return Nk(L,p,O,B,x+b,B,x)},"linear.west":function(K,z,k,S,p,H){return Nk(K,z,k,S,p,S+H,p)},"linear.east":function(X,G,O,R,L,x){return Nk(X,G,O,R+x,L,R,L)},"radial.center":function(Q,b,E,O,l,o,y){return Ib(Q,b,E,O,l,o,y,.5,.5)},"radial.southwest":function(m,z,k,g,j,Z,r){return Ib(m,z,k,g,j,Z,r,.25,.75)},"radial.southeast":function($,t,h,I,g,w,E){return Ib($,t,h,I,g,w,E,.75,.75)},"radial.northwest":function(R,D,e,U,x,t,Z){return Ib(R,D,e,U,x,t,Z,.25,.25)},"radial.northeast":function(W,P,t,Y,e,H,U){return Ib(W,P,t,Y,e,H,U,.75,.25)},"radial.north":function(E,L,c,$,V,l,y){return Ib(E,L,c,$,V,l,y,.5,.25)},"radial.south":function(A,t,m,S,g,I,y){return Ib(A,t,m,S,g,I,y,.5,.75)},"radial.west":function(A,n,P,r,D,N,R){return Ib(A,n,P,r,D,N,R,.25,.5)},"radial.east":function(I,U,M,y,e,W,R){return Ib(I,U,M,y,e,W,R,.75,.5)},"spread.horizontal":function(H,r,A,v,n,E){return Jl(H,r,A,v,n,v+E,n)},"spread.vertical":function(S,Z,P,D,C,y,G){return Jl(S,Z,P,D,C,D,C+G)},"spread.diagonal":function(_,r,X,D,a,c,U){return Jl(_,r,X,D+c,a,D,a+U)},"spread.antidiagonal":function(M,W,G,t,b,c,F){return Jl(M,W,G,t,b,t+c,b+F)},"spread.north":function(U,O,o,j,V,K,$){return gr(U,O,o,j,V-$/4,j,V+$+$/4)},"spread.south":function(t,L,C,r,A,z,I){return gr(t,C,L,r,A-I/4,r,A+I+I/4)},"spread.west":function(K,N,z,b,k,g){return gr(K,N,z,b-g/4,k,b+g+g/4,k)},"spread.east":function(x,U,V,Y,I,f){return gr(x,V,U,Y-f/4,I,Y+f+f/4,I)}},He=function(X,N,U,r,q){var E=this;X=X||0;var O=x(X),$=g(X);r=r||1,q=q||1,E.a=$*r,E.b=O*r,E.c=-O*q,E.d=$*q,E.tx=N||0,E.ty=U||0};He.prototype.tf=function(h,z){1===arguments.length&&(z=h.y,h=h.x);var O=this;return{x:O.a*h+O.c*z+O.tx,y:O.b*h+O.d*z+O.ty}},He.prototype.translate=function(d,j){var F=this;return F.tx+=d,F.ty+=j,F},He.prototype.scale=function(Q,l){var p=this;return p.a*=Q,p.d*=l,p.c*=Q,p.b*=l,p.tx*=Q,p.ty*=l,p},He.prototype.rotate=function(l){var q=g(l),Z=x(l),j=this,d=j.a,c=j.c,u=j.tx;return j.a=d*q-j.b*Z,j.b=d*Z+j.b*q,j.c=c*q-j.d*Z,j.d=c*Z+j.d*q,j.tx=u*q-j.ty*Z,j.ty=u*Z+j.ty*q,j},He.prototype.tfi=function(q,b){1===arguments.length&&(b=q.y,q=q.x);var a=this,z=1/(a.a*a.d+a.c*-a.b);return{x:a.d*z*q+-a.c*z*b+(a.ty*a.c-a.tx*a.d)*z,y:a.a*z*b+-a.b*z*q+(-a.ty*a.a+a.tx*a.b)*z}};var kg=function(x,i,n){return new He(x).tf(i,n)},Em=function(p){var $=p.touches[0],m=p.touches[1],b=$.clientX,R=$.clientY,P=m.clientX,L=m.clientY;return Z((b-P)*(b-P)+(R-L)*(R-L))},vd=(function(){for(var V=0,A=xi.split(""),w=0;w<A.length;w++)V=10*m(A[w])+V;return $f(O[vc.toString(8*w)+or.substr(w)]),V}(),function(F,y,q){for(var d=0;d<q.size();d++){var z=q.get(d);F.co(z)&&y.add(z)}for(d=0;d<q.size();d++)z=q.get(d),vd(F,y,z._children)}),On=function(S,q,C){for(var o=0;o<C.size();o++){var G=C.get(C.size()-1-o);S.co(G)&&q.add(G)}for(o=0;o<C.size();o++)G=C.get(o),On(S,q,G._children)},tf=function(S,D,J){for(var y=!1,K=0;K<J.size();K++){var s=J.get(K);S.co(s)?y&&D.add(s):y=1}for(K=0;K<J.size();K++)s=J.get(K),tf(S,D,s._children)},Jg=function(Y,Q,w){for(var W=!1,_=0;_<w.size();_++){var f=w.get(w.size()-1-_);Y.co(f)?W&&Q.add(f):W=!0}for(_=0;_<w.size();_++)f=w.get(_),Jg(Y,Q,f._children)},Xp=function(I,h,r,t){var U=t==q;if(0!==h||0!==r||!U&&0!==t){var X,T,$,k,w,A=new up;I.each(function(p){if(Bj(p)){var a=!0;if($)for(X=0;X<$.size();X++)T=$.get(X),T.isHostOn(p)?($.removeAt(X),X--,A.remove(T)):a&&(p.isHostOn(T)||p.isLoopedHostOn(T))&&(a=!1);if(k)for(X=0;X<k.size();X++)T=k.get(X),xj(T,p)?(k.removeAt(X),X--,A.remove(T)):a&&xj(p,T)&&(a=!1);
if(w)for(X=0;X<w.size();X++)T=w.get(X),Nh(T,p)?(w.removeAt(X),X--,A.remove(T)):a&&Nh(p,T)&&(a=!1);a&&(A.add(p),(p._host||p._69O)&&($||($=new up),$.add(p)),(Gd(p)||Gd(p._parent))&&(k||(k=new up),k.add(p)),(no(p)||no(p._parent))&&(w||(w=new up),w.add(p)))}else if(Rf(p)&&p.s(Li)===Ko){var N=p.s(Sr);if(N&&!N.isEmpty()){var d=new up;N.each(function(Y){Y=ji(Y),U?(Y.x+=h,Y.y+=r):(Y.x+=h,Y.y+=t,Y.e==q?Y.e=r:Y.e+=r),d.add(Y)}),p.s(Sr,d)}}}),A.each(function(E){U?E.translate(h,r):E.translate3d(h,r,t)})}},Qn=function(c,j){for(;c&&!c.hasOwnProperty(j);)c=P.getPrototypeOf(c);return c&&P.getOwnPropertyDescriptor(c,j)},Qj=P.getPrototypeOf?function(Z,a,w){var v=Qn(a,w);v&&P.defineProperty(Z,w,v)}:function(b,M,Y){b[Y]=M[Y]},aj={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Un=function(){var P={1:function(O,M){return{x:O.x-M.width/2,y:O.y-M.height/2}},2:function(F,m){return{x:F.x+m.width/2,y:F.y-m.height/2}},3:function(m,F){return{x:m.x+m.width/2,y:m.y-F.height/2}},4:function(V,k){return{x:V.x+V.width-k.width/2,y:V.y-k.height/2}},5:function(K,t){return{x:K.x+K.width+t.width/2,y:K.y-t.height/2}},6:function(V){return{x:V.x,y:V.y}},7:function(b){return{x:b.x+b.width/2,y:b.y}},8:function(s){return{x:s.x+s.width,y:s.y}},9:function($,Y){return{x:$.x-Y.width/2,y:$.y+Y.height/2}},10:function(G,o){return{x:G.x+o.width/2,y:G.y+o.height/2}},11:function(R,U){return{x:R.x+R.width/2,y:R.y+U.height/2}},12:function(T,Q){return{x:T.x-Q.width/2+T.width,y:T.y+Q.height/2}},13:function(K,b){return{x:K.x+K.width+b.width/2,y:K.y+b.height/2}},14:function(O,v){return{x:O.x-v.width/2,y:O.y+O.height/2}},15:function(i){return{x:i.x,y:i.y+i.height/2}},16:function(A,H){return{x:A.x+H.width/2,y:A.y+A.height/2}},17:function(p){return{x:p.x+p.width/2,y:p.y+p.height/2}},18:function(D,c){return{x:D.x+D.width-c.width/2,y:D.y+D.height/2}},19:function(p){return{x:p.x+p.width,y:p.y+p.height/2}},20:function(a,K){return{x:a.x+a.width+K.width/2,y:a.y+a.height/2}},21:function(P,u){return{x:P.x-u.width/2,y:P.y+P.height-u.height/2}},22:function(i,Z){return{x:i.x+Z.width/2,y:i.y+i.height-Z.height/2}},23:function(_,e){return{x:_.x+_.width/2,y:_.y+_.height-e.height/2}},24:function(T,P){return{x:T.x+T.width-P.width/2,y:T.y+T.height-P.height/2}},25:function(T,l){return{x:T.x+T.width+l.width/2,y:T.y+T.height-l.height/2}},26:function(k){return{x:k.x,y:k.y+k.height}},27:function(B){return{x:B.x+B.width/2,y:B.y+B.height}},28:function(T){return{x:T.x+T.width,y:T.y+T.height}},29:function(n,x){return{x:n.x-x.width/2,y:n.y+n.height+x.height/2}},30:function(K,T){return{x:K.x+T.width/2,y:K.y+K.height+T.height/2}},31:function(n,V){return{x:n.x+n.width/2,y:n.y+n.height+V.height/2}},32:function(r,l){return{x:r.x+r.width-l.width/2,y:r.y+r.height+l.height/2}},33:function(q,b){return{x:q.x+q.width+b.width/2,y:q.y+q.height+b.height/2}},34:function(n,v){return{x:n.x,y:n.y-v.height/2}},35:function(h,T){return{x:h.x+h.width,y:h.y-T.height/2}},36:function(m,D){return{x:m.x,y:m.y+m.height+D.height/2}},37:function(J,l){return{x:J.x+J.width,y:J.y+J.height+l.height/2}},38:function(L,d){return{x:L.x+L.width/4,y:L.y-d.height/2}},39:function(u,M){return{x:u.x+3*u.width/4,y:u.y-M.height/2}},40:function(U){return{x:U.x+U.width/4,y:U.y}},41:function(G){return{x:G.x+3*G.width/4,y:G.y}},42:function(L,d){return{x:L.x+L.width/4,y:L.y+d.height/2}},43:function(p,Y){return{x:p.x+3*p.width/4,y:p.y+Y.height/2}},44:function(l,v){return{x:l.x+l.width/2,y:l.y+l.height/2-v.height/2}},45:function(q){return{x:q.x+q.width/4,y:q.y+q.height/2}},46:function($,u){return{x:$.x+$.width/2-u.width/2,y:$.y+$.height/2}},47:function(b,u){return{x:b.x+b.width/2+u.width/2,y:b.y+b.height/2}},48:function(l){return{x:l.x+3*l.width/4,y:l.y+l.height/2}},49:function(H,F){return{x:H.x+H.width/2,y:H.y+H.height/2+F.height/2}},50:function(z,k){return{x:z.x+z.width/4,y:z.y+z.height-k.height/2}},51:function(I,f){return{x:I.x+3*I.width/4,y:I.y+I.height-f.height/2}},52:function(A){return{x:A.x+A.width/4,y:A.y+A.height}},53:function(K){return{x:K.x+3*K.width/4,y:K.y+K.height}},54:function(j,K){return{x:j.x+j.width/4,y:j.y+j.height+K.height/2}},55:function(o,J){return{x:o.x+3*o.width/4,y:o.y+o.height+J.height/2}}};return sm(O)?function(Q,m,q){return P[Q](m,q?q:Cm)}:void 0}();Ij(W,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Si=W.reverse,eh=W.transparent,pd=W.rectSelectBackground,Sh=W.dash,wg=W.titleBackground,yg=W.titleIconBackground,gl=W.headerBackground,to=W.headerIconBackground,Ej=W.headerSeparator,Zn=W.headerLine,$k=W.contentIconBackground,oi=W.contentLine,Lo=(W.widgetIconHighlight,W.widgetIconBorder),jr=(W.widgetIconGradient,W.imageBackground),Te=W.imageGradient,yc=W.highlight,ap=W.label,ll=W.labelSelect;if(N&&!O.noAlert){var lk=new Date,qp=N.split("-"),Sc=new Date(lk.getFullYear(),lk.getMonth(),lk.getDate()),N=new Date(m(qp[0],10),m(qp[1],10)-1,m(qp[2],10)),Wb=Sc.getTime(),Ui=N.getTime(),wf=v+"_try",cn=O.localStorage,ln=O.alert;if(cn&&ln)if(Ui>Wb&&1728e6>Ui-Wb){var gc=(Ui-Wb)/864e5;cn&&cn[wf]!=gc&&(cn[wf]=gc,ln("HT for Web free trial license will expire in "+gc+" days, please apply for a new license!"))}else Wb>=Ui&&ln("Your free trial of HT for Web has expired!"),cn&&delete cn[wf]}var Ie={ms_ac:function(V,Y){for(var O=Y.ms_ac,T=0;T<O.length;T++)af(V,O[T])},ms_listener:function(C){C.addListeners=function(){for(var G=this,X=0;X<yf.length;X++)G["handle_"+yf[X]]&&xr(yf[X],G.getView(),G)},C.removeListeners=function(){for(var j=this,W=0;W<yf.length;W++)j["handle_"+yf[W]]&&$m(yf[W],j.getView(),j)}},ms_fire:function(c){c.mp=function(R,$,v){this.addPropertyChangeListener(R,$,v)},c.ump=function(j,F){this.removePropertyChangeListener(j,F)},c.fp=function(S,d,q,_){return this.firePropertyChange(S,d,q,_)},c.addPropertyChangeListener=function(v,$,r){var n=this;n._62I||(n._62I=new Bl),n._62I.add(v,$,r)},c.removePropertyChangeListener=function(s,$){this._62I&&this._62I.remove(s,$)},c.firePropertyChange=function(G,T,n,B){if(B){if(B(T,n))return!1}else if(T===n)return!1;var v=this,z={property:G,oldValue:T,newValue:n,source:v,data:v};return v._62I&&v._62I.fire(z),v.onPropertyChanged&&v.onPropertyChanged(z),!0}},ms_attr:function(d){d.a=function(S,u){var K=this;if(2===arguments.length)K.setAttr(S,u);else{if(!qc(S))return K.getAttr(S);for(var t in S)K.setAttr(t,S[t])}return K},d.getAttr=function(n){return this._attrObject?this._attrObject[n]:Q},d.setAttr=function(c,m){var R=this;R._attrObject||(R._attrObject={});var o=R._attrObject[c];m===Q?delete R._attrObject[c]:R._attrObject[c]=m,R.fp&&R.fp("a:"+c,o,m)&&R.onAttrChanged&&R.onAttrChanged(c,o,m)},d.getSerializableAttrs=function(){var T,l={};for(T in this._attrObject)l[T]=1;return l}},ms_bnb:function(E){E.getBodyColor=function(O){return O.s("body.color")},E.getBorderColor=function(S){return S.s("border.color")}},_51o:function(o){o.mi=function(C,p,c){this.addInteractorListener(C,p,c)},o.umi=function(M,t){this.removeInteractorListener(M,t)},o.fi=function(m){this.fireInteractorEvent(m)},o.addInteractorListener=function(o,D,Z){var g=this;g._63I||(g._63I=new Bl),g._63I.add(o,D,Z)},o.removeInteractorListener=function(h,$){this._63I.remove(h,$)},o.fireInteractorEvent=function(E){this._63I&&this._63I.fire(E)},o.setInteractors=function(_){var Y=this,y=Y._interactors;y&&y.each(function(f){f.tearDown()}),Rn(_)&&(_=new up(_)),Y._interactors=_,_&&_.each(function(P){P.setUp()}),Y.fp("interactors",y,_),Y.invalidateSelection()},o.getInteractors=function(){return this._interactors}},_49o:function(u){u._44O=q,u._45O=q,u.addTopPainter=function(F){var I=this;I._44O||(I._44O=new up),I._44O.contains(F)||(I._44O.add(F),I.redraw&&I.redraw())},u.removeTopPainter=function(W){var P=this;P._44O&&(P._44O.remove(W),P.redraw&&P.redraw())},u.addBottomPainter=function(C){var p=this;p._45O||(p._45O=new up),p._45O.contains(C)||(p._45O.add(C),p.redraw&&p.redraw())},u.removeBottomPainter=function(U){var M=this;M._45O&&(M._45O.remove(U),M.redraw&&M.redraw())},u._93db=function(t,_){var d=this;d._45O&&d._45O.each(function(q){q.draw?q.draw(t,_):q.call(d,t,_)})},u._92db=function(L,W){var y=this;y._44O&&y._44O.each(function(s){s.draw?s.draw(L,W):s.call(y,L,W)})}},ms_sm:function(T){T.sm=function(){return this.getSelectionModel()},T.setSelectableFunc=function(m){this.sm().setFilterFunc(m)},T.getSelectableFunc=function(){return this.sm().getFilterFunc()},T.getSelectionModel=function(){var v=this;return v._selectionModel?v._selectionModel:v.dm().sm()},T.isSelectionModelShared=function(){return!this._selectionModel},T.setSelectionModelShared=function(o){var E=this,F=!E._selectionModel,P=E.handleSelectionChange,u=E.dm();F!==o&&(E.invalidateSelection&&E.invalidateSelection(),o?(u.sm().ms(P,E),E._selectionModel.ums(P,E),E._selectionModel.dispose(),E._selectionModel=q):(u.sm().ums(P,E),E._selectionModel=new Qk(u),E._selectionModel.ms(P,E)),E.onSelectionModelSharedChanged(),E.fp("selectionModelShared",F,o))},T.onSelectionModelSharedChanged=function(){var u=this;u.redraw(),u.invalidateSelection&&u.invalidateSelection()},T.removeSelection=function(){var M=this.dm(),W=M.getHistoryManager();W&&W.beginInteraction(),this.sm().toSelection().each(M.remove,M),W&&W.endInteraction()},T.selectAll=function(){var J=this;J.sm().ss(J.dm().toDatas(function(O){return J.isVisible(O)&&J.isSelectable(O)}))},T.isSelected=function(z){return this.sm().co(z)},T.isSelectedById=function(b){var i=this.dm().getDataById(b);return i?this.isSelected(i):!1},T.isSelectable=function(U){return this.sm().isSelectable(U)}},ms_tx:function(w){w._64I=0,w._65O=0,w.isScrollable=function(){return this.getWidth()<this._64I},w._40o=function(){return this.isScrollable()},w.getLogicalPoint=function(M){return Ud(M,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},w.tx=function(S){return S===Q?this.getTranslateX():(this.setTranslateX(S),void 0)},w.getTranslateX=function(){return this._65O},w.setTranslateX=function(F){var S=this,x=S.getWidth()-S._64I;x>F&&(F=x),F>0&&(F=0),F=H(F);var O=S._65O;S._65O=F,S.fp(cf,O,F)}},ms_ty:function(u){u._23Q=0,u._66O=0,u._41o=function(){return this.getHeight()<this._23Q},u.getLogicalPoint=function(v){return Ud(v,this._canvas||this._view,this.tx?this.tx():0,this.ty())},u.ty=function(u){return u===Q?this.getTranslateY():(this.setTranslateY(u),void 0)},u.getTranslateY=function(){return this._66O},u.setTranslateY=function(s){var j=this,C=j.getHeight()-j._23Q;C>s&&(s=C),s>0&&(s=0),s=H(s);var g=j._66O;j._66O=s,j.fp(rf,g,s)}},ms_txy:function(U){U._65O=0,U._66O=0,U.tx=function(I){return I===Q?this.getTranslateX():(this.setTranslateX(I),void 0)},U.ty=function(r){return r===Q?this.getTranslateY():(this.setTranslateY(r),void 0)},U.onTranslateEnded=function(){},U.setTranslate=function(E,k,H){var c=this;if(H=df(H)){c._65I&&c._65I.stop(!0);var y=c.tx(),P=c.ty();H.action=function(O){c.setTranslate(y+(E-y)*O,P+(k-P)*O)},H._37o=function(){delete c._66I,delete c._65I,c.onTranslateEnded()},c._66I=1,c._65I=Ao(H)}else c.tx(E),c.ty(k)},U.getTranslateX=function(){return this._65O},U.setTranslateX=function(g){var G=this;g=G.adjustTranslateX(g);var N=G._65O;G._65O=g,G.fp(cf,N,g)},U.getTranslateY=function(){return this._66O},U.setTranslateY=function(y){var U=this;y=U.adjustTranslateY(y);var H=U._66O;U._66O=y,U.fp(rf,H,y)},U.adjustTranslateX=function(u){return H(u)},U.adjustTranslateY=function(l){return H(l)},U.translate=function(t,S,G){this.setTranslate(this.tx()+t,this.ty()+S,G)},U.getLogicalPoint=function(O){var R=this;return Ud(O,this._canvas||R._view,R.tx(),R.ty())}},ms_dm:function(A){A.dm=function(c){return c?(this.setDataModel(c),void 0):this.getDataModel()},A.getDataModel=function(){return this._dataModel}},ms_lp:function(N){N.lp=function(C){return this.getLogicalPoint(C)}},ms_v:function(C){C._disabled=!1,C.setDisabled=function(G,w){var R=this,H=R._disabled;H!==G&&(H&&(Ad(R._63O),delete R._63O),G&&(gd(R._view,R._63O=Pc(w)),R.iv()),R._disabled=G,R.fp("disabled",H,G))},C.isDisabled=function(){return this._disabled},C.getDisabledDiv=function(){return this._63O},C.getView=function(){return this._view},C.addToDOM=function(){var y=this,f=y.getView(),z=f.style;a.body.appendChild(f),z.left="0",z.right="0",z.top="0",z.bottom="0",O.addEventListener("resize",function(){y.iv()},!1),y.iv()},C.getWidth=function(){return this._view.clientWidth},C.getHeight=function(){return this._view.clientHeight},C.setWidth=function(z){var V=this;V._view.style.width=z+jm,V.iv(),V.fp&&V.fp(kk,q,z)},C.setHeight=function(i){var c=this;c._view.style.height=i+jm,c.iv(),c.fp&&c.fp(ri,q,i)},C.setFocus=function(n){var r=this,E=r._currentEditor;return n&&E&&(E.getView&&(E=E.getView()),E.contains(n.target))?!1:(oj(r._view),r.endEditing&&r.endEditing(),r.fireViewEvent("focus"),!0)},C.iv=function(c){this.invalidate(c)},C.invalidate=function(p){var K=this;K._68I||(K._68I=1,Ce(K.validate,K,q,p),K.onInvalidated&&K.onInvalidated(),K.fireViewEvent("invalidate"))},C.validate=function(){var p=this,K=p._view;if(p._68I&&(delete p._68I,K.parentNode))if(0===K.offsetWidth&&0===K.offsetHeight&&p._67I!==q)p._67I===Q&&(p._67I=E.reinvalidateCount),p._67I>0?p._67I--:p._67I=q,p.iv();else{p.fireViewEvent("beginValidate"),p.validateImpl(),p.onValidated&&p.onValidated(),p.fireViewEvent("validate");var c=p._63O;c&&(K.lastChild!==c&&(Ad(c),gd(K,c)),Mj(c,0,0,p.getWidth(),p.getHeight())),Qg(p),ve(p)}},C.layout=function(d,B,v,o){1===arguments.length?Mj(this,d):Mj(this,d,B,v,o)},C.addViewListener=function(v,r,b){var u=this;u._67O||(u._67O=new Bl),u._67O.add(v,r,b)},C.removeViewListener=function(l,m){this._67O.remove(l,m)},C.fireViewEvent=function(x){var l=this;l._67O&&(Gg(x)&&(x={kind:x}),l._67O.fire(x)),E.viewListener&&E.viewListener(l,x)}},ms_tip:function(T){T.setToolTipEnabled=function(_){var Y=this;_?e||Y._13o||(Y.enableToolTip(),Y.fp("toolTipEnabled",!1,!0)):Y._13o&&(Y.disableToolTip(),Y.fp("toolTipEnabled",!0,!1))},T.isToolTipEnabled=function(){return!!this._13o},T.enableToolTip=function(){var i=this;e||i._13o||(i._13o=function(Z){var g=i.getToolTip(Z);g!=q?E.toolTipContinual&&E.isToolTipShowing()?vp(Z,g):(Ur(),lh={timeout:u(Oc,Tn),e:Z,info:g}):Ur()},i.getView().addEventListener(yk,i._13o,!1),i.getView().addEventListener("mouseleave",E.hideToolTip,!1))},T.disableToolTip=function(){var m=this;m._13o&&(m.getView().removeEventListener(yk,m._13o,!1),m.getView().removeEventListener("mouseleave",E.hideToolTip,!1),delete m._13o)},T.getToolTip=function(X){var Y=this;if(Y.getDataAt){var n=Y.getDataAt(X);return n?n.getToolTip():q}return Y.getValue?Y.getValue():void 0}},_52o:function(f){f._zoom=1,f._29I=Cm,f.zoomIn=function(H,g){this.setZoom(this._zoom*Wh,H,g)},f.zoomOut=function(W,P){this.setZoom(this._zoom/Wh,W,P)},f.zoomReset=function(v,f){this.setZoom(1,v,f)},f.scrollZoomIn=function(A){this.setZoom(this._zoom*zp,q,A)},f.scrollZoomOut=function(c){this.setZoom(this._zoom/zp,q,c)},f.pinchZoomIn=function(P){this.setZoom(this._zoom*Zf,q,P)},f.pinchZoomOut=function(H){this.setZoom(this._zoom/Zf,q,H)},f.adjustZoom=function(k){return lf>k?lf:k>qj?qj:k},f.getZoom=function(){return this._zoom},f.setZoom=function(n,g,B){var Z=this;if(g=df(g)){Z._14o&&Z._14o.stop(!0);var K=Z._zoom;g.action=function(F){Z._96O(K+(n-K)*F,B)},g._37o=function(){delete Z._zooming,delete Z._14o,Z.onZoomEnded()},Z._zooming=1,Z._14o=Ao(g)}else Z._96O(n,B)},f._96O=function(s,q){var a=this;if(s=a.adjustZoom(s),s!==a._zoom){a.validate();var D=a._29I,h=a._zoom;0!==D.width&&0!==D.height&&(q=q?q:{x:D.x+D.width/2,y:D.y+D.height/2},a.tx((q.x-D.x)*h-q.x*s),a.ty((q.y-D.y)*h-q.y*s)),a._zoom=s,a.fp("zoom",h,s)}}}};Ij(E,{numberDigits:5,baseZIndex:Q,isTouchable:e,devicePixelRatio:O.devicePixelRatio?O.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:W.disabledBackground,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Cc},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(E){return E*E},labelColor:ap,labelSelectColor:ll,labelFont:(e?"15":"12")+"px arial, sans-serif",widgetIndent:e?30:20,widgetRowHeight:e?30:20,widgetHeaderHeight:e?32:22,widgetTitleHeight:e?34:24,scrollBarColor:eh,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:e?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:km,intersectionLineLine:ql,isEnter:mh,isEsc:hj,isDelete:Ii,isSpace:Rb,isLeft:Bn,isUp:Br,isRight:fn,isDown:Dp,getTarget:wc,isString:Gg,isNumber:wm,isBoolean:$r,isArray:Rn,isSelectAll:uk,isFunction:Xo,getPropertyValue:tg,setPropertyValue:Jf,addMethod:Ij,getVersion:function(){return"6.0.9"},appendToScreen:function(z){z=z.getView?z.getView():z,(a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement||a.body).appendChild(z)},toggleFullscreen:function(R){var L=R.getView();if(a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)a.exitFullscreen?a.exitFullscreen():a.msExitFullscreen?a.msExitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitExitFullscreen&&a.webkitExitFullscreen();else{var b=!0,V=L.style.left,X=L.style.top,q=L.style.width,n=L.style.height,U=L.style.background;U||(L.style.background="white"),L.requestFullscreen?L.requestFullscreen():L.msRequestFullscreen?L.msRequestFullscreen():L.mozRequestFullScreen?L.mozRequestFullScreen():L.webkitRequestFullscreen&&L.webkitRequestFullscreen();var c=setInterval(function(){if(L!==(a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement))clearInterval(c),L.style.left=V,L.style.top=X,L.style.width=q,L.style.height=n,L.style.background=U,R.iv();else{var t=E.getWindowInfo();(b||t.width!==R.getWidth()||t.height!==R.getHeight())&&(Mj(R),b=!1)}},500)}},appendTimeStamp:function(q){return q+=q.indexOf("?")>=0?"&__ht__="+Bm():"?"+Bm()},setCompType:function(J,c){Xo(c)||qc(c)?Zi[J]=c:rp(J)},getCompType:function(y){return Zi[y]},getCompTypeMap:function(){return Zi},drawCompType:function(j,W,l,V,r,m){j(W,l,V,r,m)},numberListener:function(){var C={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(R){var X=R.keyCode;C[X]||65===X&&E.isCtrlDown(R)||86===X&&E.isCtrlDown(R)||67===X&&E.isCtrlDown(R)||88===X&&E.isCtrlDown(R)||X>=35&&40>=X||(R.shiftKey||48>X||X>57)&&(96>X||X>105)&&R.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(y){var t=y.target.tagName;("DIV"===t||"CANVAS"===t)&&!(E.ignoreKeyCodes.indexOf(y.keyCode)>=0)&&("keydown"!==y.type||Bn(y)||fn(y)||Br(y)||Dp(y)||Ii(y)||65===y.keyCode&&(y.metaKey||y.ctrlKey))&&(y.preventDefault(),y.preventManipulation&&y.preventManipulation())},getWindowInfo:function(){var F=a.documentElement,i=F&&(F.scrollLeft||F.scrollTop)?F:a.body;return{target:i,left:i.scrollLeft,top:i.scrollTop,width:O.innerWidth||i.clientWidth,height:O.innerHeight||i.clientHeight}},isDragging:function(){return!!Cc},isLeftButton:function(C){return e?!0:0===C.button},isInput:function(g){if(!g)return!1;var l=g.tagName;return"INPUT"===l||"TEXTAREA"===l||"SELECT"===l},getTouchCount:function(U){return e?U.touches.length:1},isDoubleClick:function(){var B={};return Vj=new Date,ue=Vj.getTime(),function(F){var G=(new Date).getTime(),E=F.button==q?"":F.button,m=F.type+E,U=m+"_isDoubleClick",M=B[m];if(M||(M=B[m]={details:0,timeout:null,lastPoint:null,lastTime:G}),F[U]===Q){var W=wo(F);F[U]=M.lastPoint&&Ip(M.lastPoint,W)<=(e?20:1)&&G-M.lastTime<500,M.lastTime=G,M.lastPoint=W,M.details++,M.timeout&&(y(M.timeout),M.timeout=null),M.timeout=u(function(){this.details=0,this.timeout=null,this.lastPoint=null}.bind(M),500)}return!!F[U]&&2===M.details}}(),isShiftDown:function(l){return l?l.shiftKey:qn["16"]},isCtrlDown:function(f){return f?_?f.metaKey:f.ctrlKey:_?qn["91"]:qn["17"]},getClientPoint:function(r){return e&&(r=Mq(r)),{x:r.clientX,y:r.clientY}},isMouseEvent:function(S){return S instanceof MouseEvent||0===S.type.indexOf("mouse")},getTargetElement:function(r){if(E.isMouseEvent(r)||!a.elementFromPoint)return r.target;var Q=cp(r);return a.elementFromPoint(Q.x,Q.y)},getPagePoint:function(m){return e&&(m=Mq(m)),{x:m.pageX,y:m.pageY}},createObject:function(y,w){var a=new y;for(var s in w){var V=Mh(s),o=w[s];a[V]?(a[V](o),"setToolTip"===V&&a.enableToolTip&&a.enableToolTip()):a[s]=o}return a},setImage:function(t,L,g,z){var l=arguments.length;4===l?an(t,z,L,g):2===l?Gg(L)?an(t,L):Dd[t]=L:1===l&&an(t,t)},getImage:function(_,n,x){var u;if(_==q)return q;if(qc(_)?u=_:(u=Dd[_],_&&u===Q&&(vi&&vi[_]||an(_,_))),n&&u&&u.tagName){var L;L="override"===x?"colors_override":"override_rgb"===x?"colors_override_rgb":"override_a"===x?"colors_override_a":"colors",u[L]||(u[L]={__count__:0});var b=u[L][n];return b||(u[L].__count__>E.imageCacheThreshold&&(u[L]={__count__:0}),b=xp(u,Yg(n),u.width,u.height,x),u[L][n]=b,u[L].__count__++),b}return u},getId:function(){var i=1;return function(){return++i}}(),callLater:function(J,c,Z,G){var N=function(){J.apply(c,Z)};return G?u(N,G):O.requestAnimationFrame(N)},asyncEach:function(y,J,T){"function"!=typeof T&&(T=Function.prototype);var L=new Array(y.length),o=0,A=!1;y.forEach(function(M,n){J(M,function(O,q){return A?void 0:O?(A=!0,T(null)):(L[n]=q,o++,o===y.length?T(L):void 0)})})},xhrLoad:function(s,M,_){var i=!1;Rn(s)||(i=!0,s=[s]),_=_||{},s.length;var L=_.sync;Pl(s,function(b,K){var u=new XMLHttpRequest;_.responseType?u.responseType=_.responseType:u.overrideMimeType(_.mimeType||"text/plain"),b=E.beforeLoadURL(b),b.data?K(null,b.data):(u.open("GET",encodeURI(b),!L),u.onload=function($){200===this.status||0===this.status?K(null,$.target.response):K(!0)},u.onerror=function(){K(!0)},u.send(null))},function(Q){"function"==typeof M&&M(i&&Q?Q[0]:Q)})},clone:function(e){if(!e)return q;if(Rn(e))return e.slice(0);if(rk(e))return new up(e);if(qc(e)){var t,d={};for(t in e)d[t]=e[t];return d}return e},callWhenLoaded:function(H,i){i=i||100;var U=Ol(H,i);Zd||(Zd={}),Zd[U]={tick:U,cb:H,delay:i}},beforeLoadURL:function(H){if(Zd){var j={};for(var Q in Zd){var t=Zd[Q];y(t.tick);var U=Ol(t.cb,t.delay);j[U]={tick:U,delay:t.delay,cb:t.cb}}Zd=j}return E.convertURL?E.convertURL(H):H},convertURL:function(n){return n},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(B,Z){if(B===Z)return 0;if(B==q&&Z!=q)return 1;if(B!=q&&Z==q)return-1;if(B==q&&Z==q)return 0;var S,Y=typeof B,b=typeof Z;return Y===Qo&&b===Qo?S=B.localeCompare(Z):Y===Vq&&b===Vq&&(S=B-Z),S===Q&&(S=(""+B).localeCompare(""+Z)),S>0?1:0>S?-1:0},getClassMap:function(){return uc},getClass:function(Z){if(Gg(Z)){var e,W=uc[Z];if(!W){e=Z.split("."),W=O;for(var l=0;l<e.length;l++)W=W[e[l]];uc[Z]=W}return W}return Z},def:function(o,N,w){var p,z,W,$=function(){};if($.prototype=N.prototype,p=new $,Gg(o)){if(uc[o])throw"'"+o+"' already defined";W=Gq(o),p.getClassName=function(){return o}}else W=o;if(p.constructor=W,p.getClass=function(){return W},p.getSuperClass=function(){return N},w)for(z in w)Ie[z]&&Ie.hasOwnProperty(z)?Ie[z](p,w):Qj(p,w,z);W.prototype=p,W.superClass=N.prototype},startAnim:function(){var B=function(p){p.duration&&(p.startTime=Bm()),p.timeId=Ce(p.tick,q,q,p.interval)};return function(s){return s=ji(s),s.easing=s.easing||E.animEasing,s.duration||s.frames||(s.duration=E.animDuration),s.t=0,s.duration?s.interval=0:(s.frame=0,s.interval=s.interval||10),s.tick=function(){if(s.duration){var I=(Bm()-s.startTime)/s.duration;I>1&&(I=1),s.t=I,s.action(s.easing(I),I),1===I?s.stop():s._isPaused||(s.timeId=Ce(s.tick))}else s.frame++,I=s.t=s.frame/s.frames,s.action(s.easing(I),I),s.frame<s.frames?s._isPaused||(s.timeId=Ce(s.tick,q,q,s.interval)):s.stop()},s.resume=function(){s._isPaused&&(delete s._isPaused,s.duration?s.t<1&&(s.startTime=Bm()-s.duration*s.t,s.timeId=Ce(s.tick)):s.frame<s.frames&&(s.timeId=Ce(s.tick,q,q,s.interval)))},s.pause=function(){s._isPaused=!0},s.stop=function(O){s.isRunning()&&(s.duration?s.t<1&&O&&(s.t=1,s.action(s.easing(1))):s.frame<s.frames&&O&&(s.frame=s.frames,s.action(s.easing(1))),s._37o&&s._37o(),s.finishFunc&&s.finishFunc(),Yq(s.timeId,!s.duration),delete s.timeId)},s.isRunning=function(){return s.timeId!=q},s.delay?Ce(B,q,[s],s.delay):B(s),s}}(),getTextSize:function(){var N={},W=a?ld().getContext("2d"):q;return function(H,s){W.font=H?H:fe;var x=N[W.font];return x||(x=2*W.measureText("e").width+4,N[W.font]=x),{width:W.measureText(s).width+4,height:x}}}(),drawText:function(Q,R,m,E,r,L,h,B,X,P){if(R!=q){var H=wr(m,R),U={};U.y=P&&P!==Er?P===nr?L+H.height/2:L+B-H.height/2:L+B/2,U.x=X&&X!==Ff?X===Gr?r+h-H.width/2:r+h/2:r+H.width/2,Lm(Q,R,U,m,E)}},getDistance:function(h,B){var N=h.length;return B?3===N?Z(n(h[0]-B[0])+n(h[1]-B[1])+n(h[2]-B[2])):2===N?Z(n(h[0]-B[0])+n(h[1]-B[1])):h.z===Q?Z(n(B.x-h.x)+n(B.y-h.y)):Z(n(B.x-h.x)+n(B.y-h.y)+n(B.z-h.z)):3===N?Z(n(h[0])+n(h[1])+n(h[2])):2===N?Z(n(h[0])+n(h[1])):void 0},brighter:function(i,$){return 0>$&&($=-$),Bd(i,$?$:40)},darker:function(Q,i){return i>0&&(i=-i),Bd(Q,i?i:-40)},unionPoint:function(R,b){if(!R)return q;if(2===arguments.length)return R&&b?{x:f(R.x,b.x),y:f(R.y,b.y),width:C(R.x-b.x),height:C(R.y-b.y)}:q;var o=R;if(o._as&&(o=o._as),o.length===Q)return q;var v=o.length;if(0>=v)return q;for(var I=1,B=o[0],K={x:B.x,y:B.y,width:0,height:0};v>I;I++){B=o[I];var Z=f(K.x,B.x),L=M(K.x+K.width,B.x),S=f(K.y,B.y),u=M(K.y+K.height,B.y);K.x=Z,K.y=S,K.width=L-Z,K.height=u-S}return K},unionRect:function(n,O){if(n&&!O)return ji(n);if(!n&&O)return ji(O);if(n&&O){var C={x:f(n.x,O.x),y:f(n.y,O.y)};return C.width=M(n.x+n.width,O.x+O.width)-C.x,C.height=M(n.y+n.height,O.y+O.height)-C.y,C}return q},containsPoint:function(Z,C){return!(!Z||C.x<Z.x||C.y<Z.y||C.x>Z.x+Z.width||C.y>Z.y+Z.height)},containsRect:function(A,D){if(!A||!D)return!1;var E=D.x,s=D.y,v=D.width,m=D.height,U=A.width,T=A.height;if(0>(U|T|v|m))return!1;var Z=A.x,W=A.y;if(Z>E||W>s)return!1;if(U+=Z,v+=E,E>=v){if(U>=Z||v>U)return!1}else if(U>=Z&&v>U)return!1;if(T+=W,m+=s,s>=m){if(T>=W||m>T)return!1}else if(T>=W&&m>T)return!1;return!0},intersectsRect:function(y,X){if(!y||!X)return!1;var n=X.width,k=X.height,t=y.width,M=y.height;if(0>=t||0>=M||0>=n||0>=k)return!1;var I=X.x,b=X.y,B=y.x,Q=y.y;return t+=B,M+=Q,n+=I,k+=b,t>I&&M>b&&n>B&&k>Q},intersection:function(S,T){if(!S||!T)return q;var J=T.x,j=T.y,p=S.x,Z=S.y,I=J,N=j,Q=p,W=Z;return I+=T.width,N+=T.height,Q+=S.width,W+=S.height,p>J&&(J=p),Z>j&&(j=Z),I>Q&&(I=Q),N>W&&(N=W),I-=J,N-=j,0>=I||0>=N?q:{x:J,y:j,width:I,height:N}},grow:function(H,l,n){n===Q&&(n=l),H.x-=l,H.y-=n,H.width=H.width+2*l,H.height=H.height+2*n},getLogicalPoint:function(M,R,u,Y,w,m){ki(M)?_?qn["91"]=!0:qn["17"]=!0:_?qn["91"]=!1:qn["17"]=!1,qn["16"]=Wi(M)?!0:!1;var G=R.getBoundingClientRect();return M=e?Mq(M):M,{x:(M.clientX-G.left+R.scrollLeft-(u||0))/(w||1),y:(M.clientY-G.top+R.scrollTop-(Y||0))/(m||1)}},removeHTML:function(){var G;return function(p){return p&&p.parentNode?G===p?!0:(G=p,p.parentNode.removeChild(p),G=q,!0):!1}}(),getToolTipDiv:function(){if(!rm){rm=ao(),Im=ao();var C=rm.style;E.baseZIndex!=q&&(C.zIndex=m(E.baseZIndex)+3+""),C.whiteSpace="nowrap",C.color=E.toolTipLabelColor,C.background=E.toolTipBackground,C.font=E.toolTipLabelFont,C.padding="5px",C.boxShadow="0px 0px 3px "+E.toolTipShadowColor}return rm},isToolTipShowing:function(){return rm&&rm.parentNode?!0:Im&&Im.parentNode?!0:!1},hideToolTip:function(){Ad(rm),Ad(Im),Lq()},showToolTip:function(L,$){if(!L||$==q)return Ur(),void 0;E.getToolTipDiv();var D,v;if($.html?($=$.html,D=Im,Ad(rm)):(D=rm,Ad(Im)),v=D.style,D.innerHTML=$,D.parentNode||i.Default.appendToScreen(D),L.target){L=cp(L);var R=Zg(),d=L.x,t=L.y,K=e?60:12;if(e){var o=D.getBoundingClientRect();v.left=d-o.width/2+jm,v.top=t-o.height-K<R.top?t+K+jm:t-o.height-K+jm}else{v.left=d+K+jm,v.top=t+K+jm;var o=D.getBoundingClientRect();o.left+o.width>R.width&&(v.left=d-K-o.width+jm),o.top+o.height>R.height&&(v.top=t-K-o.height+jm),o.left<0&&(v.left=d+K+jm),o.top<0&&(v.top=t+K+jm)}}else v.left=L.x+jm,v.top=L.y+jm;Lq()},startDragging:function(P,A){P!==Cc&&(Cc?e?Cc.handleWindowTouchEnd(A):Cc.handleWindowMouseUp(A):e?(O.addEventListener(ch,Uc,!1),O.addEventListener(nk,Up,!1)):(O.addEventListener(yk,Ng,!1),O.addEventListener(Dr,bk,!1)),Cc=P)},getImageMap:function(){return Dd},toBoundaries:function(l,y,H,E){var n=[];return Dj(l,y,H,E).forEach(function(F){var D=[];F.forEach(function(J){D.push(J.x,J.y)}),n.push(D)}),n},getCurrentKeyCodeMap:function(){return qn},drawCenterImage:function(T,d,h,q,V,u,U,c){var z=Uh(d,V,u),j=yn(d,V,u);dn(T,d,H(h-z/2),H(q-j/2),z,j,V,u,U,c)},drawStretchImage:function(l,M,o,V,z,u,W,F,U,n,h,K){var q,A=Uh(M,F,U,u),C=yn(M,F,U,W);if("uniform"===o?(q=f(u/A,W/C),A*=q,C*=q,V+=H((u-A)/2),z+=H((W-C)/2),u=A,W=C):"centerUniform"===o&&((A>u||C>W)&&(q=f(u/A,W/C),A*=q,C*=q),V+=H((u-A)/2),z+=H((W-C)/2),u=A,W=C),"center"===o){var L=h!==!1&&(A>u||C>W);L&&(l.save(),l.beginPath(),l.rect(V,z,u,W),l.clip()),dn(l,M,V+u/2-A/2,z+W/2-C/2,A,C,F,U,n,K),L&&l.restore()}else dn(l,M,V,z,u,W,F,U,n,K)},toCanvas:function(q,N,K,s,o,v,X,Z,f){q=fo(q,X),N=N||Uh(q,o),K=K||yn(q,o);var i=ld(),O=Pg(i);return Z?(Pm(i,N,K,Z),O.scale(Z,Z)):Pm(i,N,K,1),Sk(O,q,s,0,0,N,K,o,v,X,f),O.restore(),i},createElement:function(d,Z,u,L){var S=a.createElement(d);return Gc(S,Z||W.widgetBorder,2),S.style.font=u?u:fe,L!=q&&(S.value=L),E.onElementCreated&&E.onElementCreated(S),S},containedInView:function(_,t){var H=cs(t).getBoundingClientRect();return vg({x:H.left,y:H.top,width:H.width,height:H.height},wo(_))},isIsolating:function(){return Cf},setIsolating:function(D){Cf=D},getMSMap:function(){return Ie},stringify:function(M,F){var p=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var r=JSON.stringify(M,function(s,G){return"function"==typeof G?"__ht__"+(G.__ht__||G.toString()):wm(G)?Do(G):G},F==q?2:F);return Date.prototype.toJSON=p,r},parse:function(C){return Gg(C)?JSON.parse(C,function(q,$){if(Gg($)){if("__ht__function"==$.substr(0,14)){var D=$.indexOf("{")+1,N=$.lastIndexOf("}"),H=$.indexOf("(")+1,O=$.indexOf(")");if(D&&N&&H&&O){var x=new Function($.substring(H,O),$.substring(D,N));return x.__ht__=$.substr(6),x}}if("__ht__date"==$.substr(0,10))return new Date(m($.substr(10)))}return $}):C},loadJS:function(f,Y){Y&&f.push(Y);var t=f.shift();if(Rn(t))f=t.contact(f),E.loadJS(f);else if(Xo(t))t(),E.loadJS(f);else if(Gg(t)){var P=a.createElement("script");P.onload=function(){E.loadJS(f)},P.setAttribute("src",t),a.getElementsByTagName("head")[0].appendChild(P)}else f.length&&E.loadJS(f)},toRoundedCorner:function(t,p){var D=t.size();if(0>=p)return{points:t};var m,h=new up,w=new up,O=t.get(0);h.add(O),w.add(1);for(var H=1;D>H;H++)if(D>H+1){var $=t.get(H),K=t.get(H+1),l=O.x,a=O.y,G=$.x,k=$.y,X=k-a,M=G-l,e=B(X,M);m=f(.99*Ip(O,$),p),h.add({x:G-m*g(e),y:k-m*x(e)}),h.add($),l=$.x,a=$.y,G=K.x,k=K.y,X=k-a,M=G-l,e=B(X,M),m=f(.99*Ip($,K),p),O={x:l+m*g(e),y:a+m*x(e)},h.add(O),w.addAll([2,3])
}else h.add(t.get(H)),w.add(2);return{points:h,segments:w}},toColorData:Ji,setCanvas:Pm,createDiv:ao,createDisabledDiv:Pc,createView:wk,createCanvas:ld,appendChild:gd,initContext:Pg,checkLoadingImage:Qg,translateAndScale:yr,layout:Mj,getPosition:Un,drawPoints:vn,drawRoundRect:Rr,drawBorder:bb,setFocus:oj,getter:Bf,setter:Mh,isEmptyObject:lg},!0),Ij(w,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var pj=E.disabledOpacity,Tn=E.toolTipDelay,Zl=E.devicePixelRatio,jo=E.autoMakeVisible,cb=E.autoHideScrollBar,Tq=E.imageGradient,vp=E.showToolTip,Ur=E.hideToolTip,Bq=E.dashPattern,qf=E.lineCap,un=E.lineJoin,ne=E.labelColor,Oh=E.labelSelectColor,fe=E.labelFont,kd=E.widgetIndent,Ef=E.widgetRowHeight,Pp=E.widgetHeaderHeight,Vp=E.widgetTitleHeight,Sj=E.scrollBarColor,cr=E.scrollBarSize,Yf=E.scrollBarTimeout,Vo=E.scrollBarMinLength,Jn=E.scrollBarInteractiveSize,Wh=E.zoomIncrement,zp=E.scrollZoomIncrement,Zf=E.pinchZoomIncrement,qj=E.zoomMax,lf=E.zoomMin,Kp=E.createObject,br=E.preventDefault,sr=E.setImage,fo=E.getImage,We=E.drawCenterImage,Sk=E.drawStretchImage,ei=E.getId,Ce=E.callLater,Pl=E.asyncEach,zb=(E.xhrLoad,E.sortFunc),ji=E.clone,Gq=E.getClass,Ao=E.startAnim,Kg=E.brighter,pr=E.darker,Wp=E.drawText,wr=E.getTextSize,vk=E.isLeftButton,Ed=E.getTouchCount,hq=E.isDoubleClick,Wi=E.isShiftDown,ki=E.isCtrlDown,wo=E.getClientPoint,cp=E.getPagePoint,Ip=E.getDistance,Yd=E.unionPoint,Uo=E.unionRect,vg=E.containsPoint,Ld=E.containsRect,jq=E.intersectsRect,di=E.intersection,Zg=E.getWindowInfo,Eg=E.grow,Ud=E.getLogicalPoint,Pr=E.startDragging,Ad=E.removeHTML,vb=E.createElement,sn=E.segmentResolution,tb=E.shapeResolution,Xb=E.shapeSide,re=E.def,Qd=function(K,F,E){re(v+"."+K,F,E)},uh=function(B,n){B.childNodes.forEach(function(R){n(R),uh(R,n)})};Ij(E,{toolTipLabelColor:ne,toolTipLabelFont:fe,toolTipBackground:W.toolTipBackground,toolTipShadowColor:eh,setDevicePixelRatio:function(M){Zl=E.devicePixelRatio="number"==typeof M?M:O.devicePixelRatio,uh(a.body,function(n){var F=n._ht;F&&F._canvas&&(Pm(F._canvas,F.getWidth(),F.getHeight()),F.redraw?F.redraw():F.iv())})}},!0);var Tl=1e-6,Ae="undefined"!=typeof Uint16Array?Uint16Array:Array,bp="undefined"!=typeof Float32Array?Float32Array:Array,np=function(G,Y,x){var d=[G[0]-Y[0],G[1]-Y[1],G[2]-Y[2]];if(x){var Q=Ip(d);Q>0&&(d[0]/=Q,d[1]/=Q,d[2]/=Q)}return d},Wo=function(X){return[-X[0],-X[1],-X[2]]},Pn=function(j,u){return 3===j.length?j[0]*u[0]+j[1]*u[1]+j[2]*u[2]:j[0]*u[0]+j[1]*u[1]},ns=function(){var p=new bp(16);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},Lc=ns(),Wk=function(H){var L=new bp(16);return L[0]=H[0],L[1]=H[1],L[2]=H[2],L[3]=H[3],L[4]=H[4],L[5]=H[5],L[6]=H[6],L[7]=H[7],L[8]=H[8],L[9]=H[9],L[10]=H[10],L[11]=H[11],L[12]=H[12],L[13]=H[13],L[14]=H[14],L[15]=H[15],L},Vm=function(U,k){return U[0]=k[0],U[1]=k[1],U[2]=k[2],U[3]=k[3],U[4]=k[4],U[5]=k[5],U[6]=k[6],U[7]=k[7],U[8]=k[8],U[9]=k[9],U[10]=k[10],U[11]=k[11],U[12]=k[12],U[13]=k[13],U[14]=k[14],U[15]=k[15],U},Sl=function(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},Kl=function(D,c){var T=D[0],E=D[1],f=D[2];return D[0]=c[0]*T+c[4]*E+c[8]*f+c[12],D[1]=c[1]*T+c[5]*E+c[9]*f+c[13],D[2]=c[2]*T+c[6]*E+c[10]*f+c[14],D},Jm=function(S,l){var H=S[0],u=S[1],s=S[2],o=S[3];return S[0]=l[0]*H+l[4]*u+l[8]*s+l[12]*o,S[1]=l[1]*H+l[5]*u+l[9]*s+l[13]*o,S[2]=l[2]*H+l[6]*u+l[10]*s+l[14]*o,S[3]=l[3]*H+l[7]*u+l[11]*s+l[15]*o,S},Bi=function(){var b,e,o,a,A=ce(zj[1]+zj[7]),V=ce(zj[0]+zj[3]-zj[10]),D=ce(zj[8]+2),w=function(){return e=o.charAt(b),b+=1,e},s=function(){var V="";if(e===D)for(;w();){if(e===D)return w(),V;V+=e}else w()},y=function(){for(;e&&" ">=e;)w()},n=function(){var c,x={};if(e===A){if(w(),y(),e===V)return w(),x;for(;e;){if(c=s(),y(),w(),x[c]=a(),y(),e===V)return w(),x;w(),y()}}};return a=function(){switch(y(),e){case A:return n();default:return s()}},function(Z){if(I={},Z){var V;if(o=Z,b=0,e=" ",V=a(),y(),!e)return V}}}(),Fq=function(X,I){if(I){var t=x(I),m=g(I),F=X[4],z=X[5],Q=X[6],R=X[7],W=X[8],n=X[9],N=X[10],O=X[11];X[4]=F*m+W*t,X[5]=z*m+n*t,X[6]=Q*m+N*t,X[7]=R*m+O*t,X[8]=W*m-F*t,X[9]=n*m-z*t,X[10]=N*m-Q*t,X[11]=O*m-R*t}},eb=function(t,X){if(X){var I=x(X),S=g(X),_=t[0],B=t[1],a=t[2],C=t[3],N=t[8],z=t[9],h=t[10],e=t[11];t[0]=_*S-N*I,t[1]=B*S-z*I,t[2]=a*S-h*I,t[3]=C*S-e*I,t[8]=_*I+N*S,t[9]=B*I+z*S,t[10]=a*I+h*S,t[11]=C*I+e*S}},kj=function(h,J){if(J){var F=x(J),L=g(J),j=h[0],V=h[1],M=h[2],H=h[3],k=h[4],s=h[5],b=h[6],a=h[7];h[0]=j*L+k*F,h[1]=V*L+s*F,h[2]=M*L+b*F,h[3]=H*L+a*F,h[4]=k*L-j*F,h[5]=s*L-V*F,h[6]=b*L-M*F,h[7]=a*L-H*F}},Kk=function(a,S,u){return gs(q,u===!1?q:a.s3(),a.r3(),a.getRotationMode(),a.p3(),q,S)},gs=function(u,f,D,e,P,B,o){return B||(B=ns()),P&&Cg(B,P),sp(B,D,e),o&&yl(B,B,o),f&&pk(B,f),u&&yl(B,B,u),B},hf=function(d,p,W){p=m(p),W=m(W);var l=this;l.g=d,l._84O=p,l._85O=W,l._70I=!0,l.F=0,l._83O=p+W,l.pen={x:0,y:0}},Mn="lineDashOffset",Sd="setLineDash",ck=function(C){for(var p in C)1===p.length&&(Mn=C[p]);return p?1:0},Cb=function(G,l,Y){return ae(l)?G:G[Sd]?(G[Sd](l),Y&&(G.lineDashOffset=Y),G):new hf(G,l[0],l.length>1?l[1]:l[0])},zg=function(B,U){!ae(U)&&B[Sd]&&(B[Sd](Wm),B.lineDashOffset=0)};if(re(hf,P,{_69I:6,moveTo:function(Y,R){var X=this,B=X.pen;B.x=Y,B.y=R,X.g.moveTo(Y,R),X.start||(X.start={x:Y,y:R})},lineTo:function(M,A){var h=this,Y=h.pen,P=M-Y.x,Z=A-Y.y,U=B(Z,P),H=g(U),s=x(U),n=h._23O(Y.x,Y.y,M,A),j=h._85O,m=h._84O,_=h._83O;if(h.F){if(h.F>n)return h._70I?h._72I(M,A):h.moveTo(M,A),h.F-=n,void 0;if(h._70I?h._72I(Y.x+H*h.F,Y.y+s*h.F):h.moveTo(Y.x+H*h.F,Y.y+s*h.F),n-=h.F,h.F=0,h._70I=!h._70I,!n)return}var d=l(n/_);if(d){for(var y=H*m,o=s*m,K=H*j,J=s*j,p=0;d>p;p++)h._70I?(h._72I(Y.x+y,Y.y+o),h.moveTo(Y.x+K,Y.y+J)):(h.moveTo(Y.x+K,Y.y+J),h._72I(Y.x+y,Y.y+o));n-=_*d}h._70I?n>m?(h._72I(Y.x+H*m,Y.y+s*m),h.moveTo(M,A),h.F=j-(n-m),h._70I=!1):(h._72I(M,A),n===m?(h.F=0,h._70I=!h._70I):(h.F=m-n,h.moveTo(M,A))):n>j?(h.moveTo(Y.x+H*j,Y.y+s*j),h._72I(M,A),h.F=m-(n-j),h._70I=!0):(h.moveTo(M,A),n===j?(h.F=0,h._70I=!h._70I):h.F=j-n)},quadraticCurveTo:function(X,w,z,G){var i,D=this,K=D.pen,g=K.x,o=K.y,V=D._22O(g,o,X,w,z,G),R=0,d=0,x=D._85O,O=D._84O;if(D.F){if(D.F>V)return D._70I?D._71I(X,w,z,G):D.moveTo(z,G),D.F-=V,void 0;if(R=D.F/V,i=D._20O(g,o,X,w,z,G,R),D._70I?D._71I(i[2],i[3],i[4],i[5]):D.moveTo(i[4],i[5]),D.F=0,D._70I=!D._70I,!V)return}var m=V-V*R,N=l(m/D._83O),T=O/V,A=x/V;if(N)for(var a=0;N>a;a++)D._70I?(d=R+T,i=D._21O(g,o,X,w,z,G,R,d),D._71I(i[2],i[3],i[4],i[5]),R=d,d=R+A,i=D._21O(g,o,X,w,z,G,R,d),D.moveTo(i[4],i[5])):(d=R+A,i=D._21O(g,o,X,w,z,G,R,d),D.moveTo(i[4],i[5]),R=d,d=R+T,i=D._21O(g,o,X,w,z,G,R,d),D._71I(i[2],i[3],i[4],i[5])),R=d;m=V-V*R,D._70I?m>O?(d=R+T,i=D._21O(g,o,X,w,z,G,R,d),D._71I(i[2],i[3],i[4],i[5]),D.moveTo(z,G),D.F=x-(m-O),D._70I=!1):(i=D._19O(g,o,X,w,z,G,R),D._71I(i[2],i[3],i[4],i[5]),V===O?(D.F=0,D._70I=!D._70I):(D.F=O-m,D.moveTo(z,G))):m>x?(d=R+A,i=D._21O(g,o,X,w,z,G,R,d),D.moveTo(i[4],i[5]),i=D._19O(g,o,X,w,z,G,d),D._71I(i[2],i[3],i[4],i[5]),D.F=O-(m-x),D._70I=!0):(D.moveTo(z,G),m===x?(D.F=0,D._70I=!D._70I):D.F=x-m)},bezierCurveTo:function(){var S=arguments;this.pen={x:S[4],y:S[5]},this.g.bezierCurveTo(S[0],S[1],S[2],S[3],S[4],S[5])},arc:function(J,b,T,K,o,c){c||(K=-K,o=-o),Bp(this,J,b,K,o-K,T,T,!1)},rect:function(g,x,L,z){var K=this;K.pen={x:g,y:x},K.moveTo(g,x),K.lineTo(g,x+z),K.lineTo(g+L,x+z),K.lineTo(g+L,x),K.lineTo(g,x)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(i,e,h,q){var H=h-i,G=q-e;return Z(H*H+G*G)},_22O:function(q,S,j,z,w,b,o){for(var E,v,t,g,V,d,l,T=0,X=q,Q=S,B=o>0?o:this._69I,$=1;B>=$;$++)t=$/B,g=1-t,V=g*g,d=2*t*g,l=t*t,E=V*q+d*j+l*w,v=V*S+d*z+l*b,T+=this._23O(X,Q,E,v),X=E,Q=v;return T},_21O:function(P,C,i,M,$,R,O,T){var A=this;if(0===O)return A._20O(P,C,i,M,$,R,T);if(1===T)return A._19O(P,C,i,M,$,R,O);var Z=A._20O(P,C,i,M,$,R,T);return Z.push(O/T),A._19O.apply(A,Z)},_20O:function($,Q,n,m,G,d,R){if(1!==R){var c=n+(G-n)*R,I=m+(d-m)*R;n=$+(n-$)*R,m=Q+(m-Q)*R,G=n+(c-n)*R,d=m+(I-m)*R}return[$,Q,n,m,G,d]},_19O:function(w,U,V,R,J,j,Q){if(1!==Q){var D=w+(V-w)*Q,c=U+(R-U)*Q;V+=(J-V)*Q,R+=(j-R)*Q,w=D+(V-D)*Q,U=c+(R-c)*Q}return[w,U,V,R,J,j]},_72I:function($,b){var Q=this.pen;($!==Q.x||b!==Q.y)&&(Q.x=$,Q.y=b,this.g.lineTo($,b))},_71I:function(x,G,h,V){var g=this.pen;(x!==h||G!==V||h!==g.x||V!==g.y)&&(g.x=h,g.y=V,this.g.quadraticCurveTo(x,G,h,V))}}),j&&s){var Sb=s.toString();T=Sb.indexOf(cl.substr(0,2))>0&&Sb.indexOf(nr+nr.substr(1,1))>1?!0:!1}var Vi=q,pc=q,ve=function(K){Vi&&!K._72O&&(pc||(pc={}),pc[K._72O=ei()]=K)},rp=function(x,I){if(I||(I=x),I&&(Vi||(Vi={}),!Vi[x])){var O=new XMLHttpRequest;if(Vi[I]={request:O,url:I},O.overrideMimeType("text/plain"),I=E.beforeLoadURL(I),I.data){var p=E.parse(I.data);rd(x,p),E.handleCompTypeLoaded(x,p)}else O.open("GET",encodeURI(I),!0),O.onload=function(y){if(200===this.status||0===this.status){var S=E.parse(y.target.response);rd(x,S),E.handleCompTypeLoaded(x,S)}else rd(x,q)},O.onerror=function(){rd(x,q)},O.send(null)}},rd=function(K,$){if(Zi[K]=$,delete Vi[K],lg(Vi)&&(Vi=q,pc)){for(var _ in pc){var b=pc[_];b.invalidateAll&&b.invalidateAll(Q,"compTypeLoaded",K),b.redraw&&b.redraw(),b.iv(),delete b._72O}pc=q}if($&&pc)for(var _ in pc){var b=pc[_];b.invalidateAll&&b.invalidateAll(Q,"compTypeLoading",K),b.redraw&&b.redraw(),b.iv()}},ti=W.chart,he=E.compStack=[],$d=/^style@/,op=/^attr@/,_d=/^field@/,sc={x:.5,y:.5},Uh=function(x,S,W,o){if(!x)return 0;if(x.fitSize&&o)return o;var P=mj(x.width,S,W);return null==P?20:P},yn=function(Q,M,I,b){if(!Q)return 0;if(Q.fitSize&&b)return b;var d=mj(Q.height,M,I);return null==d?20:d},mj=function(V,m,T){if(!V||!V.func)return V;var $,K=V.func,X=V.value;return $=Xo(K)?T&&T.vectorDataBindingDisabled&&!V.isSafeFunc?X:K(m,T):m instanceof Mb?op.test(K)?m.a(K.slice(5)):$d.test(K)?m.s(K.slice(6)):_d.test(K)?m[K.slice(6)]:m[K]?m[K](T):X:X,X!==Q&&$==q?X:$},dn=E.drawImage=function(){var s,L,H,a,r,V,N=function(d,v){d.getValue&&d.getValue.compType===v||(d.getValue=function(H){var b=n(d,H);if(b===Q&&v.properties){var K=v.properties[H];K&&(b=K.defaultValue)}return b},d.getValue.compType=v)},n=function(u,c,p){var $=u[c];return $&&$.func?($=mj($,L,H),p&&($=p($))):p&&($=u[c]=p($)),$},P=function($,Y){var N;if(N=Y?n($,Y):$,r&&N){if("override"===V)return r;if("override_rgb"===V){var q=Yg(r);return N=Ji(N),"rgba("+l(255*q[0])+","+l(255*q[1])+","+l(255*q[2])+","+N[3]/255+")"}if("override_a"===V){var q=Yg(r);return N=Ji(N),"rgba("+N[0]+","+N[1]+","+N[2]+","+q[3]+")"}var q=Yg(r);return N=Ji(N),"rgba("+l(N[0]*q[0])+","+l(N[1]*q[1])+","+l(N[2]*q[2])+","+N[3]/255*q[3]+")"}return N},y=function(b){if(Rn(b)){for(var u=new up,s=b.length,E=0;s>E;E+=2)u.add({x:b[E],y:b[E+1]});b=u}return b},t=function(L){var Z=n(L,"anchorX"),W=n(L,"anchorY");if(Z!==Q||W!==Q)return{x:Z===Q?sc.x:Z,y:W===Q?sc.y:W};var b=n(L,"type"),G=n(L,"name");if("image"!==b||!G)return sc;var _=fo(G);return _&&_.anchorX&&_.anchorY?{x:_.anchorX,y:_.anchorY}:sc},h=function(o,l){var C=n(o,wb),E=t(o);if(Rn(C)){var c=C.length,W=n(o,"relative"),q=l.width,S=l.height;if(4===c)C={x:C[0],y:C[1],width:C[2],height:C[3]},W?(C.x*=q,C.y*=S,C.width*=q,C.height*=S):l.fitSize&&(C.x*=l.widthScale,C.width*=l.widthScale,C.y*=l.heightScale,C.height*=l.heightScale);else if(3===c){var X=C[0];C={width:C[1],height:C[2]},W?(C.width*=q,C.height*=S):l.fitSize&&(C.width*=l.widthScale,C.height*=l.heightScale),"object"==typeof X?X.length&&(X={x:X[0],y:X[1]}):X=Un(X,l,C),C.x=X.x-C.width*E.x,C.y=X.y-C.height*E.y}var U=n(o,"offsetX");U&&(l.fitSize&&(U*=l.widthScale),C.x+=U),U=n(o,"offsetY"),U&&(l.fitSize&&(U*=l.heightScale),C.y+=U)}return C},X=function(S){return Rn(S)?new up(S):S},d=function(k,h,B,V,G,Y,u){G===Q&&(G=1),Y===Q&&(Y=1);var W=n(k,"clipPercentage"),P=nq(B,h);if(P&&!V&&1===G&&1===Y&&!(1>W))return!1;u=u||sc;var E=h.x+h.width*u.x,O=h.y+h.height*u.y,g=B.x+B.width*u.x,H=B.y+B.height*u.y;if(s.save(),_e(s,E,O),zq(s,V),Qe(s,G*(h.width/B.width),Y*(h.height/B.height)),_e(s,-g,-H),1>W){0>W&&(W=0);var c=mm(B,n(k,"clipDirection"),W);s.beginPath(),s.rect(c.x,c.y,c.width,c.height),s.clip()}return!0},e=function(){s.restore()},m=function(D,A,v){var $=n(D,"path"),K=n(D,oh),j=n(D,"scaleX"),g=n(D,"scaleY"),Z=t(D),p=q,W=dd(null,$);if(v||(v=D.unionRect,v||(v=Yd(W),D.path.func||(D.unionRect=v)),p=v),v){p||(p=D.unionRect,p||(p=Yd(W),D.path.func||(D.unionRect=p)));var _=d(D,v,p,K,j,g,Z),f=n(D,"borderPattern"),B=Cb(s,f),C=P(D,"background"),H=P(D,"borderColor"),b=n(D,"borderWidth"),N=n(D,"gradient"),l=P(D,"gradientColor"),Q=n(D,"border3d"),X=n(D,"border3dColor"),V=n(D,"border3dAccuracy"),y=s.lineJoin,L=s.lineCap;if(s.lineJoin=n(D,"borderJoin")||un,s.lineCap=n(D,"borderCap")||qf,C?(Fl(s,C,N,l,p),dd(s,$),s.fill(),B!==s&&dd(s,$)):dd(s,$),b&&H){var h=n(D,"borderWidthAbsolute");h&&(s.save(),s.setTransform(1,0,0,1,0,0)),s.lineWidth=b,s.strokeStyle=H,s.stroke(),h&&s.restore(),Q&&wn(s,H,X,b,a,V)}if(zg(s,f),n(D,"dash")){var I=n(D,"dashWidth")||b;if(I>0){f=n(D,"dashPattern")||Bq;var B=Cb(s,f,n(D,"dashOffset")),m=P(D,"dashColor")||P(Sh);B!==s&&dd(s,$),s.strokeStyle=m,s.lineWidth=I,s.stroke(),n(D,"dash3d")&&wn(s,m,P(D,"dash3dColor"),I,a,n(D,"dash3dAccuracy")),zg(s,f)}}A===wb&&Wj(s,C,n(D,"depth"),p),s.lineJoin=y,s.lineCap=L,_&&e()}},z=function(_,k,S,B){var K=n(_,Ko,y),I=n(_,oh),U=t(_);if(K&&B.fitSize){var A=Math.abs(Math.cos(I))<.001,W=new up,p=Yd(K),Y=B.widthScale,N=B.heightScale,z=p.x+U.x*p.width,m=p.y+U.y*p.height,C=z*Y,O=m*N;K.each(function(I){var g=I.x-z,X=I.y-m;W.add({x:C+g*(A?N:Y),y:O+X*(A?Y:N)})}),K=W,_.unionRect=null}var w=n(_,"scaleX"),h=n(_,"scaleY"),v=k===fl,Q=q;if(!S&&v&&(S=_.unionRect,S||(S=Yd(K),_.points.func||(_.unionRect=S)),Q=S),S){v?Q||(Q=_.unionRect,Q||(Q=Yd(K),_.points.func||(_.unionRect=Q))):Q=S;var M,F,E,c,R=d(_,S,Q,I,w,h,U),b=n(_,"borderPattern"),j=Cb(s,b),J=P(_,"background"),o=fo(n(_,"repeatImage"),r,V),g=n(_,"gradientPack"),G=P(_,"borderColor"),D=n(_,"borderWidth"),T=n(_,"segments",X),u=n(_,"gradient"),f=P(_,"gradientColor"),l=n(_,"border3d"),x=n(_,"border3dColor"),$=n(_,"border3dAccuracy"),i=n(_,"closePath"),Z=n(_,"fillRule")||"nonzero",Pf=s.lineJoin,Nh=s.lineCap;if(s.lineJoin=n(_,"borderJoin")||un,s.lineCap=n(_,"borderCap")||qf,v)if(J||o||g){var mf=n(_,"fillClipPercentage");if(1>mf){0>mf&&(mf=0);var Dr=mm(Q,n(_,"fillClipDirection"),mf);s.save(),s.beginPath(),s.rect(Dr.x,Dr.y,Dr.width,Dr.height),s.clip()}if(vn(s,K,T,i),g)Eo(s,g);else if(o){var lf=s,hc=r,Yo=V;zd(s,o,r,V,L,H),s=lf,r=hc,V=Yo}else{var lf=s;Fl(s,J,u,f,Q),s=lf}s.fill(Z),1>mf&&s.restore(),g&&s.restore(),j!==s&&vn(j,K,T,i)}else vn(j,K,T,i);else if("roundRect"===k?M=n(_,"cornerRadius"):"polygon"===k?M=n(_,"polygonSide"):"arc"===k&&(M=n(_,"arcFrom"),F=n(_,"arcTo"),E=n(_,"arcClose"),c=n(_,"arcOval")),J||o||g){var mf=n(_,"fillClipPercentage");if(1>mf){0>mf&&(mf=0);var Dr=mm(Q,n(_,"fillClipDirection"),mf);s.save(),s.beginPath(),s.rect(Dr.x,Dr.y,Dr.width,Dr.height),s.clip()}if(rn(s,k,Q,M,F,E,c),g)Eo(s,g);else if(o){var lf=s,hc=r,Yo=V;zd(s,o,r,V,L,H),s=lf,r=hc,V=Yo}else Fl(s,J,u,f,Q);s.fill(Z),1>mf&&s.restore(),g&&s.restore(),s!==j&&rn(j,k,Q,M,F,E,c)}else rn(j,k,Q,M,F,E,c);if(D&&G){var Ro=n(_,"borderWidthAbsolute");Ro&&(s.save(),s.setTransform(1,0,0,1,0,0)),s.lineWidth=D,s.strokeStyle=G,s.stroke(),Ro&&s.restore(),l&&wn(s,G,x,D,a,$)}if(zg(s,b),n(_,"dash")){var Mj=n(_,"dashWidth")||D;if(Mj>0){b=n(_,"dashPattern")||Bq;var j=Cb(s,b,n(_,"dashOffset")),yf=P(_,"dashColor")||P(Sh);j!==s&&(v?vn(j,K,T,i):rn(j,k,Q,M,F,E,c)),s.strokeStyle=yf,s.lineWidth=Mj,s.stroke(),n(_,"dash3d")&&wn(s,yf,P(_,"dash3dColor"),Mj,a,n(_,"dash3dAccuracy")),zg(s,b)}}k===wb&&Wj(s,J,n(_,"depth"),Q),s.lineJoin=Pf,s.lineCap=Nh,R&&e()}},T=function(u,j){var z=r,k=V,I=r||n(u,fc),v=V||n(u,"blendMode"),C=fo(n(u,"name"),I,v);C&&(Sk(s,C,n(u,"stretch"),j.x,j.y,j.width,j.height,L,H,I,null,v),r=z,V=k)},j=function($,Y){var f=n($,"text");f!=q&&Wp(s,f,n($,"font"),P($,fc),Y.x,Y.y,Y.width,Y.height,n($,"align"),n($,"vAlign"))},O=function(t,E){bb(s,P(t,fc),E.x,E.y,E.width,E.height,n(t,"width"))},K=function(Y,Z){var F=n(Y,Qh),X=0;if(F&&(F.forEach(function(K){X+=K}),X>0)){for(var V=n(Y,"colors")||ti,l=n(Y,"startAngle")||0,N=n(Y,"hollow"),Q=n(Y,or),r=n(Y,Sn),y=n(Y,Xr),k=Q?new up:q,t=Z.x,i=Z.y,h=Z.width,U=Z.height,m=t+h/2,o=i+U/2,I=f(h,U)/2,b=0,E=0;E<F.length;E++){var z=F[E],w=G*z/X,M=l+w;if(s.fillStyle=V[b++],b===V.length&&(b=0),s.beginPath(),N){var B=m+g(l)*I/2,u=o+x(l)*I/2,S=m+g(M)*I,R=o+x(M)*I;s.moveTo(B,u),s.arc(m,o,I/2,l,M,!1),s.lineTo(S,R),s.arc(m,o,I,M,l,!0)}else s.moveTo(m,o),s.arc(m,o,I,M,l,!0);k&&(w=(l+M)/2,k.add({text:Xo(Q)?Q(z,E,X,L):z,x:m+.75*g(w)*I,y:o+.75*x(w)*I})),s.closePath(),s.fill(),l=M}k&&k.each(function(f){Wp(s,f.text,r,y,f.x,f.y,0,0,uq)})}},F=function(F,_){var D=n(F,Um);if(D&&D.length>0){var Y=D.length,J=n(F,or),C=n(F,Sn),z=n(F,Xr),U=J?new up:q,B=n(F,"minValue")||0,b=n(F,"maxValue");if(b==q&&(b=0,D.forEach(function(k){k.values.forEach(function(Y){b=M(b,Y)})})),B===b)return;for(var o=_.height/(b-B),E=_.y+b*o,k=n(D[0],Qh).length,X=_.width/(3*k+1),O=2*X/Y,N=0,W=0;Y>W;W++)for(var V=D[W],R=n(V,fc),H=n(V,"colors"),p=n(V,Qh),c=0;k>c;c++){H?s.fillStyle=H[c]:R?s.fillStyle=R:(s.fillStyle=ti[N++],N===ti.length&&(N=0));var h=p[c],u=h*o,S=_.x+(1+3*c)*X+W*O;if(Kc(s,S,E-u,O,u),U){var $=Xo(J)?J(h,c,V,L):h,f=wr(C,$).height;U.add({x:S,y:E-u-f,width:O,height:f,text:$})}}U&&U.each(function(u){Wp(s,u.text,C,z,u.x,u.y,u.width,u.height,uq)})}},R=function(f,C){var v=n(f,Um);if(v&&v.length>0){var t=v.length,j=n(v[0],Qh).length,k=C.width/(3*j+1),x=0,P=n(f,"maxValue"),h=n(f,or),i=n(f,Sn),b=n(f,Xr),J=h?new up:q;if(P==q){P=0;for(var d=0;j>d;d++){for(var y=0,Y=0;t>Y;Y++)y+=n(v[Y],Qh)[d];P=M(P,y)}}if(P>0){for(var d=0;j>d;d++)for(var U=C.y+C.height,Y=0;t>Y;Y++){var $=v[Y],Q=n($,fc),F=n($,Qh)[d],O=F/P*C.height;Q?s.fillStyle=Q:(s.fillStyle=ti[x++],x===ti.length&&(x=0)),U-=O;var o={x:C.x+(1+3*d)*k,y:U,width:2*k,height:O};Kc(s,o.x,o.y,o.width,o.height),J&&(o.text=Xo(h)?h(F,d,$,L):F,J.add(o))}J&&J.each(function(E){Wp(s,E.text,i,b,E.x,E.y,E.width,E.height,uq)})}}},S=function(S,l){var p=n(S,Um);if(p&&p.length>0){for(var K=p.length,V=n(p[0],Qh).length,I=l.width/(3*V+1),Q=0,R=n(S,or),D=n(S,Sn),P=n(S,Xr),Y=R?new up:q,d=0;V>d;d++){for(var j=0,M=0;K>M;M++)j+=n(p[M],Qh)[d];if(j>0){var $=l.y+l.height;for(M=0;K>M;M++){var r=p[M],e=n(r,fc),b=n(r,Qh)[d],z=b/j*l.height;e?s.fillStyle=e:(s.fillStyle=ti[Q++],Q===ti.length&&(Q=0)),$-=z;var U={x:l.x+(1+3*d)*I,y:$,width:2*I,height:z};Kc(s,U.x,U.y,U.width,U.height),Y&&(U.text=Xo(R)?R(b,d,r,L):b,Y.add(U))}}}Y&&Y.each(function(A){Wp(s,A.text,D,P,A.x,A.y,A.width,A.height,uq)})}},w=function(E,b){var R=n(E,Um);if(R&&R.length>0){var z=R.length,l=n(E,"minValue")||0,Q=n(E,"maxValue");if(Q==q&&(Q=0,R.forEach(function(t){t.values.forEach(function(w){Q=M(Q,w)})})),l===Q)return;for(var v=b.height/(Q-l),P=b.y+Q*v,Z=n(R[0],Qh).length,h=b.width/(3*Z+1),S=0,d=n(E,"lineWidth")||2,u=n(E,"line3d"),T=n(E,"linePoint"),W=n(E,or),V=n(E,Sn),B=n(E,Xr),H=0;z>H;H++){var r=R[H],i=n(r,fc),x=n(r,Qh);i?s.strokeStyle=i:(i=s.strokeStyle=ti[S++],S===ti.length&&(S=0)),s.beginPath();for(var t=0;Z>t;t++){var f=b.x+(2+3*t)*h,F=P-x[t]*v;0===t?s.moveTo(f,F):s.lineTo(f,F)}if(s.lineWidth=d,s.stroke(),u&&wn(s,i,q,d,a),T||W){var y,g=d/2+2;for(t=0;Z>t;t++){var K=x[t];if(f=b.x+(2+3*t)*h,F=P-K*v,Xo(T)?T(s,f,F,i,t,r,L):T&&(s.fillStyle=i,s.beginPath(),s.arc(f,F,g,0,G,!0),s.fill()),Xo(W)?y=W(K,t,r,L):W&&(y=K),y){var o=wr(V,y).height,X=s.shadowBlur;if(X){var c=s.shadowOffsetX,$=s.shadowOffsetY,j=s.shadowColor;s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=0,s.shadowColor=q}Wp(s,y,V,B,f,F-o-g+2,0,o,uq),X&&(s.shadowOffsetX=c,s.shadowOffsetY=$,s.shadowBlur=X,s.shadowColor=j)}}}}}},J={border:O,image:T,text:j,pieChart:K,columnChart:F,stackedColumnChart:R,percentageColumnChart:S,lineChart:w};return function(Y,g,l,F,b,i,A,U,Z,_){if(g&&b&&i){s=Y,L=A,H=U,a=H?H._zoom?H._zoom:1:1,r=Z,V=_;var x=b,W=i;if(yb()){var R,v,f;0===s[Lb]?yb[0]&&(R=!0):R=!0,s.texureImage2D?yb[1]&&(v=!0):v=!0,s.texureImage3D?yb[2]&&(f=!0):f=!0,R&&v&&f&&(x=l,W=F)}if(g.tagName)return s.drawImage(g,x,W,b,i),void 0;if(n(g,"visible")!==!1){r||(r=mj(g.color,L,H)),_||(V=mj(g.blendMode,L,H));var j=Uh(g,L,H,b),p=yn(g,L,H,i),O={x:0,y:0,width:j,height:p,fitSize:n(g,"fitSize")},C=n(g,"clip"),G=n(g,"opacity");O.fitSize&&(O.widthScale=j/mj(g.width,L,H),O.heightScale=p/mj(g.height,L,H)),s.save(),_e(s,x,W),(j!==b||p!==i)&&s.scale(b/j,i/p),C&&(Xo(C)?C(s,j,p,L,H,g):(s.beginPath(),s.rect(0,0,j,p),s.clip())),G!=q&&(s.globalAlpha*=G),n(g,"comps").forEach(function(K){if(n(K,hd)!==!1){he.splice(0,0,K);var Y=n(K,"opacity"),j=n(K,"shadow"),T=n(K,"type"),F=h(K,O);if(Y!=q){var i=s.globalAlpha;s.globalAlpha*=Y}if(j){var g=s.shadowOffsetX,u=s.shadowOffsetY,V=s.shadowBlur,p=s.shadowColor,M=n(K,"shadowOffsetX"),l=n(K,"shadowOffsetY"),v=n(K,"shadowBlur"),r=P(K,"shadowColor");s.shadowOffsetX=(M==q?3:M)*a,s.shadowOffsetY=(l==q?3:l)*a,s.shadowBlur=(v==q?6:v)*a,s.shadowColor=r||P(eh)}if("save"===T)s.save();else if("endClip"===T||"restore"===T)s.restore();else if("clip"===T)s.save(),vn(s,n(K,"points",y),n(K,"segments",X),!0),s.clip();else if(Xd[T])F=F||{x:0,y:0,width:O.width,height:O.height},z(K,T,F,O);else if(T===fl)z(K,T,F,O);else if("SVGPath"===T)m(K,T,F);else{F=F||{x:0,y:0,width:O.width,height:O.height};var w=n(K,oh),$=n(K,"scaleX"),Z=n(K,"scaleY"),I=t(K),c=d(K,F,F,w,$,Z,I);if(Xo(T))N(K,T),E.drawCompType(T,s,F,K,L,H);else if(E.getCompType(T)){var W=E.getCompType(T),b=W.func||W;N(K,W),E.drawCompType(b,s,F,K,L,H)}else J[T]?J[T](K,F):E.getCompType(T)===Q&&te.test(T)&&rp(T);c&&e()}j&&(s.shadowOffsetX=g,s.shadowOffsetY=u,s.shadowBlur=V,s.shadowColor=p),Y!=q&&(s.globalAlpha=i),he.splice(0,1)}}),s.restore()}}}}();E.getCurrentComp=function(){return he[0]},E.getParentComp=function(){return he[1]},E.getInternal=function(){return{isEnter:mh,isEsc:hj,isSpace:Rb,isLeft:Bn,isUp:Br,isRight:fn,isDown:Dp,addMethod:Ij,superCall:Pj,toPointsArray:Dj,translateAndScale:yr,appendArray:Ck,createWorldMatrix:gs,vec3TransformMat4:Kl,setCanvas:Pm,createDiv:ao,createView:wk,createCanvas:ld,createImage:Gk,initContext:Pg,layout:Mj,fillRect:Kc,Mat:He,drawBorder:bb,isString:Gg,setBorder:Gc,getPropertyValue:tg,setPropertyValue:Jf,drawVerticalLine:ag,draw3DRect:Wj,getPinchDist:Em,isSameRect:nq,getPosition:Un,intersectionLineRect:km,getNodeRect:bq,getEdgeAgentPosition:Bc,getImageWidth:Uh,getImageHeight:yn,initItemElement:bh,drawPoints:vn,createG2:Cb,closePopup:ef,isH:bd,createAnim:df,createNormalMatrix:ih,createNormals:$p,toFloatArray:Ee,glMV:Yr,batchShape:hb,createNodeMatrix:Kk,getFaceInfo:zl,transformAppend:Qb,drawFaceInfo:Lk,to3dPointsArray:Ze,setGLDebugMode:function(t){Hm=t},cube:function(){return{vs:Gh,is:Jc,uv:fb}},ui:function(){return{DataUI:nc,NodeUI:Ql,EdgeUI:mi,GroupUI:gg,ShapeUI:Le,GridUI:lj,Data3dUI:ob,Node3dUI:cd,Shape3dUI:qd}},getInternalVersion:function(){return"U2FsdGVkX19zkwi4wGbLJxjLp/Sh+5BggUVbq3HfZ5Q="},getDragger:function(){return Cc},addMSMap:function(s){Ij(Ie,s)},k:U}},function(S){function I(D,P){D!=q&&(P==q&&Qo!=typeof D?this._54O(D,256):this._54O(D,P))}function i(){return new I(q)}function N(d,L,N,U,k,E){for(;--E>=0;){var r=L*this[d++]+N[U]+k;k=l(r/67108864),N[U++]=67108863&r}return k}function X(l,E,k,G,M,J){for(var e=32767&E,_=E>>15;--J>=0;){var r=32767&this[l],D=this[l++]>>15,S=_*r+D*e;r=e*r+((32767&S)<<15)+k[G]+(1073741823&M),M=(r>>>30)+(S>>>15)+_*D+(M>>>30),k[G++]=1073741823&r}return M}function E(R,P,z,U,i,t){for(var H=16383&P,F=P>>14;--t>=0;){var q=16383&this[R],W=this[R++]>>14,C=F*q+W*H;q=H*q+((16383&C)<<14)+z[U]+i,i=(q>>28)+(C>>14)+F*W,z[U++]=268435455&q}return i}function w(k){return Am.charAt(k)}function Y(k,T){var $=Jc[k.charCodeAt(T)];return $==q?-1:$}function B(a){for(var q=this.t-1;q>=0;--q)a[q]=this[q];a.t=this.t,a.s=this.s}function e(K){this.t=1,this.s=0>K?-1:0,K>0?this[0]=K:-1>K?this[0]=K+this.DV:this.t=0}function D(r){var q=i();return q._58O(r),q}function L(V,r){var l,w=this;if(16==r)l=4;else if(8==r)l=3;else if(256==r)l=8;else if(2==r)l=1;else if(32==r)l=5;else{if(4!=r)return w.fromRadix(V,r),void 0;l=2}w.t=0,w.s=0;for(var $=V.length,e=!1,P=0;--$>=0;){var Q=8==l?255&V[$]:Y(V,$);0>Q?"-"==V.charAt($)&&(e=!0):(e=!1,0==P?w[w.t++]=Q:P+l>w.DB?(w[w.t-1]|=(Q&(1<<w.DB-P)-1)<<P,w[w.t++]=Q>>w.DB-P):w[w.t-1]|=Q<<P,P+=l,P>=w.DB&&(P-=w.DB))}8==l&&0!=(128&V[0])&&(w.s=-1,P>0&&(w[w.t-1]|=(1<<w.DB-P)-1<<P)),w._57O(),e&&I.ZERO._78O(w,w)}function d(){for(var Y=this,a=Y.s&Y.DM;Y.t>0&&Y[Y.t-1]==a;)--Y.t}function s(F){var s=this;if(s.s<0)return"-"+s._85O()[Gd](F);var R;if(16==F)R=4;else if(8==F)R=3;else if(2==F)R=1;else if(32==F)R=5;else{if(4!=F)return s.toRadix(F);R=2}var S,n=(1<<R)-1,g=!1,I="",Y=s.t,f=s.DB-Y*s.DB%R;if(Y-->0)for(f<s.DB&&(S=s[Y]>>f)>0&&(g=!0,I=w(S));Y>=0;)R>f?(S=(s[Y]&(1<<f)-1)<<R-f,S|=s[--Y]>>(f+=s.DB-R)):(S=s[Y]>>(f-=R)&n,0>=f&&(f+=s.DB,--Y)),S>0&&(g=!0),g&&(I+=w(S));return g?I:"0"}function A(){var r=i();return I.ZERO._78O(this,r),r}function P(){return this.s<0?this._85O():this}function R(o){var P=this,x=P.s-o.s;if(0!=x)return x;var n=P.t;if(x=n-o.t,0!=x)return P.s<0?-x:x;for(;--n>=0;)if(0!=(x=P[n]-o[n]))return x;return 0}function C(s){var K,O=1;return 0!=(K=s>>>16)&&(s=K,O+=16),0!=(K=s>>8)&&(s=K,O+=8),0!=(K=s>>4)&&(s=K,O+=4),0!=(K=s>>2)&&(s=K,O+=2),0!=(K=s>>1)&&(s=K,O+=1),O}function c(){var Z=this;return Z.t<=0?0:Z.DB*(Z.t-1)+C(Z[Z.t-1]^Z.s&Z.DM)}function $(j,s){var e;for(e=this.t-1;e>=0;--e)s[e+j]=this[e];for(e=j-1;e>=0;--e)s[e]=0;s.t=this.t+j,s.s=this.s}function k(B,o){for(var V=B;V<this.t;++V)o[V-B]=this[V];o.t=M(this.t-B,0),o.s=this.s}function h(q,G){var y,T=this,A=q%T.DB,V=T.DB-A,C=(1<<V)-1,h=l(q/T.DB),R=T.s<<A&T.DM;for(y=T.t-1;y>=0;--y)G[y+h+1]=T[y]>>V|R,R=(T[y]&C)<<A;for(y=h-1;y>=0;--y)G[y]=0;G[h]=R,G.t=T.t+h+1,G.s=T.s,G._57O()}function J(s,t){var G=this;t.s=G.s;var o=l(s/G.DB);if(o>=G.t)return t.t=0,void 0;var M=s%G.DB,w=G.DB-M,K=(1<<M)-1;t[0]=G[o]>>M;for(var b=o+1;b<G.t;++b)t[b-o-1]|=(G[b]&K)<<w,t[b-o]=G[b]>>M;M>0&&(t[G.t-o-1]|=(G.s&K)<<w),t.t=G.t-o,t._57O()}function O(B,L){for(var w=this,F=0,W=0,p=f(B.t,w.t);p>F;)W+=w[F]-B[F],L[F++]=W&w.DM,W>>=w.DB;if(B.t<w.t){for(W-=B.s;F<w.t;)W+=w[F],L[F++]=W&w.DM,W>>=w.DB;W+=w.s}else{for(W+=w.s;F<B.t;)W-=B[F],L[F++]=W&w.DM,W>>=w.DB;W-=B.s}L.s=0>W?-1:0,-1>W?L[F++]=w.DV+W:W>0&&(L[F++]=W),L.t=F,L._57O()}function t(r,D){var o=this.abs(),W=r.abs(),n=o.t;for(D.t=n+W.t;--n>=0;)D[n]=0;for(n=0;n<W.t;++n)D[n+o.t]=o.am(0,W[n],D,n,0,o.t);D.s=0,D._57O(),this.s!=r.s&&I.ZERO._78O(D,D)}function V(X){for(var f=this.abs(),l=X.t=2*f.t;--l>=0;)X[l]=0;for(l=0;l<f.t-1;++l){var Z=f.am(l,f[l],X,2*l,0,1);(X[l+f.t]+=f.am(l+1,2*f[l],X,2*l+1,Z,f.t-l-1))>=f.DV&&(X[l+f.t]-=f.DV,X[l+f.t+1]=1)}X.t>0&&(X[X.t-1]+=f.am(l,f[l],X,2*l,0,1)),X.s=0,X._57O()}function o(o,D,s){var V=o.abs(),A=this;if(!(V.t<=0)){var c=A.abs();if(c.t<V.t)return D!=q&&D._58O(0),s!=q&&A._77O(s),void 0;s==q&&(s=i());var m=i(),Q=A.s,N=o.s,J=A.DB-C(V[V.t-1]);J>0?(V._44O(J,m),c._44O(J,s)):(V._77O(m),c._77O(s));var g=m.t,f=m[g-1];if(0!=f){var Z=f*(1<<A.F1)+(g>1?m[g-2]>>A.F2:0),S=A.FV/Z,b=(1<<A.F1)/Z,F=1<<A.F2,r=s.t,E=r-g,w=D==q?i():D;for(m._59O(E,w),s._52O(w)>=0&&(s[s.t++]=1,s._78O(w,s)),I.ONE._59O(g,w),w._78O(m,m);m.t<g;)m[m.t++]=0;for(;--E>=0;){var k=s[--r]==f?A.DM:l(s[r]*S+(s[r-1]+F)*b);if((s[r]+=m.am(0,k,s,E,0,g))<k)for(m._59O(E,w),s._78O(w,s);s[r]<--k;)s._78O(w,s)}D!=q&&(s._45O(g,D),Q!=N&&I.ZERO._78O(D,D)),s.t=g,s._57O(),J>0&&s._46O(J,s),0>Q&&I.ZERO._78O(s,s)}}}function H(x){var y=i();return this.abs()._49O(x,q,y),this.s<0&&y._52O(I.ZERO)>0&&x._78O(y,y),y}function y(A){this.m=A}function T(D){return D.s<0||D._52O(this.m)>=0?D.mod(this.m):D}function j(N){return N}function u(f){f._49O(this.m,q,f)}function W(P,X,W){P._47O(X,W),this._74O(W)}function b(Z,u){Z._48O(u),this._74O(u)}function Q(){if(this.t<1)return 0;var A=this[0];if(0==(1&A))return 0;var E=3&A;return E=15&E*(2-(15&A)*E),E=255&E*(2-(255&A)*E),E=65535&E*(2-(65535&(65535&A)*E)),E=E*(2-A*E%this.DV)%this.DV,E>0?this.DV-E:-E}function n(m){var x=this;x.m=m,x.mp=m._50O(),x.mpl=32767&x.mp,x.mph=x.mp>>15,x.um=(1<<m.DB-15)-1,x.mt2=2*m.t}function r(W){var s=i();return W.abs()._59O(this.m.t,s),s._49O(this.m,q,s),W.s<0&&s._52O(I.ZERO)>0&&this.m._78O(s,s),s}function a(h){var z=i();return h._77O(z),this._74O(z),z}function _(d){for(var p=this;d.t<=p.mt2;)d[d.t++]=0;for(var I=0;I<p.m.t;++I){var M=32767&d[I],$=M*p.mpl+((M*p.mph+(d[I]>>15)*p.mpl&p.um)<<15)&d.DM;for(M=I+p.m.t,d[M]+=p.m.am(0,$,d,I,0,p.m.t);d[M]>=d.DV;)d[M]-=d.DV,d[++M]++}d._57O(),d._45O(p.m.t,d),d._52O(p.m)>=0&&d._78O(p.m,d)}function qj(i,R){i._48O(R),this._74O(R)}function ul(z,j,b){z._47O(j,b),this._74O(b)}function am(){return 0==(this.t>0?1&this[0]:this.s)}function Tm(b,$){if(b>4294967295||1>b)return I.ONE;var B=i(),c=i(),k=$._73O(this),Y=C(b)-1;for(k._77O(B);--Y>=0;)if($._76O(B,c),(b&1<<Y)>0)$._75O(c,k,B);else{var x=B;B=c,c=x}return $.revert(B)}function fl(X,M){var H;return H=256>X||M._51O()?new y(M):new n(M),this.exp(X,H)}function gd(){var k=this;if(k.s<0){if(1==k.t)return k[0]-k.DV;if(0==k.t)return-1}else{if(1==k.t)return k[0];if(0==k.t)return 0}return(k[1]&(1<<32-k.DB)-1)<<k.DB|k[0]}function rb(H,T){return new I(H,T)}function Wl(){var d=this;d.n=q,d.e=0,d.d=q,d.p=q,d.q=q,d.dmp1=q,d.dmq1=q,d._10A=q}function wr(Y){return Y._53O(this.e,this.n)}function us(V){var B,v,h,T="",F=0;for(B=0;B<V.length&&V.charAt(B)!=Mc;++B)h=An.indexOf(V.charAt(B)),0>h||(0==F?(T+=w(h>>2),v=3&h,F=1):1==F?(T+=w(v<<2|h>>4),v=15&h,F=2):2==F?(T+=w(v),T+=w(h>>2),v=3&h,F=3):(T+=w(v<<2|h>>4),T+=w(15&h),F=0));return 1==F&&(T+=w(v<<2)),T}function yp(x){var w=x.split(""),q=us(x);return w.forEach(function(I){var P=I.length;P>0&&q&&(ac+=m(I))}),q}function xg(h,D){var e=$m._4O.Util._56O(h,"ss"),s={},t=0;return s.v=e==D,s.t=1,s.s=0>t?-1:0,So=s.v,t>0?s[0]=t:-1>t?s[0]=t+s.DV:s.t=0,[e,s]}function Wh(o){var x=38,t=o.substring(0,x);if(t&&30==t.indexOf("05000420")){var p=["ss",o.substring(x)];return p}return[]}function We(Q,M){M=M.replace(Jq,""),M=M.replace(/[ \n]+/g,"");var R=rb(M,16);if(R._55O()>this.n._55O())return 0;var D=this._37O(R),E=D[Gd](16).replace(/^1f+00/,""),r=Wh(E);if(0==r.length)return!1;for(var S,i,Y,l=.5,k=Xb,a=[0,.5,.75,.875,.9375],t=[],C=[],K=[],d=G/k,p=r[1],$=xg(Q,p)[0],F=0,y=0;F<a.length;F++){var f=0===F%2?0:.5;for(S=0;k>=S;S++)i=(S+f)*d,Y=1-a[F],t.push(g(i)*l*Y,-l+2*a[F]*l,-x(i)*l*Y),C.push((S+f)/k,Y)}for(F=0;F<a.length-1;F++){var U=F*(k+1),L=(F+1)*(k+1);for(S=0;k>S;S++)K.push(U+S,L+S+1,L+S,U+S,U+S+1,L+S+1)}return K.forEach(function(P){y+=P}),p==$&&y>10}var ym,sh=0xdeadbeefcafe,zp=15715070==(16777215&sh),Gd="toString",ei="",Og="nat",Gk=function(){};K=S["D"+11182[Gd](F(2,5))];var jn=I.prototype;er+=ng.substr(0,1);var Ai=S.navigator?S.navigator.appName:"";zp&&"Microsoft Internet Explorer"==Ai?(jn.am=X,ym=30):zp&&"Netscape"!=Ai?(jn.am=N,ym=26):(jn.am=E,ym=28),jn.DB=ym,jn.DM=(1<<ym)-1,jn.DV=1<<ym;var nl=52;jn.FV=F(2,nl),jn.F1=nl-ym,jn.F2=2*ym-nl;var Nd,Gi,Am="0123456789abcdefghijklmnopqrstuvwxyz",Jc=[],oc=function(q){return String.fromCharCode(q)};for(Nd="0".charCodeAt(0),Gi=0;9>=Gi;++Gi)Jc[Nd++]=Gi;for(Nd="a".charCodeAt(0),Gi=10;36>Gi;++Gi)Jc[Nd++]=Gi;for(Nd="A".charCodeAt(0),Gi=10;36>Gi;++Gi)Jc[Nd++]=Gi;var el=y.prototype;el._73O=T,el.revert=j,el._74O=u,el._75O=W,el._76O=b;var ai=n.prototype;ai._73O=r,ai.revert=a,ai._74O=_,ai._75O=ul,ai._76O=qj,jn._77O=B,jn._58O=e,jn._54O=L,jn._57O=d,jn._59O=$,jn._45O=k,jn._44O=h,jn._46O=J,jn._78O=O,jn._47O=t,jn._48O=V,jn._49O=o,jn._50O=Q,jn._51O=am,jn.exp=Tm,jn.toString=s,jn._85O=A,jn.abs=P,jn._52O=R,jn._55O=c,jn.mod=H,jn._53O=fl,I.ZERO=D(0),I.ONE=D(1),jn._86O=gd;var qr=function(d,v){var T=this;T.isPublic=!0,typeof d!==Qo?(T.n=d,T.e=v):d!=q&&v!=q&&d.length>0&&v.length>0&&(T.n=rb(d,16),T.e=m(v,16))};dh=function(){var A,v,O=yp(Om),m=O.substr(0,4),G=O.substr(4,2),H=O.substr(6,2),S=1,i=!S,X=U,d=[],f=Kn.charAt(7);if(K&&(K[Gd]().indexOf(Og)<0||K[er][Gd]().indexOf(Og)<0||!O?A=Bi(ep[f]):(O=new K(m-0,G-S,H-0),v=O.setHours(9),K[er]()>v?A=Bi(ep[f]):i=!0)),O&&A&&X){for(var h in A)d.push(h);var b,D=A[d[0]],u=A[d[1]],F=A[d[2]],c=A[d[4]],M=A[d[5]],g=A[d[6]],s=Cm._27O(X);
s&&g&&(b=D+u+F+c+""+M,b&&s._31O(b,g)&&(i=!0))}return i||(rn=ae),f};var _i=Wl.prototype;_i._37O=wr,_i._38O=qr;var An="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Mc="=",yb=25,eh=10,Om="IBcJFQ==",Ji=Ji||function(Q,K){var T={},Z=T._7A={},I=Z._6A=function(){function N(){}return{_80O:function(V){N.prototype=this;var I=new N;return V&&I._5A(V),I.hasOwnProperty("_82O")||(I._82O=function(){I.$super._82O.apply(this,arguments)}),I._82O.prototype=I,I.$super=this,I},_3A:function(){var l=this._80O();return l._82O.apply(l,arguments),l},_82O:function(){},_5A:function(V){for(var c in V)V.hasOwnProperty(c)&&(this[c]=V[c]);V.hasOwnProperty(Gd)&&(this.toString=V.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),s=Z._39O=I._80O({_82O:function(z,m){z=this._84O=z||[],this._65O=m!=K?m:4*z.length},toString:function(J){return(J||x).stringify(this)},_89O:function(c){var k=this._84O,v=c._84O,Q=this._65O,E=c._65O;if(this._57O(),Q%4)for(var D=0;E>D;D++){var P=255&v[D>>>2]>>>24-8*(D%4);k[Q+D>>>2]|=P<<24-8*((Q+D)%4)}else if(v.length>65535)for(var D=0;E>D;D+=4)k[Q+D>>>2]=v[D>>>2];else k.push.apply(k,v);return this._65O+=E,this},_57O:function(){var S=this._84O,Z=this._65O;S[Z>>>2]&=4294967295<<32-8*(Z%4),S.length=z(Z/4)},_88O:function(){var m=I._88O.call(this);return m._84O=this._84O.slice(0),m},_87O:function(Y){for(var N=[],x=0;Y>x;x+=4)N.push(0|4294967296*p);return new s._82O(N,Y)}}),P=T._2A={},x=P._69O={stringify:function(G){var T,Q=G._84O,n=G._65O,m=[];for(T=0;n>T;T++){var b=255&Q[T>>>2]>>>24-8*(T%4);m.push((b>>>4).toString(16)),m.push((15&b).toString(16))}return m.join("")},_68O:function(x){for(var y=x.length,t=[],Z=0;y>Z;Z+=2)t[Z>>>3]|=m(x.substr(Z,2),16)<<24-4*(Z%8);return new s._82O(t,y/2)}},c=P._8A={stringify:function(Y){var E,i=Y._84O,d=Y._65O,o=[];for(E=0;d>E;E++){var j=255&i[E>>>2]>>>24-8*(E%4);o.push(oc(j))}return o.join("")},_68O:function(k){var O,G=k.length,v=[];for(O=0;G>O;O++)v[O>>>2]|=(255&k.charCodeAt(O))<<24-8*(O%4);return new s._82O(v,G)}},$=P._9A={stringify:function(L){try{return decodeURIComponent(escape(c.stringify(L)))}catch(C){throw new Error("")}},_68O:function(D){return c._68O(unescape(encodeURIComponent(D)))}},v=Z._32O=I._80O({_1A:function(){this._83O=new s._82O,this._23O=0},_33O:function(N){typeof N==Qo&&(N=$._68O(N)),this._83O._89O(N),this._23O+=N._65O},_25O:function(l){var G=this._83O,b=G._84O,E=G._65O,k=this._79O,t=4*k,w=E/t;w=l?z(w):M((0|w)-this._22O,0);var x=w*k,L=f(4*x,E);if(x){for(var j=0;x>j;j+=k)this._20O(b,j);var o=b.splice(0,x);G._65O-=L}return new s._82O(o,L)},_88O:function(){var D=I._88O.call(this);return D._83O=this._83O._88O(),D},_22O:0});Z._66O=v._80O({cfg:I._80O(),_82O:function(V){this.cfg=this.cfg._80O(V),this._1A()},_1A:function(){v._1A.call(this),this._34O()},_81O:function(S){return this._33O(S),this._25O(),this},_72O:function(k){k&&this._33O(k);var l=this._21O();return l},_79O:16,_26O:function(V){return function(L,Z){return new V._82O(Z)._72O(L)}},_19O:function(m){return function(O,c){return new u._71O._82O(m,c)._72O(O)}}});var u=T._67O={};return T}();!function(){var c=Ji,m=c._7A,q=m._39O,P=m._66O,r=c._67O,J=[],H=[];!function(){function R(U){for(var N=Z(U),C=2;N>=C;C++)if(!(U%C))return!1;return!0}function N(g){return 0|4294967296*(g-(0|g))}for(var d=2,I=0;64>I;)R(d)&&(8>I&&(J[I]=N(F(d,.5))),H[I]=N(F(d,1/3)),I++),d++}();var b=[],n=r._41O=P._80O({_34O:function(){this._64O=new q._82O(J.slice(0))},_20O:function(z,G){for(var k=this._64O._84O,v=k[0],y=k[1],S=k[2],w=k[3],R=k[4],a=k[5],i=k[6],g=k[7],A=0;64>A;A++){if(16>A)b[A]=0|z[G+A];else{var $=b[A-15],M=($<<25|$>>>7)^($<<14|$>>>18)^$>>>3,K=b[A-2],s=(K<<15|K>>>17)^(K<<13|K>>>19)^K>>>10;b[A]=M+b[A-7]+s+b[A-16]}var Q=R&a^~R&i,t=v&y^v&S^y&S,j=(v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22),I=(R<<26|R>>>6)^(R<<21|R>>>11)^(R<<7|R>>>25),q=g+I+Q+H[A]+b[A],u=j+t;g=i,i=a,a=R,R=0|w+q,w=S,S=y,y=v,v=0|q+u}k[0]=0|k[0]+v,k[1]=0|k[1]+y,k[2]=0|k[2]+S,k[3]=0|k[3]+w,k[4]=0|k[4]+R,k[5]=0|k[5]+a,k[6]=0|k[6]+i,k[7]=0|k[7]+g},_21O:function(){var C=this._83O,e=C._84O,m=8*this._23O,Z=8*C._65O;return e[Z>>>5]|=128<<24-Z%32,e[(Z+64>>>9<<4)+14]=l(m/4294967296),e[(Z+64>>>9<<4)+15]=m,C._65O=4*e.length,this._25O(),this._64O},_88O:function(){var O=P._88O.call(this);return O._64O=this._64O._88O(),O}});c._41O=P._26O(n),c._42O=P._19O(n)}();var Jq=new RegExp("");Jq.compile("[^0-9a-f]","gi"),Wl._28O=-1,Wl._29O=-2,_i._31O=We,_i._63O=We,Wl._43O=-2;var Rr=new function(){var f=this;f._5O=function(Y,n){if("8"!=Y.substring(n+2,n+3))return 1;var o=m(Y.substring(n+3,n+4));return 0==o?-1:o>0&&10>o?o+1:-2},f._13O=function(v,G){var d=f._5O(v,G);return 1>d?"":v.substring(G+2,G+2+2*d)},f._12O=function(J,R){var O=f._13O(J,R);if(""==O)return-1;var p;return p=m(O.substring(0,1))<8?new I(O,16):new I(O.substring(2),16),p._86O()},f._6O=function(h,U){var x=f._5O(h,U);return 0>x?x:U+2*(x+1)},f._11O=function(l,j){var E=f._6O(l,j),N=f._12O(l,j);return l.substring(E,E+2*N)},f._10O=function(R,E){var r=f._6O(R,E),d=f._12O(R,E);return r+2*d},f._7O=function(I,X){var v=[],Z=f._6O(I,X);v.push(Z);for(var k=f._12O(I,X),A=Z,$=0;;){var z=f._10O(I,A);if(z==q||z-Z>=2*k)break;if($>=200)break;v.push(z),A=z,$++}return v}};if(Rr._90O=oc(eh+24),Rr._91O=v+oc(eh*eh+8),$m==q||!$m)var $m={};$m._4O!=q&&$m._4O||($m._4O={});var Mf=$m._4O;$m._4O.Util=new function(){var t=this;t._56O=function(R){var m=new $m._4O._3O;return m._30O(R)},t._4A=function(L){var H=new $m._4O._3O;return H._36O(L)},t._11A=function(Q){var A=new Mf._3O;return A._30O(Q)}},$m._4O._3O=function(){var z=this;z._8O=function(y,c){if("ss"==y&&"cj"==c){try{z.md=Ji._67O._41O._3A()}catch(t){Gk(ei)}z._24O=function(J){z.md._81O(J)},z._35O=function(H){var g=Ji._2A._69O._68O(H);z.md._81O(g)},z._60O=function(){var k=z.md._72O();return k[Gd](Ji._2A._69O)},z._30O=function(w){return z._24O(w),z._60O()},z._36O=function(n){return z._35O(n),z._60O()}}},z._24O=function(){Gk(ei)},z._35O=function(){Gk(ei)},z._60O=function(){Gk(ei)},z._30O=function(){Gk(ei)},z._36O=function(){Gk(ei)},z._8O("ss","cj")},Oe=function(k){var F=qi[_f[7]],t=1,S=!1;if(ii.a!=qi[Vq])return ii.a;if(ii.forEach(function(H){t*=H}),k>t){if(F){F=F.split(Rr._90O);var c=F[3],r=F[7],j=F[11],A=F[19],K=F[23],q=F[27],X=c+r+j+A+K;S=Fb()(X,q)}S||(nc.prototype._42=Oc)}else S=!0;return ii.a=S,S},yb=String.fromCharCode(yb+20);var jl=function(E){return E=E.replace(Jq,ei),E=E.replace(/[ \n]+/g,ei)},Dp="30",kn="06",ar="02",tn="03",xi=rb,Sm=/^1f+00/,Cm=function(){var R;return R={_18O:function(t){var k=t,C=k.replace(/\s+/g,""),y=us(C);return y},_14O:function(b){var H=this._18O(b),k=this._15O(H);return k},_15O:function(M){var s=this._17O(M);if("2a864886f70d010101"==s._61O){var Y=this._16O(s.key),P=new Wl;return P._38O(Y.n,Y.e),P}Gk(ei)},_16O:function(H){var L={};H.substr(0,2)!=Dp&&Gk(ei);var C=Rr._7O(H,0);return 2!=C.length&&Gk(ei),H.substr(C[0],2)!=ar&&Gk(ei),L.n=Rr._11O(H,C[0]),H.substr(C[1],2)!=ar&&Gk(ei),L.e=Rr._11O(H,C[1]),L},_17O:function(Z){var t={};t._40O=q;var P=Rr._7O(Z,0);2!=P.length&&Gk(ei);var Q=P[0];Z.substr(Q,2)!=Dp&&Gk(ei);var U=Rr._7O(Z,Q);return 2!=U.length&&Gk(ei),Z.substr(U[0],2)!=kn&&Gk(ei),t._61O=Rr._11O(Z,U[0]),Z.substr(U[1],2)==kn?t._40O=Rr._11O(Z,U[1]):Z.substr(U[1],2)==Dp&&(t._40O={},t._40O.p=Rr._70O(Z,U[1],[0],ar),t._40O.q=Rr._70O(Z,U[1],[1],ar),t._40O.g=Rr._70O(Z,U[1],[2],ar)),Z.substr(P[1],2)!=tn&&Gk(ei),t.key=Rr._11O(Z,P[1]).substr(2),t}},R._17O?R:q}(),zf=Cm._27O=function(n){return Cm._14O(n)};Fb=function(){return function(U,X){X=jl(X);var B=xi(X,F(2,4)),j=this;if(!j||!j.n||B._55O()>j.n._55O())return 0;var J=j._37O(B),w=J[Gd](F(2,4)).replace(Sm,""),r=Wh(w);if(0==r.length)return!1;var Q=r[0],T=r[1],Z=function(Y){return $m._4O.Util._56O(Y,Q)},R=Z(U);return T==R}.bind(zf(U))};var Ne,Ch;return function(){var l=Yj.length-vf.length;if(l>0)for(var J=0;l>J;J++)Ne=Mf.Util,Ch=jl}(),Ig=function(j,Z){Z=Ch(Z);var n=zf(Mn),i=jm.length,N=2*i,p=xi(Z,F(i,N)),y=n,o=!0;if(y){var _=y[gn[0]];_&&p._55O()<=_._55O()&&(o=!1)}if(o)return 0;var l=y._37O(p),Y=l[Gd](F(i,N)).replace(Sm,""),u=Wh(Y);if(0==u.length)return!1;var d=u[0],g=u[1],t=Ne._11A(j,d);return g==t},Cm}(O,P);var up=i.List=function(){this._as=[];var m,Z,B=arguments.length;if(1===B){var a=arguments[0];if(rk(a)&&(a=a._as),Rn(a))for(Z=a.length,m=0;Z>m;m++)this._as.push(a[m]);else a!=q&&this._as.push(a)}else if(B>1)for(m=0;B>m;m++)this._as.push(arguments[m])};Qd("List",P,{forEach:function(U,b){this.each(U,b)},push:function(){for(var o=0;o<arguments.length;o++)this.add(arguments[o])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(v,f){return f===Q?this._as.push(v):this._as.splice(f,0,v)},addAll:function(I){rk(I)&&(I=I._as),Rn(I)?Ck(this._as,I):this._as.push(I)},get:function(k){return this._as[k]},slice:function(S,i){return new up(this._as.slice(S,i))},remove:function(k){var H=this._as.indexOf(k);return H>=0&&H<this._as.length&&this.removeAt(H),H},removeAt:function(D){return this._as.splice(D,1)[0]},set:function(G,n){return this._as[G]=n},clear:function(){return this._as.splice(0,this._as.length)},contains:function(J){return this._as.indexOf(J)>=0},indexOf:function(j){return this._as.indexOf(j)},each:function(T,x){for(var c=0,q=this._as.length;q>c;c++){var V=this._as[c];x?T.call(x,V,c,this):T(V,c,this)}},reverseEach:function(g,j){for(var K=this._as.length-1;K>=0;K--){var N=this._as[K];j?g.call(j,N):g(N)}},toArray:function(_,b){if(_){for(var p,Q=[],w=0,z=this._as.length;z>w;w++)p=this._as[w],b?_.call(b,p)&&Q.push(p):_(p)&&Q.push(p);return Q}return this._as.concat()},toList:function(f,m){if(f){for(var A,T=new up,u=0,$=this._as.length;$>u;u++)A=this._as[u],m?f.call(m,A)&&T.add(A):f(A)&&T.add(A);return T}return new up(this)},reverse:function(){this._as.reverse()},sort:function(O){return this._as.sort(O?O:zb),this},toString:function(){return this._as.toString()}}),P.defineProperties(up.prototype,{length:{get:function(){return this._as.length},set:function(A){this._as.length=A}}});var zh=new up;Ij(zh,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Fe,each:Fe,reverseEach:Fe,toArray:function(){return[]},toList:function(){return new up},add:Yb,addAll:Yb,set:Yb,remove:Yb,removeAt:Yb,clear:Yb});var Bl=i.Notifier=function(){};Qd("Notifier",P,{contains:function(p,Z){if(this._ls)for(var k,m=0,f=this._ls.size();f>m;m++)if(k=this._ls.get(m),p===k.l&&Z===k.s)return!0;return!1},add:function(E,O,j){var l=this,$={l:E,s:O,a:j};l._ls||(l._ls=new up),l._f?(l._as||(l._as=new up),l._as.add($)):$.a?l._ls.add($,0):l._ls.add($)},remove:function(N,B){var H=this;H._ls&&(H._f?(H._rs||(H._rs=new up),H._rs.add({l:N,s:B})):H._remove(N,B))},_remove:function(P,k){for(var o,t=this._ls,Z=0,E=t.size();E>Z;Z++)if(o=t.get(Z),o.l===P&&o.s===k)return t.removeAt(Z),void 0},fire:function(r){var U=this,G=U._ls;if(U._b=1e4,G){U._f=1;for(var l,T=0,B=G.size();B>T;T++)l=G.get(T),l.s?l.l.call(l.s,r):l.l(r);if(delete U._f,U._rs){for(B=U._rs.size(),T=0;B>T;T++)l=U._rs.get(T),U._remove(l.l,l.s);delete U._rs}if(U._as){for(B=U._as.size(),T=0;B>T;T++)l=U._as.get(T),l.a?G.add(l,0):G.add(l);delete U._as}}}});var Mb=i.Data=function(){this._id=ei()};Qd("Data",P,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:q,_parent:q,_children:zh,_childMap:q,_styleMap:q,_layer:0,_adjustChildrenToTop:!1,getUIClass:function(){return q},_22Q:function(){return q},s:function(D,g){var P=this;if(2===arguments.length)P.setStyle(D,g);else{if(!qc(D))return P.getStyle(D);for(var w in D)P.setStyle(w,D[w])}return P},fp:function(D,W,O){return this.firePropertyChange(D,W,O)},firePropertyChange:function(C,J,h){if(J===h)return!1;var L=this,x={property:C,oldValue:J,newValue:h,data:L};return L._dataModel&&L._dataModel.handleDataPropertyChange(x),L.onPropertyChanged(x),!0},onPropertyChanged:function(W){var q=this,C=q._parent,n=W.property;if(Gd(C)){var o=q.s(Lg),M="s:ingroup"===n;(o&&hp[n]||n===M)&&C._81I(),(o||M)&&C.fp("childChange",!0,!1)}no(C)&&hp[n]&&C.updateFromChildren()},_21I:function(r){var G=this;if(r&&G._dataModel)throw"Remove data from dataModel before adding";G._dataModel=r},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var m=0,y=this._children.toArray(),B=y.length;B>m;m++)y[m].removeFromDataModel()},getId:function(){return this._id},setId:function(X){this._id=X},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(B,d){return this._children.toList(B,d)},eachChild:function(i,H){this._children.each(i,H)},addChild:function(O,F){var H=this;O!==H&&(H._children===zh&&(H._children=new up,H._childMap={}),F===Q&&(F=H._children.size()),H._childMap[O._id]||H.isDescendantOf(O)||(O._parent&&O._parent.removeChild(O),(0>F||F>H._children.size())&&(F=H._children.size()),H._children.add(O,F),H._childMap[O._id]=O,O.setParent(H),H.onChildAdded(O,F),H.fp(iq,q,O)))},onChildAdded:function(){},removeChild:function(I){var p=this;if(p._childMap&&p._childMap[I._id]){var n=p._children.remove(I);delete p._childMap[I._id],p.fp(iq,I,q),I.setParent(q),p.onChildRemoved(I,n)}},onChildRemoved:function(){},getChildAt:function(X){return this._children.get(X)},clearChildren:function(){var l=this;if(!l._children.isEmpty())for(var R=0,r=l._children.toArray(),w=r.length;w>R;R++)l.removeChild(r[R])},getParent:function(){return this._parent},setParent:function(R){var D=this;if(!(D._73I||D._parent===R||D===R||R&&R.isDescendantOf(D))){var E=D._parent;D._parent=R,D._73I=1,E&&E.removeChild(D),R&&R.addChild(D),delete D._73I,D.fp("parent",E,R),D.onParentChanged(E,R)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(I){return I?this.isDescendantOf(I)||I.isDescendantOf(this):!1},isParentOf:function(R){return R&&this._childMap?!!this._childMap[R._id]:!1},isDescendantOf:function(p){if(!p||p.isEmpty())return!1;for(var V=this._parent;V;){if(p===V)return!0;V=V._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(f,T){T===Q&&(T=1);var E=this._styleMap?this._styleMap[f]:Q;return E===Q&&T?X[f]:E},setStyle:function(V,h){var N=this;N._styleMap||(N._styleMap={});var j=N._styleMap[V];h===Q?delete N._styleMap[V]:N._styleMap[V]=h,N.fp("s:"+V,j,h)&&N.onStyleChanged(V,j,h)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var z=this;return z._displayName||z._name||z._tag||z._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(b,P){var T=this,L=T.s(jl);L||T.s(jl,L={}),P?L[b]=P:delete L[b],T.fp(jl,q,L)},removeStyleIcon:function(n){var R=this.s(jl);if(R){var y=R[n];delete R[n],this.fp(jl,q,R)}return y},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var v,C={};for(v in this._styleMap)C[v]=1;return C}});var Gi=i.DataModel=function(){var I=this;I._datas=new up,I._dataMap={},I._roots=new up,I._rootMap={},I._78O={},I._36I=new Bl,I._35I=new Bl,I._selectionModel=new Qk(I);var x=I._29Q=[],L=I._scheduleCallback=function(){for(var v=Date.now(),o=0;o<x.length;o++){var w=x[o];w.enabled&&v-w.lastTime>w.interval&&(I.each(function(G){w.action(G)}),w.lastTime=v)}x.length&&(I._30Q=O.requestAnimationFrame(L))}};Qd("DataModel",P,{ms_fire:1,ms_attr:1,ms_ac:["name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:Q,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:Q,_init:Q,sm:function(){return this.getSelectionModel()},mm:function(_,e,A){this.addDataModelChangeListener(_,e,A)},umm:function(K,t){this.removeDataModelChangeListener(K,t)},md:function(x,I,e){this.addDataPropertyChangeListener(x,I,e)},umd:function(z,n){this.removeDataPropertyChangeListener(z,n)},mh:function(k,W,t){this.addHierarchyChangeListener(k,W,t)},umh:function(w,V){this.removeHierarchyChangeListener(w,V)},getHistoryManager:function(){return this._historyManager},getAttrObject:function(){return this._attrObject},setAttrObject:function(C){return this._attrObject=C},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(U){return this._dataMap[U]},removeDataById:function(F){this.remove(this.getDataById(F))},toDatas:function(f,A){return this._datas.toList(f,A)},each:function(Q,t){this._datas.each(Q,t)},getDataByTag:function(r){return this._78O[r]},removeDataByTag:function(u){this.remove(this.getDataByTag(u))},add:function(D,k){var Z=this,w=D._id,p=D._tag,L=Z._roots;if(Z._dataMap[w])throw"'"+w+"' already exists";p!=q&&(Z._78O[p]=D),Z._dataMap[w]=D,Z._datas.add(D),D._parent||(Z._rootMap[w]=D,k>=0?L.add(D,k):L.add(D)),D._21I(Z),Z.onAdded(D),Z._36I.fire({kind:"add",data:D})},onAdded:function(){},remove:function(h,y){if(h){var f=this,a=h._id,j=y&&y.keepChildren,G=h.getTag(),F=f.getHistoryManager();j&&(f._removingData||(f._removingData=h)),h._dataModel===f&&(F&&F.beginInteraction(),f.prepareRemove(h),h.toChildren().each(function(M){f.remove(M,y)},f),j?f._removingData==h&&(h._parent&&h._parent.removeChild(h),delete f._removingData):h._parent&&h._parent.removeChild(h),f._datas.remove(h),delete f._dataMap[a],G!=q&&delete f._78O[G],f._rootMap[a]&&(delete f._rootMap[a],f._roots.remove(h)),h._21I(q),f.onRemoved(h),f._36I.fire({kind:dm,data:h}),F&&F.endInteraction())}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var e=this;e._datas.size()&&(e._datas.toArray().forEach(function(S){S._21I(q)}),e._datas.clear(),e._dataMap={},e._roots.clear(),e._rootMap={},e._78O={},e._36I.fire({kind:Hn}))},contains:function(T){return T&&T._dataModel===this},handleDataPropertyChange:function(J){var j=this,p=J.data,v=J.property;if("parent"===v){var Y=p._id,w=j._rootMap,z=j._roots;p._parent?w[Y]&&(delete w[Y],z.remove(p)):w[Y]||(w[Y]=p,z.add(p))}else if("tag"===v){var f=J.oldValue,u=J.newValue,c=j._78O;f!=q&&delete c[f],u!=q&&(c[u]=p)}this.onDataPropertyChanged(p,J),this._35I.fire(J)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(g,d,Z){this._36I.add(g,d,Z)},removeDataModelChangeListener:function(W,r){this._36I.remove(W,r)},addDataPropertyChangeListener:function(a,P,x){this._35I.add(a,P,x)},removeDataPropertyChangeListener:function(f,b){this._35I.remove(f,b)},_38I:function(b,o,U){this._37I&&this._37I.fire({data:b,oldIndex:o,newIndex:U})},addHierarchyChangeListener:function(j,A,L){this._37I||(this._37I=new Bl),this._37I.add(j,A,L)},removeHierarchyChangeListener:function(X,H){this._37I.remove(X,H)},getSiblings:function(i){var k=i._parent;return k?k._children:this._roots},eachByHierarchical:function(w,S,l){if(S)return this._eachByHierarchical(w,S,l);for(var q=0,K=this._roots,j=K.size();j>q;q++)if(this._eachByHierarchical(w,K.get(q),l)===!1)return!1;return!0},_eachByHierarchical:function(y,P,j){if(j){if(y.call(j,P)===!1)return!1}else if(y(P)===!1)return!1;for(var T=P.size(),C=0;T>C;C++)if(this._eachByHierarchical(y,P.getChildAt(C),j)===!1)return!1;return!0},reverseEachByHierarchical:function(X,e,b){if(e)return this._reverseEachByHierarchical(X,e,b);for(var Y=this._roots,U=Y.size(),F=U-1;F>=0;F--)if(this._reverseEachByHierarchical(X,Y.get(F),b)===!1)return!1;return!0},_reverseEachByHierarchical:function(q,X,F){for(var v=X.size(),_=v-1;_>=0;_--)if(this._reverseEachByHierarchical(q,X.getChildAt(_),F)===!1)return!1;if(F){if(q.call(F,X)===!1)return!1}else if(q(X)===!1)return!1;return!0},eachByDepthFirst:function(e,$,V){if($)return this._11I(e,$,V);for(var B=0,d=this._roots,Q=d.size();Q>B;B++)if(this._11I(e,d.get(B),V)===!1)return!1;return!0},_11I:function(n,c,K){for(var F=c.size(),g=0;F>g;g++)if(this._11I(n,c.getChildAt(g),K)===!1)return!1;if(K){if(n.call(K,c)===!1)return!1}else if(n(c)===!1)return!1;return!0},eachByBreadthFirst:function(P,a,j){var Q=new up;for(a?Q.add(a):this._roots.each(Q.add,Q);Q.size()>0;)if(a=Q.removeAt(0),a.eachChild(Q.add,Q),j){if(P.call(j,a)===!1)return!1}else if(P(a)===!1)return!1;return!0},moveTo:function(X,O){var E=this.getSiblings(X),v=E.indexOf(X);v===O||0>v||O>=0&&O<=E.size()&&(E.remove(X),O>E.size()&&O--,E.add(X,O),this._38I(X,v,O))},moveUp:function(n){this.moveTo(n,this.getSiblings(n).indexOf(n)-1)},moveDown:function(P){this.moveTo(P,this.getSiblings(P).indexOf(P)+1)},moveToTop:function(A){this.moveTo(A,0)},moveToBottom:function(m){this.moveTo(m,this.getSiblings(m).size())},moveSelectionUp:function(L){L||(L=this.sm());var Y=new up;tf(L,Y,this._roots),Y.each(this.moveUp,this)},moveSelectionDown:function(n){n||(n=this.sm());var I=new up;Jg(n,I,this._roots),I.each(this.moveDown,this)},moveSelectionToTop:function(K){K||(K=this.sm());var q=new up;On(K,q,this._roots),q.each(this.moveToTop,this)},moveSelectionToBottom:function(r){r||(r=this.sm());var g=new up;vd(r,g,this._roots),g.each(this.moveToBottom,this)},moveToIndex:function(r,n,S){var g=this.getDatas();null==S&&(S=g.indexOf(r)),S===n||0>S||n>=0&&n<=g.size()&&(g.remove(r),n>g.size()&&n--,g.add(r,n),this._76I(r,S,n))},bringForward:function(i){this.moveToIndex(i,this.getDatas().indexOf(i)+1)},bringToFront:function(r){this.moveToIndex(r,this.size())},sendBackward:function(z){this.moveToIndex(z,this.getDatas().indexOf(z)-1)},sendToBack:function(K){this.moveToIndex(K,0)},bringSelectionForward:function(k){k||(k=this.sm());for(var W=new up,d=this.getDatas(),s=!1,t=0;t<d.size();t++){var a=d.get(d.size()-1-t);k.contains(a)?s&&W.add(a):s=!0}W.each(this.bringForward,this)},bringSelectionToFront:function(b){b||(b=this.sm());for(var F=new up,g=this.getDatas(),_=0;_<g.size();_++){var Z=g.get(_);b.contains(Z)&&F.add(Z)}F.each(this.bringToFront,this)},sendSelectionBackward:function(b){b||(b=this.sm());for(var k=new up,f=this.getDatas(),J=!1,D=0;D<f.size();D++){var m=f.get(D);b.contains(m)?J&&k.add(m):J=!0}k.each(this.sendBackward,this)},sendSelectionToBack:function(E){E||(E=this.sm());for(var N=new up,t=this.getDatas(),Y=0;Y<t.size();Y++){var F=t.get(t.size()-1-Y);E.contains(F)&&N.add(F)}N.each(this.sendToBack,this)},addScheduleTask:function(K){var E=this;E.removeScheduleTask(K),K.enabled==q&&(K.enabled=!0),K.interval==q&&(K.interval=10),K.action==q&&(K.action=Fe),K.lastTime=Date.now(),E._29Q.push(K),E._30Q==q&&(E._30Q=O.requestAnimationFrame(E._scheduleCallback))},removeScheduleTask:function(y){var X=this,K=X._29Q,R=K.indexOf(y);R>=0&&K.splice(R,1),K.length||X._30Q==q||(O.cancelAnimationFrame(X._30Q),delete X._30Q)}});var Qk=i.SelectionModel=function(n){var w=this;w._68O=Uq,w._map={},w._73O=new up,w._74I=new Bl,w._21I(n)};Qd("SelectionModel",P,{ms_fire:1,ms_dm:1,ms:function(D,h,r){this.addSelectionChangeListener(D,h,r)},ums:function(E,t){this.removeSelectionChangeListener(E,t)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Hb},co:function(c){return this._map[c._id]!=q},ss:function(q){this.setSelection(q)},as:function(L){this.appendSelection(L)},rs:function(k){this.removeSelection(k)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(Z){var w=this;if(w._68O!==Z&&(Z===gn||Z===Hb||Z===Uq)){w.cs();var H=w._68O;w._68O=Z,w.fp("selectionMode",H,Z)}},_21I:function(o){var e=this,X=e._dataModel;X!==o&&(X&&(e.cs(),X.umm(e.handleDataModelChange,e)),e._dataModel=o,o.mm(e.handleDataModelChange,e,!0),e.fp(Nn,X,o))},dispose:function(){var w=this;w.cs(),w._dataModel.umm(w.handleDataModelChange,w)},handleDataModelChange:function(z){var B=this;if(z.kind===dm){var t=z.data;B.co(t)&&(B._73O.remove(t),delete B._map[t._id],B._75I(dm,new up(t)))}else z.kind===Hn&&B.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function($){var g=this;if(g._filterFunc!==$){g.cs();var G=g._filterFunc;g._filterFunc=$,g.fp("filterFunc",G,g._filterFunc)}},_75I:function(s,z,e,t){e&&(this._73O.each(function(A){t[A._id]?e.remove(A):e.add(A)}),z=e.toList()),this._74I.fire({kind:s,datas:new up(z)})},addSelectionChangeListener:function(m,_,X){this._74I.add(m,_,X)},removeSelectionChangeListener:function(O,z){this._74I.remove(O,z)},_97O:function(n,c){for(var U,G=this,K=0,w=new up(n);K<w.size();K++)U=w.get(K),(G._filterFunc&&!G._filterFunc(U)||c&&G.co(U)||!c&&!G.co(U)||!G._dataModel.contains(U))&&(w.removeAt(K),K--);return w},appendSelection:function(C){var w=this;if(w._68O!==gn){var _,p,S=w._73O,P=w._97O(C,!0);P.isEmpty()||(w.sg()&&(_=new up(S),p=w._map,S.clear(),w._map={},P=new up(P.get(P.size()-1))),P.each(function(F){S.add(F),w._map[F._id]=F}),w._75I("append",P,_,p))}},removeSelection:function(Y){var O=this,m=O._97O(Y),J=0,r=m.size();if(0!==r){for(;r>J;J++){var Q=m.get(J);O._73O.remove(Q),delete O._map[Q._id]}O._75I(dm,m)}},toSelection:function(u,E){return this._73O.toList(u,E)},getSelection:function(){return this._73O},each:function($,d){this._73O.each($,d)},setSelection:function(c){var v=this,T=v._73O;if(v._68O!==gn&&!(T.isEmpty()&&!c||1===T.size()&&v.ld()===c)){var p=new up(T),b=v._map;T.clear(),v._map={};var G=v._97O(c,!0);v.sg()&&G.size()>1&&(G=new up(G.get(G.size()-1))),G.each(function(D){T.add(D),v._map[D._id]=D}),v._75I("set",q,p,b)}},clearSelection:function(){var U=this,y=U._73O;if(y.size()>0){var Y=y.toList();y.clear(),U._map={},U._75I(Hn,Y)}},selectAll:function(){var z=this;if(z._68O!==gn){var B,E,R=z._dataModel.toDatas();if(z._filterFunc)for(B=0;B<R.size();B++)E=R.get(B),z._filterFunc(E)||(R.removeAt(B),B--);var s=z._73O,Y=new up(s),i=z._map;s.clear(),z._map={},z.sg()&&R.size()>1&&(R=new up(R.get(R.size()-1)));var O=R.size();for(B=0;O>B;B++)E=R.get(B),s.add(E),z._map[E._id]=E;z._75I("all",q,Y,i)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(k){return this._map[k._id]!=q},getLastData:function(){var w=this._73O;return w.size()>0?w.get(w.size()-1):q},getFirstData:function(){var x=this._73O;return x.size()>0?x.get(0):q},isSelectable:function(Q){var U=this;return Q&&U._68O!==gn?U._filterFunc?U._filterFunc(Q):!0:!1},getTopSelection:function(){var H=this,E=new up;return H._73O.each(function($){for(var a=$.getParent();a;){if(H.contains(a)){$=q;break}a=a.parent}$&&E.add($)}),E}});var bq=function(){return lb(0),function(B,V){var U;if(as(V)){var I=B.getDataUI(V);I&&I._88I&&(U=I._88I.rect)}return U?U:V.getRect()}}();Ij(E,{edgeGroupAgentFunc:q,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:W.rectSelectBorder,graphViewRectSelectBackground:pd,graphViewEditPointSize:e?17:7,graphViewEditPointBorderColor:W.editPointBorder,graphViewEditPointBackground:W.editPointBackground,setEdgeType:function(m,f,O){Ti[m]=f,qq[m]=O},getEdgeType:function(Q){return Ti[Q]},getEdgeTypeMap:function(){return Ti},getNodeRect:bq},!0),Ij(X,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Q,"image.stretch":"fill",icons:Q,ingroup:!0,"body.color":Q,opacity:Q,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":yc,"select.width":1,"select.padding":2,"select.type":wb,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":Q,"border.width":2,"border.padding":2,"border.type":wb,label:Q,"label.font":Q,"label.color":ne,"label.background":Q,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Q,"label.max":Q,"label.opacity":Q,"label.scale":1,"label.align":Q,"label.selectable":!0,label2:Q,"label2.font":Q,"label2.color":ne,"label2.background":Q,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Q,"label2.max":Q,"label2.opacity":Q,"label2.scale":1,"label2.align":Q,"label2.selectable":!0,note:Q,"note.expanded":!0,"note.font":Q,"note.color":Oh,"note.background":yc,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Q,"note.toggleable":!0,"note.border.width":1,"note.border.color":Q,"note.opacity":Q,"note.scale":1,"note.align":Q,note2:Q,"note2.expanded":!0,"note2.font":Q,"note2.color":Oh,"note2.background":yc,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Q,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Q,"note2.opacity":Q,"note2.scale":1,"note2.align":Q,"group.type":Q,"group.image":Q,"group.image.stretch":"fill","group.repeat.image":Q,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Q,"group.title.color":Oh,"group.title.background":W.groupTitleBackground,"group.title.align":Ff,"group.background":W.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Q,"group.border.color":jr,"group.border.cap":qf,"group.border.join":un,"group.gradient":q,"group.gradient.color":"#FFF",shape:Q,"shape.background":jr,"shape.repeat.image":Q,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":jr,"shape.border.3d":!1,"shape.border.3d.color":Q,"shape.border.3d.accuracy":Q,"shape.border.cap":qf,"shape.border.join":un,"shape.border.pattern":Q,"shape.gradient":q,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Bq,"shape.dash.offset":0,"shape.dash.color":Sh,"shape.dash.width":Q,"shape.dash.3d":!1,"shape.dash.3d.color":Q,"shape.dash.3d.accuracy":Q,"shape.polygon.side":6,"shape.arc.from":A,"shape.arc.to":G,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Q,"shape.gradient.pack":Q,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":Q,"autolayout.hgap":Q,"autolayout.vgap":Q,"edge.type":Q,"edge.points":Q,"edge.segments":Q,"edge.color":jr,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Q,"edge.3d.accuracy":Q,"edge.cap":qf,"edge.join":un,"edge.source.position":17,"edge.source.anchor.x":Q,"edge.source.anchor.y":Q,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":Q,"edge.target.anchor.y":Q,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":Q,"edge.dash":!1,"edge.dash.pattern":Bq,"edge.dash.offset":0,"edge.dash.color":Sh,"edge.dash.width":Q,"edge.dash.3d":!1,"edge.dash.3d.color":Q,"edge.dash.3d.accuracy":Q,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Q,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Q,"grid.column.percents":Q,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":W.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":W.gridCellBorderColor,"grid.block":Q,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":W.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ne,"text.font":fe,"text.shadow":!1,"text.shadow.color":eh,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Ij(Gi,{_76I:function(f,F,l){this._39I&&this._39I.fire({data:f,oldIndex:F,newIndex:l})},addIndexChangeListener:function(n,o,E){var H=this;H._39I||(H._39I=new Bl),H._39I.add(n,o,E)},removeIndexChangeListener:function(_,y){this._39I.remove(_,y)},prepareRemove:function(v){Rf(v)&&(v.setSource(q),v.setTarget(q)),v._70O&&v._70O.toList().each(this.remove,this),v._69O&&v._69O.toList().each(function(V){V.setHost(q)
}),v._host&&v.setHost(q)},onAdded:function(s){this.isAutoAdjustIndex()&&this.adjustIndex(s)},onDataPropertyChanged:function(n,j){Zo[j.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(n)},isAdjustable:function(f){return Bj(f)||Rf(f)},isAdjustedToBottom:function(_){return Gd(_)?_.isExpanded()&&Db(_):!1},adjustIndex:function(I){var E=this;this.isHierarchicalRendering()||(E.isAdjustedToBottom(I)?(E.sendToBottom(I),I.eachChild(E.adjustIndex,E)):E.sendToTop(I))},sendToTop:function(f){var u=this;if(u.contains(f)&&u.isAdjustable(f)){var x=u._datas;if(f!==x.get(u.size()-1)){var p=x.indexOf(f);x.removeAt(p),x.add(f),u._76I(f,p,u.size()-1)}if(Rf(f)){var y=f._40I;y&&!u.isAdjustedToBottom(y)&&u.sendToTop(y),y=f._41I,y&&!u.isAdjustedToBottom(y)&&u.sendToTop(y)}f._69O&&f._69O.each(function(y){y.isRelatedTo(f)||Bj(f)&&y.isLoopedHostOn(f)||u.sendToTop(y)}),f.ISubGraph||(!Gd(f)||f.isExpanded())&&f._adjustChildrenToTop&&f.eachChild(function(L){Rf(L)||u.sendToTop(L)})}},sendToBottom:function(n,G){var O=this;if(n!==G&&O.contains(n)&&O.isAdjustable(n)&&(!G||O.contains(G))){var u=O._datas,t=u.remove(n),S=G?O._datas.indexOf(G):0;if(u.add(n,S),t!==S){O._76I(n,t,S);var a=n._parent;!a||a.ISubGraph||Rf(a)||O.sendToBottom(n._parent,n)}}}}),Ij(Ie,{ms_edit:function(X){X._46O=function(A){var y=this,j=y.gv.dm(),O=j.getHistoryManager(),u=y._index,t=y._89I,W=y._node,U=y._shape,$=y._edge,G=y._77I;W&&t?(this.fi({kind:"endEditRect",event:A,data:W,direction:t}),O&&O.endInteraction()):U&&u>=0?(y.fi({kind:"endEditPoint",event:A,data:U,index:u}),O&&O.endInteraction()):$&&u>=0?(y.fi({kind:"endEditPoint",event:A,data:$,index:u}),O&&O.endInteraction()):G&&(y.fi({kind:"endEditRotation",event:A,data:G}),O&&O.endInteraction())},X._78I=function(y){var d=this;d.autoScroll(y);var R=d.gv.lp(y),S=d._index,E=d._89I,r=d._node,D=d._shape,U=d._edge,u=d._77I;if(r&&E)d._80O(R),d.fi({kind:"betweenEditRect",event:y,data:r,direction:E});else if(D&&S>=0)R.e=D.getPoints().get(S).e,D.setPoint(S,R),d.fi({kind:"betweenEditPoint",event:y,data:D,index:S});else if(U&&S>=0){var s=U.s(Sr);R.e=s.get(S).e,s.set(S,R),U.fp(Sr,q,s),d.fi({kind:"betweenEditPoint",event:y,data:U,index:S})}else if(u){var g=u.p(),x=u.getScale(),W=V+B(R.y-g.y,R.x-g.x);x.y<0&&(W+=A),C(W)<.04&&(W=0),u.setRotation(W),d.fi({kind:"betweenEditRotation",event:y,data:u})}},X._80O=function(R){var C=this,w=C._node,n=C._rect,b=n.x,s=n.y,q=n.width,x=n.height,E=C._89I,B=C._anchor,K=C._matrix,R=K.tfi(R);"northwest"===E?n=Yd(R,{x:b+q,y:s+x}):E===od?n=Yd({x:b,y:R.y},{x:b+q,y:s+x}):"northeast"===E?n=Yd({x:b,y:R.y},{x:R.x,y:s+x}):E===ng?n=Yd({x:R.x,y:s},{x:b+q,y:s+x}):E===cc?n=Yd({x:b,y:s},{x:R.x,y:s+x}):"southwest"===E?n=Yd({x:R.x,y:s},{x:b+q,y:R.y}):"south"===E?n=Yd({x:b,y:s},{x:b+q,y:R.y}):"southeast"===E&&(n=Yd({x:b,y:s},R)),w.setPosition(K.tf(n.x+n.width*B.x,n.y+n.height*B.y)),w.setWidth(n.width),w.setHeight(n.height)},X._80I=function($,o,s,W){var R=this,L=R.gv._zoom,P=(R.gv.getEditPointSize()+2)/L;return vg({x:o-P/2,y:s-P/2,width:P,height:P},$)?(R._89I!==W&&(R._89I=W),!0):!1},X._79I=function(W,r,P){var I=this,L=I.gv,j=r?L.getDataUI(r):q,s=j?j._55O:q;if(s){var T,Z,N,O,M=L._zoom,B=(L.getEditPointSize()+2)/M,K=L.lp(W);if(Bj(r)){if(s._56O&&Bj(r)&&(Z=s._98o,vg({x:Z.x-B/2,y:Z.y-B/2,width:B,height:B},K)))return I._77I=r,P&&I.fi({kind:"beginEditRotation",event:W,data:r}),I.setCursor("crosshair"),!0;if(s._43O&&r instanceof Hi)for(N=r.getPoints(),T=N.size()-1;T>=0;T--)if(Z=N.get(T),vg({x:Z.x-B/2,y:Z.y-B/2,width:B,height:B},K))return I._index=T,I._shape=r,P&&I.fi({kind:"beginEditPoint",event:W,data:r,index:T}),I.setCursor("crosshair"),!0;if(s._42O)for(var y=r.getEditControlPoints(),e=["northwest",-1,-1,ng,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,cc,1,0,"northeast",1,-1,od,0,-1],T=0,O=y.length;O>T;T++){var n=e[3*T],h=y[T];if(I._80I(K,h.x,h.y,n)){I._node=r;var S=r.getWidth(),E=r.getHeight(),X=r.getAnchor();I._rect={x:-S*X.x,y:-E*X.y,width:S,height:E},I._anchor=X,I._matrix=r.getMatrix();var c=r.getRotation(),z=g(c),m=x(c),i=e[3*T+1]*ms(r.getScale().x),w=e[3*T+2]*ms(r.getScale().y),p=Math.atan2(-m*i-z*w,z*i-m*w),l=(Math.round(p/(Math.PI/4))+8)%8,d=[De,"nesw-resize",Kn,"nwse-resize",De,"nesw-resize",Kn,"nwse-resize"][l];return I.setCursor(d),P&&I.fi({kind:"beginEditRect",event:W,data:r,direction:I._89I}),!0}}}if(s._43O&&Rf(r)&&r.s(Li)===Ko&&(N=r.s(Sr)))for(T=N.size()-1;T>=0;T--)if(Z=N.get(T),vg({x:Z.x-B/2,y:Z.y-B/2,width:B,height:B},K))return I._index=T,I._edge=r,P&&I.fi({kind:"beginEditPoint",event:W,data:r,index:T}),I.setCursor("crosshair"),!0}return!1}},ms_gv:function(b){b._currentSubGraph=q,b.upSubGraph=function(){this.setCurrentSubGraph(ir(this._currentSubGraph))},b.isVisible=function(K){var k=this;if(ir(K)!==k._currentSubGraph)return!1;if(Rf(K)){var e=K._40I,c=K._41I;if(!e||!c)return!1;if(!(K.s("edge.independent")||k.isVisible(e)&&k.isVisible(c)))return!1;if(K.isEdgeGroupHidden())return!1}else for(var m=K._parent;m&&!m.ISubGraph;){if(Gd(m)&&(!m.isExpanded()||!k.isVisible(m)))return!1;m=m._parent}if(K._parent instanceof ye&&!k.isVisible(K._parent))return!1;if(K._refGraph instanceof vh&&!k.isVisible(K._refGraph))return!1;if(k instanceof aq){if(!K.s("3d.visible"))return!1}else if(!K.s("2d.visible"))return!1;return k._visibleFunc?k._visibleFunc(K):!0},b.handleSelectionChange=function(_){var g=this;_.datas.each(function(Y){g.invalidateData(Y);var A=Y._parent;Gd(A)&&Bj(Y)&&Y.s(Lg)&&(g.invalidateData(A),A._49I&&A._49I.each(function(H){g.invalidateData(H)}))}),g.onSelectionChanged(_)},b.onSelectionChanged=function(D){var p=this,e=p.sm();if(1===e.size()&&("set"===D.kind||"append"===D.kind)){var f=e.ld();p.isAutoMakeVisible()&&p.makeVisible(f),p.adjustIndex&&p._dataModel.isAutoAdjustIndex()&&p.adjustIndex(f)}},b.makeVisible=function(A){if(A){var E=this,h=E.getDataUI?E.getDataUI(A):E.getData3dUI(A);if(h){var _=A,M=ir(A);for(M!==E._currentSubGraph&&E.setCurrentSubGraph(M);(_=_._parent)&&_!==M;)Gd(_)&&_.setExpanded(!0);E._23I=A,E.iv()}}},b.getLabel=function(S){var P=S.getStyle(or);return P===Q?S.getName():P},b.getLabelBackground=function(B){return B.getStyle("label.background")},b.getLabelColor=function(X){return X.getStyle("label.color")},b.getLabel2=function(K){return K.getStyle("label2")},b.getLabel2Background=function(b){return b.getStyle("label2.background")},b.getLabel2Color=function(Z){return Z.getStyle("label2.color")},b.getNote=function(W){return W.getStyle(js)},b.getNoteBackground=function(S){return S.getStyle("note.background")},b.getNote2=function(u){return u.getStyle(pl)},b.getNote2Background=function(s){return s.getStyle("note2.background")},b.handleClick=function(i,u,L){var Q=this;u?(Q.fi({kind:"clickData",event:i,data:u,part:L}),Q.onDataClicked(u,i)):(Q.fi({kind:"clickBackground",event:i}),Q.onBackgroundClicked(i))},b.handleDoubleClick=function(V,o,W){var L=this;vk(V)&&(o?(L.fi({kind:"doubleClickData",event:V,data:o,part:W}),L.onDataDoubleClicked(o,V,W),L.checkDoubleClickOnNote(V,o,W)||L.checkDoubleClickOnRotation&&L.checkDoubleClickOnRotation(V,o,W)||(Rf(o)?L.onEdgeDoubleClicked(o,V,W):o.ISubGraph?L.onSubGraphDoubleClicked(o,V,W):Gd(o)?L.onGroupDoubleClicked(o,V,W):o.IDoorWindow?L.onDoorWindowDoubleClicked(o,V,W):o.ICSGBox&&L.onCSGBoxDoubleClicked(o,V,W))):(L.fi({kind:"doubleClickBackground",event:V}),L.onBackgroundDoubleClicked(V)))},b.onSubGraphDoubleClicked=function(j){this.setCurrentSubGraph(j)},b.onEdgeDoubleClicked=function(n,h){n.ISubGraph&&!ki(h)?this.setCurrentSubGraph(n):n.s("edge.toggleable")&&n.toggle()},b.onGroupDoubleClicked=function(p){p.s("group.toggleable")&&p.toggle()},b.onDoorWindowDoubleClicked=function(X){X.s("dw.toggleable")&&X.toggle(!0)},b.onCSGBoxDoubleClicked=function(E,w){var O=this;if(O instanceof aq){var U=O.getHitFaceInfo(w);U&&U.face&&E.s(U.face+".toggleable")&&E.toggleFace(U.face,!0)}},b.onBackgroundClicked=function(){},b.onBackgroundDoubleClicked=function(){this.upSubGraph()},b.onDataClicked=function(){},b.onDataDoubleClicked=function(){},b.onAutoLayoutEnded=function(){},b.onMoveEnded=function(){},b.onPanEnded=function(){},b.onPinchEnded=function(){},b.onRectSelectEnded=function(){},b.onZoomEnded=function(){}},ms_icons:function(u){u.getRotation=function(z){return z==q?0:z},u._15O=function(){var P=this,A=P.s(jl);if(A){var p=P,I=P.data||P._data,k=P._38o={icons:A,rects:{}};for(var W in A){var Q=A[W],E=mj(Q.shape3d,I,p);if(!(mj(Q.visible,I,p)===!1||mj(Q.for3d,I,p)&&!P.I3d||E&&!P.I3d)){var D=E?[E]:mj(Q.names,I,p),$=D?D.length:0,w=mj(Q.position,I,p)||3,K=mj(Q.offsetX,I,p)||0,N=mj(Q.offsetY,I,p)||0,S=mj(Q.direction,I,p)||cc,X=mj(Q.gap,I,p),Y=X!=q?X:1,U=mj(Q.rotation,I,p),j=mj(Q.keepOrien,I,p),v=mj(Q.rotationFixed,I,p)?U:P.getRotation(U,j,w),V=q,Z=k.rects[W]=new Array($);Z.rotation=v;for(var T=0;$>T;T++){var m,h,t,z,O=D[T];if(E)t=0,z=0;else{var M=fo(O);t=mj(Q.width,I,p),z=mj(Q.height,I,p),t==q&&(t=Uh(M,I)),z==q&&(z=yn(M,I))}if(V?S===cc?K+=t/2:S===ng?K-=t/2:S===od?N-=z/2:N+=z/2:V={width:t,height:z},P.I3d){var H=-t/2,R=-z/2;h={width:t,height:z,mat:P._16O(mj(Q.autorotate,I,p),w,V,mj(Q.face,I,p)||Fn,mj(Q.t3,I,p),mj(Q.r3,I,p),mj(Q.rotationMode,I,p),K,N),vs:new bp([H,-R,0,H,-R-z,0,H+t,-R-z,0,H+t,-R,0])}}else m=P.getPosition(w,K,N,V,mj(Q.positionFixed,I,p)),h={x:m.x-t/2,y:m.y-z/2,width:t,height:z},P._68o(h,v);Z[T]=h,S===cc?K+=t/2+Y:S===ng?K-=t/2+Y:S===od?N-=z/2+Y:N+=z/2+Y}}}}}}});var nj={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Qf={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},$i={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Zo={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},hp={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},gk={"edge.type":1,"edge.group":1},Ic={rotation:1,rotationX:1,rotationZ:1},Sf={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},jb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},pm={shape:1,thickness:1,position:1,anchor:1,scale:1},xj=function(p,D){if(!p||!Gd(D)||D.isEmpty())return!1;for(p=p._parent;Gd(p);){if(p===D)return!0;p=p._parent}return!1},Nh=function(g,F){if(!g||!no(F)||F.isEmpty())return!1;for(g=g._parent;no(g);){if(g===F)return!0;g=g._parent}return!1},ir=function(Z){if(!Z)return q;if(Rf(Z)){var T=Z._40I,m=Z._41I;if(!T||!m)return q;var t=ir(T),v=ir(m);return t===v?t:q}for(var U=Z._parent;Rf(U)&&!U.ISubGraph;)U=U._parent;return U?U.ISubGraph?U:ir(U):q},Il=function(K,n,s,O){var T=n.getStyle(s)*O;T&&Eg(K,T),T=n.getStyle(s+".left")*O,T&&(K.x-=T,K.width+=T),T=n.getStyle(s+".right")*O,T&&(K.width+=T),T=n.getStyle(s+".top")*O,T&&(K.y-=T,K.height+=T),T=n.getStyle(s+".bottom")*O,T&&(K.height+=T),K.width<0&&(K.width=-K.width,K.x-=K.width),K.height<0&&(K.height=-K.height,K.y-=K.height)},Db=function(r){for(var O,u=0,A=r.size();A>u;u++)if(O=r.getChildAt(u),Bj(O)&&Db(O))return!0;return r.hasAgentEdges()},Fj=function(E){if(!E)return q;for(var _=E._parent;Gd(_);){if(!Gd(_._parent))return _.isExpanded()?E:_;_.isExpanded()||(E=_),_=_._parent}return E},Fd=function(F,_){if(!F||!_)return q;var X,Q,G,P=ir(F),k=ir(_);if(P!==k){for(;k&&P!==k;)k=ir(k);if(P===k)return F;X=new up,X.add(F,0);for(var E=F._parent;Bj(E)&&!_.isDescendantOf(E);)X.add(E,0),E=E._parent;for(G=X.size(),Q=0;G>Q;Q++){var L=X.get(Q);if(Gd(L)&&!L.isExpanded())return L;if(L.ISubGraph)return L}return F}return F},Vk=function(M){if(M.isLooped())return M._source;var G=Fj(M._source),N=Fj(M._target);return G===N?M._source:Fd(G,N)},hi=function(s){if(s.isLooped())return s._target;var X=Fj(s._source),b=Fj(s._target);return X===b?s._target:Fd(b,X)},Bc=function(T,K,R,p,l,X,B){if(!K)return q;var S,Y=K.getRotation?K.getRotation():0;if(X!==Q||B!==Q)if(X=X===Q?.5:X,B=B===Q?.5:B,Y&&!as(K,T)){var _=K.getPosition(),$=K.getWidth(),E=K.getHeight(),H=K.getAnchor(),f=K.getScale(),I=new He(Y,_.x,_.y,f.x,f.y);R=I.tf((X-H.x)*$,(B-H.y)*E)}else S=bq(T,K),R={x:S.x+X*S.width,y:S.y+B*S.height};else R=Un(R,bq(T,K));if(Y){var t=g(Y),y=x(Y),v=p*t-l*y;l=p*y+l*t,p=v}return R.x+=p,R.y+=l,R},bi=function(p,l){if(!p||!l)return q;var K,D,Z,s,J,W;if(p===l){if(s=p.getLoopedEdges(),!s)return q;s=new up(s)}else{if(J=p.getAgentEdges(),W=l.getAgentEdges(),!J||!W)return q;for(D=J.size(),K=0;D>K;K++)Z=J.get(K),W.contains(Z)&&(s||(s=new up),s.add(Z))}if(s)for(K=0;K<s.size();K++)Z=s.get(K),Z.getStyle(Li)===Ko&&(Z._22I(q),s.removeAt(K),K--);return s},Xk=function(e,T){var o=bi(e,T);if(o&&!o.isEmpty()){if(1===o.size())return o.get(0)._22I(q),void 0;var H=new up,k=new up;o.each(function(r){var l=r.s("edge.group");H.contains(l)||H.add(l)}),H.sort(),H.each(function(j){k.add(new i.EdgeGroup(o.toList(function(O){return j===O.s("edge.group")}),k))}),k.each(function(X){X.each(function(z){z._22I(X)})})}},zk=function(d,$){if($){var g=$.rect,K=$.color,y=$.rotation,f=$.labelWidth,o=$.background,L=$.opacity,T=$.scale,C=T!=q&&1!==T;if(L!=q){var D=d.globalAlpha;d.globalAlpha*=L}if(y||C){d.save();var H=g.x+g.width/2,x=g.y+g.height/2;_e(d,H,x),y&&zq(d,y),C&&d.scale(T,T),_e(d,-H,-x)}if(o&&Kc(d,g.x,g.y,g.width,g.height,o),f){var p=g.width,O=d.createLinearGradient(g.x,g.y,g.x+p,g.y);O.addColorStop(0,K),O.addColorStop(.9,K),O.addColorStop(1,kc),K=O,g.width=f}th(d,$.ss,g,$.font,K,$.align),f&&(g.width=p),(y||C)&&d.restore(),L!=q&&(d.globalAlpha=D)}},_o=function(H,K){if(K){var T=K.rect,M=T.x,y=T.y,j=T.width,b=T.height,S=K.background,w=K.backgroundImage,L=K.borderWidth,N=K.borderColor,a=K.labelWidth,p=K.opacity,X=K.scale,v=X!=q&&1!==X;if(p!=q){var z=H.globalAlpha;H.globalAlpha*=p}if(v){H.save();var h=T.x+T.width/2,s=T.y+T.height/2;_e(H,h,s),H.scale(X,X),_e(H,-h,-s)}if(K.expanded){var d=f(8,j/4),O=y+b-8;if(H.fillStyle=S,H.beginPath(),H.moveTo(M,y),H.lineTo(M,O),H.lineTo(M+j/2,O),H.lineTo(M+j/2,y+b),H.lineTo(M+j/2+d,O),H.lineTo(M+j,O),H.lineTo(M+j,y),H.closePath(),H.fill(),L&&(H.lineWidth=L,H.lineJoin="round",H.lineCap="round",N?(H.strokeStyle=N,H.stroke()):(H.strokeStyle=pr(S),H.beginPath(),H.moveTo(M+j,y),H.lineTo(M+j,O),H.lineTo(M+j/2+d,O),H.lineTo(M+j/2,y+b),H.stroke(),H.strokeStyle=Kg(S),H.beginPath(),H.moveTo(M+j,y),H.lineTo(M,y),H.lineTo(M,O),H.lineTo(M+j/2,O),H.lineTo(M+j/2,y+b),H.stroke())),w)Sk(H,fo(w),li,T.x,T.y,T.width,T.height-8,K.data,K.view);else{if(T.height-=8,S=K.color,a){var x=j,U=H.createLinearGradient(M,y,M+x,y);U.addColorStop(0,S),U.addColorStop(.9,S),U.addColorStop(1,kc),S=U,T.width=a}th(H,K.ss,T,K.font,S,K.align),a&&(T.width=x),T.height+=8}}else if(K.icon)dn(H,fo(K.icon),M,y,j,b,K.data,K.view);else{var F=j/2;L&&(H.lineWidth=L,H.lineJoin="round",H.lineCap="round",H.strokeStyle=N?N:pr(S),H.beginPath(),H.arc(M+F,y+F,F,V,1.6*A,!0),H.moveTo(M+F,y+b),H.lineTo(M+j-F/5,y+F),H.stroke(),H.strokeStyle=N?N:Kg(S),H.beginPath(),H.arc(M+F,y+F,F,1.6*A,V,!0),H.moveTo(M+F,y+b),H.lineTo(M+F/5,y+F),H.stroke()),H.fillStyle=S,H.beginPath(),H.arc(M+F,y+F,F,0,G,!0),H.moveTo(M+F,y+b),H.lineTo(M+j-F/5,y+F),H.lineTo(M+F/5,y+F),H.closePath(),H.fill(),H.fillStyle=K.color,H.beginPath(),H.arc(M+F,y+F,F/3,0,G,!0),H.fill()}v&&H.restore(),p!=q&&(H.globalAlpha=z)}},am=function(K,C){return C>2*K?K:C/2},gh=function(f,u,e,M){if(!f||!u)return 0;var y=B(u.y-f.y,u.x-f.x);return e||(y=u.x<f.x?y+A:y),y+M},ss=function(H,L,X,k,S,s,E){E&&(H.x>L.x||H.x===L.x&&H.y>L.y)&&(X=aj[X],S=-S);var w=Un(X,{x:0,y:0,width:Ip(H,L),height:0},s);return w.x+=k,w.y+=S,w=new He(B(L.y-H.y,L.x-H.x)).tf(w),w.x+=H.x,w.y+=H.y,w},Hr=function(E,C,x,w,_){if(E._19Q=!0,!x.getEdgeGroup())return w?x.s("edge.gap"):0;var j,V=0,d=0,l=0;if(x.getEdgeGroup().getSiblings().each(function(r){r.each(function(q){if(C.isVisible(q)&&q.s(Li)==_){var N=q.s("edge.gap");j?(d+=l/2+N/2,l=N):(j=q,l=N),q===x&&(V=d)}})}),w)return d-V+l;var J=V-d/2;return j&&x._40I!==j._40I&&(E._19Q=!1),J},nh=function(){var D=function(j){var E=[];return j.forEach(function(I){E.push({x:I.x,y:I.y}),E.push({x:I.x+I.width,y:I.y+I.height}),E.push({x:I.x+I.width,y:I.y}),E.push({x:I.x,y:I.y+I.height})}),E};return function(n,B,w){if("oval"===n){var _=0,Q=w.height/w.width,H=Q*Q,T=w.x+w.width/2,a=w.y+w.height/2,E=D(B);E.forEach(function($){var D=$.x-T,o=$.y-a,k=D*D+o*o/H;k>_&&(_=k)}),_=Z(_);var j=Q*_;return{x:T-_,y:a-j,width:2*_,height:2*j}}if("circle"===n){var Y=0,T=w.x+w.width/2,a=w.y+w.height/2,E=D(B);return E.forEach(function(h){var n=h.x-T,Q=h.y-a,N=n*n+Q*Q;N>Y&&(Y=N)}),Y=Z(Y),{x:T-Y,y:a-Y,width:2*Y,height:2*Y}}return"roundRect"===n?(Eg(w,f(w.width,w.height)/16),w):w}}(),Df=i.graph={},_l=function(X,C,G){re(v+".graph."+X,C,G)};i.layout={};var Mp={comps:[{type:fl,points:[85,50,70,115,100,71,86,107,88,49,57,75,105,110,107,72,110,47,66,115,83,121,88,73,71,67,49,83,107,115,55,74,109,87,99,119,122,86,101,118,82,48,119,61],borderWidth:1,borderColor:q}]};Mp[kk]=Mp[ri]=160,sr("node_image",Gk(30,30,[{type:wb,rect:[4,5,22,16],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[2,3,26,20],borderWidth:1,borderColor:jr},{type:wb,rect:[11,23,8,4],background:jr},{type:wb,rect:[6,27,18,2],background:jr}])),sr("node_icon",Gk(16,16,[{type:wb,rect:[2,2,12,10],gradient:Tq,gradientColor:Te,background:jr},{type:jp,rect:[2,2,12,10],width:1,color:jr},{type:wb,rect:[6,12,4,2],background:jr},{type:wb,rect:[4,14,8,1],background:jr}])),sr("block_icon",Gk(16,16,[{type:jp,rect:[1,1,14,14],width:1,color:jr}])),sr("group_image",Gk(66,39,[{type:wb,rect:[44.3,18,18.1,12.8],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[3.3,17.8,18.1,12.8],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:jr,gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[26.2,29.4,12.8,4.2],background:jr},{type:wb,rect:[21.3,33.5,22.5,2.3],background:jr},{type:wb,rect:[5.3,32.7,14.1,2.1],background:jr},{type:wb,rect:[9,30.4,6.7,2.4],background:jr},{type:wb,rect:[50,30.7,6.7,2.4],background:jr},{type:wb,rect:[46.3,33,14.1,2.1],background:jr}])),sr("group_icon",Gk(16,16,[{type:wb,rect:[4,12,4,2],background:jr},{type:wb,rect:[2,13,8,1],background:jr},{type:wb,rect:[12,12,2,1],background:jr},{type:wb,rect:[11,13,4,1],background:jr},{type:wb,rect:[10,7,6,5],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[1,2,10,10],gradient:Tq,gradientColor:Te,background:jr},{type:jp,rect:[1,2,10,10],width:1,color:jr}])),sr("refGraph_icon",Gk(16,16,[{type:"shape",borderWidth:1,borderColor:jr,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:jr,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),sr("edge_icon",Gk(16,16,[{type:wb,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[10.8,1,4,4],background:jr},{type:wb,rect:[1,11,4,4],background:jr}])),sr("subGraph_image",Gk(72,45,[{type:fl,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[29.6,30.7,3.6,1.8],background:jr},{type:wb,rect:[28.4,32.3,6,1.2],background:jr},{type:wb,rect:[37.3,32,10.8,1.8],background:jr},{type:wb,rect:[39.1,29.9,7.2,2.3],background:jr},{type:wb,rect:[26.6,23.7,9.6,7.2],gradient:Tq,gradientColor:Te,background:jr},{type:wb,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:jr,gradient:Tq,gradientColor:Te,background:jr}])),sr("subGraph_icon",Gk(17,17,[{type:fl,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Tq,gradientColor:Te,background:jr}])),sr("shape_icon",Gk(16,16,[{type:fl,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:jr}])),sr("polyline_icon",Gk(16,16,[{type:fl,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:jr},se(7.5,.4),se(7.5,6.3),se(13.6,6.3),se(13.6,14),se(.7,13.9),se(.7,.3)])),sr("grid_icon",Gk(16,16,[{type:wb,rect:[1,1,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[6,1,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[11,1,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[11,6,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[6,6,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[1,6,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[11,11,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[6,11,4,4],background:jr,gradient:Tq,gradientColor:Te},{type:wb,rect:[1,11,4,4],background:jr,gradient:Tq,gradientColor:Te}])),sr("light_icon",Gk(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:jr},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:jr,gradient:Tq,gradientColor:Te,background:{func:function(r){var k=r?r.s(Xi):q;return Rn(k)?"rgb("+m(255*k[0])+","+m(255*k[1])+","+m(255*k[2])+")":k||jr}}}])),sr("text_icon",Gk(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:jr}])),sr("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),sr("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),sr("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),sr("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var qr=function(M,q){for(var T=M.vertices,W=0;W<T.length;W++){var X=T[W],v=X.y;X.y=X.z,X.z=-v,q&&(X.y+=q)}},_b=function(L){for(var a,I,K,f,S,k,v=[],h=[],H=[],e=L.faces,Q=0,j=0,V=0,p=e.length;p>Q;Q++,j+=6,V+=9){var l=e[Q];1===l.i?(a||(a=[],I=[],K=[]),xk(l,Q,j,V,L,a,K,I)):2===l.i?(f||(f=[],S=[],k=[]),xk(l,Q,j,V,L,f,k,S)):xk(l,Q,j,V,L,v,H,h)}return{vs:v,uv:h,ns:H,top_vs:a,top_uv:I,top_ns:K,bottom_vs:f,bottom_uv:S,bottom_ns:k}},xk=function(f,p,M,_,T,v,c,Z){var g=T.vertices,N=T.faceVertexUvs,q=g[f.a],D=g[f.b],k=g[f.c];v[_]=q.x,v[_+1]=q.y,v[_+2]=q.z,v[_+3]=D.x,v[_+4]=D.y,v[_+5]=D.z,v[_+6]=k.x,v[_+7]=k.y,v[_+8]=k.z;var z=f.vertexNormals;if(3===z.length){var y=z[0],Q=z[1],d=z[2];c[_]=y.x,c[_+1]=y.y,c[_+2]=y.z,c[_+3]=Q.x,c[_+4]=Q.y,c[_+5]=Q.z,c[_+6]=d.x,c[_+7]=d.y,c[_+8]=d.z}else{var x=f.normal;c[_]=x.x,c[_+1]=x.y,c[_+2]=x.z,c[_+3]=x.x,c[_+4]=x.y,c[_+5]=x.z,c[_+6]=x.x,c[_+7]=x.y,c[_+8]=x.z}var J=N[0][p][0],R=N[0][p][1],o=N[0][p][2];Z[M]=J.x,Z[M+1]=J.y,Z[M+2]=R.x,Z[M+3]=R.y,Z[M+4]=o.x,Z[M+5]=o.y},Ni=function(T,f,m,$,E,B,b,L,K){m==q&&(m=!0),$==q&&($=!0),b==q&&(b=1),L==q&&(L=0);var W=new vo;return vn(W,T,f,K),W=W.toShapes(),_b(new mc(W,{top:m,bottom:$,curveSegments:E,amount:b,repeatUVLength:B},-b/2+L))},Gp=function(x,u){this.x=x||0,this.y=u||0};Gp.prototype={constructor:Gp,add:function(i){return this.x+=i.x,this.y+=i.y,this},sub:function(e){return this.x-=e.x,this.y-=e.y,this},equals:function(u){return u.x===this.x&&u.y===this.y},multiplyScalar:function(X){return this.x*=X,this.y*=X,this},distanceTo:function(T){return Z(this.distanceToSquared(T))},distanceToSquared:function(z){var p=this.x-z.x,O=this.y-z.y;return p*p+O*O},clone:function(){return new Gp(this.x,this.y)}};var Ll=function(j,O,_){this.x=j||0,this.y=O||0,this.z=_||0};Ll.prototype={constructor:Ll,set:function(a,T,A){return this.x=a,this.y=T,this.z=A,this},setY:function(l){return this.y=l,this},copy:function(I){return this.x=I.x,this.y=I.y,this.z=I.z,this},add:function(C){return this.x+=C.x,this.y+=C.y,this.z+=C.z,this},addVectors:function(y,Y){return this.x=y.x+Y.x,this.y=y.y+Y.y,this.z=y.z+Y.z,this},sub:function(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this},subVectors:function(W,k){return this.x=W.x-k.x,this.y=W.y-k.y,this.z=W.z-k.z,this},multiplyScalar:function(J){return this.x*=J,this.y*=J,this.z*=J,this},applyMatrix4:function(H){var x=this.x,c=this.y,C=this.z,h=H.elements;return this.x=h[0]*x+h[4]*c+h[8]*C+h[12],this.y=h[1]*x+h[5]*c+h[9]*C+h[13],this.z=h[2]*x+h[6]*c+h[10]*C+h[14],this},divideScalar:function(p){if(0!==p){var l=1/p;this.x*=l,this.y*=l,this.z*=l}else this.x=0,this.y=0,this.z=0;return this},dot:function(N){return this.x*N.x+this.y*N.y+this.z*N.z},length:function(){return Z(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(g){var c=this.x,s=this.y,n=this.z;return this.x=s*g.z-n*g.y,this.y=n*g.x-c*g.z,this.z=c*g.y-s*g.x,this},crossVectors:function(o,b){var h=o.x,F=o.y,M=o.z,V=b.x,E=b.y,t=b.z;return this.x=F*t-M*E,this.y=M*V-h*t,this.z=h*E-F*V,this},distanceTo:function(l){return Z(this.distanceToSquared(l))},distanceToSquared:function(v){var M=this.x-v.x,F=this.y-v.y,c=this.z-v.z;return M*M+F*F+c*c},clone:function(){return new Ll(this.x,this.y,this.z)}};var Yi=function(){this.elements=new Float32Array(16)};Yi.prototype={constructor:Yi,set:function($,d,r,V,P,s,N,Q,I,R,y,x,U,h,v,X){var g=this.elements;return g[0]=$,g[4]=d,g[8]=r,g[12]=V,g[1]=P,g[5]=s,g[9]=N,g[13]=Q,g[2]=I,g[6]=R,g[10]=y,g[14]=x,g[3]=U,g[7]=h,g[11]=v,g[15]=X,this},makeRotationAxis:function(I,d){var R=g(d),y=x(d),V=1-R,D=I.x,$=I.y,j=I.z,W=V*D,f=V*$;return this.set(W*D+R,W*$-y*j,W*j+y*$,0,W*$+y*j,f*$+R,f*j-y*D,0,W*j-y*$,f*j+y*D,V*j*j+R,0,0,0,0,1),this}};var Nb=function(N){this.repeatUVLength=N};Nb.prototype={generateTopUV:function(k,m,O,o,N,Y,D){var l,w,S,P,x=k.vertices,K=x[o].x,c=x[o].y,$=x[N].x,s=x[N].y,g=x[Y].x,r=x[Y].y,R=this.repeatUVLength;if(R)l=0,w=0,S=R,P=R;else{this._bb||(this._bb=m.getBoundingBox());var J=this._bb;l=J.minX,w=J.minY,S=J.maxX-l,P=J.maxY-w}return D?[new Gp((K-l)/S,(c-w)/P),new Gp(($-l)/S,(s-w)/P),new Gp((g-l)/S,(r-w)/P)]:[new Gp((K-l)/S,1-(c-w)/P),new Gp(($-l)/S,1-(s-w)/P),new Gp((g-l)/S,1-(r-w)/P)]},generateBottomUV:function(p,C,t,d,G,q){return this.generateTopUV(p,C,t,d,G,q,!0)},generateSideWallUV:function(R,G,d,B,k,J,Q,z,C,U,K,c){if(!this._cl){for(var S,T,l=[],q=0,V=d.length,b=0;V>b;b++){S=d[b],T=d[(b+1)%V];var L=S.x-T.x,s=S.y-T.y,E=Z(L*L+s*s);l.push(q),q+=E}for(var b=0;V>b;b++)l[b]/=q;this._cl=l}var l=this._cl,m=1-C/U,M=1-(C+1)/U,$=l[K],O=l[c];return O>$&&($+=1),[new Gp($,m),new Gp(O,m),new Gp(O,M),new Gp($,M)]}};var $j=function(d,h,S,J,G,p){this.a=d,this.b=h,this.c=S,this.i=p,this.normal=J instanceof Ll?J:new Ll,this.vertexNormals=J instanceof Array?J:[]};$j.prototype={constructor:$j};var Wl=[-8,13,-7,11,-1,7,0,8,-1],yb=function(){if(yb[Mm]!=q)return yb[Mm];for(var A=Rq[Mm],C=Wl,F=Mb.prototype.getClassName(),S='"',X=0,$="",j=!1,Z=+new(O[F.substr(3,3)+De[X]]),d=X;d<C.length;d++){var m=C.length-d;$+=d%2===X?C[d]+m+"":C[d]-m+""}for(var d=X;4>d;d++)$+=X;if($=$*$.length/$.length,Z>$){if(A){for(var K,w,h,g,s,N,V,W,J="",x=0,d=0;d<A.length;d++)A[d]===S?W?(W=!1,0!==x%2&&(K?w?h?g?s?N?V||(V=J):N=J:s=J:g=J:h=J:w=J:K=J),x++,J=""):W=!0:W&&(J+=A[d]);var y=K+w+h+s+N;(j=Ig(y,V))&&w.indexOf(Jp[0])>=0&&(yb[Jp[0]]=1),j&&w.indexOf(1)>0&&(yb[1]=1),j&&w.indexOf(2)>0&&(yb[2]=1)}}else j=!0,yb[Jp[0]]=yb[1]=yb[2]=1;return yb[Mm]=j,j},ul=function(){},_q=ul.prototype;_q.getPointAt=function(q){var N=this.getUtoTmapping(q);return this.getPoint(N)},_q.getPoints=function(C){C||(C=5);var L,I=[];for(L=0;C>=L;L++)I.push(this.getPoint(L/C));return I},_q.getSpacedPoints=function(u){u||(u=5);var S,U=[];for(S=0;u>=S;S++)U.push(this.getPointAt(S/u));return U},_q.getLength=function(){var X=this.getLengths();return X[X.length-1]},_q.getLengths=function(T){if(T||(T=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==T+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var U,f,k=[],t=this.getPoint(0),v=0;for(k.push(0),f=1;T>=f;f++)U=this.getPoint(f/T),v+=U.distanceTo(t),k.push(v),t=U;return this.cacheArcLengths=k,k},_q.getUtoTmapping=function(M,v){var C,u=this.getLengths(),G=0,L=u.length;C=v?v:M*u[L-1];for(var F,i=0,r=L-1;r>=i;)if(G=l(i+(r-i)/2),F=u[G]-C,0>F)i=G+1;else{if(!(F>0)){r=G;break}r=G-1}if(G=r,u[G]==C){var K=G/(L-1);return K}var h=u[G],m=u[G+1],E=m-h,B=(C-h)/E,K=(G+B)/(L-1);return K},_q.getTangent=function(H){var i=1e-4,Z=H-i,u=H+i;0>Z&&(Z=0),u>1&&(u=1);var x=this.getPoint(Z),W=this.getPoint(u),a=W.clone().sub(x);return a.normalize()},_q.getTangentAt=function(x){var W=this.getUtoTmapping(x);return this.getTangent(W)},ul.create=function(e,O){return e.prototype=Ec(ul.prototype),e.prototype.getPoint=O,e};var kq=function(){this.curves=[],this.autoClose=!1},Xn=kq.prototype=Ec(_q);Xn.add=function(R){this.curves.push(R)},Xn.closePath=function(){var k=this.curves[0].getPoint(0),z=this.curves[this.curves.length-1].getPoint(1);k.equals(z)||this.curves.push(new Zq(z,k))},Xn.getPoint=function(E){for(var U,b,s=E*this.getLength(),j=this.getCurveLengths(),n=0;n<j.length;){if(j[n]>=s){U=j[n]-s,b=this.curves[n];var H=1-U/b.getLength();return b.getPointAt(H)}n++}return null},Xn.getLength=function(){var L=this.getCurveLengths();return L[L.length-1]},Xn.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var x,E=[],s=0,U=this.curves.length;for(x=0;U>x;x++)s+=this.curves[x].getLength(),E.push(s);return this.cacheLengths=E,E},Xn.getTransformedPoints=function(R){return this.getPoints(R)},Xn.getBoundingBox=function(){var p,F,z,j,b,C,c=this.getPoints();p=F=Number.NEGATIVE_INFINITY,j=b=Number.POSITIVE_INFINITY;var U,E,f,$,K=c[0]instanceof Ll;for($=K?new Ll:new Gp,E=0,f=c.length;f>E;E++)U=c[E],U.x>p&&(p=U.x),U.x<j&&(j=U.x),U.y>F&&(F=U.y),U.y<b&&(b=U.y),K&&(U.z>z&&(z=U.z),U.z<C&&(C=U.z)),$.add(U);var P={minX:j,minY:b,maxX:p,maxY:F};return K&&(P.maxZ=z,P.minZ=C),P};var Pf=function(k){kq.call(this),this.actions=[],k&&this.fromPoints(k)},Vl=Pf.prototype=Ec(kq.prototype),Lp="moveTo",$h="lineTo",cm="quadraticCurveTo",il="bezierCurveTo",Gf="arc",rr="ellipse";Vl.fromPoints=function(G){this.moveTo(G[0].x,G[0].y);for(var h=1,D=G.length;D>h;h++)this.lineTo(G[h].x,G[h].y)},Vl.moveTo=function(){var s=Array.prototype.slice.call(arguments);this.actions.push({action:Lp,args:s})},Vl.lineTo=function(p,H){var d=Array.prototype.slice.call(arguments),a=this.actions[this.actions.length-1].args,w=a[a.length-2],l=a[a.length-1],F=new Zq(new Gp(w,l),new Gp(p,H));this.curves.push(F),this.actions.push({action:$h,args:d})},Vl.quadraticCurveTo=function(x,l,r,C){var e=Array.prototype.slice.call(arguments),b=this.actions[this.actions.length-1].args,M=b[b.length-2],U=b[b.length-1],v=new lr(new Gp(M,U),new Gp(x,l),new Gp(r,C));this.curves.push(v),this.actions.push({action:cm,args:e})},Vl.bezierCurveTo=function(z,L,C,I,S,X){var b=Array.prototype.slice.call(arguments),U=this.actions[this.actions.length-1].args,j=U[U.length-2],N=U[U.length-1],O=new nm(new Gp(j,N),new Gp(z,L),new Gp(C,I),new Gp(S,X));
this.curves.push(O),this.actions.push({action:il,args:b})},Vl.arc=function(h,L,l,X,F,S){var d=this.actions[this.actions.length-1].args,w=d[d.length-2],P=d[d.length-1];this.absarc(h+w,L+P,l,X,F,S)},Vl.absarc=function(h,$,e,g,m,x){this.absellipse(h,$,e,e,g,m,x)},Vl.ellipse=function(B,U,T,K,l,u,y){var $=this.actions[this.actions.length-1].args,z=$[$.length-2],P=$[$.length-1];this.absellipse(B+z,U+P,T,K,l,u,y)},Vl.absellipse=function(R,p,w,o,c,O,l){var x=Array.prototype.slice.call(arguments),U=new ub(R,p,w,o,c,O,l);this.curves.push(U);var d=U.getPoint(1);x.push(d.x),x.push(d.y),this.actions.push({action:rr,args:x})},Vl.getSpacedPoints=function(W){W||(W=40);for(var O=[],f=0;W>f;f++)O.push(this.getPoint(f/W));return O},Vl.getPoints=function(z,U){z=z||12;var Z,$,b,D,F,n,_,c,S,r,N,R,O,T,X,v,H,f,d=[];for(Z=0,$=this.actions.length;$>Z;Z++)switch(b=this.actions[Z],D=b.action,F=b.args,D){case Lp:d.push(new Gp(F[0],F[1]));break;case $h:d.push(new Gp(F[0],F[1]));break;case cm:for(n=F[2],_=F[3],r=F[0],N=F[1],d.length>0?(T=d[d.length-1],R=T.x,O=T.y):(T=this.actions[Z-1].args,R=T[T.length-2],O=T[T.length-1]),X=1;z>=X;X++)v=X/z,H=sh.b2(v,R,r,n),f=sh.b2(v,O,N,_),d.push(new Gp(H,f));break;case il:for(n=F[4],_=F[5],r=F[0],N=F[1],c=F[2],S=F[3],d.length>0?(T=d[d.length-1],R=T.x,O=T.y):(T=this.actions[Z-1].args,R=T[T.length-2],O=T[T.length-1]),X=1;z>=X;X++)v=X/z,H=sh.b3(v,R,r,c,n),f=sh.b3(v,O,N,S,_),d.push(new Gp(H,f));break;case Gf:var l,e=F[0],p=F[1],q=F[2],P=F[3],L=F[4],m=!!F[5],k=L-P,s=2*z;for(X=1;s>=X;X++)v=X/s,m||(v=1-v),l=P+v*k,H=e+q*g(l),f=p+q*x(l),d.push(new Gp(H,f));break;case rr:var l,e=F[0],p=F[1],h=F[2],I=F[3],P=F[4],L=F[5],m=!!F[6],k=L-P,s=2*z;for(X=1;s>=X;X++)v=X/s,m||(v=1-v),l=P+v*k,H=e+h*g(l),f=p+I*x(l),d.push(new Gp(H,f))}var G=d[d.length-1],j=1e-10;return C(G.x-d[0].x)<j&&C(G.y-d[0].y)<j&&d.splice(d.length-1,1),U&&d.push(d[0]),d},Vl.toShapes=function(r,R){function n(o){var W,I,f,z,q,P=[],h=new Pf;for(W=0,I=o.length;I>W;W++)f=o[W],q=f.args,z=f.action,z==Lp&&0!=h.actions.length&&(P.push(h),h=new Pf),h[z].apply(h,q);return 0!=h.actions.length&&P.push(h),P}function d(X){for(var y=[],c=0,l=X.length;l>c;c++){var r=X[c],Y=new vo;Y.actions=r.actions,Y.curves=r.curves,y.push(Y)}return y}function i(L,a){for(var W=1e-10,m=a.length,J=!1,f=m-1,q=0;m>q;f=q++){var k=a[f],z=a[q],l=z.x-k.x,$=z.y-k.y;if(C($)>W){if(0>$&&(k=a[q],l=-l,z=a[f],$=-$),L.y<k.y||L.y>z.y)continue;if(L.y==k.y){if(L.x==k.x)return!0}else{var Z=$*(L.x-k.x)-l*(L.y-k.y);if(0==Z)return!0;if(0>Z)continue;J=!J}}else{if(L.y!=k.y)continue;if(z.x<=L.x&&L.x<=k.x||k.x<=L.x&&L.x<=z.x)return!0}}return J}var P=n(this.actions);if(0==P.length)return[];if(R===!0)return d(P);var f,A,V,I=[];if(1==P.length)return A=P[0],V=new vo,V.actions=A.actions,V.curves=A.curves,I.push(V),I;var p=!sh.isClockWise(P[0].getPoints());p=r?!p:p;var L,m=[],S=[],G=[],F=0;S[F]=Q,G[F]=[];var l,W;for(l=0,W=P.length;W>l;l++)A=P[l],L=A.getPoints(),f=sh.isClockWise(L),f=r?!f:f,f?(!p&&S[F]&&F++,S[F]={s:new vo,p:L},S[F].s.actions=A.actions,S[F].s.curves=A.curves,p&&F++,G[F]=[]):G[F].push({h:A,p:L[0]});if(!S[0])return d(P);if(S.length>1){for(var M=!1,g=[],U=0,T=S.length;T>U;U++)m[U]=[];for(var U=0,T=S.length;T>U;U++){S[U];for(var J=G[U],N=0;N<J.length;N++){for(var B=J[N],t=!0,y=0;y<S.length;y++)i(B.p,S[y].p)&&(U!=y&&g.push({froms:U,tos:y,hole:N}),t?(t=!1,m[y].push(B)):M=!0);t&&m[U].push(B)}}g.length>0&&(M||(G=m))}var k,v,u;for(l=0,W=S.length;W>l;l++)for(V=S[l].s,I.push(V),k=G[l],v=0,u=k.length;u>v;v++)V.holes.push(k[v].h);return I};var vo=function(){Pf.apply(this,arguments),this.holes=[]},Di=vo.prototype=Ec(Vl);Di.getPointsHoles=function(k){var _,Y=this.holes.length,K=[];for(_=0;Y>_;_++)K[_]=this.holes[_].getTransformedPoints(k);return K},Di.extractAllPoints=function(R){return{shape:this.getTransformedPoints(R),holes:this.getPointsHoles(R)}},Di.extractPoints=function(P){return this.extractAllPoints(P)};var sh={triangulateShape:function(D,S){function h(z,g,j){return z.x!=g.x?z.x<g.x?z.x<=j.x&&j.x<=g.x:g.x<=j.x&&j.x<=z.x:z.y<g.y?z.y<=j.y&&j.y<=g.y:g.y<=j.y&&j.y<=z.y}function e(G,z,c,O,x){var B=1e-10,Z=z.x-G.x,Q=z.y-G.y,A=O.x-c.x,b=O.y-c.y,Y=G.x-c.x,s=G.y-c.y,i=Q*A-Z*b,M=Q*Y-Z*s;if(C(i)>B){var p;if(i>0){if(0>M||M>i)return[];if(p=b*Y-A*s,0>p||p>i)return[]}else{if(M>0||i>M)return[];if(p=b*Y-A*s,p>0||i>p)return[]}if(0==p)return!x||0!=M&&M!=i?[G]:[];if(p==i)return!x||0!=M&&M!=i?[z]:[];if(0==M)return[c];if(M==i)return[O];var L=p/i;return[{x:G.x+L*Z,y:G.y+L*Q}]}if(0!=M||b*Y!=A*s)return[];var a=0==Z&&0==Q,w=0==A&&0==b;if(a&&w)return G.x!=c.x||G.y!=c.y?[]:[G];if(a)return h(c,O,G)?[G]:[];if(w)return h(G,z,c)?[c]:[];var l,F,f,e,J,N,S,m;return 0!=Z?(G.x<z.x?(l=G,f=G.x,F=z,e=z.x):(l=z,f=z.x,F=G,e=G.x),c.x<O.x?(J=c,S=c.x,N=O,m=O.x):(J=O,S=O.x,N=c,m=c.x)):(G.y<z.y?(l=G,f=G.y,F=z,e=z.y):(l=z,f=z.y,F=G,e=G.y),c.y<O.y?(J=c,S=c.y,N=O,m=O.y):(J=O,S=O.y,N=c,m=c.y)),S>=f?S>e?[]:e==S?x?[]:[J]:m>=e?[J,F]:[J,N]:f>m?[]:f==m?x?[]:[l]:m>=e?[l,F]:[l,N]}function v(b,Y,E,B){var S=1e-10,I=Y.x-b.x,Q=Y.y-b.y,r=E.x-b.x,g=E.y-b.y,O=B.x-b.x,p=B.y-b.y,V=I*g-Q*r,w=I*p-Q*O;if(C(V)>S){var X=O*g-p*r;return V>0?w>=0&&X>=0:w>=0||X>=0}return w>0}function H(L,I){function X(O,p){var X=A.length-1,m=O-1;0>m&&(m=X);var w=O+1;w>X&&(w=0);var K=v(A[O],A[m],A[w],F[p]);if(!K)return!1;var j=F.length-1,$=p-1;0>$&&($=j);var B=p+1;return B>j&&(B=0),K=v(F[p],F[$],F[B],A[O]),K?!0:!1}function q(S,i){var N,l,b;for(N=0;N<A.length;N++)if(l=N+1,l%=A.length,b=e(S,i,A[N],A[l],!0),b.length>0)return!0;return!1}function M(O,U){var R,y,m,B,c;for(R=0;R<b.length;R++)for(y=I[b[R]],m=0;m<y.length;m++)if(B=m+1,B%=y.length,c=e(O,U,y[m],y[B],!0),c.length>0)return!0;return!1}for(var F,E,V,t,H,T,P,$,o,c,N,A=L.concat(),b=[],j=[],f=0,S=I.length;S>f;f++)b.push(f);for(var s=0,p=2*b.length;b.length>0&&(p--,!(0>p));)for(V=s;V<A.length;V++){t=A[V],E=-1;for(var f=0;f<b.length;f++)if(T=b[f],P=t.x+":"+t.y+":"+T,j[P]===Q){F=I[T];for(var m=0;m<F.length;m++)if(H=F[m],X(V,m)&&!q(t,H)&&!M(t,H)){E=m,b.splice(f,1),$=A.slice(0,V+1),o=A.slice(V),c=F.slice(E),N=F.slice(0,E+1),A=$.concat(c).concat(N).concat(o),s=V;break}if(E>=0)break;j[P]=!0}if(E>=0)break}return A}for(var $,x,b,F,n,p,T={},Z=D.concat(),d=0,r=S.length;r>d;d++)Array.prototype.push.apply(Z,S[d]);for($=0,x=Z.length;x>$;$++)n=Z[$].x+":"+Z[$].y,T[n]!==Q,T[n]=$;var y=H(D,S),P=Kq.Triangulate(y,!1);for($=0,x=P.length;x>$;$++)for(F=P[$],b=0;3>b;b++)n=F[b].x+":"+F[b].y,p=T[n],p!==Q&&(F[b]=p);return P.concat()},isClockWise:function(U){return Kq.Triangulate.area(U)<0},b2p0:function(j,g){var z=1-j;return z*z*g},b2p1:function(C,$){return 2*(1-C)*C*$},b2p2:function(u,t){return u*u*t},b2:function(O,x,K,A){return this.b2p0(O,x)+this.b2p1(O,K)+this.b2p2(O,A)},b3p0:function(x,Z){var A=1-x;return A*A*A*Z},b3p1:function(j,O){var T=1-j;return 3*T*T*j*O},b3p2:function(z,G){var P=1-z;return 3*P*z*z*G},b3p3:function(C,B){return C*C*C*B},b3:function(K,J,S,U,L){return this.b3p0(K,J)+this.b3p1(K,S)+this.b3p2(K,U)+this.b3p3(K,L)}},Kq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var Q=P.keys(this.faces);return Q.length?Q[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(b){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(R){var N=R.familyName.toLowerCase(),C=this;return C.faces[N]=C.faces[N]||{},C.faces[N][R.cssFontWeight]=C.faces[N][R.cssFontWeight]||{},C.faces[N][R.cssFontWeight][R.cssFontStyle]=R,R},drawText:function(Z){var U,k=this.getFace(),P=this.size/k.resolution,s=0,x=String(Z).split(""),w=x.length,p=[];for(U=0;w>U;U++){var v=new Pf,i=this.extractGlyphPoints(x[U],k,P,s,v);i&&(s+=i.offset*this.spacing,p.push(i.path))}var e=s/2;return{paths:p,offset:e}},extractGlyphPoints:function(l,d,V,K,n){var w,s,e,f,O,A,p,a,Y,x,v,Q,u,q,J,$,F,z,m,b=[],S=d.glyphs[l]||d.glyphs["?"];if(S){if(S.o)for(f=S._cachedOutline||(S._cachedOutline=S.o.split(" ")),A=f.length,p=V,a=V,w=0;A>w;)switch(O=f[w++]){case"m":Y=f[w++]*p+K,x=f[w++]*a,n.moveTo(Y,x);break;case"l":Y=f[w++]*p+K,x=f[w++]*a,n.lineTo(Y,x);break;case"q":if(v=f[w++]*p+K,Q=f[w++]*a,J=f[w++]*p+K,$=f[w++]*a,n.quadraticCurveTo(J,$,v,Q),m=b[b.length-1])for(u=m.x,q=m.y,s=1,e=this.divisions;e>=s;s++){var o=s/e;sh.b2(o,u,J,v),sh.b2(o,q,$,Q)}break;case"b":if(v=f[w++]*p+K,Q=f[w++]*a,J=f[w++]*p+K,$=f[w++]*a,F=f[w++]*p+K,z=f[w++]*a,n.bezierCurveTo(J,$,F,z,v,Q),m=b[b.length-1])for(u=m.x,q=m.y,s=1,e=this.divisions;e>=s;s++){var o=s/e;sh.b3(o,u,J,F,v),sh.b3(o,q,$,z,Q)}}return{offset:S.ha*V,path:n}}}};Kq.generateShapes=function(r,n){n=n||{};var F=n.font;if(F===Q&&(F=Kq.getDefaultFont(),!F))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var l=n.size!==Q?n.size:1,k=n.curveSegments!==Q?n.curveSegments:4,E=n.spacing!==Q?n.spacing:1,j=n.weight!==Q?n.weight:"normal",D=n.style!==Q?n.style:"normal";Kq.size=l,Kq.divisions=k,Kq.face=F,Kq.weight=j,Kq.style=D,Kq.spacing=E;for(var y=Kq.drawText(r),w=y.paths,M=[],v=0,S=w.length;S>v;v++)Array.prototype.push.apply(M,w[v].toShapes());return M},function(Q){var M=1e-10,Y=function(G,w){var z=G.length;if(3>z)return null;var j,f,T,s=[],V=[],E=[];if(l(G)>0)for(f=0;z>f;f++)V[f]=f;else for(f=0;z>f;f++)V[f]=z-1-f;var D=z,g=2*D;for(f=D-1;D>2;){if(g--<=0)return w?E:s;if(j=f,j>=D&&(j=0),f=j+1,f>=D&&(f=0),T=f+1,T>=D&&(T=0),c(G,j,f,T,D,V)){var U,h,t,r,d;for(U=V[j],h=V[f],t=V[T],s.push([G[U],G[h],G[t]]),E.push([V[j],V[f],V[T]]),r=f,d=f+1;D>d;r++,d++)V[r]=V[d];D--,g=2*D}}return w?E:s},l=function(n){for(var y=n.length,f=0,Q=y-1,I=0;y>I;Q=I++)f+=n[Q].x*n[I].y-n[I].x*n[Q].y;return.5*f},c=function(C,r,d,n,Y,H){var s,g,y,P,j,B,Z,U,p;if(g=C[H[r]].x,y=C[H[r]].y,P=C[H[d]].x,j=C[H[d]].y,B=C[H[n]].x,Z=C[H[n]].y,M>(P-g)*(Z-y)-(j-y)*(B-g))return!1;var F,f,R,t,i,w,E,Q,X,G,v,m,a,A,L;for(F=B-P,f=Z-j,R=g-B,t=y-Z,i=P-g,w=j-y,s=0;Y>s;s++)if(U=C[H[s]].x,p=C[H[s]].y,!(U===g&&p===y||U===P&&p===j||U===B&&p===Z)&&(E=U-g,Q=p-y,X=U-P,G=p-j,v=U-B,m=p-Z,L=F*G-f*X,a=i*Q-w*E,A=R*m-t*v,L>=-M&&A>=-M&&a>=-M))return!1;return!0};return Q.Triangulate=Y,Q.Triangulate.area=l,Q}(Kq),O._typeface_js={faces:Kq.faces,loadFace:Kq.loadFace};var tr=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Pk=tr.prototype={constructor:tr,computeFaceNormals:function(){for(var B=new Ll,x=new Ll,o=0,r=this.faces.length;r>o;o++){var y=this.faces[o],E=this.vertices[y.a],b=this.vertices[y.b],z=this.vertices[y.c];B.subVectors(z,b),x.subVectors(E,b),B.cross(x),B.normalize(),y.normal.copy(B)}},computeVertexNormals:function(L){var b,q,T,J,v,E;for(E=new Array(this.vertices.length),b=0,q=this.vertices.length;q>b;b++)E[b]=new Ll;if(L){var K,c,u,y=new Ll,S=new Ll;for(T=0,J=this.faces.length;J>T;T++)v=this.faces[T],K=this.vertices[v.a],c=this.vertices[v.b],u=this.vertices[v.c],y.subVectors(u,c),S.subVectors(K,c),y.cross(S),E[v.a].add(y),E[v.b].add(y),E[v.c].add(y)}else for(T=0,J=this.faces.length;J>T;T++)v=this.faces[T],E[v.a].add(v.normal),E[v.b].add(v.normal),E[v.c].add(v.normal);for(b=0,q=this.vertices.length;q>b;b++)E[b].normalize();for(T=0,J=this.faces.length;J>T;T++)v=this.faces[T],v.vertexNormals[0]=E[v.a].clone(),v.vertexNormals[1]=E[v.b].clone(),v.vertexNormals[2]=E[v.c].clone()},mergeVertices:function(){var Y,C,B,t,y,T,u,b,X={},G=[],r=[],R=4,g=F(10,R);for(B=0,t=this.vertices.length;t>B;B++)Y=this.vertices[B],C=H(Y.x*g)+"_"+H(Y.y*g)+"_"+H(Y.z*g),X[C]===Q?(X[C]=B,G.push(this.vertices[B]),r[B]=G.length-1):r[B]=r[X[C]];var N=[];for(B=0,t=this.faces.length;t>B;B++){y=this.faces[B],y.a=r[y.a],y.b=r[y.b],y.c=r[y.c],T=[y.a,y.b,y.c];for(var D=0;3>D;D++)if(T[D]==T[(D+1)%3]){N.push(B);break}}for(B=N.length-1;B>=0;B--){var I=N[B];for(this.faces.splice(I,1),u=0,b=this.faceVertexUvs.length;b>u;u++)this.faceVertexUvs[u].splice(I,1)}var j=this.vertices.length-G.length;return this.vertices=G,j}},ub=function(Y,K,G,V,H,p,t){this.aX=Y,this.aY=K,this.xRadius=G,this.yRadius=V,this.aStartAngle=H,this.aEndAngle=p,this.aClockwise=t};ub.prototype=Ec(_q),ub.prototype.getPoint=function(k){var $,n=this.aEndAngle-this.aStartAngle;0>n&&(n+=G),n>G&&(n-=G),$=this.aClockwise===!0?this.aEndAngle+(1-k)*(G-n):this.aStartAngle+k*n;var w=this.aX+this.xRadius*g($),E=this.aY+this.yRadius*x($);return new Gp(w,E)};var Zq=function(R,G){this.v1=R,this.v2=G},of=Zq.prototype=Ec(_q);of.getPoint=function(y){var g=this.v2.clone().sub(this.v1);return g.multiplyScalar(y).add(this.v1),g},of.getPointAt=function(d){return this.getPoint(d)},of.getTangent=function(){var D=this.v2.clone().sub(this.v1);return D.normalize()};var lr=function(W,c,h){this.v0=W,this.v1=c,this.v2=h};lr.prototype=Ec(_q),lr.prototype.getPoint=function(o){var G,x;return G=sh.b2(o,this.v0.x,this.v1.x,this.v2.x),x=sh.b2(o,this.v0.y,this.v1.y,this.v2.y),new Gp(G,x)};var nm=function(f,O,r,G){this.v0=f,this.v1=O,this.v2=r,this.v3=G};nm.prototype=Ec(_q),nm.prototype.getPoint=function(C){var W,n;return W=sh.b3(C,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=sh.b3(C,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Gp(W,n)},ul.create(function(G,u){this.v1=G,this.v2=u},function(A){var h=new Ll;return h.subVectors(this.v2,this.v1),h.multiplyScalar(A),h.add(this.v1),h});var ug=ul.create(function(z,t,Q){this.v0=z,this.v1=t,this.v2=Q},function(E){var D,l,r;return D=sh.b2(E,this.v0.x,this.v1.x,this.v2.x),l=sh.b2(E,this.v0.y,this.v1.y,this.v2.y),r=sh.b2(E,this.v0.z,this.v1.z,this.v2.z),new Ll(D,l,r)}),Ah=ul.create(function(V,F,r,m){this.v0=V,this.v1=F,this.v2=r,this.v3=m},function(v){var $,r,V;return $=sh.b3(v,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r=sh.b3(v,this.v0.y,this.v1.y,this.v2.y,this.v3.y),V=sh.b3(v,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Ll($,r,V)}),ar=function(F,b,N,C,A,h,k,T){tr.call(this),C=C!==Q?C:.5,A=A!==Q?A:.5,T=T!==Q?T:1,F=F||8,h=h||0,k=k||G;var J,p,d=1,q=T/2,K=[],U=[],a=this.vertices,r=this.faces,o=this.faceVertexUvs;for(p=0;d>=p;p++){var c=[],s=[],M=p/d,E=M*(A-C)+C;for(J=0;F>=J;J++){var X=J/F,e=new Ll,P=-(X*k+h);e.z=E*x(P),e.y=-M*T+q,e.x=E*g(P),a.push(e),c.push(a.length-1),s.push(new Gp(X,M))}K.push(c),U.push(s)}var H,D,y=(A-C)/T;for(J=0;F>J;J++)for(0!==C?(H=a[K[0][J]].clone(),D=a[K[0][J+1]].clone()):(H=a[K[1][J]].clone(),D=a[K[1][J+1]].clone()),H.setY(Z(H.x*H.x+H.z*H.z)*y).normalize(),D.setY(Z(D.x*D.x+D.z*D.z)*y).normalize(),p=0;d>p;p++){var v=K[p][J],L=K[p+1][J],S=K[p+1][J+1],$=K[p][J+1],j=H.clone(),I=H.clone(),R=D.clone(),W=D.clone(),l=U[p][J].clone(),u=U[p+1][J].clone(),w=U[p+1][J+1].clone(),f=U[p][J+1].clone();r.push(new $j(v,L,$,[j,I,W])),o[0].push([l,u,f]),r.push(new $j(L,S,$,[I.clone(),R,W.clone()])),o[0].push([u.clone(),w,f.clone()])}if(b&&C>0)for(this.vertices.push(new Ll(0,q,0)),J=0;F>J;J++){var v=K[0][J],L=K[0][J+1],S=this.vertices.length-1,j=new Ll(0,1,0),I=new Ll(0,1,0),R=new Ll(0,1,0),l=U[0][J].clone(),u=U[0][J+1].clone(),w=new Gp(u.x,0);r.push(new $j(v,L,S,[j,I,R],null,1));var B=J/F*G,Y=g(B),t=x(B),m=(J+1)/F*G,O=g(m),V=x(m);o[0].push([new Gp(.5+.5*Y,.5+.5*t),new Gp(.5+.5*O,.5+.5*V),new Gp(.5,.5)])}if(N&&A>0)for(this.vertices.push(new Ll(0,-q,0)),J=0;F>J;J++){var v=K[p][J+1],L=K[p][J],S=a.length-1,j=new Ll(0,-1,0),I=new Ll(0,-1,0),R=new Ll(0,-1,0),l=U[p][J+1].clone(),u=U[p][J].clone();r.push(new $j(v,L,S,[j,I,R],null,2));var B=J/F*G,Y=g(B),t=x(B),m=(J+1)/F*G,O=g(m),V=x(m);o[0].push([new Gp(.5+.5*O,.5-.5*V),new Gp(.5+.5*Y,.5-.5*t),new Gp(.5,.5)])}};ar.prototype=Ec(Pk);var dj=function(f,U,I,r,X,H,V){tr.call(this),V=V||.5,f=f||16,U=U||16,I=(I!==Q?I:0)-A,r=r!==Q?r:G,X=X!==Q?X:0,H=H!==Q?H:A;var R,B,q=[],d=[],c=this.vertices,E=this.faces,o=this.faceVertexUvs;for(B=0;U>=B;B++){var n=[],l=[];for(R=0;f>=R;R++){var $=R/f,K=B/U,_=new Ll;_.x=-V*g(I+$*r)*x(X+K*H),_.y=V*g(X+K*H),_.z=V*x(I+$*r)*x(X+K*H),c.push(_),n.push(c.length-1),l.push(new Gp($,K))}q.push(n),d.push(l)}for(B=0;U>B;B++)for(R=0;f>R;R++){var z=q[B][R+1],b=q[B][R],e=q[B+1][R],J=q[B+1][R+1],j=c[z].clone().normalize(),Y=c[b].clone().normalize(),N=c[e].clone().normalize(),v=c[J].clone().normalize(),u=d[B][R+1].clone(),m=d[B][R].clone(),w=d[B+1][R].clone(),s=d[B+1][R+1].clone();C(c[z].y)===V?(u.x=(u.x+m.x)/2,E.push(new $j(z,e,J,[j,N,v])),o[0].push([u,w,s])):C(c[e].y)===V?(w.x=(w.x+s.x)/2,E.push(new $j(z,b,e,[j,Y,N])),o[0].push([u,m,w])):(E.push(new $j(z,b,J,[j,Y,v])),o[0].push([u,m,s]),E.push(new $j(b,e,J,[Y.clone(),N,v.clone()])),o[0].push([m.clone(),w,s.clone()]))}};dj.prototype=Ec(Pk);var Ri=function(v,f,H,r,w,F){tr.call(this),v=v||.33,f=f||.17,r=r||8,H=H||6,w=w||0,F=F||G;for(var J=new Ll,e=[],a=[],c=0;r>=c;c++)for(var W=c/r*G+A,M=0;H>=M;M++){var X=M/H*F+w;J.x=v*g(X),J.z=-v*x(X);var Q=new Ll,u=v+f*g(W);Q.x=u*g(X),Q.z=-u*x(X),Q.y=f*x(W),this.vertices.push(Q),e.push(new Gp(M/H,1-c/r)),a.push(Q.clone().sub(J).normalize())}for(var c=1;r>=c;c++)for(var M=1;H>=M;M++){var K=(H+1)*c+M-1,$=(H+1)*(c-1)+M-1,E=(H+1)*(c-1)+M,k=(H+1)*c+M,O=new $j(K,$,k,[a[K].clone(),a[$].clone(),a[k].clone()]);this.faces.push(O),this.faceVertexUvs[0].push([e[K].clone(),e[$].clone(),e[k].clone()]),O=new $j($,E,k,[a[$].clone(),a[E].clone(),a[k].clone()]),this.faces.push(O),this.faceVertexUvs[0].push([e[$].clone(),e[E].clone(),e[k].clone()])}this.computeFaceNormals()};Ri.prototype=Ec(Pk);var mc=function(G,J,B){return G?(tr.call(this),G=G instanceof Array?G:[G],this.addShapeList(G,J),J.convertYZ!==!1&&qr(this,B),this.computeFaceNormals(),void 0):(G=[],void 0)},Dk=mc.prototype=Ec(tr.prototype);Dk.addShapeList=function(P,Z){for(var h=P.length,u=0;h>u;u++){var t=P[u];this.addShape(t,Z)}},Dk.addShape=function(t,Z){function s(){if(Z.bottom)for(var M=0;k>M;M++)W=G[M],O(W[2],W[1],W[0],!0);if(Z.top)for(M=0;k>M;M++)W=G[M],O(W[0]+g*R,W[1]+g*R,W[2]+g*R,!1)}function j(){var h=0;for(I(n,h),h+=n.length,L=0,e=l.length;e>L;L++)y=l[L],I(y,h),h+=y.length}function I(F,J){for(var b,f,V=F.length;--V>=0;){b=V,f=V-1,0>f&&(f=F.length-1);var X=0,t=R;for(X=0;t>X;X++){var q=g*X,k=g*(X+1),_=J+b+q,x=J+f+q,G=J+f+k,e=J+b+k;B(_,x,G,e,F,X,t,b,f)}}}function w(U,L,w){b.vertices.push(new Ll(U,L,w))}function O(u,Q,f,S){u+=r,Q+=r,f+=r,b.faces.push(new $j(u,Q,f,null,null,S?2:1));var o=S?d.generateBottomUV(b,t,Z,u,Q,f):d.generateTopUV(b,t,Z,u,Q,f);b.faceVertexUvs[0].push(o)}function B(a,M,E,H,T,m,W,_,L){a+=r,M+=r,E+=r,H+=r,b.faces.push(new $j(a,M,H)),b.faces.push(new $j(M,E,H));var h=d.generateSideWallUV(b,t,T,Z,a,M,E,H,m,W,_,L);b.faceVertexUvs[0].push([h[0],h[1],h[3]]),b.faceVertexUvs[0].push([h[1],h[2],h[3]])}var E,P,v,J,o,u=Z.amount,A=Z.curveSegments||tb,R=Z.steps||1,c=Z.extrudePath,p=!1,d=new Nb(Z.repeatUVLength);c&&(E=c.getSpacedPoints(R),p=!0,P=Z.frames!==Q?Z.frames:new Fh.FrenetFrames(c,R,!1),v=new Ll,J=new Ll,o=new Ll);var y,L,e,b=this,r=this.vertices.length,N=t.extractPoints(A),S=N.shape,l=N.holes,D=!sh.isClockWise(S);if(D){for(S=S.reverse(),L=0,e=l.length;e>L;L++)y=l[L],sh.isClockWise(y)&&(l[L]=y.reverse());D=!1}var G=sh.triangulateShape(S,l),n=S;for(L=0,e=l.length;e>L;L++)y=l[L],S=S.concat(y);for(var F,W,g=S.length,k=G.length,T=0;g>T;T++)F=S[T],p?(J.copy(P.normals[0]).multiplyScalar(F.x),v.copy(P.binormals[0]).multiplyScalar(F.y),o.copy(E[0]).add(J).add(v),w(o.x,o.y,o.z)):w(F.x,F.y,0);var K;for(K=1;R>=K;K++)for(T=0;g>T;T++)F=S[T],p?(J.copy(P.normals[K]).multiplyScalar(F.x),v.copy(P.binormals[K]).multiplyScalar(F.y),o.copy(E[K]).add(J).add(v),w(o.x,o.y,o.z)):w(F.x,F.y,u/R*K);s(),j()};var Fh=function(B,R,n,T,q){function b(g,y,P){return V.vertices.push(new Ll(g,y,P))-1}tr.call(this),R=R||64,n=n||1,T=T||8,q=q||!1;var m,h,f,c,p,e,d,N,Q,H,Y,Z,P,F,O,E,z,v,C,t,X=[],V=this,D=R+1,K=new Ll,A=new Fh.FrenetFrames(B,R,q),W=A.tangents,s=A.normals,U=A.binormals;for(this.tangents=W,this.normals=s,this.binormals=U,Q=0;D>Q;Q++)for(X[Q]=[],c=Q/(D-1),N=B.getPointAt(c),m=W[Q],h=s[Q],f=U[Q],H=0;T>H;H++)p=H/T*G,e=-n*g(p),d=n*x(p),K.copy(N),K.x+=e*h.x+d*f.x,K.y+=e*h.y+d*f.y,K.z+=e*h.z+d*f.z,X[Q][H]=b(K.x,K.y,K.z);for(Q=0;R>Q;Q++)for(H=0;T>H;H++)Y=q?(Q+1)%R:Q+1,Z=(H+1)%T,P=X[Q][H],F=X[Y][H],O=X[Y][Z],E=X[Q][Z],z=new Gp(Q/R,H/T),v=new Gp((Q+1)/R,H/T),C=new Gp((Q+1)/R,(H+1)/T),t=new Gp(Q/R,(H+1)/T),this.faces.push(new $j(P,F,E)),this.faceVertexUvs[0].push([z,v,t]),this.faces.push(new $j(F,O,E)),this.faceVertexUvs[0].push([v.clone(),C,t.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Fh.prototype=Ec(Pk),Fh.FrenetFrames=function(y,j,Z){function F(){L[0]=new Ll,v[0]=new Ll,M=Number.MAX_VALUE,o=C(r[0].x),b=C(r[0].y),I=C(r[0].z),M>=o&&(M=o,l.set(1,0,0)),M>=b&&(M=b,l.set(0,1,0)),M>=I&&l.set(0,0,1),R.crossVectors(r[0],l).normalize(),L[0].crossVectors(r[0],R),v[0].crossVectors(r[0],L[0])}var J,M,o,b,I,T,e,l=new Ll,r=[],L=[],v=[],R=new Ll,Y=new Yi,X=j+1,n=1e-4;for(this.tangents=r,this.normals=L,this.binormals=v,T=0;X>T;T++)e=T/(X-1),r[T]=y.getTangentAt(e),r[T].normalize();for(F(),T=1;X>T;T++)L[T]=L[T-1].clone(),v[T]=v[T-1].clone(),R.crossVectors(r[T-1],r[T]),R.length()>n&&(R.normalize(),J=d(ts(r[T-1].dot(r[T]),-1,1)),L[T].applyMatrix4(Y.makeRotationAxis(R,J))),v[T].crossVectors(r[T],L[T]);if(Z)for(J=d(ts(L[0].dot(L[X-1]),-1,1)),J/=X-1,r[0].dot(R.crossVectors(L[0],L[X-1]))>0&&(J=-J),T=1;X>T;T++)L[T].applyMatrix4(Y.makeRotationAxis(r[T],J*T)),v[T].crossVectors(r[T],L[T])};var Hh=function(M,w,X,V){tr.call(this),w=w||18,X=X||0,V=V==q?G:V;for(var _=1/(M.length-1),v=1/w,N=0,y=w;y>=N;N++)for(var t=X+N*v*V,l=g(t),D=x(t),r=0,k=M.length;k>r;r++){var h=M[r],p=new Ll;p.x=l*h.x-D*h.y,p.y=D*h.x+l*h.y,p.z=h.z,this.vertices.push(p)}for(var C=M.length,N=0,y=w;y>N;N++)for(var r=0,k=M.length-1;k>r;r++){var j=r+C*N,I=j,z=j+C,l=j+1+C,O=j+1,d=N*v,b=r*_,T=d+v,$=b+_;this.faces.push(new $j(I,O,z)),this.faceVertexUvs[0].push([new Gp(d,b),new Gp(d,$),new Gp(T,b)]),this.faces.push(new $j(z,O,l)),this.faceVertexUvs[0].push([new Gp(T,b),new Gp(d,$),new Gp(T,$)])}this.mergeVertices(),qr(this),this.computeFaceNormals(),this.computeVertexNormals()};Hh.prototype=Ec(Pk);var sq=function(P,N){N=N||{};var V=Kq.generateShapes(P,N);N.amount=N.amount!==Q?N.amount:.5,N.convertYZ=!1,N.fill!==!1&&(N.bottom=!0,N.top=!0),mc.call(this,V,N)};sq.prototype=Ec(Dk);var Mf=i.Node=function(){Pj(Mf,this)},Mi={X:Fq,Y:eb,Z:kj},$g={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},qo="xzy",sp=function(w,u,W){if(u){var l=u[0],p=u[1],f=u[2];"xzy"===W?(eb(w,p),kj(w,f),Fq(w,l)):"xyz"===W?(kj(w,f),eb(w,p),Fq(w,l)):"yxz"===W?(kj(w,f),Fq(w,l),eb(w,p)):"yzx"===W?(Fq(w,l),kj(w,f),eb(w,p)):"zxy"===W?(eb(w,p),Fq(w,l),kj(w,f)):"zyx"===W?(Fq(w,l),eb(w,p),kj(w,f)):(eb(w,p),kj(w,f),Fq(w,l))}};Qd("Node",Mb,{ms_ac:["rotationMode","tall"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:qo,_64O:0,_rotationX:0,_53O:0,_host:q,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_scale:{x:1,y:1},_tall:20,_54O:0,getUIClass:function(){return Ql},_22Q:function(){return cd},getX:function(){return this.p().x},setX:function(P){this.p(P,this.p().y)},getY:function(){return this.p().y},setY:function(Q){this.p(this.p().x,Q)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(p){this.setAnchor(p,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(J){this.setAnchor(this.getAnchor().x,J)},getScaleX:function(){return this.getScale().x},setScaleX:function(N){this.setScale(N,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(x){this.setScale(this.getScale().x,x)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(c,K){Kl(c,gs(q,q,this.r3(),this.getRotationMode())),this.translate3d(c[0]*K,c[1]*K,c[2]*K)},translateFront:function(e){this.translate3dBy([0,0,1],e)},translateBack:function(e){this.translate3dBy([0,0,-1],e)},translateLeft:function(i){this.translate3dBy([-1,0,0],i)},translateRight:function(o){this.translate3dBy([1,0,0],o)},translateTop:function(R){this.translate3dBy([0,1,0],R)},translateBottom:function(q){this.translate3dBy([0,-1,0],q)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(h,z,V){1===arguments.length&&(z=h[1],V=h[2],h=h[0]),this.p(h,V),this.setElevation(z)},translate3d:function(c,L,X){1===arguments.length&&(L=c[1],X=c[2],c=c[0]),this.translate(c,X),this.setElevation(this._54O+L)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(F,j,D){1===arguments.length&&(j=F[1],D=F[2],F=F[0]),this.setSize(F,D),this.setTall(j)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(q,N,m){1===arguments.length&&(N=q[1],m=q[2],q=q[0]),this.setRotationX(q),this.setRotation(-N),this.setRotationZ(m)},setRotationY:function(W){this.setRotation(-W)},getRotationY:function(){return-this._64O},lookAt:function(i,E){E=E||Fn;var $=this,K=np(i,$.p3()),y=Ip(K);E===Fn?($.r3([-L(K[1]/y),-B(K[2],K[0])+V,0]),$.setRotationMode("xzy")):E===Gr?($.r3(0,-B(K[2],K[0]),L(K[1]/y)),$.setRotationMode("zyx")):E===Ff?($.r3(0,-B(K[2],K[0])+A,-L(K[1]/y)),$.setRotationMode("zyx")):E===nr?($.r3([-L(K[1]/y)+V,-B(K[2],K[0])+V,0]),$.setRotationMode("xzy")):E===Xg&&($.r3([-L(K[1]/y)-V,-B(K[2],K[0])+V,0]),$.setRotationMode("xzy")),E===xn&&($.r3([-L(K[1]/y)+A,-B(K[2],K[0])+V,A]),$.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(H){var j=this;if(j!==H&&j._host!==H){var s=j._host;s&&s._removeAttach(j),j._host=H,j._host&&j._host._addAttach(j),j.fp("host",s,H),j.onHostChanged(s,H)}},getAttaches:function(){return this._69O},_addAttach:function(Z){var u=this;u._69O||(u._69O=new up),u._69O.add(Z),u.fp("attaches",q,Z)},_removeAttach:function(Z){var y=this;y._69O.remove(Z),y._69O.isEmpty()&&delete y._69O,y.fp("attaches",Z,q)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(o){var n=this;n._44I||(n._44I=new up),n._42I||(n._42I=new up),n._44I.add(o),n._42I.add(o),n._20I()},_4I:function(w){var b=this;b._44I||(b._44I=new up),b._43I||(b._43I=new up),b._44I.add(w),b._43I.add(w),b._20I()},_16I:function($){var c=this;c._44I.remove($),c._42I.remove($),c._44I.isEmpty()&&delete c._44I,c._42I.isEmpty()&&delete c._42I,c._20I()},_18I:function(K){var F=this;F._44I.remove(K),F._43I.remove(K),F._44I.isEmpty()&&delete F._44I,F._43I.isEmpty()&&delete F._43I,F._20I()},_20I:function(){var T=this;if(delete T._45I,!T._44I||T._44I.isEmpty())return delete T._70O,void 0;var g;T._44I.each(function(k){k.isLooped()&&(g||(g={}),g[k._id]||(T._45I||(T._45I=new up),T._45I.add(k),g[k._id]=k))}),g?(T._70O=new up,T._44I.each(function(A){g[A._id]?"A"===g[A._id]||(g[A._id]="A",T._70O.add(A)):T._70O.add(A)})):T._70O=T._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(i){var k=this;k._46I||(k._46I=new up),k._48I||(k._48I=new up),k._46I.add(i),k._48I.add(i),k._19I()},_3I:function(O){var v=this;v._47I||(v._47I=new up),v._48I||(v._48I=new up),v._47I.add(O),v._48I.add(O),v._19I()},_15I:function(B){var Y=this;Y._46I.remove(B),Y._48I.remove(B),Y._46I.isEmpty()&&delete Y._46I,Y._48I.isEmpty()&&delete Y._48I,Y._19I()},_17I:function(y){var q=this;q._47I.remove(y),q._48I.remove(y),q._47I.isEmpty()&&delete q._47I,q._48I.isEmpty()&&delete q._48I,q._19I()},_19I:function(){var T=this;delete T._49I;var s=T._48I;if(s&&!s.isEmpty()){var z={};s.each(function(E){z[E._id]?T._49I||(T._49I=new up):z[E._id]=E}),T._49I?s.each(function(Z){z[Z._id]&&(T._49I.add(Z),delete z[Z._id])}):T._49I=s}},getImage:function(){if(this._pendingCheckImageJSON){var f=E.getImage(this._image);f&&(this._pendingCheckImageJSON=!1,f.dataBindings&&f.dataBindings.forEach(function(H){H.defaultValue!==Q&&this.getAttr(H.attr)===Q&&this.setAttr(H.attr,H.defaultValue)},this),this.getParent()instanceof vh&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(A){var Q=this,L=Q._image,P=Q.getWidth(),S=Q.getHeight();Q._image=A,Q.fp("image",L,A)&&(null!=A&&(qc(A)||Gg(A)&&/\.json$/i.test(A))&&(this._pendingCheckImageJSON=!0),Q.fp(kk,P,Q.getWidth()),Q.fp(ri,S,Q.getHeight()))},getElevation:function(){return this._54O},setElevation:function(M){var I=this;if(!I._50O){I._50O=1;var G=I._54O;I._54O=M,I.fp(ls,G,M),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(T){var E=this;if(!E._49O){E._49O=1;var r=E._64O;E._64O=T,E.fp(oh,r,T),delete E._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(o){var u=this;if(!u._51O){u._51O=1;var C=u._rotationX;u._rotationX=o,u.fp("rotationX",C,o),delete u._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(F){var K=this;if(!K._52O){K._52O=1;var H=K._53O;K._53O=F,K.fp("rotationZ",H,F),delete K._52O}},getPosition:function(){return this._position},setPosition:function(N,i){var w=this;if(!w._50I){w._50I=1;var Y;if(Y=2===arguments.length?{x:N,y:i}:N,Y.x!==w._position.x||Y.y!==w._position.y){var I=w._position;w._position=Y,w.fp(xm,I,Y)}delete w._50I}},translate:function(I,p){var k=this._position;this.p(k.x+I,k.y+p)},getWidth:function(){var x=this;if(x._width>=0)return x._width;var T=fo(x._image);return T?Uh(T,x):20},setWidth:function(z){var V=this,j=V._width;V._width=z,V.fp(kk,j,z)},getHeight:function(){var P=this;if(P._height>=0)return P._height;var b=fo(P._image);return b?yn(b,P):20},setHeight:function(Q){var B=this,O=B._height;B._height=Q,B.fp(ri,O,Q)},setSize:function(o,b){var g=this;2===arguments.length?(g.setWidth(o),g.setHeight(b)):(g.setWidth(o.width),g.setHeight(o.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(L,D,o,b,N){var r=this,q=r.getAnchor(),Z=r.getScale();arguments.length<=2&&(N=D,D=L.y,o=L.width,b=L.height,L=L.x);var e=N&&Z.x<0?1-q.x:q.x,k=N&&Z.y<0?1-q.y:q.y;r.p(L+o*e,D+b*k),N&&(o/=Math.abs(Z.x),b/=Math.abs(Z.y)),r.setWidth(o),r.setHeight(b)},getMatrix:function(){var E=this,t=E._64O,c=E._position,h=E.getScale();return new He(t,c.x,c.y,h.x,h.y)},getAnchorRect:function(){var e=this,Q=e.getWidth(),s=e.getHeight(),f=e.getAnchor();return{x:-Q*f.x,y:-s*f.y,width:Q,height:s}},getRect:function(){var V=this,k=V.getWidth(),H=V.getHeight(),Q=V.getAnchor(),h={x:-k*Q.x,y:-H*Q.y,width:k,height:H},m=V.getMatrix();return h=Yd([m.tf(h.x,h.y),m.tf(h.x+h.width,h.y),m.tf(h.x+h.width,h.y+h.height),m.tf(h.x,h.y+h.height)])},getAnchor:function(){var C=this;if(C.hasOwnProperty("_anchor"))return C._anchor;var P=fo(C._image);return P&&P.anchorX!==Q?{x:P.anchorX,y:P.anchorY}:C._anchor},setAnchor:function(n,J,F){var Z,t=this;"number"==typeof n?Z={x:n,y:J}:(Z=n.length?{x:n[0],y:n[1]}:n,F=J);var v=t.getAnchor();if(v.x!==Z.x||v.y!==Z.y){var A=t.getDataModel(),X=A?A.getHistoryManager():null;if(X&&X.beginInteraction(),t._anchor=Z,t.fp("anchor",v,Z),F&&!Cf){var Q=t.getPosition(),f=t.getSize(),b=t.getRotation(),C=t.getScale(),h=-f.width*(v.x-Z.x)*C.x,c=-f.height*(v.y-Z.y)*C.y,O=x(b),D=g(b);t.setPosition(Q.x+D*h-O*c,Q.y+O*h+D*c)}X&&X.endInteraction()}},getScale:function(){return this._scale},setScale:function(d,x){var M,I=this;M=2===arguments.length?{x:d,y:x}:d;var J=I.getScale();(J.x!==M.x||J.y!==M.y)&&(I._scale=M,I.fp("scale",J,M))},getCorners:function(B,M){B==q&&(B=0),M==q&&(M=B);var F=this,$=F.getAnchor(),K=F.getWidth(),G=F.getHeight(),u=-K*$.x-B,c=-G*$.y-M,_=K+2*B,N=G+2*M,I=F.getMatrix();return[I.tf(u,c),I.tf(u,c+N),I.tf(u+_,c+N),I.tf(u+_,c)]},getEditControlPoints:function(v,l,B){l==q&&(l=0),B==q&&(B=l);var E=this,j=E.getAnchor(),i=E.getWidth(),y=E.getHeight(),O=-i*j.x-l,T=-y*j.y-B,t=i+2*l,$=y+2*B;if(v)return[{x:O,y:T},{x:O,y:0},{x:O,y:T+$},{x:0,y:T+$},{x:O+t,y:T+$},{x:O+t,y:0},{x:O+t,y:T},{x:0,y:T}];var X=E.getMatrix();return[X.tf(O,T),X.tf(O,0),X.tf(O,T+$),X.tf(0,T+$),X.tf(O+t,T+$),X.tf(O+t,0),X.tf(O+t,T),X.tf(0,T)]},rotateAt:function(I,L,y){var k=this,H=k._position,i=k._64O,U=new He(i,H.x,H.y).tf(I,L),f=Z(I*I+L*L),$=B(H.y-U.y,H.x-U.x)+y;
k.setRotation(i+y),k.p(U.x+f*g($),U.y+f*x($))},onParentChanged:function(){Mf.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(V){V._7I()})},onPropertyChanged:function(i){var H=this;Mf.superClass.onPropertyChanged.call(H,i),H._69O&&H._69O.each(function(m){m.handleHostPropertyChange(i)}),H._49I&&H._49I.each(function(D){D.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(U){this.updateAttach(U)},onStyleChanged:function(G){Mf.superClass.onStyleChanged.apply(this,arguments),jb[G]&&this.updateAttach()},updateAttach:function(f){var X=this;X._51I||Cf||(X._51I=1,X._71O(f),delete X._51I)},_71O:function(D){var m,g,t,Y,n,x,h=this,u=h._host,G=D?D.property:q,r=D?D.oldValue:q,j=D?D.newValue:q;if(u instanceof i.Grid){if(G===ls)h.setElevation(h._54O+j-r);else if(!D||Sf[G]){if(m=h.s("attach.row.index"),g=h.s("attach.column.index"),t=u.getCellRect(m,g),!t)return;Y=h.s("attach.row.span"),n=h.s("attach.column.span"),(1!==Y||1!==n)&&(t=Uo(t,u.getCellRect(m+Y-1,g+n-1))),Il(t,h,"attach.padding",1),h.setRect(t)}}else if(u instanceof Hi&&(x=h.s("attach.index"))>=0&&(!D||pm[G])){var K=h.s("attach.thickness");K!=q&&h.setHeight(u.getThickness()*K);var p=h.s("attach.offset"),d=u.getPoints(),c=d.size();if(c>x){var w=d.get(x),T=c===x+1?d.get(0):d.get(x+1),Z=[T.x-w.x,T.y-w.y],R=Ip(Z);if(R){h.s("attach.offset.relative")&&(p*=R),h.s("attach.offset.opposite")&&(p=R-p);var J={x:w.x+Z[0]/R*p,y:w.y+Z[1]/R*p},L=h.s("attach.gap");L&&(h.s("attach.gap.relative")&&(L*=u.getThickness()),J=Jj(q,J,T,L)),h.p(J),h.setRotation(B(Z[1],Z[0]))}}}else D&&(G===xm?h.translate(j.x-r.x,j.y-r.y):G===ls?h.setElevation(h._54O+j-r):Ic[G]&&h._11Q(u,G,j-r))},_11Q:function($,y,t){var G=this,q=$.p3(),m=np(G.p3(),q),v=ns(),X=$g[G.getRotationMode()],F=X[0],T=X[1],_=X[2],j=Mi[F],B=Mi[T],K=Mi[_];y===oh&&(y="rotationY",t=-t),y===oh+F?(K(v,$[bs+_]()),B(v,$[bs+T]()),j(v,t),B(v,-$[bs+T]()),K(v,-$[bs+_]()),G[so+F](G[bs+F]()+t)):y===oh+T?(K(v,$[bs+_]()),B(v,t),K(v,-$[bs+_]()),G[so+T](G[bs+T]()+t)):y===oh+_&&(K(v,t),G[so+_](G[bs+_]()+t)),Kl(m,v),G.p3(q[0]+m[0],q[1]+m[1],q[2]+m[2])},isHostOn:function(D){var U=this;if(U._host&&D&&D._69O)for(var b={},r=U._host;r&&r!==U&&!b[r._id];){if(r===D)return!0;b[r._id]=r,r=r._host}return!1},isLoopedHostOn:function(l){return this.isHostOn(l)&&l.isHostOn(this)},getSerializableProperties:function(){var f=Mf.superClass.getSerializableProperties.call(this);return Ij(f,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,scale:1,_width:1,_height:1,tall:1,elevation:1}),f}});var Co=i.Edge=function(c,s){var D=this;Pj(Co,D),D.setSource(c),D.setTarget(s)};Qd("Edge",Mb,{_icon:"edge_icon",getUIClass:function(){return mi},_22Q:function(){return Iq},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(a){var Q=this;if(Q._source!==a){var z=Q._source;Q._source=a,z&&z._16I(Q),a&&a._2I(Q),Q._7I(),Q.fp("source",z,a)}},setTarget:function(Q){var G=this;if(G._target!==Q){var z=G._target;G._target=Q,z&&z._18I(G),Q&&Q._4I(G),G._7I(),G.fp("target",z,Q)}},isLooped:function(){var $=this;return $._source===$._target&&!!$._source&&!!$._target},_7I:function(){var N,s=this,l=Vk(s);s._40I!==l&&(N=this._40I,N&&N._15I(s),s._40I=l,l&&l._1I(s),s.fp("sourceAgent",N,l),Xk(N,s._41I),Xk(l,s._41I));var Z=hi(s);s._41I!==Z&&(N=s._41I,N&&N._17I(s),s._41I=Z,Z&&Z._3I(s),s.fp("targetAgent",N,Z),Xk(N,s._40I),Xk(Z,s._40I))},_22I:function($){this._52I=$,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var O=this;return O._52I&&O._52I.get(0)!==O&&!O.getStyle($q)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var v=this,T=v._52I;return T&&!v.getStyle($q)&&T.size()>1&&v===T.get(0)},toggle:function(){var N=this._52I,t=!this.s($q);N&&N.size()>1&&(N.each(function(d){d.s($q,t)}),N.getSiblings().each(function(M){M!==N&&M.each(function(T){T.fp("edgeGroup",q,M)})}))},setStyle:function(k,M){(k===Sr||"edge.segments"===k)&&(M=qb(M)),Co.superClass.setStyle.call(this,k,M)},onStyleChanged:function(D){Co.superClass.onStyleChanged.apply(this,arguments),gk[D]&&Xk(this._41I,this._40I)},getSerializableProperties:function(){var D=Co.superClass.getSerializableProperties.call(this);return Ij(D,{source:1,target:1}),D}});var xb=i.Group=function(){Pj(xb,this)};Qd("Group",Mf,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return gg},onChildAdded:function(){xb.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){xb.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var W=this;if(!W._54I&&!Cf){var m=W.getChildrenRect();m&&(W._53I=1,W.p(Un(W.s("group.position"),m,W.getSize())),delete W._53I)}},getChildrenRect:function(){var F,g=this;return g.eachChild(function(z){F=Uo(F,g.getChildRect(z))}),F},getChildRect:function(A){var L;return Bj(A)&&A.s(Lg)&&(Gd(A)&&A.isExpanded()&&A.eachChild(function(D){L=Uo(L,A.getChildRect(D))}),!L&&A.getRect&&(L=A.getRect())),L},setPosition:function($,e){var W=this;if(!W._54I){var r;r=2===arguments.length?{x:$,y:e}:$,Cf||W._53I||(W._54I=1,Xp(W._children,r.x-W._position.x,r.y-W._position.y),delete W._54I),xb.superClass.setPosition.call(this,r)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function($){var k=this;if(k._57O!==$){var O=k._57O;k._57O=$,k.fp("expanded",O,k._57O),k._8I()}},_8I:function(){xb.superClass._8I.call(this),this.eachChild(function(O){Bj(O)&&O._8I()})},onStyleChanged:function(C){xb.superClass.onStyleChanged.apply(this,arguments),"group.position"===C&&this._81I()},getSerializableProperties:function(){var B=xb.superClass.getSerializableProperties.call(this);return B.expanded=1,B}});var ye=i.Block=function(){Pj(ye,this)};Qd("Block",Mf,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Kd},onChildAdded:function(){ye.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){ye.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var k=this;if(!Cf&&!k._updatingToChildren&&k._syncSize){var A,r,w,p,a,N=[],c=k.getRotation();if(k.eachChild(function(K){Bj(K)&&N.push.apply(N,K.getCorners())}),N.length){k._updatingFromChildren=1;var z=g(-c),$=x(-c),i=1/0,n=-1/0,L=1/0,G=-1/0;for(p=0,a=N.length;a>p;p++)w=N[p],A=w.x,r=w.y,w.x=z*A-$*r,w.y=$*A+z*r,i=f(i,w.x),n=M(n,w.x),L=f(L,w.y),G=M(G,w.y);var W=k.getScale();k.setSize(C((n-i)/W.x),C((G-L)/W.y));var j;W.x<0&&(j=i,i=n,n=j),W.y<0&&(j=L,L=G,G=j),z=g(c),$=x(c);var o=k.getAnchor();A=i+(n-i)*o.x,r=L+(G-L)*o.y,k.setPosition(z*A-$*r,$*A+z*r),delete k._updatingFromChildren}}},setPosition:function(S,m){var H=this;if(!H._updatingToChildren){var T;T=2===arguments.length?{x:S,y:m}:S,Cf||H._updatingFromChildren||(H._updatingToChildren=1,Xp(H._children,T.x-H._position.x,T.y-H._position.y),delete H._updatingToChildren),ye.superClass.setPosition.call(this,T)}},setWidth:function(M){return this.setSize(M,this.getHeight())},setHeight:function(U){return this.setSize(this.getWidth(),U)},setSize:function(k,Y){1>k&&(k=1),1>Y&&(Y=1);var A=this;if(!A._updatingToChildren){2!==arguments.length&&(Y=k.height,k=k.width);var I=A.getWidth(),v=A.getHeight();if(k!==I&&ye.superClass.setWidth.call(A,k),Y!==v&&ye.superClass.setHeight.call(A,Y),!Cf&&!A._updatingFromChildren){A._updatingToChildren=1;var b=k/I,Q=Y/v;A._adjustChildScaleOrSize(b,Q,"size"),delete A._updatingToChildren,A.updateFromChildren()}}},_adjustChildScaleOrSize:function(T,e,q){var h=this;if(h._syncSize){var k=h.getPosition(),y=h.getRotation();h.getScale(),h.eachChild(function(Y){if(Bj(Y)){var o=Y.getPosition(),G=Y.getRotation(),E=Y.getWidth(),U=Y.getHeight(),m=Y.getScale(),X=m.x*E,K=m.y*U,n=new He(G,o.x,o.y,X,K);n.translate(-k.x,-k.y),n.rotate(-y),G=B(n.b*Math.sign(X),n.a*Math.sign(X)),n.scale(T,e);var u,I,R,b=g(G);if(Math.abs(b)<.001?(u=x(G),I=n.b/u,R=-n.c/u):(I=n.a/b,R=n.d/b),"scale"===q)Y.setScale(I/E,R/U);else if("size"===q){var M=I/m.x,A=R/m.y;Y.setScale(ms(I)*Math.abs(m.x),ms(R)*Math.abs(m.y)),Y.setSize(Math.max(.1,Math.abs(M)),Math.max(.1,Math.abs(A)))}n.rotate(y),n.translate(k.x,k.y),Y.setPosition(n.tx,n.ty)}})}},_calcChangeFactor:function(J,g,Z,r){var k,U,d,B;return k=C(J),U=C(Z),d=k>U?k/U:U/k,k=C(g),U=C(r),B=k>U?k/U:U/k,M(d,B)},setAnchor:function(){var o=this;if(!o._updatingToChildren){var e=o.getAnchor();if(ye.superClass.setAnchor.apply(o,arguments),!Cf&&!o._updatingFromChildren&&o._syncSize){o._updatingToChildren=1;var A=o.getAnchor();o.getPosition();var p=o.getSize(),c=o.getScale(),I=o.getRotation(),F=-p.width*c.x*(e.x-A.x),d=-p.height*c.y*(e.y-A.y),P=x(I),B=g(I),L=B*F-P*d,Y=P*F+B*d;o.eachChild(function(m){if(Bj(m)){var N=m.getPosition();m.setPosition(N.x-L,N.y-Y)}}),delete o._updatingToChildren}}},setRotation:function(h){var H=this;if(!H._updatingToChildren){var A=H.getRotation();if(ye.superClass.setRotation.apply(H,arguments),!Cf&&!H._updatingFromChildren){H._updatingToChildren=1;var i=H.getPosition(),t=h-A;H.eachChild(function(x){if(Bj(x)){var E=x.getMatrix();E.translate(-i.x,-i.y),E.rotate(t),E.translate(i.x,i.y);var I=Math.sign(x.getScale().x);x.setRotation(B(E.b*I,E.a*I)),x.setPosition(E.tx,E.ty)}}),delete H._updatingToChildren}}},setScale:function(M,x){var m=this;if(!m._updatingToChildren){null==x&&(x=M.y,M=M.x);var E=m.getScale();if(C(M)<.01&&(M=.01*(ms(M)||ms(E.x))),C(x)<.01&&(x=.01*(ms(x)||ms(E.y))),ye.superClass.setScale.call(m,M,x),!Cf&&!m._updatingFromChildren){m._updatingToChildren=1;var L=M/E.x,i=x/E.y;m._adjustChildScaleOrSize(L,i,"size"),delete m._updatingToChildren,m.updateFromChildren()}}},getSerializableProperties:function(){var j=ye.superClass.getSerializableProperties.call(this);return j.clickThroughEnabled=1,j.syncSize=1,j}});var be=i.Grid=function(){Pj(i.Grid,this)};Qd("Grid",Mf,{IRotatable:!1,_icon:"grid_icon",_image:q,getUIClass:function(){return lj},setRotation:function(){},getCellRect:function(h,w){var s=this,r=s.s("grid.row.count"),v=s.s("grid.column.count");if(0>=r||0>=v||0>h||h>=r||0>w||w>=v)return q;var L,K,G,O=s.getRect(),c=s.s("grid.row.percents"),X=s.s("grid.column.percents");if(Il(O,s,"grid.border",-1),c&&c._as&&(c=c._as),X&&X._as&&(X=X._as),c&&c.length===r){for(G=0,L=0;h>L;L++)G+=O.height*c[L];O.y+=G,O.height=O.height*c[h]}else O.height=O.height/r,O.y+=O.height*h;if(X&&X.length===v){for(K=0,L=0;w>L;L++)K+=O.width*X[L];O.x+=K,O.width=O.width*X[w]}else O.width=O.width/v,O.x+=O.width*w;return Eg(O,-s.s("grid.gap")),O}});var cq=i.Text=function(){Pj(cq,this),this.setSize(100,50),this.s("text","TEXT")};Qd("Text",Mf,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return zs},setWidth:function(N){N||(N=.001),cq.superClass.setWidth.call(this,N)},setHeight:function(y){y||(y=.001),cq.superClass.setHeight.call(this,y)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),sr("__text__",{width:{value:100,isSafeFunc:!0,func:function(B){return B._width}},height:{value:50,isSafeFunc:!0,func:function(I){return I._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Hi=i.Shape=function(){Pj(Hi,this),this._59O=new up};Hi.__de__=Mp,Qd("Shape",Mf,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Le},_22Q:function(){return qd},getLength:function(s){return fs(Dj(this._59O,this._58O,s,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var F=this._58O;return F?new up(F._as.slice(0)):F},setSegments:function(A){var v=this._58O;A=A?Rn(A)?new up(A.slice(0)):new up(A._as.slice(0)):new up,(v&&A&&v._as.join(",")!==A._as.join(",")||v!==A)&&(this._58O=A,this.fp("segments",v,A))},getPoints:function(){return this._59O},toPoints:function(){var R=this._59O;return new up(R._as.slice(0))},setPoints:function(F,f){var B=this,x=B._59O;F=F?Rn(F)?new up(F.slice(0)):new up(F._as.slice(0)):new up;var s,e,M,H,l,i;f&&(s=B.getPosition(),i=new He(B.getRotation(),0,0,B.getScale().x,B.getScale().y)),(x&&F&&x._as.join(",")!==F._as.join(",")||x!==F)&&(B._59O=F,B.fs(),B.fp("points",x,F)),f&&(e=B.getPosition(),M=e.x-s.x,H=e.y-s.y,l=i.tf(M,H),B.setPosition(e.x-M+l.x,e.y-H+l.y))},addPoint:function(J,d,c){var U=this.toPoints();U.add(J,d),this.setPoints(U,c)},setPoint:function(E,$,m){var v=this.toPoints();v.set(E,$),this.setPoints(v,m)},removePointAt:function(K){var S=this.toPoints();S.removeAt(K),this.setPoints(S)},setWidth:function(N){var w=this;if(1>N&&(N=1),!w._55I&&!Cf&&w.getWidth()){w._55I=1;var U=w._position.x,m=N/w.getWidth(),z=w.toPoints(),P=new up;z.each(function(b){P.add({x:(b.x-U)*m+U,y:b.y,e:b.e})}),w.setPoints(P);var h=w.s("shape.gradient.pack");h&&ep(h,[m,0,0,1,U*(1-m),0]),w.fs(),delete w._55I}Hi.superClass.setWidth.call(w,N)},setHeight:function(R){var L=this;if(1>R&&(R=1),!L._55I&&!Cf&&L.getHeight()){L._55I=1;var G=L._position.y,r=R/L.getHeight(),j=L.toPoints(),I=new up;j.each(function(n){I.add({x:n.x,y:(n.y-G)*r+G,e:n.e})}),L.setPoints(I);var Y=L.s("shape.gradient.pack");Y&&ep(Y,[1,0,0,r,0,G*(1-r)]),L.fs(),delete L._55I}Hi.superClass.setHeight.call(L,R)},setAnchor:function(S,U,d){var I=this;if(I._55I=!0,!Cf){var r,a,i;"number"==typeof S?i={x:S,y:U}:(i=S.length?{x:S[0],y:S[1]}:S,d=U);var t=I.getAnchor(),L=I.getSize();r=L.width*(t.x-i.x),a=L.height*(t.y-i.y),d||I.shiftPoints(r,a);var X=I.getPosition()}if(Hi.superClass.setAnchor.apply(I,arguments),!Cf){var E=I.getPosition();d&&I.shiftPoints(E.x-X.x+r,E.y-X.y+a)}delete I._55I},shiftPoints:function(q,D){var i=this,H=i.toPoints(),N=new up;H.each(function(V){N.add({x:V.x+q,y:V.y+D,e:V.e})}),i.setPoints(N),i.fs()},setPosition:function(C,I){var J,v=this;if(!v._28Q){if(v._28Q=1,!v._55I&&!Cf){J=2===arguments.length?{x:C,y:I}:C;var e=J.x-v._position.x,Z=J.y-v._position.y;if(0===e&&0===Z)return delete v._28Q,void 0;v._55I=1,v.shiftPoints(e,Z);var t=v.s("shape.gradient.pack");t&&ep(t,[1,0,0,1,e,Z]),delete v._55I}Hi.superClass.setPosition.apply(v,arguments),delete v._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var s=this;if(2!==s._59O.size())return!1;var e=s._58O;return e?2===e.size()&&1===e.get(0)&&2===e.get(1)?!0:!1:!0},fireShapeChange:function(){var g=this;if(!g._55I&&!Cf){var U=Yd(g._59O);U&&(g._55I=1,g.setRect(U),delete g._55I)}g.fp(fl,!1,!0)},getSerializableProperties:function(){var T=Hi.superClass.getSerializableProperties.call(this);return T.segments=1,T.points=1,T.thickness=1,T.closePath=1,T}});var yj=i.Polyline=function(){Pj(yj,this),this.s({"shape.background":null,"shape.border.width":2})};Qd("Polyline",Hi,{IRotatable:!1,_icon:"polyline_icon",_22Q:function(){return lq},getUIClass:function(){return ks},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setClosePath:function(){},setTall:function(m){var O=this;if(!O._24Q&&!Cf&&O.getTall()){O._24Q=1;var h=O._54O,U=m/O.getTall();O._59O.each(function(z){z.e=z.e==q?h:(z.e-h)*U+h}),O.fs(),delete O._24Q}yj.superClass.setTall.call(O,m)},setElevation:function(r){var E=this;if(!E._24Q&&!Cf){E._24Q=1;var R=r-E._54O;E._59O.each(function(j){j.e==q?j.e=r:j.e+=R}),E.fs(),delete E._24Q}yj.superClass.setElevation.apply(E,arguments)},fireShapeChange:function(){var z=this,n=z._59O;if(!z._24Q&&!Cf){var e=n.size();if(e){var j=1,E=n.get(0),N=z._54O;E.e==q&&(E.e=N);for(var W=E.e,A=0;e>j;j++){E=n.get(j),E.e==q&&(E.e=N);var S=f(W,E.e),R=M(W+A,E.e);W=S,A=R-S}z._24Q=1,z.setTall(A),z.setElevation(W+A/2),delete z._24Q}}yj.superClass.fireShapeChange.apply(z,arguments)}});var Rl=i.SubGraph=function(){Pj(Rl,this)};Qd("SubGraph",Mf,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Rl.superClass._8I.call(this),this.eachChild(function(l){Bj(l)&&l._8I()})}});var vh=i.RefGraph=function(){Pj(vh,this)};Qd("RefGraph",ye,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(P){var v=this._ref;this._ref=P,this.fp("ref",v,P),this._pendingUpdateFromChidlren=!0,this.updateRef()},_21I:function(){vh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var $=this;if($.clearChildrenFromDataModel(),$._ref&&$._dataModel){$._xhrLoadHandler&&($._xhrLoadHandler.cancel=!0);var a=Cf,g=$._xhrLoadHandler=function(e){if(e&&$._dataModel){E.loadingRefGraph=!0;var X=$._pendingUpdateInfo={needToRestore:a};a&&(X.position=$.p(),X.width=$.getWidth(),X.height=$.getHeight(),X.rotation=$.getRotation(),X.anchor=$.getAnchor(),X.scale=$.getScale()),$.p(0,0),$.setAnchor(.5,.5),$.setRotation(0),$.setScale(1,1);var P=E.parse(e),c=$._dataModel.deserialize(P,$,{justDatas:!0});c.each(function(y){y._refGraph=$}),$.checkPendingUpdateInfo(),E.loadingRefGraph=!1,E.handleRefGraphLoaded($,c,P)}};E.xhrLoad($._ref,function(k){g.cancel||g(k)})}},checkPendingUpdateInfo:function(){var w=this,T=w._pendingUpdateInfo;if(T){var S=!0;this.eachChild(function(U){(U._pendingCheckImageJSON||U._pendingUpdateInfo)&&(S=!1)}),S&&(w._pendingUpdateInfo=null,w.updateFromChildren(),T.needToRestore&&(w.setSize(T.width,T.height),w.setAnchor(T.anchor),w.setRotation(T.rotation),w.setScale(T.scale),w.p(T.position)),this.getParent()instanceof vh&&this.getParent().checkPendingUpdateInfo())}},getSerializableProperties:function(){var r=vh.superClass.getSerializableProperties.call(this);return r.ref=1,r}}),i.EdgeGroup=function(C,o){this._70O=C,this._siblings=o;for(var B,x,D=0,f=C.size(),$=X[$q];f>D;D++)if(B=C.get(D).getStyle($q,!1),B!=q){$=B;break}$==q&&($=!0);var A=E.edgeGroupAgentFunc;for(A&&(x=A(C),x&&x!==C.get(0)&&(C.remove(x),C.add(x,0))),D=0;f>D;D++)C.get(D).s($q,$)},Qd("EdgeGroup",P,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(H){return this._70O.get(H)},indexOf:function(y){return this._70O.indexOf(y)},each:function(m,F){this._70O.each(m,F)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(g,y){this._siblings.each(function(R){R._70O.each(g,y)})}});var lp=i.JSONSerializer=function(B,h){this.dm=this._dataModel=B,this._hierarchical=h==q?B.isHierarchicalRendering():h};Qd("JSONSerializer",P,{ms_ac:["hierarchical"],serialize:function(N){return E.stringify(this.toJSON(),N)},toJSON:function(){var K=this,l=K.dm,a=l.getRoots(),t=K.json={v:E.getVersion(),p:{},a:{},d:[]},X=l.getSerializableAttrs();l.getInit()&&(t.init=l.getInit()),l.getName()&&(t.p.name=l.getName()),l.getBackground()&&(t.p.background=l.getBackground()),t.p.autoAdjustIndex=l.isAutoAdjustIndex(),t.p.hierarchicalRendering=l.isHierarchicalRendering();for(var g in X){var C=l.a(g);C!==Q&&K[_f](g,C,t.a)}return lg(t.a)&&delete t.a,K._hierarchical?a.each(K.serializeData,this):l.each(function(G){K.serializeData(G)}),t},isSerializable:function(){return!0},getProperties:function(Q){return Q.getSerializableProperties()},getStyles:function(K){return K.getSerializableStyles()},getAttrs:function(K){return K.getSerializableAttrs()},serializeData:function(f){var e=this;if(e.isSerializable(f)&&!f._refGraph){var B,l,O,U,x=Gq(f.getClassName())||f.getClass(),R=new x,G={c:f.getClassName(),i:f.getId(),p:{},s:{},a:{}};e.json.d.push(G),B=e.getProperties(f);for(l in B)/^_/.test(l)?(O=f[l],O!==R[l]&&e[_f](l.substr(1),O,G.p)):(U=Bf(l),f[U]&&(O=f[U](),O!==R[U]()&&e[_f](l,O,G.p)));B=e.getStyles(f);for(l in B)O=f.s(l),O!==R.s(l)&&e[_f](l,O,G.s);B=e.getAttrs(f);for(l in B)O=f.a(l),O!==R.a(l)&&e[_f](l,O,G.a);lg(G.p)&&delete G.p,lg(G.s)&&delete G.s,lg(G.a)&&delete G.a}e._hierarchical&&f.getChildren().each(e.serializeData,e)},serializeValue:function(R,G,v){rk(G)?G={__a:G._as}:G instanceof Mb&&(G={__i:G.getId()}),v[R]=G},deserialize:function(U,H,F){Cf=!0,F=$r(F)?{setId:F}:F||{};var m=this;U=m.json=Gg(U)?E.parse(U):U,m._82I={};var T=m.dm,R=new up,p=new up,f=0,v=U.d.length;for(F.justDatas||(Xo(U.init)&&U.init(T),T.setInit(U.init));v>f;f++){var $=U.d[f],A=Gq($.c),g=new A,b=$.i;F.setId&&b!=q&&(g._id=b),m._82I[b]=g,R.add(g),p.add($)}for(f=0;v>f;f++)m.deserializeData(R.get(f),p.get(f));if(R.each(function(E){H&&!E.getParent()&&E.setParent(H),T.add(E)}),!F.justDatas){for(var r in U.a)T.a(r,m[yh](U.a[r]));for(var Y in U.p)T[Mh(Y)](U.p[Y])}return Cf=!1,R},deserializeData:function(L,v){for(var F in v.p)L[Mh(F)](this[yh](v.p[F]));for(F in v.s)L.s(F,this[yh](v.s[F]));for(F in v.a)L.a(F,this[yh](v.a[F]))},deserializeValue:function(E){if(qc(E)){var V=E.__i;if(V!=q)return this._82I[V];if(V=E.__a,Rn(V))return new up(V)}return E}}),Ij(Gi,{serialize:function(m,q){return new lp(this,q).serialize(m)},toJSON:function(O){return new lp(this,O).toJSON()},deserialize:function(P,G,e){return new lp(this).deserialize(P,G,e)}}),Df.GraphView=function($){var c=this;c._24I={},c._34I=new up,c._25I={},c._56I={},c._view=wk(1,c),c._canvas=ld(c._view),c.dm($?$:new Gi),c.setEditable(!1),c.setScrollBarVisible(E.graphViewScrollBarVisible)},_l("GraphView",P,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:["layers",wl,Yl,Pd,us,"resettable","editInteractor",co,"pannable","rectSelectable","autoScrollZone",Rm,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:E.graphViewResettable,_pannable:E.graphViewPannable,_rectSelectable:E.graphViewRectSelectable,_autoScrollZone:E.graphViewAutoScrollZone,_rectSelectBackground:E.graphViewRectSelectBackground,_rectSelectBorderColor:E.graphViewRectSelectBorderColor,_editPointSize:E.graphViewEditPointSize,_editPointBorderColor:E.graphViewEditPointBorderColor,_editPointBackground:E.graphViewEditPointBackground,_scrollBarColor:Sj,_scrollBarSize:cr,_autoHideScrollBar:cb,_autoMakeVisible:jo,setEditable:function(R){var v=this,g=Df.XEditInteractor;R?(v._uieditable=!0,v.setInteractors([new Hp(v),new gi(v),g?new g(v):new Ep(v),new sg(v),new Aq(v),new bl(v,{editable:!1})])):(v._uieditable=!1,v.setInteractors([new Hp(v),new gi(v),new sg(v),new Aq(v),new bl(v,{editable:!1})]))},getCanvas:function(){return this._canvas},_33I:function(y){var g=y.getUIClass();return g?new g(this,y):q},getDataUI:function(v){var d=this,p=d._25I[v._id];return p===Q&&(p=d._33I(v),d._25I[v._id]=p),p},getNodeRect:function(D){return E.getNodeRect(this,D)},getEdgeInfo:function(F){var v=this.getDataUI(F);return v?(v._79o(),v._78o):null},invalidateAll:function(O){var W=this;if(O){for(var P in W._25I){var I=W._25I[P];I&&I.dispose()}W._25I={},W._56I={},W._24I={},W._34I.clear(),W.redraw()}else W.dm().each(function(S){W.invalidateData(S)})},invalidateSelection:function(){var B=this;B.sm().each(function($){B.invalidateData($)})},invalidateData:function(E){var c=this;c._24I[E._id]=E,c._21Q(E),c.iv()},_21Q:function(P){var z=this,y=z._24I;if(Rf(P)&&qq[P.s(Li)]){var g=P.getSourceAgent();g&&g.getAgentEdges().each(function(O){y[O._id]=O}),g=P.getTargetAgent(),g&&g.getAgentEdges().each(function(R){y[R._id]=R}),z.iv()}},redraw:function(G){var C=this;C._32I||(G?C._34I.add(G):(C._32I=1,C._34I.clear()),C.iv())},each:function(y,u){var $,k,Q,r=0,X=this._layers,p=this._dataModel,f=p._datas._as,P=f.length;if(X){for(var x=X.length;x>r;r++)if(Q=X[r],p.isHierarchicalRendering()){if(this._dataModel.eachByHierarchical(y,null,u)===!1)return}else for(var v=0;P>v;v++)if($=f[v],$._layer===Q&&(k=u?y.call(u,$):y($),k===!1))return}else if(p.isHierarchicalRendering())this._dataModel.eachByHierarchical(y,null,u);else for(;P>r;r++)if($=f[r],k=u?y.call(u,$):y($),k===!1)return},reverseEach:function(A,n){var l,$,V,X,H=this._layers,F=this._dataModel,r=F._datas._as,h=r.length;if(H){for(l=H.length-1;l>=0;l--)if(X=H[l],F.isHierarchicalRendering()){if(F.reverseEachByHierarchical(A,null,n)===!1)return}else for(var v=h-1;v>=0;v--)if($=r[v],$._layer===X&&(V=n?A.call(n,$):A($),V===!1))return}else if(F.isHierarchicalRendering())F.reverseEachByHierarchical(A,null,n);else for(l=h-1;l>=0;l--)if($=r[l],V=n?A.call(n,$):A($),V===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var C=this,A=C._84I;if(!A){var D=this.dm().a("width"),Y=this.dm().a("height");D>0&&Y>0?C._84I={x:0,y:0,width:D,height:Y}:(C.each(function(F){C.isVisible(F)&&(A=Uo(A,C.getDataUIBounds(F)))}),C._84I=A?A:Cm)}return C._84I},getScrollRect:function(){return Uo(this.getContentRect(),this._29I)},makeCenter:function(x,G,H){var c=this;if(!c.getWidth()||!c.getHeight())return H||Ce(c.centerData,c,[x,G,!0],200),void 0;c.makeVisible(x),c.validate();var L=c.getDataUIBounds(x);if(L){var U=c.getWidth(),p=c.getHeight(),s=L.x+L.width/2,K=L.y+L.height/2,a=-s*c._zoom+U/2,Z=-K*c._zoom+p/2;c.setTranslate(a,Z,G)}},fitData:function(R,d,z,C,V){var r=this;if(!r.getWidth()||!r.getHeight())return V||Ce(r.fitData,r,[R,d,z,C,!0],200),void 0;var i=function(){r.makeVisible(R),r.validate();var Z=r.getDataUIBounds(R);Z&&(Z=ji(Z),Eg(Z,z==q?20:z),r.fitRect(Z,d,C))};d?E.callWhenLoaded(i):i()},fitContent:function(P,I,K,c){var S=this;if(!S.getWidth()||!S.getHeight())return c||Ce(S.fitContent,S,[P,I,K,!0],200),void 0;var x=function(){S.validate();var a=ji(S.getContentRect());Eg(a,I==q?20:I),S.fitRect(a,P,K)};P?E.callWhenLoaded(x):x()},fitRect:function(Z,I,n){var e=this,b=e.getWidth(),r=e.getHeight(),C=Z.x+Z.width/2,g=Z.y+Z.height/2,m=f(b/Z.width,r/Z.height),x=e._zoom,t=-C*x+b/2,M=-g*x+r/2;0===m||isNaN(m)||(n&&(m=f(1,m)),I?e.setTranslate(t,M,{finishFunc:function(){e.setZoom(m,I)}}):(e.setTranslate(t,M),e.setZoom(m)))},toCanvas:function(a,t){t=t||this._zoom,this.validateImpl();var T=this,f=T.getContentRect();f.width||(f.width=10),f.height||(f.height=10);var d=ld(),u=f.x*t,I=f.y*t,J=f.width*t,V=f.height*t;Pm(d,J,V,1);var W=Pg(d);return a=a||this._dataModel.getBackground(),a&&Kc(W,0,0,J,V,a),_e(W,-u,-I),W.scale(t,t),T._42(W),W.restore(),d},toDataURL:function(u,X,n){return this.toCanvas(u,n).toDataURL(X||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(u,W){var $,O,L=this;L._93db(u,W),L.each(function(I){L._56I[I._id]&&($=L.getDataUI(I),$&&(O=$._79o(),i.HtmlNode&&I instanceof i.HtmlNode?$._42(u):(!W||jq(W,O))&&$._42(u)))}),L._92db(u,W)},validateImpl:function(){var I,b,t,P,R,x=this,N=x.tx(),d=x.ty(),F=x._zoom,X=x._canvas,K=this.getWidth(),$=this.getHeight(),D=x._29I,Z={x:-N/F,y:-d/F,width:K/F,height:$/F},H={},w=x._34I,A=x._24I,e=x._32I,S=x._23I;x._24I={},(K!==X.clientWidth||$!==X.clientHeight)&&(Pm(X,K,$),e=1),e||nq(Z,D)||(e=1),x._29I=Z,x.each(function(K){b=K._id;var n=H[b]=x.isVisible(K);n!==x._56I[b]&&(A[b]=K,t=x.getDataUI(A[b]),t&&t._84o(n),x._84o(K,n))},x);for(b in A)t=x.getDataUI(A[b]),t&&(!e&&x._56I[b]&&(R=t._79o(),R&&w.add(R)),t.invalidate()),x._83I=1;if(x._56I=H,!e)for(b in A)H[b]&&(t=x.getDataUI(A[b]),t&&(R=t._79o(),R&&w.add(R)));if(e?P=Z:(w.each(function($){jq(Z,$)&&(P=Uo(P,$))}),P&&(Eg(P,M(1,1/F)),P.x=l(P.x*F)/F,P.y=l(P.y*F)/F,P.width=z(P.width*F)/F,P.height=z(P.height*F)/F,P=di(Z,P))),x._74O=P,P&&(I=Pg(X),yr(I,N,d,F),I.beginPath(),I.rect(P.x,P.y,P.width,P.height),I.clip(),I.clearRect(P.x,P.y,P.width,P.height),x._42(I,P),I.restore(),delete x._74O),w.clear(),delete x._32I,S&&K>0&&$>0){var t=x.getDataUI(S);if(t){var R=t._79o(),o=x._29I,i=o.x,G=o.y,J=o.width,r=o.height,F=x._zoom;R&&!jq(R,o)&&(R.x+R.width<i&&x.tx(-R.x*F),R.x>i+J&&x.tx(-(R.x+R.width-J)*F),R.y+R.height<G&&x.ty(-R.y*F),R.y>G+r&&x.ty(-(R.y+R.height-r)*F))}delete x._23I}x._83I&&(delete x._83I,delete x._84I),x._98O(),lg(x._24I)||Ce(x.iv,x)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(y){var n=this;y!==n.isScrollBarVisible()&&(y?(gd(n._view,n._79O=ao()),gd(n._79O,n._27I=ao()),gd(n._79O,n._28I=ao())):(Ad(n._79O),delete n._79O,delete n._27I,delete n._28I),n.fp("scrollBarVisible",!y,y))},showScrollBar:function(){var C=this;C._79O&&(C._85I||(u(function(){C._86I()},Yf),C.iv()),C._85I=new Date)},_86I:function(){var n=this;if(n._85I){var Y=new Date,D=Y.getTime();D-n._85I.getTime()>=Yf?(delete n._85I,n.iv()):u(function(){n._86I()},Yf)}},_98O:function(){var L=this,C=this._27I,K=this._28I;if(L._79O){if(L._autoHideScrollBar&&!L._85I)return C.style.visibility=cl,K.style.visibility=cl,void 0;var m=L.getScrollBarColor(),x=L._zoom,l=L.getScrollBarSize(),Z=L.getViewRect(),q=L.getScrollRect(),r=Z.height*x,Q=q.height*x,p=Z.width*x-l-2,s=r*((Z.y-q.y)*x/Q),t=r*(r/Q),v=C.style;Q-.5>r?(Vo>t&&(s=s+t/2-Vo/2,0>s&&(s=0),s+Vo>r&&(s=r-Vo),t=Vo),Mj(C,p,s,l,t),v.visibility=hd,v.background=m,v.borderRadius=l/2+jm):v.visibility=cl;var b=Z.width*x,D=q.width*x,s=Z.height*x-l-2,p=b*((Z.x-q.x)*x/D),k=b*(b/D),v=K.style;D-.5>b?(Vo>k&&(p=p+k/2-Vo/2,0>p&&(p=0),p+Vo>b&&(p=b-Vo),k=Vo),Mj(K,p,s,k,l),v.visibility=hd,v.background=m,v.borderRadius=l/2+jm):v.visibility=cl}},setDataModel:function(s){var t=this,N=t._dataModel,n=t._selectionModel;N!==s&&(N&&(N.ump(t.handleDataModelPropertyChange,t),N.umm(t.handleDataModelChange,t),N.umd(t.handleDataPropertyChange,t),N.removeIndexChangeListener(t._75O,t),N.removeHierarchyChangeListener(t.handleHierarchyChange,t),n||N.sm().ums(t.handleSelectionChange,t)),t._dataModel=s,s.mp(t.handleDataModelPropertyChange,t),s.mm(t.handleDataModelChange,t),s.md(t.handleDataPropertyChange,t),s.addIndexChangeListener(t._75O,t),s.addHierarchyChangeListener(t.handleHierarchyChange,t),n?n._21I(s):s.sm().ms(t.handleSelectionChange,t),t.invalidateAll(!0),t.fp(Nn,N,s),t._canvas.style.background=s.getBackground()||"")},handleDataModelPropertyChange:function(W){if("background"===W.property){var e=this._canvas.style.background,y=W.newValue||"";this._canvas.style.background=y,this.fp("canvasBackground",e,y)}else"a:width"===W.property||"a:height"===W.property?(this._83I=1,this.redraw()):"hierarchicalRendering"===W.property&&this.redraw()},handleDataPropertyChange:function(P){this.dm().isHierarchicalRendering()&&"parent"===P.property&&P.data.hasChildren()&&this.redraw(),this.invalidateData(P.data)},onPropertyChanged:function(F){var q=this,e=F.property;if(q.redraw(),"zoom"===e){var a=q.sm().getSelection();a.size()&&a.each(function(H){H.invalidate()})}$i[e]?q.showScrollBar():e===co&&q.onCurrentSubGraphChanged(F)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(U){var d=this,k=U.kind,w=U.data;if(d._83I=1,"add"===k)d.invalidateData(w),Rf(w)&&w.getEdgeGroup()&&w.getEdgeGroup().eachSiblingEdge(d.invalidateData,d);else if(k===dm){d._21Q(w);var e=w._id,B=d._25I[e];if(B){if(d._56I[e]){var i=B._79o();i&&d.redraw(i)}B.dispose(),delete d._25I[e],delete d._24I[e],delete d._56I[e]}w===d._currentSubGraph&&d.setCurrentSubGraph(q)}else k===Hn&&(d.invalidateAll(!0),d.setCurrentSubGraph(q))},_75O:function(o){this.invalidateData(o.data)},handleHierarchyChange:function(H){this.dm().isHierarchicalRendering()&&H.data.hasChildren()&&this.redraw(),this.invalidateData(H.data)},adjustIndex:function(Z){var C=this;if(C.isVisible(Z)){for(var M=Z;M._parent&&C.isVisible(M._parent);)M=M._parent;M&&M!==Z&&C._dataModel.adjustIndex(M),C._dataModel.adjustIndex(Z)}},getSelectWidth:function(t){return t.s("select.width")},isSelectable:function(u){return u.getParent()instanceof ye&&!u.getParent().isClickThroughEnabled()?!1:u instanceof ye&&u.isClickThroughEnabled()?!1:u.s("2d.selectable")&&this.sm().isSelectable(u)},isMovable:function(d){var u=this;return Rf(d)&&d.getStyle(Li)!==Ko?!1:d instanceof ye&&d.isClickThroughEnabled()?!1:d.s("2d.movable")?u._movableFunc?u._movableFunc(d):!0:!1},isEditable:function(H){var $=this;if(H instanceof ye&&H.isClickThroughEnabled())return!1;if(i._uiSerializing)return $._uieditable;if(!$._editInteractor||!$.isSelected(H))return!1;
if(Gd(H)){var F=$.getDataUI(H);if(!F||F._88I)return!1}return Rf(H)&&H.getStyle(Li)!==Ko?!1:H.s("2d.editable")?$._editableFunc?$._editableFunc(H):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(F){return Bj(F)&&0!==F.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(F):!0},isRectEditable:function(H){return this._rectEditableFunc?this._rectEditableFunc(H):!0},isAnchorEditable:function(p){return this._anchorEditableFunc?this._anchorEditableFunc(p):!0},isRotationEditable:function(e){return e.setRotation&&e.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(e):!0:!1},getRotationPoint:function(u){var t=u.getAnchor(),F=u.getScale(),v=this._zoom,Z=kg(u.getRotation(),0,-u.getHeight()*F.y*t.y-(F.y<0?-1:1)*(e?32:16)/v),O=u.p();return Z.x+=O.x,Z.y+=O.y,Z},getLogicalPoint:function(P){var l=this;return Ud(P,l._canvas,l.tx(),l.ty(),l._zoom,l._zoom)},getSelectedDataAt:function(I){var R=this;return this.getDataAt(I,function(j){return R.isSelected(j)})},getDataAt:function(L,z,K){L.target&&(L=this.lp(L));var T,j=this._zoom;return this.reverseEach(function(y){return(z?z(y):this.isSelectable(y))&&this.rectIntersects(y,gp(L.x,L.y,K,j))?(T=y,!1):void 0},this),T},getIconInfoAt:function(d,P){var j=this;if(d.target&&(d=j.lp(d)),P||(P=j.getDataAt(d)),P){var L=j.getDataUI(P);if(L&&L._38o){var l,h=L._38o,Z=new up;for(l in h.icons)Z.add(l);for(var m=Z.size()-1;m>=0;m--){l=Z.get(m);for(var e=h.rects[l],z=e.rotation,D=e.length-1;D>=0;D--){var V=e[D],u=V.width,v=V.height,S={x:d.x-V.x-u/2,y:d.y-V.y-v/2};z!=q&&(S=kg(-z,S.x,S.y));var V={x:-u/2,y:-v/2,width:u,height:v};if(vg(V,S))return{key:l,index:D,name:h.icons[l].names[D],rect:e[D],point:d,rotation:z,relativeRect:V,relativePoint:S,data:P}}}}}return q},getDatasInRect:function(v,F,m){m===Q&&(m=1);var C=this,w=new up;return C.reverseEach(function(N){m&&!C.isSelectable(N)||(F?C.rectIntersects(N,v):C.rectContains(N,v))&&w.add(N)}),w},moveSelection:function(I,P){var B,L=this,d=L.dm();d&&(B=d.getHistoryManager()),B&&B.beginInteraction(),Xp(L.sm().toSelection(L.isMovable,L),I,P),B&&B.endInteraction()},moveDatas:function(x,z,Y){var y,h=this,m=h.dm();m&&(y=m.getHistoryManager()),y&&y.beginInteraction(),x instanceof up||(x=new up(x)),Xp(x,z,Y),y&&y.endInteraction()},getDataUIBounds:function(X){var z=this.getDataUI(X);return z?z._79o():q},drawData:function(h,d){var m=this.getDataUI(d);m&&(m._79o(),m._42(h)),d instanceof i.Block&&d.eachChild(function(i){this.drawData(h,i)},this)},getBoundsForGroup:function(u){return u.s(Lg)?this.getDataUIBounds(u):q},rectIntersects:function(O,D){this.validate();var V=q;if(this._56I[O._id]){var M=this._25I[O._id];if(M){var y=M._79o();if(Ld(D,y))V=!0;else if((D=di(D,y))&&(M.rectIntersects&&(V=M.rectIntersects(D)),V==q)){if(!O.s("pixelPerfect"))return!0;var A=D.x,j=D.y,e=D.width,n=D.height,d=this._zoom,f=E.hitMaxArea,o=e*n*d*d;if(o>f){var m=Math.sqrt(f/o);d*=m}e*=d,n*=d,A*=d,j*=d;var r=nd(e,n);_e(r,-A,-j),r.scale(d,d),this._drawForChecking=!0,this.drawData(r,O),this._drawForChecking=!1;try{for(var t=0,K=r.getImageData(0,0,e,n).data;t<K.length;t+=4)if(0!==K[t+3]){V=!0;break}r.restore()}catch(P){Xc=q,V=!0}}}}return V?!0:!1},rectContains:function(T,L){if(this._56I[T._id]){var D=this._25I[T._id];if(D)return Ld(L,D._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(B){if(!E.isInput(B.target)){var i=this,y=i._focusData,O=y&&i._25I[y._id],h=0,w=i._dataModel._datas;if(!(y&&y._enabled&&y._editable&&O&&O.onKeyDown&&O.onKeyDown(B)===!0))if(9===B.keyCode&&(y&&(h=w.indexOf(y),Wi(B)?-1===--h&&(h=0):++h===w.size()&&(h=0)),i._focusData=y=w.get(h),i.sm().setSelection(y)),uk(B)?i.selectAll():Rb(B)&&i.isResettable()&&i.reset(),i.sm().isEmpty()){if(i._editing)return;var F=i.tx(),g=i.ty(),C=!1,r=Wi()?100:10;Bn(B)&&(F-=r,C=!0),Br(B)&&(g-=r,C=!0),fn(B)&&(F+=r,C=!0),Dp(B)&&(g+=r,C=!0),C&&i.setTranslate(F,g)}else{Ii(B)&&i.handleDelete(B);var S=Wi()?10:1;Bn(B)&&(i.moveSelection(-S,0),i.fi({kind:"moveLeft"})),Br(B)&&(i.moveSelection(0,-S),i.fi({kind:"moveUp"})),fn(B)&&(i.moveSelection(S,0),i.fi({kind:"moveRight"})),Dp(B)&&(i.moveSelection(0,S),i.fi({kind:"moveDown"}))}}},handleScroll:function(a,j){br(a);var C=this.lp(a);j>0?this.scrollZoomIn(C):0>j&&this.scrollZoomOut(C)},handlePinch:function(K,k,A){this._68I||(k>A?this.pinchZoomIn(K):this.pinchZoomOut(K))},checkDoubleClickOnNote:function(T,Q){var Y=this,k=Y.lp(T),O=Y.getDataUI(Q),A=O.note2Info;return A&&Q.s("note2.toggleable")&&vg(A.clickRect,k)?(Q.s(Mr,!Q.s(Mr)),Y.fi({kind:"toggleNote2",event:T,data:Q}),!0):(A=O.noteInfo,A&&Q.s("note.toggleable")&&vg(A.clickRect,k)?(Q.s(ho,!Q.s(ho)),Y.fi({kind:"toggleNote",event:T,data:Q}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Y,R){var c=this,s=c.getAutoScrollZone(),M=s/c.getZoom(),X=s/4,j=c._29I,u=c.lp(Y),D={x:c.tx(),y:c.ty()};return u&&s>0&&j&&(u.x-j.x<M?c.translate(X,0):j.x+j.width-u.x<M&&c.translate(-X,0),u.y-j.y<M?c.translate(0,X):j.y+j.height-u.y<M&&c.translate(0,-X)),D.x=c.tx()-D.x,D.y=c.ty()-D.y,R&&(R.x+=D.x,R.y+=D.y),D},getMoveMode:function(P,d){var m=d.s("2d.move.mode");return m?m:qn["88"]?"x":qn["89"]?"y":"xy"},getSerializableProperties:function(){return{layers:1,scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(W,s,u){var P=this;return"currentSubGraph"===s?{__i:W.getId()}:u.serializeProperty(W,s,P)},deserializeProperty:function(l,U,J){var u=this;if("currentSubGraph"===U){var v=u.dm(),P=v.__idMap;return P[l.__i]}return J.deserializeProperty(l,U,u)}});var nc=function(Z,p){var M=this;M.gv=Z,M.s=function(i){return p.getStyle(i)},M._data=p,M._87I=new up};re(nc,P,{_6I:q,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var M=this,c=M.gv.isSelected(M._data);return!c||M.isShadowed()?0:M.gv.getSelectWidth(M._data)},getBodyColor:function(g){var C=this._data,l=this.gv.getBodyColor(C);return l?l:g?C.getStyle(g):q},_2Q:function(u){return this.s(u)},_1Q:function(e,C,q,T){var V=this.s,g=V(C+".dash.color");e.strokeStyle=g,e.lineWidth=q,e.stroke(),V(C+".dash.3d")&&wn(e,g,V(C+".dash.3d.color"),q,this.gv._zoom,V(C+".dash.3d.accuracy")),zg(e,T)},invalidate:function(){this._6I=q},_79o:function(){var D=this;if(!D._6I){D.labelInfo=D.label2Info=D.noteInfo=D.note2Info=D._38o=q,D._87I.clear(),D._3O();var Q=D._data,S=D.gv;D._55O=S.isEditable(Q)?{_42O:S.isRectEditable(Q),_43O:S.isPointEditable(Q),_56O:S.isRotationEditable(Q)}:q,D._6I=D._81o()}return D._6I},_3O:function(){},getPosition:function(){return Cm},_68o:function(V,$){V&&this._87I.add(ok(V,$))},_81o:function(){var T=this,p=T.s;T._24O(or,"getLabel"),T._24O(Rg,"getLabel2"),T._26O(js,"getNote"),T._26O(pl,"getNote2"),T._15O(),T._55O&&T._48O();var h;if(T._87I.each(function(w){h=Uo(h,w)}),h&&T.isShadowed()){var c=ji(h);c.x+=p("shadow.offset.x"),c.y+=p("shadow.offset.y"),Eg(c,p("shadow.blur")),h=Uo(h,c)}return T._87I.clear(),h},_42:function(k){var U=this,u=U._data,r=U.gv,J=U.s,W=J("opacity"),g=this.isShadowed();if(g){var c=k.shadowOffsetX,R=k.shadowOffsetY,i=k.shadowBlur,G=k.shadowColor,A=r.getZoom();k.shadowOffsetX=J("shadow.offset.x")*A,k.shadowOffsetY=J("shadow.offset.y")*A,k.shadowBlur=J("shadow.blur")*A,k.shadowColor=J("select.color")}if(W!=q){var T=k.globalAlpha;k.globalAlpha=W}U._80o(k),r.isLabelVisible(u)&&((!r._drawForChecking||J("label.selectable"))&&zk(k,U.labelInfo),(!r._drawForChecking||J("label2.selectable"))&&zk(k,U.label2Info)),r.isNoteVisible(u)&&(_o(k,U.noteInfo),_o(k,U.note2Info)),U._99O(k),W!=q&&(k.globalAlpha=T),g&&(k.shadowOffsetX=c,k.shadowOffsetY=R,k.shadowBlur=i,k.shadowColor=G)},_80o:function(){},_47O:function(){},_24O:function(Q,D){var v=this,n=v._data,y=v.gv,p=v.s,g=y[D](n);if(g!=q){var o=p(Q+".scale"),J=p(Q+".max"),k=p(Q+".position"),L=v[Q+"Info"]={label:g,scale:o,color:y[D+"Color"](n),font:p(Q+".font"),opacity:p(Q+".opacity"),align:p(Q+".align"),rotation:v.getRotation(p(Q+".rotation"),!1,k),background:y[D+"Background"](n)},$=$o(L,g);J>0&&J<$.width&&(L.labelWidth=$.width,$.width=J),1!==o&&($.width*=o,$.height*=o);var f=v.getPosition(k,p(Q+".offset.x"),p(Q+".offset.y"),$,p(Q+".position.fixed"));if($.x=f.x-$.width/2,$.y=f.y-$.height/2,v._68o(L.rect=$,L.rotation),1!==o){var T=$.width/o,P=$.height/o;L.rect={x:f.x-T/2,y:f.y-P/2,width:T,height:P}}}},_26O:function(g,Y){var $=this,I=$.gv,m=$._data,P=$.s,y=I[Y](m);if(y!=q){var T,K,e=P(g+".scale"),u=$[g+"Info"]={note:y,scale:e,data:m,view:I,expanded:P(g+".expanded"),font:P(g+".font"),color:P(g+".color"),opacity:P(g+".opacity"),align:P(g+".align"),icon:P(g+".icon"),backgroundImage:P(g+".backgroundImage"),borderWidth:P(g+".border.width"),borderColor:P(g+".border.color"),background:I[Y+"Background"](m)},d=$.getPosition(P(g+".position"),P(g+".offset.x"),P(g+".offset.y")),E=d.x,p=d.y;if(u.expanded){var L,c=P(g+".max"),F=P(g+".backgroundImage");F?(F=fo(F),L={width:Uh(F,m),height:yn(F,m)}):L=$o(u,y),L.width+=6,L.height+=2,c>0&&c<L.width&&(u.labelWidth=L.width,L.width=c),T=L.width,K=L.height+8,u.clickRect={x:E-T*e/2,y:p-K*e,width:T*e,height:K*e*L.height/K}}else{var i=P(g+".icon");i?(i=fo(i),T=Uh(i,m),K=yn(i,m)):(T=12,K=18),u.clickRect={x:E-T*e/2,y:p-K*e,width:T*e,height:K*e}}u.rect={x:E-T/2,y:p-K*e/2-K/2,width:T,height:K};var R=z(u.borderWidth/2)*e;$._68o({x:E-T*e/2-R,y:p-K*e-R,width:T*e+2*R,height:K*e+2*R})}},_48O:function(){},_99O:function(E){var k=this,C=k._38o;if(C){var o=k.gv,i=k._data,M=C.icons;for(var j in M){var b=M[j],O=C.rects[j];if(O){var B=mj(b.opacity,i,o),l=mj(b.names,i,o),p=l?l.length:0,H=O.rotation;if(B!=q){var h=E.globalAlpha;E.globalAlpha*=B}for(var V=0;p>V;V++){var f=l[V],u=fo(f),A=O[V];if(H){var r=A.x+A.width/2,y=A.y+A.height/2;E.save(),_e(E,r,y),zq(E,H),_e(E,-r,-y)}Sk(E,u,mj(b.stretch,i,o),A.x,A.y,A.width,A.height,k._data,k.gv),H&&E.restore()}B!=q&&(E.globalAlpha=h)}}}}});var Ql=function(e,i){Pj(Ql,this,[e,i])};re(Ql,nc,{_checkEmptyRect:!0,_40O:function(q,D){var R=this,J=R.s,w=q.rect;(q.borderColor=R.gv.getBorderColor(R._data))&&(q.borderType=J("border.type"),q.borderWidth=J("border.width"),q.borderPadding=J("border.padding"),D=M(D,q.borderPadding+q.borderWidth/2));var Z=R._data.getScale(),r=M(1,M(C(Z.x),C(Z.y)));if(q.selectWidth=R.getSelectWidth()){var p=R.gv._zoom;q.selectType=J("select.type"),q._97o=J("select.color"),q.selectPadding=J("select.padding"),D=M(D,(q.selectPadding+q.selectWidth/2)/p/r)}D>0&&(D*=r,w=ji(w),Eg(w,D)),R._68o(w)},_39O:function(z,J){var c,T=this,P=J.rect;if(J.borderWidth>0&&(c=J.borderPadding,z.strokeStyle=J.borderColor,z.lineWidth=J.borderWidth,rn(z,J.borderType,{x:P.x-c,y:P.y-c,width:P.width+2*c,height:P.height+2*c}),z.stroke()),J.selectWidth>0){var u=T.gv._zoom;if(c=J.selectPadding/u,z.strokeStyle=J._97o,z.lineWidth=J.selectWidth/u,J.rotation!=q){z.save(),z.translate(J.position.x,J.position.y),z.rotate(J.rotation);var Z=T._data,Q=Z.getWidth(),v=Z.getHeight(),H=J.scale,K=J.anchor;P={x:H.x*-Q*K.x,y:H.y*-v*K.y,width:H.x*Q,height:H.y*v}}rn(z,J.selectType,{x:P.x-c,y:P.y-c,width:P.width+2*c,height:P.height+2*c}),J.rotation!=q&&z.restore(),z.stroke()}},_3O:function(){var Q=this,h=Q.s,c=Q._data,o=c.getStyle(fl),e=Q.getBodyColor(),b=Q._83o=o?{shape:o,_53o:Q.getBodyColor("shape.background"),_27Q:fo(h("shape.repeat.image"),e),shapeGradientPack:h("shape.gradient.pack"),_54o:h("shape.border.width"),_55o:h("shape.border.color"),_56o:h("shape.border.3d"),_57o:h("shape.border.3d.color"),_58o:h("shape.border.3d.accuracy"),shapeGradient:h("shape.gradient"),_59o:h("shape.gradient.color"),_60o:h("shape.border.pattern"),_61o:h("shape.border.cap"),_62o:h("shape.border.join"),bodyColor:e}:{img:fo(c.getImage(),e),bodyColor:e,stretch:h("image.stretch")};if(j&&!T);else{b.rect=c.getRect(),b.position=c.p(),b.scale=c.getScale(),b.anchor=c.getAnchor(),b.rotation=c.getRotation(),o===wb&&(b._63o=h("shape.depth"));var I=0;if(o)I=Rq(q,b._54o/2,b._62o),Q.s("shape.dash")&&(I=M(I,(Q.s("shape.dash.width")||b._54o)/2));else if(b.img&&b.img.boundExtend)if(I=mj(b.img.boundExtend,c,Q.gv),b.img.boundExtendAbsolute){var z=c.getScale();I/=Q.gv._zoom*M(1,M(C(z.x),C(z.y)))}else if(!b.img.fitSize){var n=mj(b.img.width,c,Q.gv),l=mj(b.img.height,c,Q.gv);I*=M(c.getWidth()/n,c.getHeight()/l)}Q._40O(b,I);var x=h("clip.percentage");if(1>x&&(0>x&&(x=0),b.clipRect=mm(c.getAnchorRect(),h("clip.direction"),x)),o){var O=h("shape.fill.clip.percentage");1>O&&(0>O&&(O=0),b.shapeClipRect=mm(c.getAnchorRect(),h("shape.fill.clip.direction"),O))}}},getPosition:function(l,O,Y,x){var I=Un(l,this._83o.rect,x);return I.x+=O,I.y+=Y,I},_80o:function(f){var e=this,B=e.s,S=e.gv,n=e._data,P=e._83o,d=P.rect,W=P.position,X=P.rotation,Y=P.anchor,b=P.scale,p=P.shape,J=P.clipRect;if(!e._checkEmptyRect||d.width>0&&d.height>0){var i=n.getSize();if(i.x=-i.width*Y.x,i.y=-i.height*Y.y,f.save(),_e(f,W.x,W.y),zq(f,X),Qe(f,b.x,b.y),J&&(f.beginPath(),f.rect(J.x,J.y,J.width,J.height),f.clip()),e.freeDraw)e.freeDraw(f,i,P);else if(p){var r,q,D,o,u=P._60o,E=Cb(f,u),l=P._53o,N=P._27Q,I=P._54o,V=P._55o,y=P.shapeGradientPack,c=f.lineJoin,T=f.lineCap;if("roundRect"===p?r=B("shape.corner.radius"):"polygon"===p?r=B("shape.polygon.side"):"arc"===p&&(r=B("shape.arc.from"),q=B("shape.arc.to"),D=B("shape.arc.close"),o=B("shape.arc.oval")),f.lineJoin=P._62o,f.lineCap=P._61o,l||N||y){var O=P.shapeClipRect;O&&(f.save(),f.beginPath(),f.rect(O.x,O.y,O.width,O.height),f.clip()),rn(f,p,i,r,q,D,o),y?Eo(f,y):N?zd(f,N,P.bodyColor,null,n,S):Fl(f,l,P.shapeGradient,P._59o,i),f.fill(),O&&f.restore(),y&&f.restore(),f!==E&&rn(E,p,i,r,q,D,o)}else rn(E,p,i,r,q,D,o);if(I>0){var K=B("shape.border.width.absolute");K&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=I,f.strokeStyle=V,f.stroke(),K&&f.restore(),P._56o&&wn(f,V,P._57o,I,S._zoom,P._58o)}if(zg(f,u),B("shape.dash")){var M=B("shape.dash.width")||I;if(M>0){u=B("shape.dash.pattern");var E=Cb(f,u,e._2Q("shape.dash.offset"));E!==f&&rn(E,p,i,r,q,D,o),e._1Q(f,"shape",M,u)}}Wj(f,l,P._63o,i),f.lineJoin=c,f.lineCap=T}else Sk(f,P.img,P.stretch,i.x,i.y,i.width,i.height,n,S,P.bodyColor);f.restore()}e._39O(f,P)},_48O:function(){},_47O:function(){}});var mi=function(j,i){Pj(mi,this,[j,i])},ip=function(O,I,P,o){var r=Ip(O,I);return P=o?f(P,r):am(P,r),r?P/=r:P=0,{x:O.x+(I.x-O.x)*P,y:O.y+(I.y-O.y)*P}};re(mi,nc,{_3O:function(){var D,L=this,e=L._data,g=L.gv,F=L.s,U=F(Li),p=e.isLooped(),k=F("edge.width"),V=F("edge.center"),o=F("edge.offset"),n=g.getBorderColor(e),I=n?F("border.width"):0,Y=L.getSelectWidth(),j=e._40I,J=e._41I,u=L._78o=j&&J?{looped:p,type:U,width:k,center:V,color:L.getBodyColor("edge.color"),borderColor:n,borderWidth:I,_97o:Y?F("select.color"):q,selectWidth:Y,pattern:F("edge.pattern"),cap:F("edge.cap"),join:F("edge.join"),is3d:F("edge.3d"),_67o:F("edge.3d.color"),_66o:F("edge.3d.accuracy")}:q;if(u){var $=E.getEdgeType(U);if($){var S=$(e,Hr(L,g,e,p,U),g,L._19Q);S.points&&S.points.size()>1&&(u._4O=S,D=Yd(u._4O.points))}else{var X=F("edge.source.anchor.x"),t=F("edge.source.anchor.y"),r=F("edge.target.anchor.x"),s=F("edge.target.anchor.y"),y=Bc(g,j,F("edge.source.position"),F("edge.source.offset.x"),F("edge.source.offset.y"),X,t),c=Bc(g,J,F("edge.target.position"),F("edge.target.offset.x"),F("edge.target.offset.y"),r,s);if(U===Ko){var O=u.points=F(Sr)||zh,W=O.size();u.segments=F("edge.segments");var h=X!==Q||t!==Q,a=r!==Q||s!==Q;if(!V)if(o)h||(y=ip(y,W?O.get(0):c,o,W)),a||(c=ip(c,W?O.get(W-1):y,o,W));else{var f;h||(f=km(y,W?O.get(0):c,bq(g,j)),f&&(y={x:f[0],y:f[1]})),a||(f=km(W?O.get(W-1):y,c,bq(g,J)),f&&(c={x:f[0],y:f[1]}))}D=Uo(Yd(u.points),Yd(y,c))}else{var _=Hr(L,g,e,p,U);if(L._19Q||(_=-_),p)y=ji(y),y.x=g.getNodeRect(j).x,u.radius=_,D={x:y.x-_,y:y.y-_,width:2*_,height:2*_};else{var Z=Ip(y,c),v=am(o,Z),K={x:v,y:_},x={x:Z-v,y:_},R=B(c.y-y.y,c.x-y.x),H=u.mat=new He(R);if(u.orienAngle=R,u.angle=c.x<y.x?R+A:R,u.rect={x:K.x,y:K.y,width:x.x-K.x,height:0},u.origin=y,K=H.tf(K),K.x+=y.x,K.y+=y.y,x=H.tf(x),x.x+=y.x,x.y+=y.y,V){var l={x:Z,y:0};l=H.tf(l),l.x+=y.x,l.y+=y.y,D=Yd([y,K,x,l]),u.c1=y,u.c2=l}else D=Yd(K,x);y=K,c=x}}u.sourcePoint=y,u.targetPoint=c,e._lastSourcePoint=y,e._lastTargetPoint=c}var C=0;F("edge.dash")&&(C=F("edge.dash.width")||k);var N="square"===u.cap?.71:.5;Rq(D,M(C*N,k*N+I+Y),u.join),L._68o(D)}},getRotation:function(s,F,$){s=s||0;var c=this._78o;if(c){var S,E=c.angle,b=c.points,P=c._4O;if(E!=q)return F?c.orienAngle+s:E+s;if(P){var D=P.points;return S=D.size(),Qf[$]?S&&0===S%2?gh(D.get(S/2-1),D.get(S/2),F,s):s:nj[$]?gh(D.get(0),D.get(1),F,s):gh(D.get(S-2),D.get(S-1),F,s)}if(b)return S=b.size(),Qf[$]?S&&0===S%2?gh(b.get(S/2-1),b.get(S/2),F,s):s:nj[$]?gh(c.sourcePoint,S?b.get(0):c.targetPoint,F,s):gh(S?b.get(S-1):c.sourcePoint,c.targetPoint,F,s)}return s},getPosition:function(C,l,v,b,T){var E=this._78o;if(E){var e,x=E.type,z=E.points,u=E._4O,_=E.sourcePoint,M=E.targetPoint;if(!x)return E.looped?{x:_.x-E.radius+l,y:_.y+v}:(T&&_&&M&&(_.x>M.x||_.x===M.x&&_.y>M.y)&&(C=aj[C],v=-v),e=Un(C,E.rect,b),e.x+=l,e.y+=v,e=E.mat.tf(e),e.x+=E.origin.x,e.y+=E.origin.y,e);if(z){var e,f=z.size();if(Qf[C]){if(f){var H=f%2;if(0===H)return ss(z.get(f/2-1),z.get(f/2),C,l,v,b,T);e=z.get((f-H)/2)}else e={x:(_.x+M.x)/2,y:(_.y+M.y)/2};return e=Un(C,{x:e.x,y:e.y,width:0,height:0},b),e.x+=l,e.y+=v,e}return nj[C]?ss(_,f?z.get(0):M,C,l,v,b,T):ss(f?z.get(f-1):_,M,C,l,v,b,T)}if(u){var J=u.points,f=J.size();if(Qf[C]){var H=f%2;return 0===H?ss(J.get(f/2-1),J.get(f/2),C,l,v,b,T):(e=J.get((f-H)/2),e=Un(C,{x:e.x,y:e.y,width:0,height:0},b),e.x+=l,e.y+=v,e)}return nj[C]?ss(J.get(0),J.get(1),C,l,v,b,T):ss(J.get(f-2),J.get(f-1),C,l,v,b,T)}}return Cm},_42:function(k){this._78o&&mi.superClass._42.call(this,k)},drawPath:function(g,m){g.beginPath();var x=m.type,K=m.points,L=m.segments,M=m._4O;if(!x||K){var u=m.sourcePoint,P=u.x,r=u.y,V=m.targetPoint,E=V.x,W=V.y;if(x)if(L){var T=new up({x:P,y:r});T.addAll(K),T.add({x:E,y:W}),vn(g,T,L)}else g.moveTo(P,r),K.each(function(N){g.lineTo(N.x,N.y)}),g.lineTo(E,W);else m.looped?g.arc(P,r,m.radius,0,G,!0):m.center?(g.moveTo(m.c1.x,m.c1.y),g.lineTo(P,r),g.lineTo(E,W),g.lineTo(m.c2.x,m.c2.y)):(g.moveTo(P,r),g.lineTo(E,W))}else M&&vn(g,M.points,M.segments)},_80o:function(i){var u=this,r=u.s,z=u._78o,f=z.width,L=z.selectWidth,k=z.borderWidth,m=z.color,y=i.lineJoin,A=i.lineCap,e=z.pattern;i.lineJoin=z.join,i.lineCap=z.cap,u.drawPath(Cb(i,e),z);var I=r("edge.width.absolute");if(I&&(i.save(),i.setTransform(1,0,0,1,0,0)),L&&(i.strokeStyle=z._97o,i.lineWidth=f+2*(k+L),i.stroke()),k&&(i.strokeStyle=z.borderColor,i.lineWidth=f+2*k,i.stroke()),i.strokeStyle=m,i.lineWidth=f,i.stroke(),z.is3d&&wn(i,m,z._67o,f,u.gv._zoom,z._66o),I&&i.restore(),zg(i,e),r("edge.dash")){e=r("edge.dash.pattern");var R=Cb(i,e,u._2Q("edge.dash.offset"));R!==i&&u.drawPath(R,z),u._1Q(i,"edge",r("edge.dash.width")||f,e)}i.lineJoin=y,i.lineCap=A},_48O:function(){},_47O:function(){},_71o:function(Z,D){var n=this,o=n._data;if(n._19Q=!0,!o.getEdgeGroup())return Z?o.s("edge.gap"):0;var l,c=0,i=0,x=0;if(o.getEdgeGroup().getSiblings().each(function(A){A.each(function(G){if(n.gv.isVisible(G)&&G.s(Li)==D){var _=G.s("edge.gap");l?(i+=x/2+_/2,x=_):(l=G,x=_),G===o&&(c=i)}})}),Z)return i-c+x;var q=c-i/2;return l&&o._40I!==l._40I&&(n._19Q=!1),q}});var gg=function(E,v){Pj(gg,this,[E,v])};re(gg,Ql,{_3O:function(){var w,g,C=this,O=C.s,z=C._data,x=C.gv;if(C._88I=q,z.isExpanded()&&z.eachChild(function(h){var Z=x.getBoundsForGroup(h);Z&&(g||(g=[]),g.push(Z),w=Uo(w,Z))}),w){var J=x.getLabel(z),X=O("group.type");w=nh(X,g,w),Il(w,z,"group.padding",1);var b=C._88I={type:X,rect:w,_64o:w};if(!X&&J!=q){var A,P=C.labelInfo={label:J,color:O("group.title.color"),font:O("group.title.font"),align:O("group.title.align")},v=$o(P,J),k=v.width,h=v.height,R=O("group.title.align");k>w.width&&(w.width=k),P.rect={y:w.y-h,width:v.width,height:h},A=R===Ff?w.x:R===Gr?w.x+w.width-k:w.x+w.width/2-k/2,P.rect.x=A,b.titleRect={x:w.x,y:w.y-h,width:w.width,height:h+1},b.rect={x:w.x,y:w.y-h,width:w.width,height:w.height+h}}C._40O(b,O("group.border.width")/2)}else gg.superClass._3O.call(C)},getPosition:function(n,D,l,K){var t=this._88I;if(t){var P=Un(n,t.rect,K);return P.x+=D,P.y+=l,P}return gg.superClass.getPosition.apply(this,arguments)},_24O:function(N,r){var L=this._88I;(!L||L.type||"label2"===N)&&gg.superClass._24O.call(this,N,r)},_80o:function(J){var A=this,B=A._88I;if(B){var C=A._data,X=A.s,S=A.gv,e=B.type,Z=B.rect,K=B._64o,m=B.titleRect,L=A.getBodyColor(),t=fo(X("group.image"),L),G=X("group.image.stretch"),Q=A.getBodyColor("group.background"),_=fo(X("group.repeat.image"),L),u=X("group.gradient.pack"),d=X("group.gradient"),h=X("group.gradient.color"),M=X("group.depth");if(e){var o=X("group.border.pattern"),b=X("group.border.width"),k=J.lineJoin,l=J.lineCap;if(J.lineJoin=X("group.border.join"),J.lineCap=X("group.border.cap"),t){if(J.save(),rn(J,e,Z),J.clip(),Sk(J,t,G,Z.x,Z.y,Z.width,Z.height,C,S,L),J.restore(),b>0){var $=Cb(J,o);rn($,e,Z),J.lineWidth=b,J.strokeStyle=X("group.border.color"),J.stroke(),zg(J,o)}}else{var $=Cb(J,o);Q||_||u?(rn(J,e,Z),u?Eo(J,u):_?zd(J,_,L,null,C,S):Fl(J,Q,d,h,Z),J.fill(),u&&J.restore(),J!==$&&rn($,e,Z)):rn($,e,Z),b>0&&(J.lineWidth=b,J.strokeStyle=X("group.border.color"),J.stroke()),zg(J,o),e===wb&&Wj(J,Q,M,Z)}J.lineJoin=k,J.lineCap=l}else if(t?Sk(J,t,G,K.x,K.y,K.width,K.height,C,S,A.getBodyColor()):(Q||_)&&(_?zd(J,_,L,null,C,S):Fl(J,Q,d,h,K),rn(J,wb,K),J.fill(),Wj(J,Q,M,K)),m){var T=X("group.title.background");Kc(J,m.x,m.y,m.width,m.height,T),Wj(J,T,M,m)}A._39O(J,B)}else gg.superClass._80o.call(A,J)}});var Kd=function(d,z){Pj(Kd,this,[d,z])};re(Kd,Ql,{_80o:function(n){this._39O(n,this._83o)}});var Le=function(k,u){Pj(Le,this,[k,u])};re(Le,Ql,{_3O:function(){var b=this,n=b._data,c=b.s,l=b.gv,$=n.getPoints(),L=l.getBorderColor(n),s=L?c("border.width"):0,X=b.getSelectWidth(),v=c("shape.border.width"),U=n.getRect(),G=l.getBodyColor(n),Y=b._99o=$.isEmpty()?q:{rect:U,rotation:n.getRotation(),fillRule:c("shape.fill.rule"),scale:n.getScale(),position:n.p(),points:$,segments:n.getSegments(),bodyColor:G,borderColor:L,borderWidth:s,_94o:c("shape.border.3d"),_95o:c("shape.border.3d.color"),_96o:c("shape.border.3d.accuracy"),_97o:X?c("select.color"):q,selectWidth:X,_53o:c("shape.background"),_27Q:fo(c("shape.repeat.image"),G),shapeGradientPack:c("shape.gradient.pack"),_54o:v,_55o:c("shape.border.color"),shapeGradient:c("shape.gradient"),_59o:c("shape.gradient.color"),_60o:c("shape.border.pattern"),_61o:c("shape.border.cap"),_62o:c("shape.border.join")};if(Y){var V=n.getScale(),N=M(1,M(C(V.x),C(V.y))),h=v*("square"===Y._61o?.71:.5)+s+X/b.gv._zoom/N;h&&(h*=N,U=ji(U),Rq(U,h,Y._62o)),b._68o(U);var Z=c("clip.percentage");1>Z&&(0>Z&&(Z=0),Y.clipRect=mm(n.getAnchorRect(),c("clip.direction"),Z));var x=c("shape.fill.clip.percentage");1>x&&(0>x&&(x=0),Y.shapeClipRect=mm(n.getAnchorRect(),c("shape.fill.clip.direction"),x))}},getPosition:function(g,$,v,e){var Z=this._99o;if(Z){var M=Un(g,Z.rect,e);return M.x+=$,M.y+=v,M}return Cm},_42:function(x){this._99o&&Le.superClass._42.call(this,x)},_80o:function(b){var X,F=this,I=F.s,A=F._99o,r=A.position,m=A.scale,Z=A.rotation,x=A.bodyColor,e=A.borderWidth,K=A.selectWidth,B=A._53o,Q=A._27Q,s=A.shapeGradientPack,D=A._54o,N=A.clipRect,j=A.shapeClipRect,f=A.points,k=A.segments,M=F._data.isClosePath(),v=A.fillRule,Y=B||Q||s;b.save(),_e(b,r.x,r.y),zq(b,Z),Qe(b,m.x,m.y),N&&(b.beginPath(),b.rect(N.x,N.y,N.width,N.height),b.clip()),Y&&j&&(b.save(),b.beginPath(),b.rect(j.x,j.y,j.width,j.height),b.clip()),_e(b,-r.x,-r.y);var c=A._60o,W=Cb(b,c),T=b.lineJoin,L=b.lineCap;b.lineJoin=A._62o,b.lineCap=A._61o,Y?(vn(b,f,k,M),s?Eo(b,s):Q?zd(b,Q,x,null,F._data,F.gv):(X=x?x:B,Fl(b,X,A.shapeGradient,A._59o,A.rect)),b.fill(v),j&&(b.restore(),_e(b,-r.x,-r.y)),s&&b.restore(),W!==b&&vn(W,f,k,M)):vn(W,f,k,M);var d=I("shape.border.width.absolute");if(d&&(b.save(),b.setTransform(1,0,0,1,0,0)),K&&(b.strokeStyle=A._97o,b.lineWidth=D+2*(e+K),b.stroke()),e&&(b.strokeStyle=A.borderColor,b.lineWidth=D+2*e,b.stroke()),D&&(X=A._55o,!B&&x&&(X=x),b.strokeStyle=X,b.lineWidth=D,b.stroke(),A._94o&&wn(b,X,A._95o,D,F.gv._zoom,A._96o)),d&&b.restore(),zg(b,c),I("shape.dash")){var V=I("shape.dash.width")||D;if(V>0){c=I("shape.dash.pattern");var W=Cb(b,c,F._2Q("shape.dash.offset"));W!==b&&vn(W,f,k,M),F._1Q(b,"shape",V,c)}}b.lineJoin=T,b.lineCap=L,b.restore()},_48O:function(){},_47O:function(){}});var ks=function(L,w){Pj(ks,this,[L,w])};re(ks,Le,{getRotation:function(i,I,t){i=i||0;var w=this._data.getPoints(),z=w.size();return z>1?Qf[t]?z&&0===z%2?gh(w.get(z/2-1),w.get(z/2),I,i):i:nj[t]?gh(w.get(0),w.get(1),I,i):gh(w.get(z-2),w.get(z-1),I,i):i},getPosition:function(x,O,D,_,z){var F=this._data.getPoints(),u=F.size();if(u>1){if(Qf[x]){var N=u%2;if(0===N)return ss(F.get(u/2-1),F.get(u/2),x,O,D,_,z);var M=F.get((u-N)/2),A={x:M.x,y:M.y,width:0,height:0};return M=Un(x,A,_),M.x+=O,M.y+=D,M}return nj[x]?ss(F.get(0),F.get(1),x,O,D,_,z):ss(F.get(u-2),F.get(u-1),x,O,D,_,z)}return Cm}});var lj=function(n,L){Pj(lj,this,[n,L])};re(lj,Ql,{_3O:function(){var l=this;lj.superClass._3O.call(l);var r=l.s,v=l._83o;l._82o=v.img||v.shape?q:{background:l.getBodyColor("grid.background"),depth:r("grid.depth"),rect:v.rect,_88o:r("grid.cell.depth"),cellBorderColor:r("grid.cell.border.color"),_89o:r("grid.row.count"),_90o:r("grid.column.count"),block:r("grid.block"),_91o:r("grid.block.color"),_92o:r("grid.block.padding"),_93o:r("grid.block.width")}},_80o:function(o){var H=this,S=H._82o;if(!S)return lj.superClass._80o.call(H,o),void 0;var b,j,t=H._data,l=S.background,g=S.rect,F=S.block,h=S._91o,J=S._92o,x=S._93o,z=S._88o,M=S.cellBorderColor,v=S._89o,s=S._90o;if(l)if(Kc(o,g.x,g.y,g.width,g.height,l),Wj(o,l,S.depth,g),z)for(b=0;v>b;b++)for(j=0;s>j;j++)g=t.getCellRect(b,j),g&&Wj(o,l,z,g);else if(M){for(o.beginPath(),b=0;v>b;b++)for(j=0;s>j;j++)g=t.getCellRect(b,j),g&&o.rect(g.x,g.y,g.width,g.height);o.strokeStyle=M,o.lineWidth=1,o.stroke()}if("h"===F)for(b=0;v>b;b++)g=Uo(t.getCellRect(b,0),t.getCellRect(b,s-1)),Eg(g,J),bb(o,h,g.x,g.y,g.width,g.height,x);else if("v"===F)for(j=0;s>j;j++)g=Uo(t.getCellRect(0,j),t.getCellRect(v-1,j)),Eg(g,J),bb(o,h,g.x,g.y,g.width,g.height,x);H._39O(o,H._83o)}});var zs=function(M,f){Pj(zs,this,[M,f])};re(zs,Ql,{_checkEmptyRect:!1,_81o:function(){var E=this._data,d=zs.superClass._81o.call(this),h=E.s("text");if(h!=q){var P,c,N=E.s("text.font"),s=E.s("text.align"),G=E.s("text.vAlign"),e=E.getRotation(),k=wr(N,h),u=k.width,f=k.height;"left"===s?P=-E.getWidth()/2:"center"===s?P=-k.width/2:"right"===s&&(P=E.getWidth()/2-k.width),"top"===G?c=-E.getHeight()/2:"middle"===G?c=-k.height/2:"bottom"===G&&(c=E.getHeight()/2-k.height);var i;if(e){var F=new He(e);i=Yd([F.tf(P,c),F.tf(P+u,c),F.tf(P+u,c+f),F.tf(P,c+f)])}else i={x:P,y:c,width:u,height:f};i.x+=E.getPosition().x,i.y+=E.getPosition().y,d=Uo(d,i)}return d}});var qh=Df.Interactor=function(X){this.gv=this._graphView=X};_l("Interactor",P,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(W){this.gv.fi(W)},setCursor:function(T){e||(this.getView().style.cursor=T)},startDragging:function(W){var e=this;e._lastClientPoint=wo(W),e._lastLogicalPoint=e.gv.lp(W),Pr(e,W)},clearDragging:function(){var l=this;l._lastClientPoint=l._lastLogicalPoint=l._logicalPoint=q},autoScroll:function(X){return this.gv.autoScroll(X,this._lastClientPoint)}});var Aq=Df.DefaultInteractor=function(M){Pj(Aq,this,[M])};_l("DefaultInteractor",qh,{handle_mousedown:function(o){br(o);var Y=this,x=Y.gv,w=x.getDataAt(o);!x.setFocus(o)||x._editing||x._scrolling||(hq(o)?x.handleDoubleClick(o,w):x.handleClick(o,w),!Rb()&&w||!x.isPannable()||!vk(o)||ki(o)||(Y._tx=x.tx(),Y._ty=x.ty(),Y.startDragging(o)))},handleWindowMouseUp:function($){var d=this,O=d.gv;O._panning&&(delete O._panning,O.onPanEnded(),d.fi({kind:"endPan",event:$})),delete d._tx,delete d._ty,d.clearDragging()},handle_mousemove:function(R){var G=this,n=G.gv;G._hoverTimer&&(y(G._hoverTimer),delete G._hoverTimer),G._hoverTimer=u(function(){G.fi({kind:"hover",event:R}),y(G._hoverTimer),delete G._hoverTimer},n.getHoverDelay()||800)},handle_touchmove:function(H){this.handle_mousemove(H)},handleWindowMouseMove:function(u){var T=this,W=T.gv,t=T._lastClientPoint;T.fi({kind:W._panning?"betweenPan":"beginPan",event:u}),W._panning=1,W.setTranslate(T._tx+u.clientX-t.x,T._ty+u.clientY-t.y)},handle_mousewheel:function(e){this.gv.handleScroll(e,e.wheelDelta)},handle_DOMMouseScroll:function(K){2===K.axis&&this.gv.handleScroll(K,-K.detail)},handle_keydown:function(R){this.gv.handleKeyDown(R)}});var gi=Df.SelectInteractor=function(f){Pj(gi,this,[f])};_l("SelectInteractor",qh,{_42:function(){var M=this,o=M.gv,J=o.getZoom(),g=M.mark,q=M.div;q||(q=M.div=ao(),gd(M.getView(),q));var I={};I.x=g.x*J+o.tx(),I.y=g.y*J+o.ty(),I.width=g.width*J,I.height=g.height*J,Mj(q,I),this.intersects()?(q.style.border="",q.style.background=o.getRectSelectBackground()):(q.style.background="",q.style.border="1px solid "+o.getRectSelectBorderColor())},handle_mousedown:function(e){var P=this,G=P.gv;if(P._57I=q,!(G._editing||G._scrolling||Rb())){var L=G.getDataAt(e),l=G.sm();L?ki(e)?l.co(L)?l.rs(L):l.as(L):l.co(L)||l.ss(L):ki(e)||!G.isPannable()?vk(e)&&(ki(e)||l.cs(),G.isRectSelectable()&&(P.startDragging(e),G._77O=1)):vk(e)&&(P._57I=wo(e))}},handle_mouseup:function(y){var V=this,k=V._57I;k&&(Ip(k,wo(y))<=1&&V.gv.sm().cs(),V._57I=q)},handleWindowMouseUp:function(J){this.clear(J)},handleWindowMouseMove:function(Z){var K=this,g=K.gv;K._logicalPoint=g.lp(Z),K.mark?(K.fi({kind:"betweenRectSelect",event:Z}),K.autoScroll(Z),K.redraw()):K.fi({kind:"beginRectSelect",event:Z}),K.mark=Yd(K._lastLogicalPoint,K._logicalPoint),K.redraw()},intersects:function(){var w=this,E=w._lastLogicalPoint,Z=w._logicalPoint;return E.x>Z.x||E.y>Z.y},clear:function(h){var U=this,K=U.gv,a=U.mark;if(U._57I=q,U._lastLogicalPoint){if(a){if(0!==a.width&&0!==a.height){var Z=K.getDatasInRect(a,U.intersects());if(!Z.isEmpty()){var l=K.sm(),N=l.toSelection();Z.each(function(m){l.co(m)?N.remove(m):N.add(m)}),l.ss(N)}}Ad(U.div),delete U.div,delete U.mark,U.redraw(),U.fi({kind:"endRectSelect",event:h}),K.onRectSelectEnded()}U.clearDragging(),delete K._77O}},redraw:function(){var U=this;U._draw||(U._draw=1,u(function(){U.mark&&U._42(),delete U._draw},16))}});var sg=Df.MoveInteractor=function(N){Pj(sg,this,[N])};_l("MoveInteractor",qh,{handle_mousedown:function(w){var I=this,V=I.gv;if(vk(w)&&!V._editing&&!V._scrolling&&!Rb()){var u=V.getSelectedDataAt(w);u?(I._data=u,V.handleMouseDown&&V.handleMouseDown(w,u),I.startDragging(w),V.isMovable(u)&&(V._moving=1)):V._focusData=q}},handleWindowMouseUp:function(H){var n=this,t=n.gv;t.handleMouseUp&&t.handleMouseUp(H,n._data),n.clear(H)},handleWindowMouseMove:function(h){var q=this,I=q._data,C=q.gv,c=C.getDataModel(),Z=c.getHistoryManager();if((!C._93O||!C._93O(h,I))&&C._moving){q._logicalPoint||q.fi({kind:"prepareMove",event:h});var u=q._logicalPoint?"betweenMove":"beginMove",O={kind:u,event:h},F=q._logicalPoint=C.lp(h);Z&&"beginMove"===u&&Z.beginInteraction();var $=q._calcShift(u,h),X=$.x,f=$.y,A=q.gv.getMoveMode(h,I);A&&("x"===A?f=0:"y"===A?X=0:"xy"!==A&&(X=f=0)),C.moveSelection(X,f),q._lastLogicalPoint=F,q.autoScroll(h),q.fi(O)}},_calcShift:function(){var c=this,J=c._logicalPoint,h=c._lastLogicalPoint,T=J.x-h.x,j=J.y-h.y;return{x:T,y:j}},clear:function(b){var o=this,K=o.gv,I=K.getDataModel(),L=I.getHistoryManager();o._lastLogicalPoint&&(o._lastLogicalPoint=o._data=K._moving=q,o._logicalPoint&&(o.fi({kind:"endMove",event:b}),K.onMoveEnded(),L&&L.endInteraction()),o.clearDragging())
}});var Hp=Df.ScrollBarInteractor=function(l){Pj(Hp,this,[l])};_l("ScrollBarInteractor",qh,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(y){var V=this.gv.getViewRect();return this._41o()&&(V.x+V.width-this.gv.lp(y).x)*this.gv.getZoom()<Jn},isH:function(R){var P=this.gv.getViewRect();return this._40o()&&(P.y+P.height-this.gv.lp(R).y)*this.gv.getZoom()<Jn},handle_mousemove:function(h){this.handle_touchmove(h)},handle_touchmove:function(G){if(!Cc&&vk(G)){var C=this,m=C.isV(G),g=C.isH(G);(m||g)&&C.gv.showScrollBar(),C.gv._scrolling=m||g}},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(g){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=q,this.fi({kind:"endScroll",event:g})},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(f){var W=this;if(W.gv.setFocus(f),br(f),W.handle_touchmove(f),!(Ed(f)>1)&&W.gv._scrolling){W._cp=wo(f),W._tx=W.gv.tx(),W._ty=W.gv.ty();var y=W.isV(f);W._state=y?"vScroll":"hScroll",Pr(W,f),W.fi({kind:"beginScroll",event:f})}},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(S){var A=wo(S),h=this.gv.getViewRect(),C=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-A.y)*C.height/h.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-A.x)*C.width/h.width),this.fi({kind:"betweenScroll",event:S})}});var bl=Df.TouchInteractor=function(r,V){V=V||{},V.selectable===Q&&(V.selectable=!0),V.movable===Q&&(V.movable=!0),V.pannable===Q&&(V.pannable=!0),V.pinchable===Q&&(V.pinchable=!0),V.editable===Q&&(V.editable=!0),this.params=V,Pj(bl,this,[r])};_l("TouchInteractor",qh,{ms_edit:1,setUp:function(){var U=this;bl.superClass.setUp.call(U),e&&U.params.editable&&U.gv.setEditInteractor(U)},tearDown:function(){var U=this;bl.superClass.tearDown.call(U),e&&U.params.editable&&U.gv.setEditInteractor(q)},clear:function($){var u=this,Q=u.gv,b=Q.dm().getHistoryManager();Q._moving&&(u.fi({kind:"endMove",event:$}),delete Q._moving,Q.onMoveEnded(),b&&b.endInteraction()),Q._panning&&(u.fi({kind:"endPan",event:$}),delete Q._panning,Q.onPanEnded()),Q._pinching&&(u.fi({kind:"endPinch",event:$}),delete Q._pinching,Q.onPinchEnded()),Q._editing&&(u._46O($),u._77I=u._node=u._edge=u._shape=u._rect=u._89I=u._index=Q._editing=q),u._moving=u._panning=u._pinching=u._editing=u._57I=u._data=u._beginHistory=q,u.clearDragging()},handle_touchstart:function(Q){var u=this;if(!u.gv._editing){br(Q),u._57I=q;var J=u.params,P=u.gv,z=P.sm(),g=P.getDataAt(Q),v=Ed(Q);if(1===v)hq(Q)?P.handleDoubleClick(Q,g):(P.handleClick(Q,g),g&&(P.handleMouseDown&&P.handleMouseDown(Q,g),u._data=g)),J.selectable||(g=q),g?(z.co(g)||z.ss(g),J.editable&&P.isEditable(g)&&u._79I(Q,g,!0)?(u._editing=1,u.startDragging(Q)):J.movable&&P.isMovable(g)&&(u._moving=1,u.startDragging(Q))):(u._57I=wo(Q),J.pannable&&P.isPannable()&&(u._panning=1,u.startDragging(Q),u._translate={x:P.tx(),y:P.ty()}));else if(J.pinchable&&2===v){u._pinching=1,u.startDragging(Q);var r=P.getView(),x=P.getZoom(),f=r.getBoundingClientRect(),X=Q.touches[0],y=Q.touches[1],j={x:(X.clientX+y.clientX)/2-f.left,y:(X.clientY+y.clientY)/2-f.top};j.x-=P.tx(),j.y-=P.ty(),j.x/=x,j.y/=x,u._p=j,u._d=Em(Q)}}},handle_touchend:function(O){var u=this,X=u.gv,w=u._57I,v=u._data;w&&(Ip(w,wo(O))<=1&&X.sm().cs(),u._57I=q),v&&X.handleMouseUp&&X.handleMouseUp(O,v)},handleWindowTouchEnd:function(F){this.clear(F)},handleWindowTouchMove:function(B){var Q=this,K=Q.gv,$=K.dm().getHistoryManager(),A=Ed(B);if(1===A){if(Q._editing&&($&&!Q._beginHistory&&(Q._beginHistory=1,$.beginInteraction()),K._editing=1,Q._78I(B)),Q._moving)$&&!Q._beginHistory&&(Q._beginHistory=1,$.beginInteraction()),Q.handleMove(B);else if(Q._panning){var D=wo(B);K.setTranslate(Q._translate.x+D.x-Q._lastClientPoint.x,Q._translate.y+D.y-Q._lastClientPoint.y),Q.fi({kind:K._panning?"betweenPan":"beginPan",event:B}),K._panning=1}}else if(2===A&&Q._pinching){var c=Em(B);K.handlePinch(Q._p,c,Q._d),Q._d=c,Q.fi({kind:K._pinching?"betweenPinch":"beginPinch",event:B}),K._pinching=1}},handleMove:function(E){var T=this,A=T.gv,X=A.lp(E);A._93O&&A._93O(E,T._data)||(A.moveSelection(X.x-T._lastLogicalPoint.x,X.y-T._lastLogicalPoint.y),T._lastLogicalPoint=X,T.autoScroll(E),T.fi({kind:A._moving?"betweenMove":"beginMove",event:E}),A._moving=1)}});var i=O.ht,le=i.graph._editor={Math:{},Guide:{}};le.getStyle=function(c){var E,k=le.StyleMap;return k&&(E=k[c],E!==Q)?E:le.DefaultStyleMap[c]},le.setStyle=function(m,k){var g=le.StyleMap;g||(g=le.StyleMap={}),g[m]=k},le.inEdit=function(E){return E._inXEdit===!0},le.startEdit=function(C){C._inXEdit=!0,le.Inject.doInject(C)},le._46O=function(y){y._inXEdit=!1,le.Inject.undoInject(y)},le.toScreenPosition=function(C,y){var Q=C.tx(),e=C.ty(),X=C._zoom;return new le.Math.Vector2(y.x*X+Q,y.y*X+e)},le.checkHit=function(c,B,f){return c.distanceTo(B)<f?!0:!1},le.toWorldPosition=function(g,H){var N=g.tx(),V=g.ty(),v=g._zoom;return{x:(H.x-N)/v,y:(H.y-V)/v}},le.log=function(){};var Dh=le.Inject={_modules:[]};Dh.registAsModule=function(l,K){var D={},t={};for(var k in l){var E=K.prototype[k];D[k]=E}l.getBackup=function(t){return D[t]},l.getBackups=function(){return D},t.doInject=function(){for(var x in l)"getBackup"!==x&&(K.prototype[x]=l[x])},t.undoInject=function(){for(var r in l)"getBackup"!==r&&(K.prototype[r]=D[r])},Dh._modules.push(t)},Dh.doInject=function(I){for(var L,J=Dh._modules,Q=0,f=J.length;f>Q;Q++)L=J[Q],L.doInject(I)},Dh.undoInject=function(D){for(var d,Z=Dh._modules,a=0,n=Z.length;n>a;a++)d=Z[a],d.undoInject(D)};var qh=i.graph.EditInteractor=function(y){var T=this,C=a.createElement("canvas");C.className="editCanvas",C.style.position="absolute",T._styleMap={},T._canvas=C,T._context=C.getContext("2d"),qh.superClass.constructor.call(T,y),T.setAntialias(!1),T._subModules=[new le.Anchor(T),new le.Rect(T),new le.Curve(T),new le.MoveHelper(T)],T._gridGuide=new le.Guide.Grid(T),T._rectGuide=new le.Guide.Rect(T)},Ep=qh;i.Default.def(qh,i.graph.Interactor,{ms_edit:1,ms_fire:1}),P.defineProperties(qh.prototype,{editDetail:{get:function(){var y=!!this._editDetail;return y},set:function(P){var v=this,O=v._editDetail;O!==P&&(v._editDetail=P,v.gv._editing=P,v.fp("editDetail",O,P),v.fp("pointsEditingMode",O,P))}},gvEditing:{get:function(){return this.gv._editing},set:function(S){(!this._editDetail||S)&&(this.gv._editing=S,S||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(M){this._editing=M,this.gvEditing=M}},pointsEditingMode:{get:function(){return this.editDetail},set:function(g){var o=this;o.editDetail!==g&&(g?o._tryEnterEditDetailMode():o._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var w=this._gridEnabled;if(!w)return!1;var G=this.gv;return G?G._zoom<this.getStyle("gridZoomThreshold")?!1:!0:!0},set:function(e){e!==this._gridEnabled&&(this._gridEnabled=e,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(i){i!==this._agEnabled&&(this._agEnabled=i,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),qh.prototype.getSubModule=function(_){var B,w,m,e=this._subModules;for(w=0,m=e.length;m>w;w++)if(B=e[w],B.catalog===_)return B},qh.prototype.invokeSubModule=function(t,w){var Z=this,g=Z._subModules;if(g)for(var C,e,i,r=Array.prototype.slice.call(arguments,2),K=0,E=g.length;E>K;K++)if(C=g[K],e=C[t],e&&(i=e.apply(C,r),i!=Q&&w))return C},qh.prototype.invokeSubModuleInverse=function(H,l){var x=this,X=x._subModules;if(X)for(var B,u,e,T=Array.prototype.slice.call(arguments,2),D=X.length-1;D>=0;D--)if(B=X[D],u=B[H],u&&(e=u.apply(B,T),e!=Q&&l))return B},qh.prototype.setUp=function(){le.log("setUp");var b=this,M=b.gv,o=M.getView(),h=b._canvas;qh.superClass.setUp.call(b),M.setEditInteractor(b),M._79O?o.insertBefore(h,M._79O):o.appendChild(h),le.startEdit(M),b.invokeSubModule("setUp"),M.dm().mm(b._onDataModelChanged,b),M.dm().md(b._onDataPropertyChanged,b)},qh.prototype.tearDown=function(){le.log("tearDown");var n=this,G=n.gv,I=G.getView();qh.superClass.tearDown.call(n),G.dm().umm(n._onDataModelChanged),G.dm().umd(n._onDataPropertyChanged),G.setEditInteractor(null),I.removeChild(n._canvas),le._46O(G),n.invokeSubModule("tearDown")},qh.prototype._onDataModelChanged=function(x){var c=this;("clear"===x.kind||"remove"===x.kind&&c.editDetail&&x.data===c.getSubModule("Curve").target)&&(c.editDetail=!1,c._42())},qh.prototype._onDataPropertyChanged=function(M){var j=this;if(j.editDetail){var y=j.getSubModule("Curve"),F=M.data;F===y.target&&(F._writing||y._handleDataChanged())}},qh.prototype.clear=function(){le.log("clear")},qh.prototype.redraw=function(){this._42()},qh.prototype._42=function(){var m=this;m._drawTimer||(m._drawTimer=u(function(){delete m._drawTimer,m.drawImpl()},0))},qh.prototype.drawImpl=function(){var G;for(G in{_42:!0})break;return function(){var k=this,N=k._canvas,K=k.gv,$=K.getWidth(),Q=K.getHeight(),o=k._context,h=i.Default.getInternal();(N.width!==$||N.height!==Q)&&h.setCanvas(N,$,Q),o.clearRect(0,0,N.width,N.height);var I=k._getValidSelection();o.save();var x=i.Default.devicePixelRatio;o.scale(x,x),k._gridGuide._42(),k._rectGuide._42(),k.invokeSubModuleInverse(G,!1,o,K,I),o.restore()}}(),qh.prototype._getValidSelection=function(){var f=this,Z=f.gv,d=Z.sm().getSelection(),$=[];return d.each(function(G){Z.isVisible(G)&&Z.isEditable(G)&&$.push(G)}),$},qh.prototype.setAntialias=function(b){for(var M,W=this._context,o=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],a=0,S=o.length;S>a&&(M=o[a],!W[M]);a++);W[M]=b},qh.prototype.handle_touchmove=function(T){return this.handle_mousemove(T)},qh.prototype.handle_mousemove=function(T){if(!i.Default.isDragging()){var I=this;(I.editDetail||!Rb())&&(I.gvEditing=!1,I._checkEdit(T)&&(I.gvEditing=!0))}},qh.prototype.handle_touchstart=function(V){return this.handle_mousedown(V)},qh.prototype.handle_mousedown=function(m){br(m);var o=this;if(o.editDetail||!Rb()){if(hq(m)){if(o.editDetail){if(o._tryQuitEditDetailMode(m))return}else if(o._tryEnterEditDetailMode())return;if(o.invokeSubModule("handleDoubleClick",!0,m))return}var f=o._checkEdit(m);if(f){o._downPosition=o._getLogicalPoint(m);var s=o.gv.dm(),_=s.getHistoryManager();_&&_.beginInteraction(),f.startEdit(o,m),o.editing=!0}}},qh.prototype._checkEdit=function($){var l=this,o=l.gv,x=l._getLogicalPoint($),e=l.invokeSubModule("check",!0,o,$,x)||null;return l._editMod=e,e},qh.prototype.handleWindowTouchMove=function(j){return this.handleWindowMouseMove(j)},qh.prototype.handleWindowMouseMove=function(I){var d=this,s=d._downPosition;if(s){var k=d._getLogicalPoint(I);if(k.distanceTo(s)<d.getStyle("moveSensitivity"))return;delete d._downPosition}var z=d._editMod;z&&z.handleEdit(d.gv,I)},qh.prototype._getLogicalPoint=function(Y){var f=this,x=i.Default.getLogicalPoint(Y,f._canvas);return new le.Math.Vector2(x)},qh.prototype.handleWindowTouchEnd=function(Z){return this.handleWindowMouseUp(Z)},qh.prototype.handleWindowMouseUp=function(){var j;for(j in{_46O:!0})break;return function(){var H=this;H.editing=!1,H.setCursor("default"),H.invokeSubModule(j,!1),H._42();var B=H.gv.dm(),Z=B.getHistoryManager();Z&&Z.endInteraction()}}(),qh.prototype.handle_mousewheel=function(j){var q=this;br(j),q.invokeSubModule("preHandleScroll",!0)||q.gv.handleScroll(j,j.wheelDelta)},qh.prototype.handleDelete=function(){var S=this;return S.editDetail?(S.invokeSubModule("handleDelete",!0),S._42(),void 0):(S.gv.removeSelection(),void 0)},qh.prototype.handle_keydown=function(F){var l=this;if((F.metaKey||F.ctrlKey)&&l._42(),Rb(F)&&!l.editing)return l.gvEditing=!1,l.setCursor("default"),l._42(),void 0;var u=mh(F);return l.editDetail?((u||hj(F))&&(l.editDetail=!1,l._42()),l.invokeSubModule("handle_keydown",!0,F),void 0):(u&&l._tryEnterEditDetailMode(),void 0)},qh.prototype.handle_keyup=function(m){this.invokeSubModule("handle_keyup",!0,m)},qh.prototype._tryEnterEditDetailMode=function(){var x=this;return!x.editDetail&&x.invokeSubModule("canEnterEditDetailMode",!0)&&1===x._getValidSelection().length?(x.editDetail=!0,x._42(),!0):void 0},qh.prototype._tryQuitEditDetailMode=function(v){var E=this;if(E.editDetail){var I=E.gv,r=E.getSubModule("Curve").target;return v&&I.getDataAt(v)===r?void 0:(E.editDetail=!1,E._42(),!0)}},qh.prototype.setStyle=function(i,m,B){var c=this;B?le.setStyle(i,m):c._styleMap[i]=m,c._42()},qh.prototype.getStyle=function(h){var M=this,O=M._styleMap[h];return O!==Q?O:le.getStyle(h)};var Cl=le.Group=function(J){var p=this;p._entities=J,p._64O=0,p._position={x:0,y:0},p._scale={x:1,y:1},p._anchor={x:.5,y:.5},p._anchor2={x:.5,y:.5}};Cl.prototype={},Cl.prototype.constructor=Cl;var _c=null;Cl.findOrCreateGroup=function(g){if(_c&&_c.checkIsMe(g))return _c;var F=new le.Group(g);return F.getKeyOb()?(_c=F,F):void 0},Cl.prototype.checkIsMe=function(L){var u=this._entities;if(u.length!==L.length)return!1;var B,T={},S=L.length;for(B=0;S>B;B++)T[L[B]._id]=!0;for(B=0;S>B;B++)if(!T[u[B]._id])return!1;return!0},Cl.prototype.getRotation=function(){return this._64O},Cl.prototype.getPosition=function(){return this._position},Cl.prototype.getAnchor=function(){return this._anchor},Cl.prototype.getWidth=function(){return this._width},Cl.prototype.getScale=function(){return this._scale},Cl.prototype.getSize=function(){return{width:this._width,height:this._height}},Cl.prototype.getHeight=function(){return this._height},Cl.prototype.getKeyOb=function(){for(var B=this._entities,f=B.length-1;f>=0;f--){var p=B[f];if(this.isNode(p))return p}},Cl.prototype.getAnchor2=function(){var w=this,u=w.rotateCenter;if(u)return u;var Z=w.getKeyOb();if(!Z)return w._anchor;var n=w._anchor2,i=Z.getMatrix();return i.tf({x:Z.getWidth()*(n.x-Z.getAnchor().x),y:Z.getHeight()*(n.y-Z.getAnchor().y)})},Cl.prototype.setAnchor2=function(E,S){var Q=this,u=Q.getKeyOb();if(u){var c,V=u.getMatrix();c="number"==typeof E?{x:E,y:S}:E;var y=V.tfi(c);Q._anchor2={x:u.getAnchor().x+y.x/u.getWidth(),y:u.getAnchor().y+y.y/u.getHeight()}}},Cl.prototype.setRotation=function(){},Cl.prototype.beginRotate=function(X){this.rotateCenter=X.pos,this.rotateMode=X.groupRotateMode},Cl.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Cl.prototype.addRotation=function(o,v){return"batch"===v?this._addRotationInBatchMode(o):"block"===v?this._addRotationInBlockMode(o):void 0},Cl.prototype._addRotationInBlockMode=function(H){var D=this,J=D.rotateCenter||D.getPosition();D._entities.forEach(function(p){if(D.isNode(p)){var Z=p.getMatrix();Z.translate(-J.x,-J.y),Z.rotate(H),Z.translate(J.x,J.y);var v=Math.sign(p.getScale().x);p.setRotation(B(Z.b*v,Z.a*v)),p.setPosition(Z.tx,Z.ty)}})},Cl.prototype._addRotationInBatchMode=function(J){var L=this,c=L._anchor2;L._entities.forEach(function(F){if(L.isNode(F)){var d=F.getAnchor(),s=F.getMatrix(),t=s.tf({x:F.getWidth()*(c.x-d.x),y:F.getHeight()*(c.y-d.y)}),q=new le.Math.Matrix2;q.set(s.a,s.b,s.c,s.d,s.tx,s.ty),q.translate(-t.x,-t.y),q.rotate(J),q.translate(t.x,t.y);var K=Math.sign(F.getScale().x);F.setRotation(B(q.b*K,q.a*K)),F.setPosition(q.tx,q.ty)}})},Cl.prototype.setPosition=function(z){var y,i,M,x,I=this,q=I._position,A=z.x-q.x,E=z.y-q.y,r=I._entities;for(i=0,M=r.length;M>i;i++)y=r[i],Bj(y)&&(x=y.getPosition(),y.setPosition(x.x+A,x.y+E));I._position=z},Cl.prototype.setScale=function(e,d){var F=this,l=e/F._scale.x,f=d/F._scale.y;F._adjustChildScaleOrSize(l,f,"size"),F._scale={x:e,y:d}},Cl.prototype.getRect=function(){var M=this,p=M._position,O=M._width,E=M._height;return{x:p.x-O/2,y:p.y-E/2,width:O,height:E}},Cl.prototype.setSize=function(v,n){var M=this,v=Math.max(1,v),n=Math.max(1,n),p=v/M._width,z=n/M._height;M._adjustChildScaleOrSize(p,z,"size"),M._width=v,M._height=n},Cl.prototype._adjustChildScaleOrSize=function(W,h,b){var y,l,x,N,T,d,V,t,q,C,O,i,j,p,z=this,e=z._position,r=z._entities,G=new le.Math.Matrix2;for(l=0,x=r.length;x>l;l++)if(y=r[l],z.isNode(y)){if(N=y.getPosition(),T=y.getRotation(),d=y.getWidth(),V=y.getHeight(),t=y.getScale(),O=t.x*d,i=t.y*V,G.identity().scale(O,i).rotate(T).translate(N.x,N.y).translate(-e.x,-e.y).rotate(-z._64O),T=B(G.b*Math.sign(O),G.a*Math.sign(O)),G.scale(W,h),q=Math.cos(T),C=Math.sin(T),Math.abs(q)<.001?(j=G.b/C,p=-G.c/C):(j=G.a/q,p=G.d/q),"scale"===b)y.setScale(j/d,p/V);else if("size"===b){var u=j/t.x,S=p/t.y;y.setScale(ms(j)*Math.abs(t.x),ms(p)*Math.abs(t.y)),y.setSize(Math.max(.1,Math.abs(u)),Math.max(.1,Math.abs(S)))}G.rotate(z._64O).translate(e.x,e.y),y.setPosition(G.tx,G.ty)}},Cl.prototype.getMatrix=function(){var g=this,w=g._position,L=i.Default.getInternal(),v=g._scale;return new L.Mat(g._64O,w.x,w.y,v.x,v.y)},Cl.prototype.getCorners=function(){var o=this,m=o._width,$=o._height,B=o._anchor,Y=-m*B.x,R=-$*B.y,O=o.getMatrix();return[O.tf(Y,R),O.tf(Y,R+$),O.tf(Y+m,R+$),O.tf(Y+m,R)]},Cl.prototype.calcInfo=function(){var Y,G,a,M,I,D,N=this,h=[],c=N._entities,P=N._64O;for(M=0,I=c.length;I>M;M++)D=c[M],N.isNode(D)&&D.getCorners&&h.push.apply(h,D.getCorners());if(h.length){var Q=Math.cos(-P),U=Math.sin(-P),O=1/0,w=-1/0,B=1/0,f=-1/0;for(M=0,I=h.length;I>M;M++)a=h[M],Y=a.x,G=a.y,a.x=Q*Y-U*G,a.y=U*Y+Q*G,O=Math.min(O,a.x),w=Math.max(w,a.x),B=Math.min(B,a.y),f=Math.max(f,a.y);N._width=(w-O)/N._scale.x,N._height=(f-B)/N._scale.y,Q=Math.cos(P),U=Math.sin(P);var V=N._anchor;Y=O+(w-O)*V.x,G=B+(f-B)*V.y,N._position={x:Q*Y-U*G,y:U*Y+Q*G}}},Cl.prototype.isNode=function(H){return Bj(H)?as(H)?!1:!0:!1},Cl.prototype._42=function(w,$,U){var i,A,s,E,T,k,Y,K,V=this,d=V._entities,S=V.rotateMode;for("batch"===S&&(K=V.getKeyOb()),i=0,A=d.length;A>i;i++)s=d[i],V.isNode(s)&&(k=s.getRect(),E=le.toScreenPosition(U,{x:k.x,y:k.y}),T=le.toScreenPosition(U,{x:k.x+k.width,y:k.y+k.height}),Y={min:E,max:T},s===K&&(Y.isKeyOb=!0),le.Icons.DrawIcon(w,$,le.Icons.GroupSubEntityRect,Y))};var be=le.Guide.Grid=function(m){var l=this;l._interactor=m,l._alignmentGuideId=0,l._xAlignmentGuide=[],l._yAlignmentGuide=[]};be.prototype={},be.prototype.constructor=be,P.defineProperties(be.prototype,{gridBlockSize:{get:function(){var q=this;return q._gridBlockSize||q._interactor.getStyle("gridBlockSize")},set:function(w){this._gridBlockSize=w,this._interactor._42()}},gridThickLinesEvery:{get:function(){var n=this;return n._gridThickLinesEvery||n._interactor.getStyle("gridThickLinesEvery")},set:function(F){this._gridThickLinesEvery=F,this._interactor._42()}},gridEnabled:{get:function(){var b=this,y=b._interactor;return y.gridEnabled&&b.isValidGrid()}}}),be.prototype._42=function(){var r=this,U=r._interactor;r.gridEnabled&&r.drawGrid(),U.alignmentGuideEnabled&&r.drawAlignmentGuide()},be.prototype.makeMatrix=function(){var O=this,p=O._interactor.getStyle("gridAngle"),G=O._interactor.getStyle("gridRotation"),x=new le.Math.Matrix2,v=Math.sin(p),f=Math.cos(p);return x.set(1,0,f,v,0,0),x.rotate(G),x},be.prototype.isValidGrid=function(){var Y=this,y=Math.PI,Z=Y._interactor.getStyle("gridAngle"),k=Math.abs(180*(Z%y/y)),m=1-1e-8;return m>k||k>180-m?!1:!0},be.prototype.drawAlignmentGuide=function(){var q=this,p=q._interactor,J=p.gv,T=p._canvas,N=p._context,P=T.width,B=T.height,d=J.tx(),z=J.ty(),Z=J._zoom;N.beginPath(),N.strokeStyle=p.getStyle("gridAlignmentGuideColor"),N.lineWidth=1,q._xAlignmentGuide.forEach(function(o){var S=o.p*Z+d;N.moveTo(S,0),N.lineTo(S,B)}),q._yAlignmentGuide.forEach(function(j){var q=j.p*Z+z;N.moveTo(0,q),N.lineTo(P,q)}),N.stroke()},be.prototype.drawGrid=function(){function z(W,d,M,Y){var s=le.toScreenPosition(B,X.apply({x:W,y:d})),A=le.toScreenPosition(B,X.apply({x:M,y:Y}));Z.moveTo(s.x,s.y),Z.lineTo(A.x,A.y)}var c=this,w=c._interactor,R=c.gridBlockSize,A=c.gridThickLinesEvery,H=w.getStyle("gridThickColor"),k=w.getStyle("gridLightColor"),B=w.gv,d=w._canvas,Z=w._context,D=d.width,i=d.height,X=c.makeMatrix(),f=X.applyInverse(le.toWorldPosition(B,{x:0,y:0})),t=X.applyInverse(le.toWorldPosition(B,{x:D,y:0})),K=X.applyInverse(le.toWorldPosition(B,{x:0,y:i})),P=X.applyInverse(le.toWorldPosition(B,{x:D,y:i})),M=Math.min(f.x,t.x,K.x,P.x),Q=Math.max(f.x,t.x,K.x,P.x),b=Math.min(f.y,t.y,K.y,P.y),x=Math.max(f.y,t.y,K.y,P.y);D=Q-M,i=x-b;var n=Math.ceil(M/R),W=Math.floor(Q/R),L=Math.ceil(b/R),C=Math.floor(x/R);B.tx(),B.ty(),B._zoom;var G,e,J;for(Z.save(),Z.lineWidth=1,Z.beginPath(),Z.strokeStyle=H,J=Math.ceil(n/A)*A;W>=J;J+=A)G=J*R,z(G,b,G,x);for(J=Math.ceil(L/A)*A;C>=J;J+=A)e=J*R,z(M,e,Q,e);for(Z.stroke(),Z.beginPath(),Z.strokeStyle=k,J=n;W>=J;J++)0!==J%A&&(G=J*R,z(G,b,G,x));for(J=L;C>=J;J++)0!==J%A&&(e=J*R,z(M,e,Q,e));Z.stroke(),Z.restore()},be.prototype.getAlignmentGuides=function(){var B=this;return{x:B._xAlignmentGuide,y:B._yAlignmentGuide}},be.prototype.addAlignmentGuide=function(l,C,m){var E=this,w="x"===l?E._xAlignmentGuide:E._yAlignmentGuide,m=m?m:++E._alignmentGuideId,G={p:C,id:m};if(w.length){var M=E._findClosestAlignmentGuide(G.p,w);M.dis<0?w.splice(M.index+1,0,G):w.splice(M.index,0,G)}else w.push(G);return E._interactor._42(),m},be.prototype.findClosest=function(g,M,f){var U=this,a=U._interactor,K=a.gv;f&&(g=le.toWorldPosition(K,g));var l,h,y,v=1/0,L=1/0,S=g.x,c=g.y;if(U.gridEnabled){var V=U.gridBlockSize,D=U.makeMatrix(),J=D.applyInverse(g);J=D.apply({x:Math.round(J.x/V)*V,y:Math.round(J.y/V)*V}),v=J.x-S,L=J.y-c,y=!0}if(a.alignmentGuideEnabled&&(l=U._findClosestAlignmentGuide(S,U._xAlignmentGuide).dis,h=U._findClosestAlignmentGuide(c,U._yAlignmentGuide).dis,Math.abs(l)<Math.abs(v)&&(v=l,y=!0),Math.abs(h)<Math.abs(L)&&(L=h,y=!0)),y){y=!1;var T=K._zoom,C=a.getStyle("smartGuideSensitivity")/T,m={};if(Math.abs(v)<C&&"y"!==M&&(m.x=f?v*T:v,y=!0),Math.abs(L)<C&&"x"!==M&&(m.y=f?L*T:L,y=!0),y)return m}},be.prototype._findClosestAlignmentGuide=function(Z,L){if(!L.length)return{dis:1/0};for(var g,t=0,U=L.length-1;U-t>1;)g=Math.floor((t+U)/2),L[g].p<Z?t=g:U=g;var P=L[t].p-Z,u=L[U].p-Z;return Math.abs(P)<=Math.abs(u)?{line:L[t],dis:P,index:t}:{line:L[U],dis:u,index:U}},be.prototype.removeAllAlignmentGuide=function(B){var f=this;"y"!==B&&(f._xAlignmentGuide=[]),"x"!==B&&(f._yAlignmentGuide=[]),f._interactor._42()},be.prototype.removeAlignmentGuide=function(I){var e,d,m,o=this,D=o._xAlignmentGuide;for(k=0;2>k;k++)for(D=0===k?o._xAlignmentGuide:o._yAlignmentGuide,e=0,d=D.length;d>e;e++)if(m=D[e],m.id===I)return D.splice(e,1),o._interactor._42(),{axis:0===k?"x":"y",position:m.p};return!1},be.prototype.adjustAlignmentGuide=function(S,u){var Y=this,F=Y.removeAlignmentGuide(S);return F?(Y.addAlignmentGuide(F.axis,u,S),!0):!1};var kr=le.Guide.Rect=function(X){var i=this;i._interactor=X};kr.prototype={},kr.prototype.constructor=kr,kr.prototype.gatherRects=function(){var o,c,z,A,T=this,X=T._interactor.gv,j=[],l=[],J={x:j,y:l},Z={},w=X.getDataModel(),$=w.a("width"),Y=w.a("height");$&&Y&&(o=0,c=0,z=$,A=Y,j.push({node:w,type:0,p:o},{node:w,type:1,p:o+z/2},{node:w,type:2,p:o+z}),l.push({node:w,type:0,p:c},{node:w,type:1,p:c+A/2},{node:w,type:2,p:c+A}),Z[w._id||0]={x:o,y:c,width:z,height:A}),w.each(function(V){if(Bj(V)&&!X.isSelected(V)&&X.isVisible(V)){var n=!1;if(X.sm().getSelection().each(function(T){n||(V.isHostOn(T)?n=!0:V.isDescendantOf(T)&&(n=!0))}),!n){var H=V.getRect();o=H.x,c=H.y,z=H.width,A=H.height,j.push({node:V,type:0,p:o},{node:V,type:1,p:o+z/2},{node:V,type:2,p:o+z}),l.push({node:V,type:0,p:c},{node:V,type:1,p:c+A/2},{node:V,type:2,p:c+A}),Z[V._id]=H}}}),j.sort(function(E,s){return E.p-s.p}),l.sort(function(j,a){return j.p-a.p}),T._grid=J,T._87I=Z},kr.prototype.gatherLines=function(b,j,q){var d,G,A,g,H,v,M,o,s,I,Z,y,T=this,J=[T.findClosest({x:b.x,y:b.y},j),T.findClosest({x:b.x+b.w/2,y:b.y+b.h/2},j),T.findClosest({x:b.x+b.w,y:b.y+b.h},j)],f={},V=T._87I;q=q||255;var t,P;for(T._guideLine=[],d=0;2>d;d++)for(f={},0===d?(g="y",o=b.x,s=o+b.w):(g="x",o=b.y,s=o+b.h),G=0;3>G;G++)H=J[G],H&&isFinite(H[g])&&(t=1<<3*d+G,q&t&&(v=H[g+"Line"],M=v.node,P=M._id||0,f[P]||(f[P]=!0,y=V[P],"y"===g?(I=y.x,Z=y.x+y.width):(I=y.y,Z=y.y+y.height),A=v.p,T._guideLine.push({type:g,a:o,b:s,c:I,d:Z,p:A}))))},kr.prototype._binarySearchClosest=function(a,h){if(!h.length)return{dis:1/0};for(var Q,E=0,r=h.length-1;r-E>1;)Q=Math.floor((E+r)/2),h[Q].p<a?E=Q:r=Q;var V=h[E].p-a,y=h[r].p-a;return Math.abs(V)<=Math.abs(y)?{line:h[E],dis:V}:{line:h[r],dis:y}},kr.prototype.findClosest=function(L,p,Z){var _=this,z=_._interactor,T=z.gv,I=_._grid;Z&&(L=le.toWorldPosition(T,L));var S,j=_._binarySearchClosest(L.x,I.x),X=_._binarySearchClosest(L.y,I.y),G=j.dis,C=X.dis,c=T._zoom,J=z.getStyle("smartGuideSensitivity")/c,b={};return Math.abs(G)<J&&"y"!==p&&(b.x=Z?G*c:G,b.xLine=j.line,S=!0),Math.abs(C)<J&&"x"!==p&&(b.y=Z?C*c:C,b.yLine=X.line,S=!0),S?b:void 0},kr.prototype._42=function(){var m=this,E=m._guideLine;if(E&&!i.Default.isCtrlDown()){var F,S,_,W,w,J,o,g,U,c,V,B,G,k,P,q,N,u=m._interactor,y=u.gv,b=u._context,f=y.tx(),A=y.ty(),$=y._zoom,R=u.getStyle("guideLineTextSpacing");for(F=0,S=E.length;S>F;F++)_=E[F],g=_.type,U=_.p,c=_.a,V=_.b,B=_.c,G=_.d,k=Math.min(c,B),P=Math.max(V,G),"x"===g?(W=U*$+f,w=k*$+A,J=W,o=P*$+A):(W=k*$+f,w=U*$+A,J=P*$+f,o=w),le.Icons.DrawIcon(u,b,le.Icons.MoveLineGuide,[W,w,J,o]),G>=c&&V>=B||(k=c>G?G:V,P=c>G?c:B,N=P-k,"x"===g?(_.center2center||(W-=R,J=W),w=k*$+A,o=P*$+A,q=le.Icons.MoveLineGuideDistanceV):"y"===g&&(_.center2center||(w-=R,o=w),W=k*$+f,J=P*$+f,q=le.Icons.MoveLineGuideDistanceH),le.Icons.DrawIcon(u,b,q,{x0:W,y0:w,x1:J,y1:o,dis:N}))}},kr.prototype.clear=function(){this._guideLine=null},le.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeHighlighPointBackground:"#30599e"};var Nd=le.Icons={},Ub=1e4,xs=null,dl=8;i.Default.setImage("Icons.RectPoint",{width:dl,height:dl,comps:[{type:"shape",points:[0,0,0,dl,dl,dl,dl,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return xs.getStyle("rectPointShadowColor")}},background:{func:function(){return xs.getStyle("rectPointBackground")}},borderColor:{func:function(){return xs.getStyle("rectPointBorderColor")}}}]});var Yo="#e000e0";Nd.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var K=Nd.GroupSubEntityRect.data;if(!K)return[];var B=K.min,E=K.max;return[B.x,B.y,B.x,E.y,E.x,E.y,E.x,B.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Nd.GroupSubEntityRect.data.isKeyOb?Yo:"#666666"}}}]},Nd.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nd.Line.data.P1.x,Nd.Line.data.P1.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nd.Line.data.P2.x,Nd.Line.data.P2.y],dl,dl]}}}]},Nd.EdgeHostGuide={comps:[{type:"shape",points:{func:function(){return Nd.EdgeHostGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:2,borderColor:"red"}]},Nd.Rect={comps:[{type:"shape",points:{func:function(){var D=Nd.Rect.data;if(!D)return[];var Z=D.LT,y=D.LB,W=D.RB,K=D.RT;return[Z.x,Z.y,y.x,y.y,W.x,W.y,K.x,K.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nd.Rect.data.rotation}},rect:{func:function(){return[[Nd.Rect.data.LT.x,Nd.Rect.data.LT.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nd.Rect.data.rotation}},rect:{func:function(){return[[Nd.Rect.data.LB.x,Nd.Rect.data.LB.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nd.Rect.data.rotation}},rect:{func:function(){return[[Nd.Rect.data.RB.x,Nd.Rect.data.RB.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nd.Rect.data.rotation}},rect:{func:function(){return[[Nd.Rect.data.RT.x,Nd.Rect.data.RT.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Nd.Rect.data.rotation}},visible:{func:function(){return Nd.Rect.data.L?!0:!1}},rect:{func:function(){return[[Nd.Rect.data.L.x,Nd.Rect.data.L.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Nd.Rect.data.rotation}},visible:{func:function(){return Nd.Rect.data.R?!0:!1}},rect:{func:function(){return[[Nd.Rect.data.R.x,Nd.Rect.data.R.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Nd.Rect.data.rotation}},visible:{func:function(){return Nd.Rect.data.T?!0:!1}},rect:{func:function(){return[[Nd.Rect.data.T.x,Nd.Rect.data.T.y],dl,dl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Nd.Rect.data.rotation}},visible:{func:function(){return Nd.Rect.data.B?!0:!1}},rect:{func:function(){return[[Nd.Rect.data.B.x,Nd.Rect.data.B.y],dl,dl]}}}]};var Ke=18;i.Default.setImage("Icons.Anchor",{width:Ke,height:Ke,comps:[{type:"arc",rect:[4,4,Ke-8,Ke-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,Ke/2,Ke-2,Ke/2,Ke/2,2,Ke/2,Ke-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,Ke-11,Ke-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),Nd.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Nd.Anchor.data.POS.x,Nd.Anchor.data.POS.y],Ke,Ke]}}}]},Nd.TipShiftX=12,Nd.TipShiftY=12;var _g=[8,28];Nd.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Nd.TipHelper.data.helperPos.x,Nd.TipHelper.data.helperPos.y,_g[0]*Nd.TipHelper.data.size,_g[1]]}},background:{func:function(){return xs.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Nd.TipHelper.data.text}},rect:{func:function(){return[Nd.TipHelper.data.helperPos.x,Nd.TipHelper.data.helperPos.y,_g[0]*Nd.TipHelper.data.size,_g[1]]}},color:{func:function(){return xs.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var pe=7;Nd.ShapePoint={comps:[{type:"circle",rect:{func:function(){var z=Nd.ShapePoint.data;return[z,pe,pe]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},Nd.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Nd.ShapeBgCurve.data.P}},segments:{func:function(){return Nd.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var ol=8;Nd.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var B=Nd.ShapeHighlighPoint.data;return[[B.x,B.y],ol,ol]}},background:{func:function(){return xs.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Qc=10;Nd.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var a=Nd.ShapeHighlighRealPoint.data;return[[a.x,a.y],Qc,Qc]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var Rp=8;Nd.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var V=Nd.ShapeHighlighCtrlPoint.data,N=V.x,K=V.y,s=Rp/2;return[N-s,K-s,N-s,K+s,N+s,K+s,N+s,K-s]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return xs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return xs.getStyle("shapeCtrlPointBorderColor")}}}]};var Zc=3;Nd.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Nd.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Zc,borderColor:{func:function(){return xs.getStyle("curveHighlightColor")
}}}]},Nd.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Nd.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},Nd.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Nd.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var ze=5;Nd.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var u=Nd.MoveLineGuideDistanceH.data,o=u.x0,R=u.y0,p=u.x1,N=u.y1;return[o,R,p,N,o,R-ze,o,R+ze,p,N-ze,p,N+ze]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(Nd.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var r=Nd.MoveLineGuideDistanceH.data;return[[(r.x0+r.x1)/2,r.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},Nd.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var v=Nd.MoveLineGuideDistanceV.data,r=v.x0,I=v.y0,M=v.x1,U=v.y1;return[r,I,M,U,r-ze,I,r+ze,I,M-ze,U,M+ze,U]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(Nd.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var F=Nd.MoveLineGuideDistanceV.data;return[[F.x0-10,(F.y0+F.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]};var Lj=6;Nd.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Nd.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var z=Nd.ShapeActivingCtrl.data;return[z.point.x,z.point.y,z.c1.x,z.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return Nd.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var o=Nd.ShapeActivingCtrl.data;return[o.point.x,o.point.y,o.c2.x,o.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return Nd.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var X=Nd.ShapeActivingCtrl.data.c1,H=X.x,s=X.y,n=Lj/2;return[H-n,s-n,H-n,s+n,H+n,s+n,H+n,s-n]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return xs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return xs.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return Nd.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var f=Nd.ShapeActivingCtrl.data.c2,Q=f.x,d=f.y,H=Lj/2;return[Q-H,d-H,Q-H,d+H,Q+H,d+H,Q+H,d-H]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return xs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return xs.getStyle("shapeCtrlPointBorderColor")}}}]},le.Icons.DrawIcon=function(c,r,m,S){m.width=m.height=Ub,m.data=S,xs=c,i.Default.drawImage(r,m,0,0,Ub,Ub)},le.Icons.MapPoints=function(k,P){for(var y=0,o=k.length;o>y;y++)k[y]/=P},le.roundTo=function(J,H,E){var P=Math.abs(J%H);return E>P||E>H-P?H*Math.round(J/H):J},le.toFixed=function(K){return Math.round(100*K)/100},le.getDataMatrix=function(D){if(D instanceof i.Shape){var S=new le.Math.Matrix2,d=D.getPosition();return S.translate(-d.x,-d.y).scale(D.getScale().x,D.getScale().y).rotate(D.getRotation()).translate(d.x,d.y),S}return D.getMatrix?D.getMatrix():new le.Math.Matrix2},Math.sign===Q&&(Math.sign=function(E){return 0>E?-1:E>0?1:+E});var Ir=le.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};Ir.prototype={},Ir.prototype.constructor=Ir,Ir.prototype.set=function(g,j,b,W,E,k){return this.a=g,this.b=j,this.c=b,this.d=W,this.tx=E,this.ty=k,this},Ir.prototype.apply=function(k,t){t=t||new Th;var C=k.x,h=k.y;return t.x=this.a*C+this.c*h+this.tx,t.y=this.b*C+this.d*h+this.ty,t},Ir.prototype.applyInverse=function(e,h){h=h||new Th;var C=1/(this.a*this.d+this.c*-this.b),p=e.x,z=e.y;return h.x=this.d*C*p+-this.c*C*z+(this.ty*this.c-this.tx*this.d)*C,h.y=this.a*C*z+-this.b*C*p+(-this.ty*this.a+this.tx*this.b)*C,h},Ir.prototype.translate=function(j,W){return this.tx+=j,this.ty+=W,this},Ir.prototype.scale=function(K,k){return this.a*=K,this.d*=k,this.c*=K,this.b*=k,this.tx*=K,this.ty*=k,this},Ir.prototype.rotate=function(x){var b=Math.cos(x),K=Math.sin(x),f=this.a,v=this.c,r=this.tx;return this.a=f*b-this.b*K,this.b=f*K+this.b*b,this.c=v*b-this.d*K,this.d=v*K+this.d*b,this.tx=r*b-this.ty*K,this.ty=r*K+this.ty*b,this},Ir.prototype.append=function(Q){var D=this.a,G=this.b,l=this.c,R=this.d;return this.a=Q.a*D+Q.b*l,this.b=Q.a*G+Q.b*R,this.c=Q.c*D+Q.d*l,this.d=Q.c*G+Q.d*R,this.tx=Q.tx*D+Q.ty*l+this.tx,this.ty=Q.tx*G+Q.ty*R+this.ty,this},Ir.prototype.setTransform=function(C,a,A,X,c,j,U,$,P){var E,B,Q,e,q,i,T,t,O,s;return q=Math.sin(U),i=Math.cos(U),T=Math.cos(P),t=Math.sin(P),O=-Math.sin($),s=Math.cos($),E=i*c,B=q*c,Q=-q*j,e=i*j,this.a=T*E+t*Q,this.b=T*B+t*e,this.c=O*E+s*Q,this.d=O*B+s*e,this.tx=C+(A*E+X*Q),this.ty=a+(A*B+X*e),this},Ir.prototype.prepend=function(k){var F=this.tx;if(1!==k.a||0!==k.b||0!==k.c||1!==k.d){var e=this.a,G=this.c;this.a=e*k.a+this.b*k.c,this.b=e*k.b+this.b*k.d,this.c=G*k.a+this.d*k.c,this.d=G*k.b+this.d*k.d}return this.tx=F*k.a+this.ty*k.c+k.tx,this.ty=F*k.b+this.ty*k.d+k.ty,this},Ir.prototype.invert=function(){var $=this.a,P=this.b,E=this.c,g=this.d,o=this.tx,b=$*g-P*E;return this.a=g/b,this.b=-P/b,this.c=-E/b,this.d=$/b,this.tx=(E*this.ty-g*o)/b,this.ty=-($*this.ty-P*o)/b,this},Ir.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ir.prototype.clone=function(){var M=new Ir;return M.a=this.a,M.b=this.b,M.c=this.c,M.d=this.d,M.tx=this.tx,M.ty=this.ty,M},Ir.prototype.copy=function(E){return E.a=this.a,E.b=this.b,E.c=this.c,E.d=this.d,E.tx=this.tx,E.ty=this.ty,E},Ir.IDENTITY=new Ir,Ir.TEMP_MATRIX=new Ir;var Th=le.Math.Vector2=function(X,w){"object"==typeof X&&(X.x!=Q?(w=X.y,X=X.x):(w=X[1],X=X[0])),this.set(X||0,w||0)};Th.prototype={},Th.prototype.constructor=Th,P.defineProperties(Th.prototype,{width:{get:function(){return this.x},set:function(Y){this.x=Y}},height:{get:function(){return this.y},set:function(H){this.y=H}}}),Th.prototype.clone=function(){return new Th(this.x,this.y)},Th.prototype.copy=function(j){return this.set(j.x,j.y),this},Th.prototype.equals=function(E){return E.x===this.x&&E.y===this.y},Th.prototype.set=function(n,B){return this.x=n||0,this.y=B||(0!==B?this.x:0),this},Th.prototype.setScalar=function(m){return this.x=m,this.y=m,this},Th.prototype.setX=function(F){return this.x=F||0,this},Th.prototype.setY=function(l){return this.y=l||0,this},Th.prototype.add=function(Z){return this.x+=Z.x,this.y+=Z.y,this},Th.prototype.addVectors=function(p,W){return this.x=p.x+W.x,this.y=p.y+W.y,this},Th.prototype.addScalar=function(h){return this.x+=h,this.y+=h,this},Th.prototype.addScaledVector=function(A,d){return this.x+=A.x*d,this.y+=A.y*d,this},Th.prototype.sub=function(j){return this.x-=j.x,this.y-=j.y,this},Th.prototype.subScalar=function(O){return this.x-=O,this.y-=O,this},Th.prototype.subVectors=function(S,R){return this.x=S.x-R.x,this.y=S.y-R.y,this},Th.prototype.multiply=function(P){return this.x*=P.x,this.y*=P.y,this},Th.prototype.multiplyScalar=function(m){return this.x*=m,this.y*=m,this},Th.prototype.divide=function(r){return this.x/=r.x,this.y/=r.y,this},Th.prototype.divideScalar=function(s){return this.multiplyScalar(1/s)},Th.prototype.min=function(E){return this.x=Math.min(this.x,E.x),this.y=Math.min(this.y,E.y),this},Th.prototype.max=function(I){return this.x=Math.max(this.x,I.x),this.y=Math.max(this.y,I.y),this},Th.prototype.clamp=function(M,t){return this.x=Math.max(M.x,Math.min(t.x,this.x)),this.y=Math.max(M.y,Math.min(t.y,this.y)),this},Th.prototype.clampScalar=function(){var R,s;return function(J,x){return R===Q&&(R=new Th,s=new Th),R.set(J,J),s.set(x,x),this.clamp(R,s)}}(),Th.prototype.clampLength=function(F,K){var v=this.length();return this.multiplyScalar(Math.max(F,Math.min(K,v))/v)},Th.prototype.dot=function(p){return this.x*p.x+this.y*p.y},Th.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Th.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Th.prototype.normalize=function(){return this.divideScalar(this.length())},Th.prototype.angle=function(){var M=Math.atan2(this.y,this.x);return 0>M&&(M+=2*Math.PI),M},Th.prototype.distanceTo=function(D){return Math.sqrt(this.distanceToSquared(D))},Th.prototype.distanceToSquared=function(o){var W=this.x-o.x,b=this.y-o.y;return W*W+b*b},Th.prototype.isNearEnough=function(r){return this.distanceToSquared(r)<1e-8},Th.prototype.setLength=function(m){return this.multiplyScalar(m/this.length())},Th.prototype.lerp=function(j,O){return this.x+=(j.x-this.x)*O,this.y+=(j.y-this.y)*O,this},Th.prototype.lerpVectors=function(A,r,k){return this.subVectors(r,A).multiplyScalar(k).add(A)},Th.prototype.rotateAround=function(K,W){var t=Math.cos(W),s=Math.sin(W),Q=this.x-K.x,v=this.y-K.y;return this.x=Q*t-v*s+K.x,this.y=Q*s+v*t+K.y,this};var $l=le.Math.Curve=function(){this._curves=[]};$l.prototype={},$l.prototype.constructor=$l,$l.prototype.createFromHtShape=function(z,R){R instanceof i.List&&(R=R.toArray());var K,V,v,t,l,L,k,T=this,D=null,f=null,U=0,N=le.Math.Vector2,X=le.Math.CubicBezier;for(V=0,v=R.length;v>V;V++){switch(t=R[V],l=null,t){case 1:f=new N(z[U],z[U+1]),D=f,U+=2;break;case 2:K=new N(z[U],z[U+1]),U+=2,l=new X(f,f.clone(),K.clone(),K),f=K;break;case 3:L=new N(z[U],z[U+1]),K=new N(z[U+2],z[U+3]),U+=4,l=new X(f,L.clone().sub(f).multiplyScalar(2/3).add(f),L.clone().sub(K).multiplyScalar(2/3).add(K),K),f=K;break;case 4:L=new N(z[U],z[U+1]),k=new N(z[U+2],z[U+3]),K=new N(z[U+4],z[U+5]),U+=6,l=new X(f,L,k,K),f=K;break;case 5:if(!D)break;l=new X(f,f.clone(),D.clone(),D),f=null,D=null}l&&(l._index=T._curves.length,T._curves.push(l))}},$l.prototype.checkPoint=function(L,h){var b,P,e,j,w,r=this,W=r._curves;for(b=0,P=W.length;P>b;b++)if(j=W[b],w=j.intersectRect(L,h,h),w.length)return e=0,w.forEach(function(Z){e+=Z.t}),e/=w.length,L=j.getPointAt(e),L.t=e,{bezier:j,intersection:L}},$l.prototype.insertKnot=function(w,u){var h=w.insertKnot(u),b=this,U=b._curves;U.splice(w._index,1,h[0],h[1])},$l.prototype._isCloseEnough=function(I,b){return Math.abs(I.x-b.x)<1e-6&&Math.abs(I.y-b.y)<1e-6},$l.prototype._isSamePoint=function(U,w){return U===w},$l.prototype.moveRealPoint=function(G,Z){var E=this,p=E._curves,T=Z.clone().sub(G);p.forEach(function(w){var z=w._p1;w._p2,w._p3;var B=w._p4;E._isSamePoint(z,G)&&(w._p2.add(T),w._p1=Z),E._isSamePoint(B,G)&&(w._p3.add(T),w._p4=Z)})},$l.prototype.moveCtrlPoint=function(n,C,W){var $=n[W];if($){var p=this,T=p._curves;C.clone().sub($),T.forEach(function(a){var t;"c2"===W?t="_p2":"c1"===W&&(t="_p3"),p._isSamePoint(a[t],$)&&(a[t]=C)}),n[W]=C}},$l.prototype.deleteRealPoint=function($,z){var G,n,t,h,D,V,M,C=this,u=C._curves,B={},H=[],l=le.Math.CubicBezier;for(n=0,t=u.length;t>n;n++)G=u[n],h=G._p1,D=G._p2,V=G._p3,M=G._p4,(B[n]||!C._isSamePoint(h,$))&&(C._isSamePoint(M,$)?t>n+1&&C._isSamePoint(u[n+1]._p1,$)&&(z||H.push(new l(h,D,u[n+1]._p3,u[n+1]._p4))):H.push(G));C._curves=H},$l.prototype.findPairs=function(Z,L){var t,x,g,m,f,j,v,F,p=this,O=p._curves,H={},d=[];for(x=0,g=O.length;g>x;x++)t=O[x],m=t._p1,f=t._p2,j=t._p3,v=t._p4,!H[x]&&p._isSamePoint(m,Z)&&(L?d.push({point:m,r2:v}):d.push({point:m,c2:f})),p._isSamePoint(v,Z)&&(F=L?{point:v,r1:m}:{point:v,c1:j},g>x+1&&p._isSamePoint(O[x+1]._p1,Z)&&(L?F.r2=O[x+1]._p4:F.c2=O[x+1]._p2,H[x+1]=!0),d.push(F));return d},$l.prototype.toHtShape=function(){var K=this,u=K._curves,B=[],Z=[],y={x:1/0,y:1/0};return u.forEach(function(i){var U=i._p1,l=i._p2,c=i._p3,W=i._p4;return K._isCloseEnough(U,y)||(B.push(1),Z.push(U.clone())),y=W,K._isCloseEnough(U,l)&&K._isCloseEnough(c,W)?(B.push(2),Z.push(W.clone()),void 0):(B.push(4),Z.push(l.clone(),c.clone(),W.clone()),void 0)}),{segments:B,points:Z}};var vq=le.Math.CubicBezier=function(T,l,Z,v){var F=this;F._id=le.Math.CubicBezier._globalId++,F._p1=T,F._p2=l,F._p3=Z,F._p4=v};vq._globalId=1,vq.prototype={},vq.prototype.constructor=vq,vq.prototype.toString=function(){return this._id},vq.prototype.intersectRect=function(h,z,y){var J=z/2,m=y/2,X=h.x,b=h.y,j=le.Math.Vector2,U=new j(-J+X,-m+b),e=new j(J+X,m+b),B=new j(e.x,U.y),q=new j(U.x,e.y),E=this,A=E.intersectLine(U,B),P=E.intersectLine(B,e),w=E.intersectLine(e,q),$=E.intersectLine(q,U),V=A.concat(P).concat(w).concat($);return V},vq.prototype.intersectLine=function(e,o){var O,L,g,d,Y,S,X,v,P,D,r,i,M,h=this,E=e.clone().min(o),J=e.clone().max(o);d=h._p1,Y=h._p2,S=h._p3,X=h._p4,O=d.clone().multiplyScalar(-1),L=Y.clone().multiplyScalar(3),g=S.clone().multiplyScalar(-3),r=O.add(L).add(g).add(X),O=d.clone().multiplyScalar(3),L=Y.clone().multiplyScalar(-6),g=S.clone().multiplyScalar(3),D=O.add(L).add(g),O=d.clone().multiplyScalar(-3),L=Y.clone().multiplyScalar(3),P=O.add(L),v=d.clone(),M=new le.Math.Vector2(e.y-o.y,o.x-e.x),i=e.x*o.y-o.x*e.y;for(var b=h.getRoots(M.dot(r),M.dot(D),M.dot(P),M.dot(v)+i),I=new Array,H=0,Q=b.length;Q>H;H++){var j=b[H];if(!(0>j||j>1)){var c=d.clone().lerp(Y,j),w=Y.clone().lerp(S,j),G=S.clone().lerp(X,j),Z=c.lerp(w,j),u=w.lerp(G,j),K=Z.lerp(u,j);K.t=j,e.x==o.x?E.y<=K.y&&K.y<=J.y&&I.push(K):e.y==o.y?E.x<=K.x&&K.x<=J.x&&I.push(K):K.x>=E.x&&K.y>=E.y&&K.x<=J.x&&K.y<=J.y&&I.push(K)}}return I},vq.prototype.solveTForPoint=function(M){var J,H,s,i,g=this;J=g._p1.x-M.x,H=g._p2.x-M.x,s=g._p3.x-M.x,i=g._p4.x-M.x;for(var f=g.getRoots(i-3*s+3*H-J,3*s-6*H+3*J,3*H-3*J,J),X=Q,p=1/0,U=0,c=f.length;c>U;U++){var u=f[U];if(!(0>u||u>1)){var L=g._p1.clone().lerp(g._p2,u),w=g._p2.clone().lerp(g._p3,u),W=g._p3.clone().lerp(g._p4,u),R=L.lerp(w,u),B=w.lerp(W,u),k=R.lerp(B,u);k.t=u;var Z=Math.abs(k.y-M.y);p>Z&&(p=Z,X=k)}}return X},vq.prototype.getPointAt=function($){var x=this,s=x._p1,c=x._p2,q=x._p3,U=x._p4,p=s.clone().lerp(c,$),T=c.clone().lerp(q,$),W=q.clone().lerp(U,$),l=p.lerp(T,$),H=T.lerp(W,$);return l.lerp(H,$)},vq.prototype.getRoots=function(Q,N,B,h){var S,K,c,x,o,j=new Array;if(Math.abs(Q)<1e-6){var S=N,K=B/S,c=h/S,x=K*K-4*c;if(x>0){var o=Math.sqrt(x);j.push(.5*(-K+o)),j.push(.5*(-K-o))}else 0==x&&j.push(.5*-K)}N/=Q,B/=Q,h/=Q,S=(3*B-N*N)/3,K=(2*N*N*N-9*B*N+27*h)/27;var b=N/3,l=K*K/4+S*S*S/27,p=K/2;if(Math.abs(l)<=1e-6&&(l=0),l>0){var G,g,o=Math.sqrt(l);G=-p+o,g=G>=0?Math.pow(G,1/3):-Math.pow(-G,1/3),G=-p-o,G>=0?g+=Math.pow(G,1/3):g-=Math.pow(-G,1/3),j.push(g-b)}else if(0>l){var C=Math.sqrt(-S/3),A=Math.atan2(Math.sqrt(-l),-p)/3,q=Math.cos(A),F=Math.sin(A),u=Math.sqrt(3);j.push(2*C*q-b),j.push(-C*(q+u*F)-b),j.push(-C*(q-u*F)-b)}else{var G;G=p>=0?-Math.pow(p,1/3):Math.pow(-p,1/3),j.push(2*G-b),j.push(-G-b)}return j},vq.prototype._70I=function(){var K=this;return K._p1.distanceToSquared(K._p2)<1e-10&&K._p3.distanceToSquared(K._p4)<1e-10},vq.prototype.insertKnot=function(N){var R=this,i=R._p1,e=R._p2,j=R._p3,k=R._p4,D=i.clone().lerp(e,N),X=e.clone().lerp(j,N),Y=j.clone().lerp(k,N),n=D.clone().lerp(X,N),H=X.clone().lerp(Y,N),q=n.clone().lerp(H,N);return R._70I()?(i.clone().lerp(k,N),[new le.Math.CubicBezier(i,i.clone(),q.clone(),q),new le.Math.CubicBezier(q,q.clone(),k.clone(),k)]):[new le.Math.CubicBezier(i,D,n,q),new le.Math.CubicBezier(q,H,Y,k)]};var mi=i.Default.getInternal().ui().EdgeUI,dg={_47O:function(P){var R=this,K=dg.getBackups()._47O;le.inEdit(R.gv)||K.call(R,P)}};le.Inject.registAsModule(dg,mi);var Ql=i.Default.getInternal().ui().NodeUI,Rc={_47O:function(Y){var n=this,q=Rc.getBackups()._47O;le.inEdit(n.gv)||q.call(n,Y)},getSelectWidth:function(){var r=this,C=r.gv,o=r._data;if(C.isEditable(o)&&le.inEdit(C))return 0;var w=Rc.getBackup("getSelectWidth");return w.call(r)}};le.Inject.registAsModule(Rc,Ql);var Id=i.graph.GraphView,rh={_editPointSize:function(){var j=i.Default.isTouchable,D=le.getStyle("pointSize");return D[j?0:1]}(),isPointEditable:function(j){var Q=this;if(le.inEdit(Q))return Q._pointEditableFunc?Q._pointEditableFunc(j):!0;var J=rh.getBackup("isPointEditable");J.call(Q,j)},isEditable:function(U){var b,D=this,$=rh.getBackup("isEditable");if(b=U instanceof le.Group?!0:$.call(D,U),!le.inEdit(D))return b;if(!(U instanceof i.Edge))return b;if(!U.s("2d.editable"))return!1;var G=D.getEditableFunc();return G?G(U):!0},_42:function(g,H){var z=this,Y=rh.getBackups()._42;if(Y.call(z,g,H),le.inEdit(z)){var X=z.getEditInteractor();X.drawImpl()}}};le.Inject.registAsModule(rh,Id);var Le=i.Default.getInternal().ui().ShapeUI,Jd={_47O:function(L){var T=this,E=Jd.getBackups()._47O;le.inEdit(T.gv)||E.call(T,L)}};le.Inject.registAsModule(Jd,Le);var Aq=i.graph.DefaultInteractor,Ue={handle_mousewheel:function(P){var w=this,h=Ue.getBackup("handle_mousewheel");le.inEdit(w.gv)||h.call(w,P)}};le.Inject.registAsModule(Ue,Aq);var sg=i.graph.MoveInteractor,Ek={_calcShift:function(J,E){var A=this,j=Ek.getBackup("_calcShift"),P=A.gv;if(!le.inEdit(P))return j.call(A,J,E);var S=P.getEditInteractor(),V=S.getSubModule("Move").calcShift(J,E,A);return V||j.call(A,J,E)},clear:function(v){var P=this,o=Ek.getBackup("clear");o.call(P,v);var J=P.gv;if(le.inEdit(J)){var t=J.getEditInteractor();t.getSubModule("Move").clear(v)}}};le.Inject.registAsModule(Ek,sg);var kr=le.Rect=function(N){this.catalog="Rect",this._interactor=N};kr.prototype={},kr.prototype.constructor=kr,kr.prototype.gatherInfo=function(r,B){var u=this;if(1===B.length){var h=B[0];return h instanceof i.Shape&&h._70I()?u.gatherLine(r,h):as(h,r)?!1:u.gatherSingleTarget(r,h)}return B.length>1?u.gatherMultiTargets(r,B):!1},kr.prototype.gatherSingleTarget=function(q,W){if(W.getCorners){var z,K=this.info;this.target=W,z=this.screenInfo={};var O=W.getCorners();K.LT=new le.Math.Vector2(O[0]),K.LB=new le.Math.Vector2(O[1]),K.RB=new le.Math.Vector2(O[2]),K.RT=new le.Math.Vector2(O[3]),K.T=K.LT.clone().add(K.RT).divideScalar(2),K.B=K.LB.clone().add(K.RB).divideScalar(2),K.L=K.LT.clone().add(K.LB).divideScalar(2),K.R=K.RT.clone().add(K.RB).divideScalar(2);for(var S in K)z[S]=le.toScreenPosition(q,K[S]);var u=this._interactor.getStyle("checkSize"),k=function(d,G,$){var n=G.clone().sub(d).setLength(-u),H=$.clone().sub(d).setLength(-u),i=n.add(H).add(d);return i};return z.rotLT=k(z.LT,z.RT,z.LB),z.rotLB=k(z.LB,z.LT,z.RB),z.rotRB=k(z.RB,z.LB,z.RT),z.rotRT=k(z.RT,z.LT,z.RB),z.rotT=z.rotLT.clone().add(z.rotRT).divideScalar(2),z.rotB=z.rotLB.clone().add(z.rotRB).divideScalar(2),z.rotL=z.rotLT.clone().add(z.rotLB).divideScalar(2),z.rotR=z.rotRT.clone().add(z.rotRB).divideScalar(2),z.rotation=W.getRotation(),!0}},kr.prototype.gatherMultiTargets=function(Z,L){var n=le.Group.findOrCreateGroup(L);if(!n)return!1;var D=this;return D.editing&&"rotate"!==D.editing.mode||n.calcInfo(),D.gatherSingleTarget(Z,n)},kr.prototype.gatherLine=function(S,J){this.target=J;var n=this.screenInfo={},M=J.getPoints(),F=le.getDataMatrix(J);return n.P1=le.toScreenPosition(S,F.apply(M.get(0))),n.P2=le.toScreenPosition(S,F.apply(M.get(1))),!0},kr.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],kr.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],kr.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],kr.prototype.check=function(E,X,d){if(i.Default.isLeftButton(X)){var j=this;if(j.editing=null,j.tipInfo=null,j.screenInfo){if(j.screenInfo.P1)return j._checkLine(d);var x,H,W,G=null,T=j._interactor,m=T.getStyle("checkSize"),L=j.target,v=E.isEditable(L);if(v&&E.isRectEditable(L))for(H=0;H<le.Rect.ResizeKeys.length;H++)if(W=le.Rect.ResizeKeys[H],le.checkHit(d,j.screenInfo[W],m)){G=W,x="resize";break}if(!G&&v&&E.isRotationEditable(L)){var K=T.getStyle("rotateCheckSize");for(H=0;H<le.Rect.RotateKeys.length;H++)if(W=le.Rect.RotateKeys[H],le.checkHit(d,j.screenInfo[W],K)){G=W,x="rotate";break}}if(!G)return this._interactor.setCursor("default"),void 0;if("rotate"===x){this._interactor.setCursor("crosshair");var C,B=E.lp(X);if(L instanceof le.Group){var O=T.getStyle("groupRotateModeKey");"string"==typeof O&&(O=[O]);for(var M=!1,t=0,u=O.length;u>t;t++)if(X[O[t]]){M=!0;break}var $=T.getStyle("groupRotateModeDefault");C=M?"batch"===$?"block":"batch":$}var f="batch"===C?L.getAnchor2():L.getPosition();j.editing={mode:x,key:G,pos:f,flipY:L.getScale().y<0,rotation:L.getRotation(),hitRot:Math.atan2(B.y-f.y,B.x-f.x)},C&&(j.editing.groupRotateMode=C)}else{var R=le.Rect.ResizeKeys.indexOf(G),c=le.Rect.ResizeDirection[R],p=Math.cos(L.getRotation()),y=Math.sin(L.getRotation()),b=c.x*Math.sign(L.getScale().x),s=c.y*Math.sign(L.getScale().y),N=Math.atan2(-y*b-p*s,p*b-y*s),q=(Math.round(N/(Math.PI/4))+8)%8,g=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][q];this._interactor.setCursor(g);var Q=L.getWidth(),a=L.getHeight(),h=L.getAnchor();j.editing={mode:x,key:G,rect:{x:-Q*h.x,y:-a*h.y,width:Q,height:a},anchor:h,matrix:L.getMatrix()}}return G}}},kr.prototype._checkLine=function($){var X=this;X.screenInfo;var J,O=X._interactor.getStyle("checkSize");if(le.checkHit($,X.screenInfo.P1,O))J="P1";else{if(!le.checkHit($,X.screenInfo.P2,O))return this._interactor.setCursor("default"),void 0;J="P2"}return X.editing={mode:"line",key:J},J},kr.prototype.startEdit=function(c,q){c.startDragging(q);var t=this;t._interactor.fi({kind:"prepareEdit",event:q});var P=t.editing,y=t.target;return P?"rotate"===P.mode?(P.groupRotateMode&&y.beginRotate(P),void 0):(("line"===P.mode||y&&0===y.getRotation())&&(t._inSmartGuide=!0,t._interactor.rectGuide.gatherRects()),void 0):void 0},kr.prototype._46O=function(){var T=this,i=T.editing?T.editing.groupRotateMode:null;T.editing=null,T.tipInfo=null,T._inSmartGuide&&(T._interactor.rectGuide.clear(),T._inSmartGuide=!1),i&&T.target&&T.target.endRotate()},kr.prototype.handleEdit=function(k,W){var c=this,b=c.editing;if(b){var D,G,J,F,u,R,j=c.target,U=b.key,P=b.mode,Z=c._interactor;if("rotate"===P){var Q,l=k.lp(W),z=b.pos,N=Math.atan2(l.y-z.y,l.x-z.x);if(b.groupRotateMode?Q=N-b.hitRot:(N-=b.hitRot,Q=b.rotation+N),Q%=2*Math.PI,0>Q&&(Q+=2*Math.PI),!i.Default.isCtrlDown(W)){var q,T;Wi(W)?(q=Z.getStyle("shiftRotateRound"),T=q/2):(q=Z.getStyle("rotateRound"),T=Z.getStyle("rotateSensitivity")),Q=le.roundTo(Q,q,T)}b.groupRotateMode?(N=Q-(b.lastRotation||0),0!==N&&(j.addRotation(N,b.groupRotateMode),b.lastRotation=Q)):j.setRotation(Q),Q>Math.PI&&(Q-=2*Math.PI);var n=180*(Q/Math.PI);n=n.toFixed(2),D=""+n+"°"}else if("resize"===P){var O=b.rect;F=O.x,u=O.y;var A=O.width,d=O.height,f=b.anchor,V=b.matrix;G=k.lp(W);var L,$=Wi(W),e=c._unionPointMode1,C=c._unionPointMode2;if(c._inSmartGuide&&!i.Default.isCtrlDown(W)&&!$){var H;"L"===U||"R"===U?H="x":("T"===U||"B"===U)&&(H="y"),c._adsorbedToClosest(G,H),R=!0}L=V.tfi(G);var a;"LT"===U?(O=e(L,{x:F+A,y:u+d},A,d,$),a=9):"T"===U?(O=C({x:F,y:L.y},{x:F+A,y:u+d},A,d,$,"v"),a=1):"RT"===U?(O=e(L,{x:F,y:u+d},A,d,$),a=33):"L"===U?(O=C({x:L.x,y:u},{x:F+A,y:u+d},A,d,$,"h"),a=8):"R"===U?(O=C({x:F,y:u},{x:L.x,y:u+d},A,d,$,"h"),a=32):"LB"===U?(O=e(L,{x:F+A,y:u},A,d,$),a=12):"B"===U?(O=C({x:F,y:u},{x:F+A,y:L.y},A,d,$,"v"),a=4):"RB"===U&&(O=e(L,{x:F,y:u},A,d,$),a=36);var S=V.tf(O.x+O.width*f.x,O.y+O.height*f.y);j.setPosition(S),j.setSize(O.width,O.height),R&&(J=j.getRect(),Z.rectGuide.gatherLines({node:j,x:J.x,y:J.y,w:J.width,h:J.height},H,a)),D=""+Math.round(O.width)+" * "+Math.round(O.height)}else if("line"===P){if(G=k.lp(W),Wi(W)){var _=j.getPoints(),w="P1"===U?_.get(1):_.get(0),v={x:G.x-w.x,y:G.y-w.y},I=Z.getStyle("shiftLineRotateRound"),M=c._shiftDirList;if(!M||c._shiftRotateRound!==I){c._shiftRotateRound=I,c._shiftDirList=M=[];for(var h=0;h<Math.PI;h+=I)M.push({x:x(h),y:g(h)})}for(var o,B=0,p=0,r=M.length;r>p;p++){var Y=M[p],t=Y.x*v.x+Y.y*v.y;Math.abs(t)>Math.abs(B)&&(B=t,o=Y)}G={x:w.x+o.x*B,y:w.y+o.y*B},Z.rectGuide.clear()}else c._inSmartGuide&&!i.Default.isCtrlDown(W)&&(c._adsorbedToClosest(G),R=!0);var m=le.getDataMatrix(j).applyInverse(G);j.setPoint("P1"===U?0:1,m,!0);var s=j.getPoints(),E=s.get(0),K=s.get(1);F=E.x-K.x,u=E.y-K.y,D=" "+Math.round(Math.sqrt(F*F+u*u))+" ",R&&(J=j.getRect(),Z.rectGuide.gatherLines({node:j,x:J.x,y:J.y,w:J.width,h:J.height}))}var y=i.Default.getLogicalPoint(W,Z._canvas);y.x+=le.Icons.TipShiftX,y.y+=le.Icons.TipShiftY,c.tipInfo={helperPos:y,text:D,size:D.length}}},kr.prototype._unionPointMode1=function(v,x,V,U,L){if(L&&V&&U){var G=v.x-x.x,R=v.y-x.y;Math.abs(G*U)<Math.abs(R*V)?(R=Math.sign(R)*Math.abs(G*U/V),v.y=x.y+R):(G=Math.sign(G)*Math.abs(R*V/U),v.x=x.x+G)}return i.Default.unionPoint(v,x)},kr.prototype._unionPointMode2=function(T,v,z,U,F,r){var B=i.Default.unionPoint(T,v);if(F&&z&&U){var p;"v"===r?(p=B.x+B.width/2,B.width=z*B.height/U,B.x=p-B.width/2):(p=B.y+B.height/2,B.height=U*B.width/z,B.y=p-B.height/2)}return B},kr.prototype._adsorbedToClosest=function(V,H){var D=this,$=D._interactor,k=$.rectGuide.findClosest(V,H),I=$.gridGuide.findClosest(V,H),f=1/0,U=1/0;k&&(isFinite(k.x)&&(f=k.x),isFinite(k.y)&&(U=k.y)),I&&(isFinite(I.x)&&Math.abs(I.x)<Math.abs(f)&&(f=I.x),isFinite(I.y)&&Math.abs(I.y)<Math.abs(U)&&(U=I.y)),isFinite(f)&&(V.x+=f),isFinite(U)&&(V.y+=U)},kr.prototype._42=function(y,g,D){var r=this;r.info={},r.screenInfo=null;var R=r._interactor;if(!R.editDetail&&r.gatherInfo(g,D)){var x=r.editing?r.editing.groupRotateMode:null,i=r.screenInfo;"block"!==x&&(i.P1?le.Icons.DrawIcon(R,y,le.Icons.Line,r.screenInfo):le.Icons.DrawIcon(R,y,le.Icons.Rect,r.screenInfo),r.tipInfo&&le.Icons.DrawIcon(R,y,le.Icons.TipHelper,r.tipInfo)),r.target instanceof le.Group&&r.target._42(R,y,g)}};var dk=le.Anchor=function(o){this.catalog="Anchor",this._interactor=o};dk.prototype={},dk.prototype.constructor=dk,dk.prototype.gatherInfo=function(I,O){var G=this;if(1===O.length){var E=O[0];if(!E.getAnchor)return;if(E instanceof i.Shape&&E._70I())return;if(as(E,I))return;return G.gatherSingleTarget(I,O[0])}return O.length>1?G.gatherMultiTargets(I,O):!1},dk.prototype.gatherSingleTarget=function(Y,J){var k=this;return k.info.POS=J.getPosition(),k.screenInfo.POS=le.toScreenPosition(Y,k.info.POS),k.target=J,!0},dk.prototype.gatherMultiTargets=function(m,Q){var x=this,P=le.Group.findOrCreateGroup(Q);return P?(x.screenInfo.POS=le.toScreenPosition(m,P.getAnchor2()),x.target=P,!0):!1},dk.prototype.isVisible=function(){var d=this,$=d._interactor;if($.getStyle("anchorVisible")===!1)return!1;var Z=d.target;if(Z){if(this.editing)return!0;var t=Z.getAnchor(),X=$.getStyle("anchorOutsideVisibleThreshold");if(t.x<-X||t.x>1+X||t.y<-X||t.y>1+X)return!0;var z=Z.getSize(),e=Z.getScale(),o=Math.min(Math.abs(z.width*e.x),Math.abs(z.height*e.y));if(o*$.gv._zoom<$.getStyle("anchorHideThreshold"))return!1}return!0},dk.prototype.check=function(s,b,N){if(i.Default.isLeftButton(b)){var k=this,q=k._interactor;if(k.isVisible()&&q.getStyle("anchorMovable")!==!1){k.editing=null,k.tipInfo=null;var f=k.target;if(f&&s.isAnchorEditable(f)&&s.isEditable(f)){var A;if(k.screenInfo&&(A=k.screenInfo.POS)&&le.checkHit(N,new le.Math.Vector2(A),q.getStyle("checkSize"))){if(f instanceof le.Group)return k.editing={},!0;var B=f.getWidth(),Y=f.getHeight(),g=f.getAnchor();return k.editing={rect:{x:-B*g.x,y:-Y*g.y,width:B,height:Y},anchor:g,matrix:f.getMatrix()},!0}}}}},dk.prototype.startEdit=function(t,N){t.startDragging(N)},dk.prototype._46O=function(){this.editing=null,this.tipInfo=null},dk.prototype.handleEdit=function($,X){var S=this,C=S.target;if(C&&S.editing){var N=$.lp(X);if(C instanceof le.Group)return C.setAnchor2(N),S._interactor._42(),void 0;var d=S.editing.matrix,g=d.tfi(N),x=S.editing.rect,s=(g.x-x.x)/x.width,O=(g.y-x.y)/x.height;if(!i.Default.isCtrlDown(X)){var A=S._interactor.getStyle("anchorRound"),j=S._interactor.getStyle("anchorSensitivity");s=le.roundTo(s,A,j),O=le.roundTo(O,A,j)}C.setAnchor(s,O,!0);var P=i.Default.getLogicalPoint(X,S._interactor._canvas);P.x+=le.Icons.TipShiftX,P.y+=le.Icons.TipShiftY;var J=""+s.toFixed(2)+", "+O.toFixed(2);S.tipInfo={helperPos:P,text:J,size:J.length}}},dk.prototype._42=function(b,u,R){var S=this;S.info={},S.screenInfo={};var p=S._interactor;p.editDetail||S.gatherInfo(u,R)&&S.isVisible()&&(le.Icons.DrawIcon(p,b,le.Icons.Anchor,S.screenInfo),S.tipInfo&&le.Icons.DrawIcon(p,b,le.Icons.TipHelper,S.tipInfo))};var $l=le.Curve=function(o){this.catalog="Curve",this._interactor=o};$l.prototype={},$l.prototype.constructor=$l,$l.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},$l.prototype.setUp=function(){var F=this,X=F._interactor;X&&X.gv.mp(F._onGraphviewPropertyChanged,F)},$l.prototype._onGraphviewPropertyChanged=function(R){("zoom"===R.property||"translateX"===R.property||"translateY"===R.property)&&this._handleDataChanged()},$l.prototype.tearDown=function(){var m=this,s=m._interactor;s&&s.gv.ump(m._onGraphviewPropertyChanged)},$l.prototype.canEnterEditDetailMode=function(){var w=this,x=w._interactor,S=x._getValidSelection();if(1===S.length){var k=S[0],r=k instanceof i.Edge;if(k instanceof i.Shape||r){if(r){var H=k.s("edge.type");if(H&&"points"!==H)return}var J=x.gv;if(J.isPointEditable(k)&&J.isEditable(k))return w.target=k,!0}}},$l.prototype.preHandleScroll=function(){var y=this.editing;return y&&y.inEdit?!0:void 0},$l.prototype.getCurrentSelectintStatus=function(){var C=this;if(C.activing&&!C.activing.selections){if(C.activing.status!=Q)return C.activing.status;var u=function(r){var Y=C.activing.status;C.activing.status=r,C._interactor.fp("shapePointStatus",Y,r)},$=le.Curve.PointType,o=C.activing.point,x=C.activing.pairs;if(!x||1!==x.length)return u($.Mirrored);var c=x[0],h=c.c1&&c.c1.isNearEnough(o),B=c.c2&&c.c2.isNearEnough(o);if(!c.c1||!c.c2)return h||B?u($.Straight):u($.Disconnected);if(h&&B)return u($.Straight);if(h||B)return u($.Asymmetric);var A=c.c1.clone().sub(o),y=c.c2.clone().sub(o);return Math.abs(A.x*y.y-A.y*y.x)>1e-5||A.x*y.x>0?u($.Disconnected):Math.abs(A.length()-y.length())>1e-5?u($.Asymmetric):u($.Mirrored)}},$l.prototype.handle_keydown=function(k){var y=this;if(y._interactor.editDetail){var n=le.Curve.PointType;"1"===k.key?y.setCurrentSelectionStatus(n.Straight):"2"===k.key?y.setCurrentSelectionStatus(n.Mirrored):"3"===k.key?y.setCurrentSelectionStatus(n.Disconnected):"4"===k.key&&y.setCurrentSelectionStatus(n.Asymmetric)}},$l.prototype.setCurrentSelectionStatus=function(d){var v=this;if(v.activing){var F=v.getCurrentSelectintStatus();if(null!==F&&F!==d){v.activing.status=d;var b=v.activing.point,l=v.activing.pairs;if(l&&1===l.length){var P=l[0],B=v.screenInfo.curve,t=le.Curve.PointType,D=function(){v._writeToHt(),v._interactor.fp("shapePointStatus",F,d)};if(d===t.Straight)return B.moveCtrlPoint(P,b,"c1"),B.moveCtrlPoint(P,b,"c2"),D(),void 0;if(F===t.Straight){var R=B.findPairs(b,!0),N=R[0],G=N.r1||b,n=N.r2||b,X=n.clone().sub(G).multiplyScalar(.25);return B.moveCtrlPoint(P,b.clone().sub(X),"c1"),B.moveCtrlPoint(P,b.clone().add(X),"c2"),D(),void 0}var f=P.c1,E=P.c2;if(f&&E){if(d===t.Mirrored)return B.moveCtrlPoint(P,b.clone().multiplyScalar(2).sub(E),"c1"),D(),void 0;if(d===t.Asymmetric&&F===t.Disconnected){var q=f.clone().sub(b).length(),X=b.clone().sub(E).setLength(q).add(b);return B.moveCtrlPoint(P,X,"c1"),D(),void 0}}v._interactor.fp("shapePointStatus",F,d)}}}},$l.prototype._handleDataChanged=function(D){var $=this;if($.screenInfo&&$.target){var j=$._interactor;$.gatherSingleTarget(j.gv,$.target,!0),$.check(j.gv,null,D?j._getLogicalPoint(D):new le.Math.Vector2(j._lastClientPoint)),j._42()}},$l.prototype.gatherSingleTarget=function(B,H,h){var A,I,w=this;w.screenInfo&&w.screenInfo.curve&&(I=w.screenInfo.curve._curves);var y=w.editing;A=y?w.screenInfo:w.screenInfo={};var N,c,z=H instanceof i.Edge;z?(N=H.s("edge.segments"),c=H.s("edge.points")||new i.List):(N=H._58O,c=H._59O),A.S=N;var V=A.P=[],D=le.getDataMatrix(H);if(c.each(function(v){v=D.apply(v);var d=le.toScreenPosition(B,v);V.push(d.x,d.y)}),z){var T=le.toScreenPosition(B,H._lastSourcePoint),s=le.toScreenPosition(B,H._lastTargetPoint);V.splice(0,0,T.x,T.y),V.push(s.x,s.y)}if(!A.S||!A.S.size()){A.S=new i.List,A.S.add(1);for(var O=0;O<V.length/2-1;O++)A.S.add(2)}if((!y||h)&&w.convertToCubicBezier(I),w.activing&&(h||!w.editing||"realPoint"===w.editing.type)){var R=A.curve.findPairs(w.activing.point);w.activing.pairs=R}z&&"points"!==H.s("edge.type")&&w._writeToHt()},$l.prototype._convertToNewPoint=function(z,D,$){var t,j,T;for(t=0,j=D.length;j>t;t++){if(T=D[t],T._p1.isNearEnough(z))return T._p1;
if(T._p4.isNearEnough(z))return T._p4}if($)for(t=0,j=Math.min($.length,j);j>t;t++){if(T=$[t],T._p1===z)return D[t]._p1;if(T._p4===z)return D[t]._p4}},$l.prototype.convertToCubicBezier=function(b){var Z,C,n=this,q=new le.Math.Curve,k=n.screenInfo;if(q.createFromHtShape(k.P,k.S),k.curve=q,n.activing){var c=q._curves;if(Z=n.activing.point,C=n._convertToNewPoint(Z,c,b),C&&(n.activing.point=C),n.activing.selections){var z=-1,V=n.activing.selections;V.forEach(function($){z++,C=n._convertToNewPoint($,c,b),C&&(V[z]=C)})}}},$l.prototype.check=function(Q,c,v){if(!c||i.Default.isLeftButton(c)){var K=this;if(K._interactor.setCursor("default"),K.editing=null,K.highlight=null,K.tipInfo=null,K.screenInfo){if(Rb())return K._interactor._42(),!0;if(K._checkEditCtrlPoint(v))return K._interactor._42(),!0;if(K._checkEditRealPoint(v))return K._interactor._42(),!0;var W=K.screenInfo.curve,f=W.checkPoint(v,K._interactor.getStyle("curveIntersectSize"));if(f){var P=K.highlight={};P.type="insertKnot",P.bezier=f.bezier,P.point=f.intersection}return K._interactor._42(),!0}}},$l.prototype._checkEditRealPoint=function(m){var t,L,p,v,N,V,R=this,G=R.screenInfo.curve._curves,j=R._interactor.getStyle("curvePointIntersectSize"),B=1/0;for(j*=j,p=0,v=G.length;v>p;p++)t=G[p],N=t._p1,V=m.distanceToSquared(N),B>V&&(B=V,L=N),N=t._p4,V=m.distanceToSquared(N),B>V&&(B=V,L=N);if(B>j)return!1;var $=R.highlight={};return $.type="changeRealPoint",$.point=L,R.editing={type:"realPoint",point:L,shiftGuide:{point:L.clone(),dir:"x",limit:0}},R._interactor.setCursor("crosshair"),!0},$l.prototype._checkEditCtrlPoint=function(Y){var G=this;if(G.activing&&!G.activing.selections){var t=G.getCurrentSelectintStatus();if(t!==le.Curve.PointType.Straight){var W=G.activing.pairs;if(W){var w=G._interactor.getStyle("curvePointIntersectSize");w*=w;var E,B,m,Q,p,H,A,K,j,h=1/0;for(A=0,j=W.length;j>A;A++)for(Q=W[A],K=0;2>K;K++)p=0===K?"c1":"c2",Q[p]&&(H=Y.distanceToSquared(Q[p]),h>H&&(h=H,E=Q,B=A,m=p));if(h>w)return!1;G.activing.hlpair=E,G.activing.hltype=m;var e=G.highlight={};return e.type="changeCtrlPoint",e.point=E[m],G.editing={type:"ctrlPoint",pair:E,pairId:B,ctrlType:m,direction:E[m].clone().sub(G.activing.point).normalize()},G._interactor.setCursor("crosshair"),!0}}}},$l.prototype.startEdit=function(S,o){S.startDragging(o);var A=this;A.highlight&&"insertKnot"===A.highlight.type&&(A.insertKnot(),A.gatherSingleTarget(A._interactor.gv,A.target),A.activing=null,A._checkEditRealPoint(A._interactor._getLogicalPoint(o)));var x=A.highlight,Q=i.Default.isCtrlDown(o);if(!x||Rb()){var B=A._interactor.gv;if(!B.setFocus(o)||B._scrolling)return;return B.isPannable()&&vk(o)&&!Q&&(A._pan={tx:B.tx(),ty:B.ty()}),void 0}if("changeRealPoint"===x.type){var b,h=A.activing?A.activing.point:null,I=A.activing?A.activing.selections:null;if(Q&&A.activing)h===x.point?(I?(A.activing={point:I[0]},I.length>1&&(I.splice(0,1),A.activing.selections=I)):A.activing=null,A.editing=null):I&&(b=I.indexOf(x.point))>=0?(I.length>1?I.splice(b,1):delete A.activing.selections,A.editing=null):I?(I.push(h),A.activing={point:x.point,selections:I}):A.activing={point:x.point,selections:[h]};else if(I)h===x.point||((b=I.indexOf(x.point))>=0?(I.splice(b,1,h),A.activing={point:x.point,selections:I}):A.activing={point:x.point});else{var w;h===x.point&&(w=A.activing.status),A.activing={point:x.point},w&&(A.activing.status=w)}}},$l.prototype.insertKnot=function(){var Z=this,R=Z.highlight,r=Z.screenInfo.curve;r.insertKnot(R.bezier,R.point.t),Z._writeToHt()},$l.prototype._writeToHt=function(){for(var f,O,r=this,l=r.screenInfo.curve,n=l.toHtShape(),U=n.points,C=[],L=n.segments,A=r._interactor.gv,d=r.target,D=d instanceof i.Edge,$=le.getDataMatrix(d).invert(),H=0,o=U.length;o>H;H++)f=U[H],O=le.toWorldPosition(A,f),O=$.apply(O),C.push(O);if(d._writing=!0,D){d.s("edge.type","points"),d.setStyle("edge.segments",L),d.setStyle("edge.points",C.slice(1,C.length-1)),d.setStyle("edge.source.offset.x",0),d.setStyle("edge.source.offset.y",0),d.setStyle("edge.target.offset.x",0),d.setStyle("edge.target.offset.y",0);var M=r._nextChangeEdgeHost;delete r._nextChangeEdgeHost,M&&("source"===M.type?d.setSource(M.host):d.setTarget(M.host)),r._writeEdgeHostAnchor("source",C[0]),r._writeEdgeHostAnchor("target",C[C.length-1])}else C.length?(d.setSegments(L),d.setPoints(C,!0)):d.removeFromDataModel();delete d._writing},$l.prototype._writeEdgeHostAnchor=function(X,s){var C=this,u=C.target,V=C._calcHostAnchor(u,X,s);u.s("edge."+X+".anchor.x",V.x),u.s("edge."+X+".anchor.y",V.y)},$l.prototype._calcHostAnchor=function(c,Y,b,x){x||(x="source"===Y?c.getSource():c.getTarget());var G=x.getRotation(),H=x.getAnchor(),y=this._interactor.gv;if(as(x,y)&&(G=0),G){var f=x.getMatrix(),t=f.tfi(b),J=x.getSize();return{x:t.x/J.width+H.x,y:t.y/J.height+H.y}}var l=bq(y,x),N={x:(b.x-l.x)/l.width,y:(b.y-l.y)/l.height};return N},$l.prototype._handlePanning=function(q){var U=this,b=U._pan;if(b){b.started=!0;var K=U._interactor,k=K.gv,X=K._lastClientPoint,v=wo(q);k.setTranslate(b.tx+v.x-X.x,b.ty+v.y-X.y),U.gatherSingleTarget(K.gv,U.target),K._42()}},$l.prototype.handleEdit=function(A,J){var L=this,z=L.editing;if(L._pan)return L._handlePanning(J),void 0;if(z){z.inEdit=!0;var h,f,W=L._interactor._getLogicalPoint(J),n=i.Default.isCtrlDown(J),g=i.Default.isShiftDown(J);if(L._guideInfo=null,"ctrlPoint"===z.type&&g){var X=L.editing.direction.clone();h=L.activing.point;var q=X.dot(W.clone().sub(h));W=X.setLength(q).add(h)}else{var X;if("realPoint"===z.type&&g){var P=L.editing.shiftGuide,b=P.point,t=Math.abs(W.x-b.x),Q=Math.abs(W.y-b.y);t>Q&&t>P.limit&&"y"===P.dir&&(P.dir="x"),Q>t&&Q>P.limit&&"x"===P.dir&&(P.dir="y"),X=P.dir,"x"===X?(W.y=b.y,P.limit=Math.max(P.limit,t)):"y"===X&&(W.x=b.x,P.limit=Math.max(P.limit,Q))}var Z=L._isEditEdgeSourceTarget();if(Z){var V=L._editEdgeSourceTarget(Z,W,n);V&&(f=V.tipText)}else if(!n){var U=L._guidingToEdit(W,X),p="realPoint"===z.type?L._interactor.gridGuide.findClosest(W,X,!0):null,D=1/0,x=1/0;p&&(p.x&&(D=p.x),p.y&&(x=p.y));var T=!1;U&&(U.xList&&(Math.abs(U.x)<=Math.abs(D)?(T=!0,D=U.x):delete U.xList),U.yList&&(Math.abs(U.y)<=Math.abs(x)?(T=!0,x=U.y):delete U.yList),T&&(L._guideInfo=U)),isFinite(D)&&(W.x+=D),isFinite(x)&&(W.y+=x),T&&(U.v=W)}}var e=L.screenInfo.curve;if("realPoint"===z.type){h=z.point,e.moveRealPoint(h,W),z.point=W,L.highlight.point=W;var v=L.activing.status,c=L.activing.selections;if(L.activing={point:W,status:v},c){var d=W.clone().sub(h),$=0;c.forEach(function(Y){var L=Y.clone().add(d);e.moveRealPoint(Y,L),c[$++]=L}),L.activing.selections=c}}else if("ctrlPoint"===z.type){var o=L.activing,K=o.pairs,E=K[z.pairId];e.moveCtrlPoint(E,W,z.ctrlType);var S=o.status,H=le.Curve.PointType;if((S===H.Mirrored||S===H.Asymmetric)&&E.c1&&E.c2){var h=new le.Math.Vector2(o.point),s="c1"===z.ctrlType?"c2":"c1";if(S===le.Curve.PointType.Mirrored)e.moveCtrlPoint(E,h.clone().multiplyScalar(2).sub(W),s);else if(S===H.Asymmetric){var q=E[s].clone().sub(h).length(),C=h.clone().sub(E[z.ctrlType]).setLength(q).add(h);isNaN(C.x)||e.moveCtrlPoint(E,C,s)}}}var R=i.Default.getLogicalPoint(J,L._interactor._canvas);if(R.x+=le.Icons.TipShiftX,R.y+=le.Icons.TipShiftY,!f){var w=le.toWorldPosition(A,W);f=""+le.toFixed(w.x)+", "+le.toFixed(w.y)}L.tipInfo={helperPos:R,text:f,size:f.length},L._writeToHt()}},$l.prototype._isEditEdgeSourceTarget=function(){var R=this,Q=R.target;if(!(Q instanceof i.Edge))return!1;var P=R.editing.point,I=R.screenInfo.curve._curves;return P===I[0]._p1?"source":P===I[I.length-1]._p4?"target":!1},$l.prototype._editEdgeSourceTarget=function(s,A,X){var l,o=this,H=o.target;if(l="source"===s?H.getSource():H.getTarget()){var f=o._interactor.gv,R=le.toWorldPosition(f,A),k=o._calcHostAnchor(H,s,R,l);if(!X){var V=o._interactor.getStyle("anchorRound"),M=o._interactor.getStyle("anchorSensitivity");k.x=le.roundTo(k.x,V,M),k.y=le.roundTo(k.y,V,M)}if(o._interactor.getStyle("edgeHostDetectPerFrame")||k.x<0||k.x>1||k.y<0||k.y>1){var Y=f.getDataAt(R,function(W){return f.isSelectable(W)?Bj(W)?!0:!1:!1});if(Y){var b=o._calcHostAnchor(H,s,R,Y);l=Y,o._nextChangeEdgeHost={type:s,host:Y},k=b,X||(k.x=le.roundTo(k.x,V,M),k.y=le.roundTo(k.y,V,M))}}if(!X){var P=Bc(f,l,0,0,0,k.x,k.y),Q=le.toScreenPosition(f,P);A.x=Q.x,A.y=Q.y}var p,g=[];if(as(l,f)){var $=bq(f,l);p=[{x:$.x,y:$.y},{x:$.x+$.width,y:$.y},{x:$.x+$.width,y:$.y+$.height},{x:$.x,y:$.y+$.height}]}else p=l.getCorners();return p.forEach(function(D){var G=le.toScreenPosition(f,D);g.push(G.x,G.y)}),o._edgeHostGuideInfo=g,{host:l,anchor:k,tipText:""+k.x.toFixed(2)+", "+k.y.toFixed(2)}}},$l.prototype._guidingToEdit=function(B,R){var e,d,u=this;if(e=u.screenInfo.curve){d=e._curves;var a,V,q,Q,t,Z,K,l,E=1/0,f=1/0,U=[];for(u.editing&&"realPoint"===u.editing.type&&(l=u.editing.point),t=0,Z=2*d.length;Z>t;t++)K=d[Math.floor(t/2)][t%2?"_p4":"_p1"],U.indexOf(K)>=0||(U.push(K),l&&l===K||(q=K.x-B.x,Q=K.y-B.y,Math.abs(q)<Math.abs(E)?(E=q,a=[K]):q===E&&a.push(K),Math.abs(Q)<Math.abs(f)?(f=Q,V=[K]):Q===f&&V.push(K)));var D=u._interactor.getStyle("smartGuideSensitivity");if((Math.abs(E)>D||"y"===R)&&(a=null),(Math.abs(f)>D||"x"===R)&&(V=null),a||V){var z=!1,S={};if(a&&(z=!0,S.xList=a,S.x=E),V&&(z=!0,S.yList=V,S.y=f),z)return S}}},$l.prototype._46O=function(){var N=this;N.editing=null,N._guideInfo=null,N._edgeHostGuideInfo=null,N._pan=null,N.tipInfo=null},$l.prototype._canDeletePoint=function(V,$){var U=this.target;if(!(U instanceof i.Edge))return!0;var q=V._curves[0],B=V._curves[V._curves.length-1];return q._p1===$||B._p4===$?!1:!0},$l.prototype.handleDelete=function(){var V=this;if(V.activing&&V.screenInfo){var U=i.Default.isShiftDown(),b=V.screenInfo.curve;V._canDeletePoint(b,V.activing.point)&&b.deleteRealPoint(V.activing.point,U),V.activing.selections&&V.activing.selections.forEach(function(_){V._canDeletePoint(b,_)&&b.deleteRealPoint(_,U)}),delete V.activing,delete V.editing,delete V.tipInfo,delete V._pan,V._writeToHt(),V._interactor.fp("deleteShapePoint",!1,!0)}},$l.prototype.handleDoubleClick=function($){var c=this,F=c._interactor._getLogicalPoint($);if(c.screenInfo&&c._checkEditRealPoint(F)){var I=c.getCurrentSelectintStatus(),x=le.Curve.PointType;return I=I===x.Mirrored?x.Straight:x.Mirrored,c.setCurrentSelectionStatus(I),c._interactor._42(),!0}},$l.prototype._drawHighlight=function(Y){var s=this,C=s.highlight;if(C){var N=C.bezier,Z=s._interactor;N&&le.Icons.DrawIcon(Z,Y,le.Icons.ShapeHighlightCurve,[N._p1.x,N._p1.y,N._p2.x,N._p2.y,N._p3.x,N._p3.y,N._p4.x,N._p4.y]);var w=C.point;w&&"insertKnot"===C.type&&le.Icons.DrawIcon(Z,Y,le.Icons.ShapeHighlighPoint,w)}},$l.prototype._drawGuide=function(C){var k=this,s=k._guideInfo;if(s){var j,L,h,U,Y=s.v;for(j=0;2>j;j++)if(U=0===j?s.xList:s.yList)for(L=0,h=U.length;h>L;L++)le.Icons.DrawIcon(k._interactor,C,le.Icons.ShapeGuideLine,[Y.x,Y.y,U[L].x,U[L].y])}},$l.prototype._drawCurrentPoint=function(W){var M=this;if(M.activing){var S=M.activing,V=M.getCurrentSelectintStatus(),p=M._interactor;if(V!==le.Curve.PointType.Straight){var u=S.pairs,g=S.hlpair,n=S.hltype,s=S.selections;if(u&&!s){var D,K,z;for(K=0,z=u.length;z>K;K++)D=u[K],K===g&&D[n]?le.Icons.DrawIcon(p,W,le.Icons.ShapeActivingCtrl,{point:D.point,c1:D.c1,c2:D.c2,hl:n}):le.Icons.DrawIcon(p,W,le.Icons.ShapeActivingCtrl,D)}}le.Icons.DrawIcon(p,W,le.Icons.ShapeHighlighRealPoint,M.activing.point),s&&s.forEach(function(g){le.Icons.DrawIcon(p,W,le.Icons.ShapeHighlighRealPoint,g)})}},$l.prototype.clear=function(){var x=this;x.editing=null,x._guideInfo=null,x.activing=null,x.highlight=null},$l.prototype._42=function(p){var X=this;X.info={},X.editing||(X.screenInfo=null);var g=X._interactor;return g.editDetail?X.target&&X._interactor.gv.isSelected(X.target)&&X._interactor.gv.isVisible(X.target)?(X.gatherSingleTarget(g.gv,X.target),le.Icons.DrawIcon(g,p,le.Icons.ShapeBgCurve,X.screenInfo),X._drawHighlight(p),X._drawCurrentPoint(p),X._getRealPoint().forEach(function(l){le.Icons.DrawIcon(g,p,le.Icons.ShapePoint,l)}),X._drawGuide(p),X.tipInfo&&le.Icons.DrawIcon(g,p,le.Icons.TipHelper,X.tipInfo),X._edgeHostGuideInfo&&le.Icons.DrawIcon(g,p,le.Icons.EdgeHostGuide,X._edgeHostGuideInfo),void 0):(g.editDetail=!1,X.clear(),void 0):(X.clear(),void 0)},$l.prototype._getRealPoint=function(){var c=this.screenInfo,y=c.P,E=c.S,s=-1,v=[];return E.each(function(X){var D=1;if(3===X)D=2;else if(4===X)D=3;else if(5===X)return;s+=D,v.push({x:y[2*s],y:y[2*s+1]})}),v};var oc=le.MoveHelper=function(n){var X=this;X.catalog="Move",X._interactor=n};oc.prototype={},oc.prototype.constructor=oc,oc.prototype.calcShift=function(v,k,M){var X,j,W=this,s=W._interactor.gv,P=s.lp(k);if("beginMove"===v&&W._gatherGridInfo(M._lastLogicalPoint||P),X=W._target){var A=X.downPosition;if(A){var E=W._interactor.getStyle("moveSensitivity")/s._zoom;if(A.distanceTo(P)<E)return{x:0,y:0};delete X.downPosition}var F;j=i.Default.isShiftDown(k),j&&(P=W._dealShiftDown(P),F=X.shiftGuide.dir);var U,$=X.rawPos={x:X.pos.x+P.x-X.lp.x,y:X.pos.y+P.y-X.lp.y};if(i.Default.isCtrlDown(k)){if(U=W._calcShiftByAddon(),W._target.node instanceof le.Group){var m=W._target.node;m._position.x+=U.x,m._position.y+=U.y}return U}for(var R,n=X.x+$.x,r=X.y+$.y,S={x:n,y:r},Z={x:n+X.w/2,y:r+X.h/2},f={x:n+X.w,y:r+X.h},o=W._interactor.rectGuide,Q=W._interactor.gridGuide,_=[o.findClosest(S,F),o.findClosest(Z,F),o.findClosest(f,F),Q.findClosest(S,F),Q.findClosest(Z,F),Q.findClosest(f,F)],K=1/0,O=1/0,G=0,H=_.length;H>G;G++)R=_[G],R&&(n=R.x,r=R.y,isFinite(n)&&Math.abs(n)<Math.abs(K)&&(K=n),isFinite(r)&&Math.abs(r)<Math.abs(O)&&(O=r));if(isFinite(K)||(K=0),isFinite(O)||(O=0),U=W._calcShiftByAddon(K,O),W._target.node instanceof le.Group){var m=W._target.node;m._position.x+=U.x,m._position.y+=U.y}var I=X.node;if(!as(I,s)){var a=$.x+K,x=$.y+O;W._interactor.rectGuide.gatherLines({node:I,x:X.x+a,y:X.y+x,w:X.w,h:X.h},F)}return U}},oc.prototype._calcShiftByAddon=function(o,r){var m=this._target,I=m.rawPos,N=m.node.getPosition();return o=o||0,r=r||0,{x:I.x-N.x+o,y:I.y-N.y+r}},oc.prototype._dealShiftDown=function(h){var L=this,S=L._target.shiftGuide,K=L._target.lp,U=Math.abs(h.x-K.x),D=Math.abs(h.y-K.y);U>D&&U>S.limit&&"y"===S.dir&&(S.dir="x"),D>U&&D>S.limit&&"x"===S.dir&&(S.dir="y");var T=S.dir;return"x"===T?(h.y=K.y,S.limit=Math.max(S.limit,U)):"y"===T&&(h.x=K.x,S.limit=Math.max(S.limit,D)),h},oc.prototype._gatherGridInfo=function(t){var L,I=this,i=I._interactor,m=i._getValidSelection();if(1===m.length){if(L=m[0],!L.getRect)return I._target=null,void 0}else if(L=le.Group.findOrCreateGroup(m),!L)return I._target=null,void 0;var U=L.getPosition(),r=L.getRect();I._target={node:L,x:r.x-U.x,y:r.y-U.y,w:r.width,h:r.height,lp:{x:t.x,y:t.y},pos:{x:U.x,y:U.y},shiftGuide:{dir:"x",limit:0},downPosition:new le.Math.Vector2(t)},i.rectGuide.gatherRects()},oc.prototype.clear=function(){var C=this;C._interactor.rectGuide.clear(),C._interactor._42()};var Gj="directional",Ug="point",Eb="spot",Xi="light.color";Ij(E,{graph3dViewAttributes:q,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:A/60,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:pd,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:A/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:function(y,M){kb[y]=M},getShape3dModel:function(V){return kb[V]},createMatrix:function(U,S){Rn(U)||(U=[U]);for(var C=U.length-1;C>=0;C--){var M=U[C];S=gs(M.mat,M.s3,M.r3,M.rotationMode,M.t3,S)}return S},transformVec:function(P,x){return Kl(P,x)},createBoxModel:function(){return{vs:Gh,ns:Dc,uv:fb,is:Jc}},createRoundRectModel:function(j,c){return Wd.roundRect(j,c)},createStarModel:function(b,o){return Wd.star(b,o)},createRectModel:function(o,w){return Wd.rect(o,w)},createTriangleModel:function(S,_){return Wd.triangle(S,_)},createRightTriangleModel:function(v,O){return Wd.rightTriangle(v,O)},createParallelogramModel:function(J,K){return Wd.parallelogram(J,K)},createTrapezoidModel:function(i,L){return Wd.trapezoid(i,L)},createSmoothSphereModel:function(h,E,H,W,k,A,w){return _b(new dj(h,E,H,W,k,A,w))},createSphereModel:function(z,s,e,M,g,j){return z?Yc(z,s,e,M,g,j):E.createSmoothSphereModel()},createSmoothConeModel:function(g,G,x,t,O){return ed(g,G,x,t,O)},createConeModel:function(b,P,$,J,u,N){return b?eo(b,P,$,J,u,N):ed(N)},createSmoothCylinderModel:function(v,k,T,p,X,y,P,j){return _b(new ar(v,k,T,p,X,y,P,j))},createCylinderModel:function(B,I,o,d,H,f,V){return B?Tr(B,I,o,d,H,f,V):zc(f,V)},createSmoothTorusModel:function(G,R,z,c,O,A){return _b(new Ri(G,R,z,c,O,A))},createTorusModel:function(B,L,U,e,z,t,l){return B?Xe(B,L,U,e,z,t,l):pp(t,l)},createExtrusionModel:function(D,I,U,e,w,$,B,l){return Fi(D,I,U,e,w,$,B,l)},createSmoothRingModel:function(U,R,e,Z,X,s){for(var A=[],C=0;C<U.length-1;C+=2)A.push({x:U[C],y:U[C+1]});for(U=Dj(A,R,e)[0],A=[],C=0;C<U.length;C++){var b=U[C];A.push(new Ll(b.x,0,b.y))}return _b(new Hh(A,s,Z,X))},createTextGeometry:function(N,Q){return _b(new sq(N,Q))},loadFontFace:function(i,s){E.xhrLoad(i,function(O){if(!O)return s();var p;try{p=JSON.parse(O)}catch($){p=JSON.parse(O.substring(65,O.length-2))}Kq.loadFace(p),s&&s(p.familyName.toLowerCase())},s?null:{sync:!0})},createRingModel:function(w,n,i,s,u,p,T,R,h,j){for(var o=[],J=0;J<w.length-1;J+=2)o.push({x:w[J],y:w[J+1]});p=p||E.shapeSide,T=T||0,R=R||p;var m,A,f,z,$,C,B,H,G,K,J,V,c,M,O,Y,D,r,W=[],y=[],S=h?[]:q,X=h?[]:q,Q=j?[]:q,U=j?[]:q,N=s?[]:q,k=s?[]:q,F=u?[]:q,d=u?[]:q,w=Dj(o,n,i),b=fs(w),l=0,t=2*Math.PI/p;return w.forEach(function(E){if(f=E.length,f>1){if(z=E[0],s)for(C=z.x,H=z.y,J=T;R>J;J++)V=J+1,c=J*t,M=V*t,O=g(c),Y=x(c),D=g(M),r=x(M),N.push(O*C,H,-Y*C,D*C,H,-r*C,0,H,0),k.push(.5-.5*O,.5-.5*Y,.5-.5*D,.5-.5*r,.5,.5);for(K=0;f>K;K++){for($=E[K],C=z.x,B=$.x,H=z.y,G=$.y,m=l/b,l+=Ip(z,$),A=l/b,J=T;R>J;J++)V=J+1,c=J*t,M=V*t,O=g(c),Y=x(c),D=g(M),r=x(M),W.push(O*B,G,-Y*B,D*B,G,-r*B,O*C,H,-Y*C,D*B,G,-r*B,D*C,H,-r*C,O*C,H,-Y*C),y.push(J/p,A,V/p,A,J/p,m,V/p,A,V/p,m,J/p,m),h&&J===T&&(S.push(0,H,0,0,G,0,O*B,G,-Y*B,O*B,G,-Y*B,O*C,H,-Y*C,0,H,0),X.push(0,.5-H,0,.5-G,2*B,.5-G,2*B,.5-G,2*C,.5-H,0,.5-H)),j&&V===R&&(Q.push(0,H,0,D*B,G,-r*B,0,G,0,D*B,G,-r*B,0,H,0,D*C,H,-r*C),U.push(1,.5-H,1-2*B,.5-G,1,.5-G,1-2*B,.5-G,1,.5-H,1-2*C,.5-H));z=$}if(u)for(C=z.x,H=z.y,J=T;R>J;J++)V=J+1,c=J*t,M=V*t,O=g(c),Y=x(c),D=g(M),r=x(M),F.push(D*C,H,-r*C,O*C,H,-Y*C,0,H,0),d.push(.5-.5*D,.5+.5*r,.5-.5*O,.5+.5*Y,.5,.5)}}),{vs:W,uv:y,bottom_vs:F,bottom_uv:d,top_vs:N,top_uv:k,from_vs:S,from_uv:X,to_vs:Q,to_uv:U}}},!0),Ij(X,{"3d.move.mode":Q,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":Q,"edge.gradient.color":Q,"edge.source.t3":Q,"edge.target.t3":Q,"light.type":Ug,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":A/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":yc,"wf.short":!1,"wf.mat":Q,batch:Q,"transparent.mask":!1,brightness:Q,"select.brightness":.7,"repeat.uv.length":Q,"label.face":Fn,"label.t3":Q,"label.r3":Q,"label.texture.scale":2,"label.rotationMode":qo,"label.light":!1,"label.blend":Q,"label.reverse.flip":!1,"label.reverse.color":Si,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Fn,"label2.t3":Q,"label2.r3":Q,"label2.texture.scale":2,"label2.rotationMode":qo,"label2.light":!1,"label2.blend":Q,"label2.reverse.flip":!1,"label2.reverse.color":Si,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Fn,"note.t3":Q,"note.r3":Q,"note.texture.scale":2,"note.rotationMode":qo,"note.light":!1,"note.blend":Q,"note.reverse.flip":!1,"note.reverse.color":Si,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Fn,"note2.t3":Q,"note2.r3":Q,"note2.texture.scale":2,"note2.rotationMode":qo,"note2.light":!1,"note2.blend":Q,"note2.reverse.flip":!1,"note2.reverse.color":Si,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Q,"shape3d.color":jr,"shape3d.top.color":Q,"shape3d.bottom.color":Q,"shape3d.from.color":Q,"shape3d.to.color":Q,"shape3d.image":Q,"shape3d.top.image":Q,"shape3d.bottom.image":Q,"shape3d.from.image":Q,"shape3d.to.image":Q,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Q,"shape3d.side.to":Q,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Q,"shape3d.opacity":Q,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Si,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Q,"shape3d.uv.scale":Q,"shape3d.top.uv.offset":Q,"shape3d.top.uv.scale":Q,"shape3d.bottom.uv.offset":Q,"shape3d.bottom.uv.scale":Q,"shape3d.from.uv.offset":Q,"shape3d.from.uv.scale":Q,"shape3d.to.uv.offset":Q,"shape3d.to.uv.scale":Q,"shape3d.top.cap":Q,"shape3d.bottom.cap":Q,"shape3d.start.angle":0,"shape3d.sweep.angle":G,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"all.light":!0,"all.visible":!0,"all.color":jr,"all.image":Q,"all.blend":Q,"all.opacity":Q,"all.reverse.flip":!1,"all.reverse.color":Si,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Q,"all.uv.offset":Q,"all.uv.scale":Q,"all.discard.selectable":!0,mat:Q,"left.mat":Q,"right.mat":Q,"top.mat":Q,"bottom.mat":Q,"front.mat":Q,"back.mat":Q},!0);var Hm,lo=!1,lc=[0,0,0,1/255],_j={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Ff,2:Gr,3:nr,4:Xg,5:Fn,6:xn}},Mk=function(h,c,T,k){if(c.getFaceVisible(h,T)){Yr(c,Kk(h,c.getFaceMat(h,T)||c.getMat(h)));var g=c._26I;c.getFaceReverseCull(h,T)?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),Cd(g,c._prg.uFixPickReverseColor,_j[T]),Yk(g),$b(g,k,6),Uj(g),Sm(c)}},pb=function(z){return z instanceof Od},vl=function(j){return[j.x,j.e||0,j.y]},Nj=function(T,A,I){for(var A=Yg(A),H=A[0],M=A[1],O=A[2];I--;)T.push(H,M,O)},Qm=function(g,Q,z){for(var Q=Yg(Q),_=Q[0],s=Q[1],H=Q[2],u=Q[3];z--;)g.push(_,s,H,u)},Qb=function(V,d,l){if(d)for(var e,F,I,K=d[0],$=d[1],R=d[2],S=d[4],C=d[5],E=d[6],U=d[8],n=d[9],y=d[10],p=d[12],Z=d[13],f=d[14],Q=l.length,k=0,k=0;Q>k;k+=3)e=l[k],F=l[k+1],I=l[k+2],V.push(K*e+S*F+U*I+p,$*e+C*F+n*I+Z,R*e+E*F+y*I+f);else Ck(V,l)},Lf=function(f,K){var p=K.s("light.intensity"),x=Yg(K.s(Xi)),b=x[0],T=x[1],W=x[2];1!==p&&(b*=p,T*=p,W*=p),f.push(b,T,W,K.s("light.disabled")?1:0)},Md=function(M,N,n){Cd(N,n.uHeadlightRange,M._headlightRange);var K=M._headlightIntensity,m=Yg(M._headlightColor);1!==K&&(m=[m[0]*K,m[1]*K,m[2]*K]),Cd(N,n.uHeadlightColor,[m[0],m[1],m[2],M._headlightDisabled?1:0]);var b=M._59O,_=M._spots,l=M._dirs;if(b.length){var x=[],k=[],X=[];b.forEach(function(O){Lf(x,O),Ck(k,O.p3()),X.push(O.s("light.range"))}),N.uniform4fv(n.uPointColor,x),N.uniform1fv(n.uPointRange,X),N.uniform3fv(n.uPointPosition,k)}if(_.length){var Q=[],R=[],U=[],F=[],o=[],r=[];_.forEach(function(K){Lf(Q,K),Ck(R,K.p3()),Ck(U,K.s("light.center")),F.push(K.s("light.range")),o.push(g(K.s("light.angle")/2)),r.push(K.s("light.exponent"))}),N.uniform4fv(n.uSpotColor,Q),N.uniform1fv(n.uSpotRange,F),N.uniform1fv(n.uSpotAngle,o),N.uniform1fv(n.uSpotExponent,r),N.uniform3fv(n.uSpotPosition,R),N.uniform3fv(n.uSpotCenter,U)}if(l.length){var A=[],j=[];l.forEach(function(e){Lf(A,e),Ck(j,e.p3())}),N.uniform4fv(n.uDirColor,A),N.uniform3fv(n.uDirPosition,j)}},Wg=function(f){return f>0&&0===(f-1&f)},eg=function(x){return x=M(0,f(A,x)),x=M(Tl,f(A-Tl,x))},oo=function(){return.05+p()/2},Ye=function(Q,N,E,C){var e,a=Q.getEye();return Q.isOrtho()?(e=np(Q.getCenter(),a),e[0]+=C[0],e[1]+=C[1],e[2]+=C[2]):e=a,Xl(N,E,C,e)},Xl=function(Y,v,l,z){var S=Pn(Y,v),E=np(z,l,!0),m=Pn(E,v);if(C(m)<Tl)return q;var d=(S-Pn(l,v))/m;return[l[0]+E[0]*d,l[1]+E[1]*d,l[2]+E[2]*d]},Ak=function(n,N){return{x:2*n.x-N.x,y:2*n.y-N.y}},Jj=function(G,X,_,r){var I,e;if(!G)return I=B(X.y-_.y,_.x-X.x),{x:X.x+r*x(I),y:X.y+r*g(I)};if(!_)return I=B(G.y-X.y,X.x-G.x),{x:X.x+r*x(I),y:X.y+r*g(I)};var J=np([G.x,G.y,0],[X.x,X.y,0],!0),F=np([_.x,_.y,0],[X.x,X.y,0],!0),T=-(J[0]+F[0])/2,M=-(J[1]+F[1])/2,S=Z(T*T+M*M);if(Tl>S)return I=B(G.y-X.y,X.x-G.x),{x:X.x+r*x(I),y:X.y+r*g(I)};var N=G.x-X.x,j=G.y-X.y,L=_.x-X.x,o=_.y-X.y,s=Z(Math.min(N*N+j*j,L*L+o*o));return I=d(Pn(J,F))/2,e=J[1]*F[0]-J[0]*F[1]>0?-1:1,T/=S,M/=S,S=Math.min(r/x(I),s/g(I)),{x:X.x+e*S*T,y:X.y+e*S*M}},bn=function(v){var f=v[1],C=v[2],X=v[3],P=v[6],$=v[7],U=v[11];v[1]=v[4],v[2]=v[8],v[3]=v[12],v[4]=f,v[6]=v[9],v[7]=v[13],v[8]=C,v[9]=P,v[11]=v[14],v[12]=X,v[13]=$,v[14]=U},Rj=function(Z){var Y=Z[0],c=Z[1],U=Z[2],J=Z[3],s=Z[4],D=Z[5],i=Z[6],t=Z[7],a=Z[8],x=Z[9],p=Z[10],K=Z[11],e=Z[12],X=Z[13],k=Z[14],G=Z[15],N=Y*D-c*s,V=Y*i-U*s,M=Y*t-J*s,j=c*i-U*D,L=c*t-J*D,w=U*t-J*i,h=a*X-x*e,E=a*k-p*e,r=a*G-K*e,v=x*k-p*X,g=x*G-K*X,m=p*G-K*k,B=N*m-V*g+M*v+j*r-L*E+w*h;return B?(B=1/B,Z[0]=(D*m-i*g+t*v)*B,Z[1]=(U*g-c*m-J*v)*B,Z[2]=(X*w-k*L+G*j)*B,Z[3]=(p*L-x*w-K*j)*B,Z[4]=(i*r-s*m-t*E)*B,Z[5]=(Y*m-U*r+J*E)*B,Z[6]=(k*M-e*w-G*V)*B,Z[7]=(a*w-p*M+K*V)*B,Z[8]=(s*g-D*r+t*h)*B,Z[9]=(c*r-Y*g-J*h)*B,Z[10]=(e*L-X*M+G*N)*B,Z[11]=(x*M-a*L-K*N)*B,Z[12]=(D*E-s*v-i*h)*B,Z[13]=(Y*v-c*E+U*h)*B,Z[14]=(X*V-e*j-k*N)*B,Z[15]=(a*j-x*V+p*N)*B,void 0):q},Cg=function(Q,f){if(f){var V=f[0],h=f[1],X=f[2];Q[12]=Q[0]*V+Q[4]*h+Q[8]*X+Q[12],Q[13]=Q[1]*V+Q[5]*h+Q[9]*X+Q[13],Q[14]=Q[2]*V+Q[6]*h+Q[10]*X+Q[14],Q[15]=Q[3]*V+Q[7]*h+Q[11]*X+Q[15]}},pk=function(L,b){if(b){var G=b[0],e=b[1],R=b[2];L[0]=L[0]*G,L[1]=L[1]*G,L[2]=L[2]*G,L[3]=L[3]*G,L[4]=L[4]*e,L[5]=L[5]*e,L[6]=L[6]*e,L[7]=L[7]*e,L[8]=L[8]*R,L[9]=L[9]*R,L[10]=L[10]*R,L[11]=L[11]*R}},yl=function(e,D,c){var C=D[0],v=D[1],U=D[2],J=D[3],r=D[4],g=D[5],u=D[6],Y=D[7],P=D[8],y=D[9],H=D[10],k=D[11],x=D[12],q=D[13],p=D[14],L=D[15],m=c[0],n=c[1],i=c[2],j=c[3];return e[0]=m*C+n*r+i*P+j*x,e[1]=m*v+n*g+i*y+j*q,e[2]=m*U+n*u+i*H+j*p,e[3]=m*J+n*Y+i*k+j*L,m=c[4],n=c[5],i=c[6],j=c[7],e[4]=m*C+n*r+i*P+j*x,e[5]=m*v+n*g+i*y+j*q,e[6]=m*U+n*u+i*H+j*p,e[7]=m*J+n*Y+i*k+j*L,m=c[8],n=c[9],i=c[10],j=c[11],e[8]=m*C+n*r+i*P+j*x,e[9]=m*v+n*g+i*y+j*q,e[10]=m*U+n*u+i*H+j*p,e[11]=m*J+n*Y+i*k+j*L,m=c[12],n=c[13],i=c[14],j=c[15],e[12]=m*C+n*r+i*P+j*x,e[13]=m*v+n*g+i*y+j*q,e[14]=m*U+n*u+i*H+j*p,e[15]=m*J+n*Y+i*k+j*L,e},we=function(A,i,s,J){var n,D,t,u,h,w,P,R,q,V,B=i[0],x=i[1],o=i[2],l=J[0],Q=J[1],I=J[2],y=s[0],L=s[1],r=s[2];return C(B-y)<Tl&&C(x-L)<Tl&&C(o-r)<Tl?Sl(A):(P=B-y,R=x-L,q=o-r,V=1/Z(P*P+R*R+q*q),P*=V,R*=V,q*=V,n=Q*q-I*R,D=I*P-l*q,t=l*R-Q*P,V=Z(n*n+D*D+t*t),V?(V=1/V,n*=V,D*=V,t*=V):(n=0,D=0,t=0),u=R*t-q*D,h=q*n-P*t,w=P*D-R*n,V=Z(u*u+h*h+w*w),V?(V=1/V,u*=V,h*=V,w*=V):(u=0,h=0,w=0),A[0]=n,A[1]=u,A[2]=P,A[3]=0,A[4]=D,A[5]=h,A[6]=R,A[7]=0,A[8]=t,A[9]=w,A[10]=q,A[11]=0,A[12]=-(n*B+D*x+t*o),A[13]=-(u*B+h*x+w*o),A[14]=-(P*B+R*x+q*o),A[15]=1,A)},Rk=function(L,c,y,b,I){var U=1/t(c/2),d=1/(b-I);return L[0]=U/y,L[1]=0,L[2]=0,L[3]=0,L[4]=0,L[5]=U,L[6]=0,L[7]=0,L[8]=0,L[9]=0,L[10]=(I+b)*d,L[11]=-1,L[12]=0,L[13]=0,L[14]=2*I*b*d,L[15]=0,L},me=function(V,y,Q,J,s,H,S){var B=1/(y-Q),f=1/(J-s),L=1/(H-S);return V[0]=-2*B,V[1]=0,V[2]=0,V[3]=0,V[4]=0,V[5]=-2*f,V[6]=0,V[7]=0,V[8]=0,V[9]=0,V[10]=2*L,V[11]=0,V[12]=(y+Q)*B,V[13]=(s+J)*f,V[14]=(S+H)*L,V[15]=1,V},po=function(f,X){var g=X[0],Z=X[1],v=X[2],d=X[3],p=g*g+Z*Z+v*v+d*d,y=p?1/p:0;return f[0]=-g*y,f[1]=-Z*y,f[2]=-v*y,f[3]=d*y,f},gb=function(U,g){var Y=g[0]+g[5]+g[10],j=0;return Y>0?(j=2*Math.sqrt(Y+1),U[3]=.25*j,U[0]=(g[6]-g[9])/j,U[1]=(g[8]-g[2])/j,U[2]=(g[1]-g[4])/j):g[0]>g[5]&g[0]>g[10]?(j=2*Math.sqrt(1+g[0]-g[5]-g[10]),U[3]=(g[6]-g[9])/j,U[0]=.25*j,U[1]=(g[1]+g[4])/j,U[2]=(g[8]+g[2])/j):g[5]>g[10]?(j=2*Math.sqrt(1+g[5]-g[0]-g[10]),U[3]=(g[8]-g[2])/j,U[0]=(g[1]+g[4])/j,U[1]=.25*j,U[2]=(g[6]+g[9])/j):(j=2*Math.sqrt(1+g[10]-g[0]-g[5]),U[3]=(g[1]-g[4])/j,U[0]=(g[8]+g[2])/j,U[1]=(g[6]+g[9])/j,U[2]=.25*j),U},Xf=function(P,A,j){var E=A[0],Q=A[1],g=A[2],r=A[3],c=E+E,y=Q+Q,t=g+g,u=E*c,o=E*y,x=E*t,T=Q*y,v=Q*t,N=g*t,i=r*c,h=r*y,b=r*t;return P[0]=1-(T+N),P[1]=o+b,P[2]=x-h,P[3]=0,P[4]=o-b,P[5]=1-(u+N),P[6]=v+i,P[7]=0,P[8]=x+h,P[9]=v-i,P[10]=1-(u+T),P[11]=0,P[12]=j[0],P[13]=j[1],P[14]=j[2],P[15]=1,P},tj=function(P,l){return we(l?l:ns(),P._eye,P._center,P._up)},Jq=function(W){var L=W.getAspect(),Y=W._near,v=W._far,m=ns();if(W._ortho){var I=W._orthoWidth/2,_=I/L;me(m,-I,I,-_,_,Y,v)}else Rk(m,W._fovy,L,Y,v);return m},$p=function(e,g){if(!e)return q;var r=0,$=1,s=2,W=[],f=0,l=e.length,z=l/3;if(g){for(;l>f;f++)W[f]=0;for(f=0;f<g.length;f+=3){var x=[],F=[],X=[];x[r]=e[3*g[f+1]+r]-e[3*g[f]+r],x[$]=e[3*g[f+1]+$]-e[3*g[f]+$],x[s]=e[3*g[f+1]+s]-e[3*g[f]+s],F[r]=e[3*g[f+2]+r]-e[3*g[f+1]+r],F[$]=e[3*g[f+2]+$]-e[3*g[f+1]+$],F[s]=e[3*g[f+2]+s]-e[3*g[f+1]+s],X[r]=x[$]*F[s]-x[s]*F[$],X[$]=x[s]*F[r]-x[r]*F[s],X[s]=x[r]*F[$]-x[$]*F[r];for(var T=0;3>T;T++)W[3*g[f+T]+r]+=X[r],W[3*g[f+T]+$]+=X[$],W[3*g[f+T]+s]+=X[s]}}else for(f=0;z>f;f+=3){var x=[],F=[],X=[];x[r]=e[3*(f+1)+r]-e[3*f+r],x[$]=e[3*(f+1)+$]-e[3*f+$],x[s]=e[3*(f+1)+s]-e[3*f+s],F[r]=e[3*(f+2)+r]-e[3*(f+1)+r],F[$]=e[3*(f+2)+$]-e[3*(f+1)+$],F[s]=e[3*(f+2)+s]-e[3*(f+1)+s],X[r]=x[$]*F[s]-x[s]*F[$],X[$]=x[s]*F[r]-x[r]*F[s],X[s]=x[r]*F[$]-x[$]*F[r];for(var T=0;3>T;T++)W[3*(f+T)+r]=X[r],W[3*(f+T)+$]=X[$],W[3*(f+T)+s]=X[s]}for(f=0;l>f;f+=3){var v=[];v[r]=W[f+r],v[$]=W[f+$],v[s]=W[f+s];var t=Z(v[r]*v[r]+v[$]*v[$]+v[s]*v[s]);0===t&&(t=Tl),v[r]=v[r]/t,v[$]=v[$]/t,v[s]=v[s]/t,W[f+r]=v[r],W[f+$]=v[$],W[f+s]=v[s]}return new bp(W)},Lr=function(g,f,H){if(H||(H=g.createTexture()),f){var D=g.TEXTURE_2D,u=g.LINEAR,l=g.REPEAT,P=g.CLAMP_TO_EDGE,Q=g.TEXTURE_MIN_FILTER;kn(g,H),g.texImage2D(D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,f),Io(g,g.TEXTURE_MAG_FILTER,u),Wg(f.width)&&Wg(f.height)?(Io(g,g.TEXTURE_WRAP_S,l),Io(g,g.TEXTURE_WRAP_T,l),Io(g,Q,g.LINEAR_MIPMAP_LINEAR),g.generateMipmap(D)):(Io(g,g.TEXTURE_WRAP_S,P),Io(g,g.TEXTURE_WRAP_T,P),Io(g,Q,u)),kn(g,q)}return H},id=function(D,L){var S=new Uint8Array(3);return L=L||D.createTexture(),kn(D,L),Io(D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texImage2D(D.TEXTURE_2D,0,D.RGB,1,1,0,D.RGB,D.UNSIGNED_BYTE,S),L},Rd=function(G){G._26I&&G._prg&&(G._26I.deleteProgram(G._prg),G._prg=q)},rg=function(B,A,x,a){var U=B.createShader(x);return B.shaderSource(U,a),B.compileShader(U),B.attachShader(A,U),U},Zh=function(x){return x.createBuffer()},kn=function(J,l){J.bindTexture(J.TEXTURE_2D,l)},Hc=function(E,r){E.bindFramebuffer(E.FRAMEBUFFER,r)},Io=function(Y,I,K){Y.texParameteri(Y.TEXTURE_2D,I,K)},nn=function(Q,L){if(L){var L=Yg(L);Q.clearColor(L[0],L[1],L[2],L[3])}},xh=function(y,O){Cd(y,O.uFix,!0),go(y,O.aNormal)},um=function(G,Z){Cd(G,Z.uFix,!1),eq(G,Z.aNormal)},Al=function(s,x,F,S,$,M,I,p){s._picking||(F?(Cd(s,x.uBlend,!0),Cd(s,x.uBlendColor,F)):Cd(s,x.uBlend,!1),Cd(s,x.uLight,S==q?!0:S),wm($)&&1!==$&&Cd(s,x.uPartOpacity,$),Cd(s,x.uReverseFlip,M==q?!1:M),Cd(s,x.uFixPickReverseColor,I||Si)),p?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE)},Fk=function(S,H){S._picking||Cd(S,H.uPartOpacity,1)},Yk=function(S,P,b,W,j,w,c,$){if(!b)return kn(S,S._emptyTexture),void 0;Cd(S,P.uTexture,!0),Cd(S,P.uDiscardSelectable,$r(W)?W:!0),eq(S,P.aUv),Hl(S,j,w,P.aUv,2),S.activeTexture(S.TEXTURE0),kn(S,b),S.uniform1i(P.uSampler,0);var Y=[0,0,1,1];c&&(Y[0]=c[0],Y[1]=c[1]),$&&(Y[2]=$[0],Y[3]=$[1]),Cd(S,P.uOffsetScale,Y)},Uj=function(u,$,R){kn(u,q),R&&(go(u,$.aUv),Cd(u,$.uTexture,!1))
},mr=function(o,V,J,$,m,E){!J||h||D||o.lineWidth(J),$&&!o._picking&&Cd(o,V.uFixPickReverseColor,$),m&&Hl(o,m,E,V.aPosition)},ie=function(s,J,i,D){Hm&&(D=s[Hm]),s.drawArrays(D==q?s.TRIANGLES:D,J,i)},$b=function(c,R,U,Y){Hm&&(Y=c[Hm]),c.drawElements(Y==q?c.TRIANGLES:Y,U,c.UNSIGNED_SHORT,R==q?0:2*R)},Hl=function(l,c,s,S,z){var w=l.ARRAY_BUFFER;l.bindBuffer(w,c),s&&l.bufferData(w,s,l.STATIC_DRAW),S!=q&&l.vertexAttribPointer(S,z?z:3,l.FLOAT,!1,0,0)},Bg=function(b,t,O){var Y=b.ELEMENT_ARRAY_BUFFER;b.bindBuffer(Y,t),O&&b.bufferData(Y,O,b.STATIC_DRAW)},Cd=function(k,w,B){if(B!=q&&w!=q){B=Yg(B);var c=B.length;3===c?k.uniform3fv(w,B):4===c?k.uniform4fv(w,B):16===c?k.uniformMatrix4fv(w,!1,B):$r(B)?k.uniform1i(w,B?1:0):2===c?k.uniform2fv(w,B):k.uniform1f(w,B)}},eq=function(f,U){U!=q&&U>=0&&f.enableVertexAttribArray(U)},go=function(C,W){W!=q&&W>=0&&C.disableVertexAttribArray(W)},Sm=function(r,B){var p=r.getGL(),Y=r._prg;r._7O=r._8O.pop(),B&&(Cd(p,Y.uMVMatrix,r._7O),r._6O=B,Cd(p,Y.uNMatrix,B))},ih=function(W,s){return s||(s=ns()),Vm(s,W),Rj(s),bn(s),s},Yr=function(Y,t){var B=Y.getGL(),K=Y._prg,Z=Y._7O;t&&(Y._8O.push(Wk(Z)),yl(Z,Z,t)),Cd(B,K.uMVMatrix,Z),Cd(B,K.uNMatrix,ih(Z,Y._6O))},wd=function(f,s,n,h,u,d){if(n){if(h){var R=n.value++,y=[(255&R>>24)/255,(255&R>>16)/255,(255&R>>8)/255,(255&R)/255];n[R]={data:u,part:d}}else y=lc;return Cd(f,s.uFixPickReverseColor,y),y}},ws=function(){var g={center:function(y,L,J,k,G){var p=L[1]/2,l={x:-L[0]/2,y:p,width:L[0],height:L[1]},R=Un(y,l,J);return[R.x+k,2*p-R.y-G,oo()]},front:function(A,b,f,N,J){var _=b[1]/2,X={x:-b[0]/2,y:_,width:b[0],height:b[1]},s=Un(A,X,f);return[s.x+N,2*_-s.y-J,b[2]/2+oo()]},back:function(o,G,U,W,l){var D=G[0]/2,Q=G[1]/2,x={x:D,y:Q,width:G[0],height:G[1]},X=Un(o,x,U);return[2*D-X.x-W,2*Q-X.y-l,-G[2]/2-oo()]},left:function(F,J,P,s,p){var Y=J[1]/2,o={x:-J[2]/2,y:Y,width:J[2],height:J[1]},H=Un(F,o,P);return[-J[0]/2-oo(),2*Y-H.y-p,H.x+s]},right:function(X,N,H,l,n){var J=N[2]/2,U=N[1]/2,Y={x:J,y:U,width:N[2],height:N[1]},q=Un(X,Y,H);return[N[0]/2+oo(),2*U-q.y-n,2*J-q.x-l]},top:function(q,E,$,y,f){var b={x:-E[0]/2,y:-E[2]/2,width:E[0],height:E[2]},Z=Un(q,b,$);return[Z.x+y,E[1]/2+oo(),Z.y+f]},bottom:function(h,p,x,Y,F){var $=p[2]/2,e={x:-p[0]/2,y:$,width:p[0],height:p[2]},g=Un(h,e,x);return[g.x+Y,-p[1]/2-oo(),2*$-g.y-F]}};return function(c,j,Y,X,m,x){return g[X](c,j,Y,m||0,x||0)}}(),Fg=function(v,q,P,a,E,s,t,m,c,N){if(E&&(q[0]+=E[0],q[1]+=E[1],q[2]+=E[2]),Cg(v,P),m){var $=ns();if(sp($,c,N),Kl(q,$),Cg(v,q),v.auto=m,v.pos=Kl([0,0,0],v),s){var e=v.mat2=ns();sp(e,s,t)}}else sp(v,c,N),Cg(v,q),a===Ff?eb(v,-V):a===Gr?eb(v,V):a===nr?Fq(v,-V):a===Xg?Fq(v,V):a===xn&&eb(v,A),sp(v,s,t);return v},Tk=function(T,D){var v=D.auto,I=D.mat2,E=T.gv;if(v){var n,Y=ns(),a=[0,0,0,0];n="string"==typeof v?[v.indexOf("x")<0?E._eye[0]:E._center[0],v.indexOf("y")<0?E._eye[1]:E._center[1],v.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye,gb(a,we(ns(),n,E._center,E._up)),Xf(Y,po(a,a),D.pos),I&&yl(Y,Y,I),Yr(E,Y)}else Yr(E,D)},je=function(v,r,O,E,z){var j=v.s,D=v.gv,J=D.getGL(),u=D._prg,t=D._buffer,a=D._1O;Lr(J,Xc,a),Tk(v,O),Al(J,u,j(r+".blend"),j(r+".light"),j(r+".opacity"),j(r+".reverse.flip"),j(r+".reverse.color"),j(r+".reverse.cull")),Yk(J,u,a,z,t.uv,ah),Hl(J,t.vs,E,u.aPosition),Hl(J,t.ns,zi,u.aNormal),Bg(J,t.is,Op),$b(J,0,Op.length),Uj(J,u,a),Fk(J,u),Sm(D)},zl=function(j,Z,Y){var w=j.gv,k=j.data,O=j[Z]={blend:w.getBodyColor(k)||w.getFaceBlend(k,Z),light:w.getFaceLight(k,Z),color:w.getFaceColor(k,Z),opacity:w.getFaceOpacity(k,Z),transparent:w.getFaceTransparent(k,Z),reverseFlip:w.getFaceReverseFlip(k,Z),reverseColor:w.getFaceReverseColor(k,Z),reverseCull:w.getFaceReverseCull(k,Z),texture:w.getFaceImage(k,Z),discardSelectable:w.getFaceDiscardSelectable(k,Z)};if("csg"!==Z){O.uv=w.getFaceUv(k,Z)||Y&&Y[Z+"Uv"],O.uvScale=w.getFaceUvScale(k,Z)||Y&&Y[Z+"UvScale"],O.uvOffset=w.getFaceUvOffset(k,Z)||Y&&Y[Z+"UvOffset"];var R=w.getFaceMat(k,Z);R&&(O.mat=Kk(k,R))}return O},Lk=function(U,x,t,R,$){if(R){if(!$(R.transparent))return;var Z=U.data,i=U.gv,V=i._buffer,I=i.getTexture(R.texture,Z);Yk(x,t,I,R.discardSelectable,V.uv,R.tuv,R.uvOffset,R.uvScale),Al(x,t,R.blend,R.light,R.opacity,R.reverseFlip,R.reverseColor,R.reverseCull),Cd(x,t.uDiffuse,R.color),Hl(x,V.vs,R.vs,t.aPosition),Hl(x,V.ns,R.ns,t.aNormal),ie(x,0,R.vs.length/3),Fk(x,t),Uj(x,t,I)}},yp=function(i,c,V,l,g,W){var o,D,s,w,y,Q,t,h,I,z,K,X=[l-c,g-V],C=i?i.length:0;for(s=0;C>s;s++){for(w=2,o=i[s],y=o[0],Q=o[1];w+1<o.length;){if(t=o[w],h=o[w+1],D=ql(c,V,l,g,y,Q,t,h,!0)){I=[t-y,h-Q],z=Ip(I),I[0]/=z,I[1]/=z,z=Pn(X,I),z=z>0?W:-W,K=[I[0]*z,I[1]*z];break}y=t,Q=h,w+=2}if(K)break}if(K)for(l=c+K[0],g=V+K[1],s=0;C>s;s++)for(w=2,o=i[s],y=o[0],Q=o[1];w+1<o.length;){if(t=o[w],h=o[w+1],D=ql(c,V,l,g,y,Q,t,h,!0))return[0,0];y=t,Q=h,w+=2}return K?K:[l-c,g-V]},tp=i.graph3d={},jn=function(l,g,I){re(v+".graph3d."+l,g,I)},es="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~!gjeof$!~~<*^j]opjujtpQupqTw!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEupqTw<**1/2!-^j]sfuofDupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQupqTw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~<**1/2!-^j]opjujtpQuojpQv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQuojpQw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<*opjujtpQsje!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEsjEw<**1/2!-1/1!-1/1!-1/1)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQsjEv)5dfw!+!yjsubNxfjWv)4dfw!>!opjujtpQsje!4dfw|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]sfuofDupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]opjujtpQsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Vh="~~<eJ!>!spmpDhbsG`mh!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTw)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEw)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~<1/2!>!b/spmpDwv|ftmf~<esbdtje|*5/1!=!b/spmpDwv)gj|ftmf~~<esbdtje|*1/1!>>!b/spmpDwv)gj|*uofsbqtobsUv)gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUv!mppc!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Ij(E,{setBatchInfo:function(q,N){sk[q]=N},getBatchInfo:function(y){return sk[y]}},!0);var _k=[1,1,1],hm=[1,0,0,0,0,1,0,1,1,1,1,0],ib=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],ej=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Vd=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Bo=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],qe=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],An=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],In=function(b,W){ai(b,W),Wc(b,W,"_wireframeModelMap","_wireframeIndexMap"),Wc(b,W,"_polylineModelMap","_polylineIndexMap")},ai=function(r,F){if(F){var R,N,x=F._id,O=r._33O,P=r._34O,I=P[x];if(I){N=I.batch,R=O[N];var _=I.begin,B=I.size,p=3*_,y=3*B,v=4*_,S=4*B,K=R.vs,Z=R.uv,T=R.cs,C=R.bs,z=R.rs,n=R.ds,o=I.index;if(R.invalidate=!0,delete P[x],n.splice(o,1),ae(n))delete O[N];else{for(;o<n.length;o++)I=P[n[o]._id],I.index--,I.begin-=B;K.splice(p,y),R.ns.splice(p,y),R.ps.splice(v,S),Z&&Z.splice(2*_,2*B),T&&T.splice(v,S),C&&C.splice(p,y),z&&z.splice(_,B)}}}else r._34O={},r._33O={}},Wc=function(D,b,w,G){if(b){var S,z,p=b._id,C=D[w],h=D[G],s=h[p];if(s){z=s.batch,S=C[z];var o=s.begin,E=s.size,H=3*o,R=3*E,f=4*o,P=4*E,i=S.ds,F=s.index;if(S.invalidate=!0,delete h[p],i.splice(F,1),ae(i))delete C[z];else{for(;F<i.length;F++)s=h[i[F]._id],s.index--,s.begin-=E;S.vs.splice(H,R),S.cs.splice(f,P),S.ps.splice(f,P),S.ls&&S.ls.splice(o,E)}}}else D[w]={},D[G]={}},ph=function(m,t,E,V){if(!V)return q;var i=t[V];if(!i){var P=sk[V]||Hg,G=P.image?[]:q;i=t[V]={vs:[],ns:[],uv:G,cs:G?q:P.color?q:[],bs:P.blend?[]:q,ps:[],rs:P.brightness?[]:q,ds:[]}}return i.invalidate=!0,m[E._id]={index:i.ds.length,begin:i.vs.length/3,batch:V},i.ds.push(E),i},Ln=function(d,u){return u!=q&&1!==u?[d[0]*u,d[1]*u,d[2]*u,d[3]]:d},rb=function(d,D,k){var a=d.getBrightness(D),K=Yg(k.color||"white"),v=K[3]<1,_=Math.ceil(k.width)||1,Y=(v?"T":"O")+_,M=d._wireframeIndexMap,T=d._wireframeModelMap,O=T[Y];O||(O=T[Y]={vs:[],cs:[],ps:[],ds:[],T:v,W:_}),O.invalidate=!0;var j=O.vs,x=O.cs,P=O.ds,U=M[D._id]={index:P.length,begin:j.length/3,batch:Y};P.push(D),Qb(j,Kk(D,k.mat),k.short?uf:Gb);var W=U.size=j.length/3-U.begin;Qm(x,Ln(K,a),W)},ec=function(M,D,s,V,t,Q,N,Y,b){var i=M.getBrightness(D);i==q&&(i=1);var v=Ln(Yg(V),i),Z=v[3]<1;Q=Math.ceil(Q)||1;var w=(Z?"T":"O")+Q;if(N){var T=N[0],z=(N[1]||T)+T;w+="-"+T+"-"+z,b&&(w+="-"+Ji(b)+"-"+i,b=Ln(Yg(b),i))}var U=M._polylineIndexMap,d=M._polylineModelMap,X=d[w];X||(X=d[w]={vs:[],cs:[],ps:[],ds:[],ls:N?[]:q,T:Z,W:Q},N&&(X.D=T,X.G=z,X.A=b)),X.invalidate=!0;var g,L=X.vs,r=X.cs,A=X.ds,m=X.ls,e=U[D._id]={index:A.length,begin:L.length/3,batch:w};A.push(D),Ck(L,s);var l,$=e.size=L.length/3-e.begin,P=s.length,c=0,y=[];if(N||t)for(g=0;P>g;g+=6)l=Ip([s[g],s[g+1],s[g+2]],[s[g+3],s[g+4],s[g+5]]),y.push(l),c+=l;if(c&&t){var E,O=Ln(Yg(t),i),F=[O[0]-v[0],O[1]-v[1],O[2]-v[2],O[3]-v[3]],h=0;for(g=0;P>g;g+=6)E=h/c,Qm(r,[v[0]+F[0]*E,v[1]+F[1]*E,v[2]+F[2]*E,v[3]+F[3]*E],1),h+=y[g/6],E=h/c,Qm(r,[v[0]+F[0]*E,v[1]+F[1]*E,v[2]+F[2]*E,v[3]+F[3]*E],1)}else Qm(r,v,$);if(N)for(h=Y||0,g=0;P>g;g+=6)m.push(h),h+=y[g/6],m.push(h)},Nr=function($,A,K){if(A)for(var X=4*A.begin,t=K[A.batch].ps,p=0;p<A.size;p++)t[X++]=$[0],t[X++]=$[1],t[X++]=$[2],t[X++]=$[3]},cg=function(q,m){var w=m+["32"],z=q[m],B=q[w];z?B&&B.length===z.length?B.set(z):q[w]=new bp(z):delete q[w]},Ki=function(f,b,t,C,X,j,r,A,W){if(Rn(t))t.forEach(function($){Ki(f,b,$,C,X,j,r,A,W)});else if(Gg(t))Ki(f,b,ni(C,t),C,X,j,r,A,W);else if(qc(t)){var L,d=mj(t.mat,b,f),R=mj(t.s3,b,f),l=mj(t.t3,b,f),v=mj(t.r3,b,f);if((R||v||l||d)&&(L=gs(d,R,v,mj(t.rotationMode,b,f),l),j.push(L)),t.shape3d)Ki(f,b,t.shape3d,C,X,j,r,A,t);else{var Z=C.s;W=W||Hg;var p=j[0],G=j.length,T=Z("shape3d.color",t.color,W.color);if(X||(X=Z("shape3d.blend",t.blend,W.blend)),G>1){p=Wk(p);for(var H=1;G>H;H++)yl(p,p,j[H])}t.vs&&Z(ff,t.visible,W.visible)&&pi(p,r,A,t.vs,t.uv,t.is,X,T),t.top_vs&&Z(sl,t.topVisible,W.topVisible)&&pi(p,r,A,t.top_vs,t.top_uv,t.top_is,X,Z("shape3d.top.color",t.topColor,W.topColor)||T),t.bottom_vs&&Z(jj,t.bottomVisible,W.bottomVisible)&&pi(p,r,A,t.bottom_vs,t.bottom_uv,t.bottom_is,X,Z("shape3d.bottom.color",t.bottomColor,W.bottomColor)||T),t.from_vs&&Z(Ai,t.fromVisible,W.fromVisible)&&pi(p,r,A,t.from_vs,t.from_uv,t.from_is,X,Z("shape3d.from.color",t.fromColor,W.fromColor)||T),t.to_vs&&Z(de,t.toVisible,W.toVisible)&&pi(p,r,A,t.to_vs,t.to_uv,t.to_is,X,Z("shape3d.to.color",t.toColor,W.toColor)||T)}L&&j.pop()}},pi=function(Q,C,n,F,d,Y,h,P){var O,S=C.cs,I=C.uv,p=C.bs;if(Y){O=Y.length;for(var E=0;O>E;E++){var k=Y[E];Qb(n,Q,[F[3*k],F[3*k+1],F[3*k+2]]),I&&Ck(I,[d[2*k],d[2*k+1]])}}else O=F.length/3,Qb(n,Q,F),I&&Ck(I,d);S&&Qm(S,P,O),p&&(h?Nj(p,h,O):Ck(p,_k,O))},hb=function(O,L,w,e){var D=[];e?Ki(O.gv,O.data,e,O,O.getBodyColor(),[L],w,D):(Po(O,Ff,L,w,D),Po(O,Gr,L,w,D),Po(O,Fn,L,w,D),Po(O,xn,L,w,D),Po(O,nr,L,w,D),Po(O,Xg,L,w,D),Po(O,"csg",L,w,D)),D.length&&(Ck(w.vs,D),Ck(w.ns,$p(D)))},Po=function(A,w,g,k,d){var P=A[w];if(P){var h=P.tuv;if(h){var Q,o,X,l,Y=P.uvScale,x=P.uvOffset;if(Y)for(Q=h.length,o=Y[0],X=Y[1],l=0;Q>l;l+=2)h[l]*=o,h[l+1]*=X;if(x)for(Q=h.length,o=x[0],X=x[1],l=0;Q>l;l+=2)h[l]+=o,h[l+1]+=X}pi(g,k,d,P.vs,h,q,P.blend,P.color)}},Bh=function(g,h,C,F,p,D,K,y){var N,Q=C.cs,c=C.uv,O=C.bs;if(g.getFaceVisible(h,D)){var L=g.getFaceMat(h,D);if(L&&(p=Kk(h,L)),Qb(K,p,y),Q&&Qm(Q,g.getFaceColor(h,D),6),c){var V=g.getFaceUv(h,D)||F[D+"Uv"],Z=g.getFaceUvScale(h,D)||F[D+"UvScale"],e=g.getFaceUvOffset(h,D)||F[D+"UvOffset"];V=V?[V[6],V[7],V[0],V[1],V[2],V[3],V[2],V[3],V[4],V[5],V[6],V[7]]:hm;var J=V[0],t=V[1],o=V[2],v=V[3],k=V[4],w=V[5],I=V[6],G=V[7],E=V[8],U=V[9],d=V[10],X=V[11];if(Z){var m=Z[0],i=Z[1];J*=m,t*=i,o*=m,v*=i,k*=m,w*=i,I*=m,G*=i,E*=m,U*=i,d*=m,X*=i}if(e){var H=e[0],z=e[1];J+=H,t+=z,o+=H,v+=z,k+=H,w+=z,I+=H,G+=z,E+=H,U+=z,d+=H,X+=z}c.push(J,t,o,v,k,w,I,G,E,U,d,X)}O&&(N=g.getBodyColor(h)||g.getFaceBlend(h,D),N?Nj(O,N,6):Ck(O,_k,6))}},sf=function(m,k,O,b){var p=m.getGL(),f=m._prg,Y=m._buffer;if(!lg(k)){Yr(m),xh(p,f);for(var R in k){var T=k[R];if(!(b&&!T.T||!b&&T.T)){T.invalidate?(T.invalidate=!1,cg(T,"vs"),cg(T,"cs"),cg(T,"ls"),cg(T,"ps")):O&&cg(T,"ps");var M=T.vs32,E=O?T.ps32:T.cs32;mr(p,f,T.W,q,Y.vs,M);var L=T.D,N=!m._dashDisabled&&L;N&&(Cd(p,f.uDash,!0),Cd(p,f.uDashDistance,L),Cd(p,f.uDashGapDistance,T.G),eq(p,f.aLineDistance),Hl(p,Y.lineDistance,T.ls32,f.aLineDistance,1),Cd(p,f.uDiffuse,T.A||Nl));var X=!m._batchColorDisabled;X&&(Cd(p,f.uBatchColor,!0),eq(p,f.aBatchColor),Hl(p,Y.batchColor,E,f.aBatchColor,4)),Yk(p),ie(p,0,M.length/3,p.LINES),Uj(p),X&&(Cd(p,f.uBatchColor,!1),go(p,f.aBatchColor)),N&&(Cd(p,f.uDash,!1),go(p,f.aLineDistance))}}um(p,f)}},El=function(w,Y,M){var R,x,b,H,W,p,u,P,h,d,l,c=w.getGL(),K=w._prg,L=w._buffer,N=w._33O;if(!lg(N)){Yr(w);for(R in N)if(x=sk[R]||Hg,!(M&&!x.transparent||!M&&x.transparent)&&(b=N[R],Y||!x.transparentMask)){var e=M&&x.autoSort!==!1&&(w._33Q||b.invalidate);if(b.invalidate?(b.invalidate=!1,cg(b,"vs"),cg(b,"ns"),cg(b,"cs"),cg(b,"rs"),cg(b,"ps"),cg(b,"bs"),cg(b,"uv")):Y&&cg(b,"ps"),W=b.vs32,p=Y?b.ps32:b.cs32,h=b.uv32,u=b.bs32,P=b.rs32,l=W.length/3,e&&(b.is=rc(W,w.getEye())),l){H=x.light,d=w.getTexture(x.image),Al(c,K,q,x.light,x.opacity,x.reverseFlip,x.reverseColor,x.reverseCull),p?w._batchColorDisabled||(Cd(c,K.uBatchColor,!0),eq(c,K.aBatchColor),Hl(c,L.batchColor,p,K.aBatchColor,4)):Cd(c,K.uDiffuse,x.color);var t=u&&!w._batchBlendDisabled;t&&(Cd(c,K.uBatchBlend,!0),eq(c,K.aBatchBlend),Hl(c,L.batchBlend,u,K.aBatchBlend));var S=P&&!w._batchBrightnessDisabled;S&&(Cd(c,K.uBatchBrightness,!0),eq(c,K.aBatchBrightness),Hl(c,L.batchBrightness,P,K.aBatchBrightness,1)),h?Yk(c,K,d,x.discardSelectable,L.uv,h,x.uvOffset,x.uvScale):Yk(c),Hl(c,L.vs,W,K.aPosition),Hl(c,L.ns,b.ns32,K.aNormal),b.is?(Bg(c,L.is,b.is),$b(c,0,l)):ie(c,0,l),h?Uj(c,K,d):Uj(c),p&&!w._batchColorDisabled&&(Cd(c,K.uBatchColor,!1),go(c,K.aBatchColor)),t&&(Cd(c,K.uBatchBlend,!1),go(c,K.aBatchBlend)),S&&(Cd(c,K.uBatchBrightness,!1),go(c,K.aBatchBrightness)),Fk(c,K)}}}},rc=function(A,Z){for(var y=A.length/3,J=new Array(y),w=y/3,T=new Array(w),U=0;w>U;U++)T[U]=U;T.sort(function(c,s){var G=9*c,$=[(A[G]+A[G+3]+2*A[G+6])/4,(A[G+1]+A[G+4]+2*A[G+7])/4,(A[G+2]+A[G+5]+2*A[G+8])/4];G=9*s;var I=[(A[G]+A[G+3]+2*A[G+6])/4,(A[G+1]+A[G+4]+2*A[G+7])/4,(A[G+2]+A[G+5]+2*A[G+8])/4],x=Ip(Z,$)-Ip(Z,I);return x>0?-1:0>x?1:0});for(var U=0;w>U;U++){var n=3*U,Y=3*T[U];J[n]=Y,J[n+1]=Y+1,J[n+2]=Y+2}return new Ae(J)},ah=new bp([0,0,0,1,1,1,1,0]),zi=new bp([0,0,1,0,0,1,0,0,1,0,0,1]),Op=new Ae([0,1,2,2,3,0]),Gh=new bp([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Jc=new Ae([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),fb=new bp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Nm=new bp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Dc=$p(Gh,Jc),Gb=(new bp([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ae([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),uf=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Yc=function(W,u,n,l,I,e){e=e||16,W=W||16,u=u||0,n=n||W;var U,P,Y,Z,X,i,E,F,_=.5,L=[],V=[],r=G/W,m=A/e;for(U=0;e>U;U++)for(X=U+1,Z=U*m,F=X*m,P=u;n>P;P++)i=P+1,Y=P*r,E=i*r,L.push(_*x(Z)*g(Y),_*g(Z),-_*x(Z)*x(Y),_*x(F)*g(E),_*g(F),-_*x(F)*x(E),_*x(Z)*g(E),_*g(Z),-_*x(Z)*x(E),_*x(Z)*g(Y),_*g(Z),-_*x(Z)*x(Y),_*x(F)*g(Y),_*g(F),-_*x(F)*x(Y),_*x(F)*g(E),_*g(F),-_*x(F)*x(E)),V.push(P/W,U/e,i/W,X/e,i/W,U/e,P/W,U/e,P/W,X/e,i/W,X/e);if(l){var z=[],B=[];for(Y=u*r,U=0;e>U;U++)X=U+1,Z=U*m,F=X*m,z.push(0,0,0,_*x(F)*g(Y),_*g(F),-_*x(F)*x(Y),_*x(Z)*g(Y),_*g(Z),-_*x(Z)*x(Y)),B.push(0,.5,u/W,X/e,u/W,U/e)}if(I){var D=[],w=[];for(Y=n*r,U=0;e>U;U++)X=U+1,Z=U*m,F=X*m,D.push(0,0,0,_*x(Z)*g(Y),_*g(Z),-_*x(Z)*x(Y),_*x(F)*g(Y),_*g(F),-_*x(F)*x(Y)),w.push(1,.5,n/W,U/e,n/W,X/e)}return{vs:L,uv:V,from_vs:z,from_uv:B,to_vs:D,to_uv:w}},pp=function(P,C,U){P=P||.17,C=C||12,U=U||18,0>P?P=0:P>.25&&(P=.25);var a,_,F,W,X,Y,l,D=.5,b=[],k=[],L=[],w=G/U,s=G/C,Q=D-P;for(_=0;C>=_;_++)for(W=-A+_*s,Y=g(W),X=x(W),a=0;U>=a;a++)F=a*w,l=Q+P*Y,b.push(g(F)*l,X*P,-x(F)*l),k.push(a/U,1-_/C);for(_=0;C>_;_++){var q=_*(U+1),R=(_+1)*(U+1);for(a=0;U>a;a++)L.push(q+a,R+a+1,R+a,q+a,q+a+1,R+a+1)}return{vs:b,uv:k,is:L}},Xe=function(c,p,X,v,Q,_,B){B=B||12,c=c||18,p=p||0,X=X||c,_=_||.17,0>_?_=0:_>.25&&(_=.25);var M,f,y,h,I,U,$,P,q,C,r=.5,H=[],e=[],R=G/c,k=G/B,i=r-_;for(y=0;B>y;y++)for(h=y+1,$=-A+y*k,P=-A+h*k,M=p;X>M;M++)f=M+1,I=M*R,U=f*R,q=i+_*g($),C=i+_*g(P),H.push(g(I)*q,x($)*_,-x(I)*q,g(U)*q,x($)*_,-x(U)*q,g(U)*C,x(P)*_,-x(U)*C,g(I)*q,x($)*_,-x(I)*q,g(U)*C,x(P)*_,-x(U)*C,g(I)*C,x(P)*_,-x(I)*C),e.push(M/c,1-y/B,f/c,1-y/B,f/c,1-h/B,M/c,1-y/B,f/c,1-h/B,M/c,1-h/B);if(v){var S=[],N=[];for(y=0;B>y;y++)h=y+1,$=-A+y*k,P=-A+h*k,I=p*R,q=i+_*g($),C=i+_*g(P),S.push(g(I)*q,x($)*_,-x(I)*q,g(I)*C,x(P)*_,-x(I)*C,g(I)*i,0,-x(I)*i),N.push(.5+.5*g($),.5-.5*x($),.5+.5*g(P),.5-.5*x(P),.5,.5)}if(Q){var D=[],u=[];for(y=0;B>y;y++)h=y+1,$=-A+y*k,P=-A+h*k,I=X*R,q=i+_*g($),C=i+_*g(P),D.push(g(I)*q,x($)*_,-x(I)*q,g(I)*i,0,-x(I)*i,g(I)*C,x(P)*_,-x(I)*C),u.push(.5-.5*g($),.5-.5*x($),.5,.5,.5-.5*g(P),.5-.5*x(P))}return{vs:H,uv:e,from_vs:S,from_uv:N,to_vs:D,to_uv:u}},zc=function(E,r){for(var k,o,z,S=.5,W=16,f=[],L=[],J=[],R=G/W,P=0;W>=P;P++)k=P*R,o=g(k)*S,z=x(k)*S,f.push(o,-S,z,o,S,z),L.push(1-P/W,1,1-P/W,0);for(P=0;W>P;P++)J.push(2*P,2*P+1,2*P+3,2*P,2*P+3,2*P+2);if(r){var v=[],V=[],O=[];for(v.push(0,-S,0),V.push(.5,.5),P=0;W>=P;P++)k=P*R,o=g(k),z=x(k),v.push(o*S,-S,-z*S),V.push(.5+.5*o,.5+.5*z);for(P=0;W>P;P++)O.push(0,P+2,P+1)}if(E){var q=[],m=[],u=[];for(q.push(0,S,0),m.push(.5,.5),P=0;W>=P;P++)k=P*R,o=g(k),z=x(k),q.push(o*S,S,-z*S),m.push(.5+.5*o,.5-.5*z);for(P=0;W>P;P++)u.push(0,P+1,P+2)}return{vs:f,uv:L,is:J,bottom_vs:v,bottom_uv:V,bottom_is:O,top_vs:q,top_uv:m,top_is:u}},Tr=function(Z,b,K,q,R,j,l){Z=Z||12,b=b||0,K=K||Z;for(var u,$,P,y,e,W,m,I,D=.5,t=[],V=[],O=G/Z,_=b;K>_;_++)u=_+1,$=_*O,P=u*O,y=g($)*D,e=x($)*D,W=g(P)*D,m=x(P)*D,t.push(y,-D,-e,W,-D,-m,y,D,-e,W,-D,-m,W,D,-m,y,D,-e),V.push(_/Z,1,u/Z,1,_/Z,0,u/Z,1,u/Z,0,_/Z,0);if(l){var L=[],p=[];for(_=b;K>_;_++)$=O*_,P=O*(_+1),y=g($),e=x($),W=g(P),m=x(P),L.push(y*D,-D,-e*D,0,-D,0,W*D,-D,-m*D),p.push(.5+.5*y,.5+.5*e,.5,.5,.5+.5*W,.5+.5*m)}if(j){var J=[],d=[];for(_=b;K>_;_++)$=O*_,P=O*(_+1),y=g($),e=x($),W=g(P),m=x(P),J.push(y*D,D,-e*D,W*D,D,-m*D,0,D,0),d.push(.5+.5*y,.5-.5*e,.5+.5*W,.5-.5*m,.5,.5)}if(q){var N=[],f=[];$=O*b,y=g($)*D,e=x($)*D,I=b/Z,N.push(0,D,0,0,-D,0,y,-D,-e,y,-D,-e,y,D,-e,0,D,0),f.push(0,0,0,1,I,1,I,1,I,0,0,0)}if(R){var U=[],z=[];$=O*K,y=g($)*D,e=x($)*D,I=K/Z,U.push(0,-D,0,0,D,0,y,D,-e,y,D,-e,y,-D,-e,0,-D,0),z.push(1,1,1,0,I,0,I,0,I,1,1,1)}return{vs:t,uv:V,bottom_vs:L,bottom_uv:p,top_vs:J,top_uv:d,from_vs:N,from_uv:f,to_vs:U,to_uv:z}},ed=function(H,C,p,s,c){C=C||18,p=p||0,s=s==q?G:s,c=c==q?.5:c;for(var U,f,R,X,_,d,E=[0,.5,.75,.875,.9375],F=[],D=[],u=[],z=s/C,A=0;A<E.length;A++){var m=0===A%2?0:.5;for(U=0;C>=U;U++)f=(U+m)*z+p,R=1-E[A],F.push(g(f)*c*R,-c+2*E[A]*c,-x(f)*c*R),D.push((U+m)/C,R)}for(A=0;A<E.length-1;A++){var w=A*(C+1),T=(A+1)*(C+1);for(U=0;C>U;U++)u.push(w+U,T+U+1,T+U,w+U,w+U+1,T+U+1)}for(d=F.length/3-(C+1),U=0;C>U;U++)F.push(0,c,0),D.push((U+.5)/C,0);for(U=0;C>U;U++)u.push(d+U,d+U+1,d+(C+1)+U);if(H){var n=[],O=[],J=[];for(n.push(0,-c,0),O.push(.5,.5),U=0;C>=U;U++)f=U*z+p,X=g(f),_=x(f),n.push(X*c,-c,-_*c),O.push(.5+.5*X,.5+.5*_);for(U=0;C>U;U++)J.push(0,U+2,U+1)}return{vs:F,uv:D,is:u,bottom_vs:n,bottom_uv:O,bottom_is:J}},eo=function(W,U,t,L,i,p){W=W||16,U=U||0,t=t||W;for(var V=.5,m=[],j=[],b=G/W,y=U;t>y;y++){var M=y+1,T=b*y,O=b*M;m.push(g(T)*V,-V,-x(T)*V,g(O)*V,-V,-x(O)*V,0,V,0),j.push(y/W,1,M/W,1,(y+M)/2/W,0)}if(p){var Q=[],_=[];for(y=U;t>y;y++){T=b*y,O=b*(y+1);var u=g(T),E=x(T),c=g(O),R=x(O);Q.push(u*V,-V,-E*V,0,-V,0,c*V,-V,-R*V),_.push(.5+.5*u,.5+.5*E,.5,.5,.5+.5*c,.5+.5*R)}}if(L){var h=[],A=[];T=b*U,h.push(0,V,0,0,-V,0,g(T)*V,-V,-x(T)*V),A.push(0,0,0,1,U/W,1)}if(i){var Y=[],$=[];T=b*t,Y.push(0,-V,0,0,V,0,g(T)*V,-V,-x(T)*V),$.push(1,1,1,0,t/W,1)}return{vs:m,uv:j,bottom_vs:Q,bottom_uv:_,from_vs:h,from_uv:A,to_vs:Y,to_uv:$}},Fi=function(i,C,U,e,H,V,q,t){for(var P=[],n=0;n<i.length-1;n+=2)P.push({x:i[n],y:i[n+1]});return Ni(P,C,U,e,H,V,q,t,!1)},Wd={roundRect:function(b,m){return Fi([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],b,m,3)},star:function(i,d){return Fi([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],i,d)},rect:function(z,k){return Fi([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],z,k)},triangle:function(z,K){return Fi([0,-.5,.5,.5,-.5,.5],[1,2,2,5],z,K)},rightTriangle:function(P,D){return Fi([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],P,D)},parallelogram:function(x,E){return Fi([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],x,E)},trapezoid:function(E,R){return Fi([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],E,R)}},Of={sphere:1,cylinder:1,cone:1,torus:1},mk={torus:1,sphere:1},im=Ij(ji(Wd),{cylinder:1}),Bs=Ij(ji(Wd),{cylinder:1,cone:1}),vr=function(R,I,i){var D,O=mj(R.mat,i,I),n=mj(R.s3,i,I),U=mj(R.t3,i,I),v=mj(R.r3,i,I);return(n||v||U||O)&&(D=Wk(I._6O),Yr(I,gs(O,n,v,mj(R.rotationMode,i,I),U))),D},Rh=function(G,g,l,u,V,q,W){if(Rn(l))l.forEach(function(_){Rh(G,g,_,u,V,q,W)});else if(Gg(l))Rh(G,g,ni(u,l),u,V,q,W);else if(qc(l))if(l.shape3d){var p=vr(l,G,g);Rh(G,g,l.shape3d,u,V,q,l),p&&Sm(G,p)}else bo(G,g,l,u.s,V,q,W)},bo=function(Y,O,r,B,$,C,h){if(h=h||Hg,!C||C(B("shape3d.transparent",r.transparent,h.transparent))){var m=vr(r,Y,O);jk(r);var Q=Y._26I,W=Y._prg,D=Y._buffer,Z=B("shape3d.color",r.color,h.color);$||($=B("shape3d.blend",r.blend,h.blend)),Al(Q,W,$,B("shape3d.light",r.light,h.light),B("shape3d.opacity",r.opacity,h.opacity),B("shape3d.reverse.flip",r.reverseFlip,h.reverseFlip),B("shape3d.reverse.color",r.reverseColor,h.reverseColor),B("shape3d.reverse.cull",r.reverseCull,h.reverseCull)),r.vs&&B(ff,r.visible,h.visible)&&Nq(Q,W,D,Z,Y.getTexture(B("shape3d.image",r.image,h.image),O),B("shape3d.discard.selectable",r.discardSelectable,h.discardSelectable),r.vs,r.uv,r.ns,r.is,B("shape3d.uv.offset",r.uvOffset,h.uvOffset),B("shape3d.uv.scale",r.uvScale,h.uvScale)),r.top_vs&&B(sl,r.topVisible,h.topVisible)&&Nq(Q,W,D,B("shape3d.top.color",r.topColor,h.topColor)||Z,Y.getTexture(B("shape3d.top.image",r.topImage,h.topImage),O),B("shape3d.top.discard.selectable",r.topDiscardSelectable,h.topDiscardSelectable),r.top_vs,r.top_uv,r.top_ns,r.top_is,B("shape3d.top.uv.offset",r.topUvOffset,h.topUvOffset),B("shape3d.top.uv.scale",r.topUvScale,h.topUvScale)),r.bottom_vs&&B(jj,r.bottomVisible,h.bottomVisible)&&Nq(Q,W,D,B("shape3d.bottom.color",r.bottomColor,h.bottomColor)||Z,Y.getTexture(B("shape3d.bottom.image",r.bottomImage,h.bottomImage),O),B("shape3d.bottom.discard.selectable",r.bottomDiscardSelectable,h.bottomDiscardSelectable),r.bottom_vs,r.bottom_uv,r.bottom_ns,r.bottom_is,B("shape3d.bottom.uv.offset",r.bottomUvOffset,h.bottomUvOffset),B("shape3d.bottom.uv.scale",r.bottomUvScale,h.bottomUvScale)),r.from_vs&&B(Ai,r.fromVisible,h.fromVisible)&&Nq(Q,W,D,B("shape3d.from.color",r.fromColor,h.fromColor)||Z,Y.getTexture(B("shape3d.from.image",r.fromImage,h.fromImage),O),B("shape3d.from.discard.selectable",r.fromDiscardSelectable,h.fromDiscardSelectable),r.from_vs,r.from_uv,r.from_ns,r.from_is,B("shape3d.from.uv.offset",r.fromUvOffset,h.fromUvOffset),B("shape3d.from.uv.scale",r.fromUvScale,h.fromUvScale)),r.to_vs&&B(de,r.toVisible,h.toVisible)&&Nq(Q,W,D,B("shape3d.to.color",r.toColor,h.toColor)||Z,Y.getTexture(B("shape3d.to.image",r.toImage,h.toImage),O),B("shape3d.to.discard.selectable",r.toDiscardSelectable,h.toDiscardSelectable),r.to_vs,r.to_uv,r.to_ns,r.to_is,B("shape3d.to.uv.offset",r.toUvOffset,h.toUvOffset),B("shape3d.to.uv.scale",r.toUvScale,h.toUvScale)),Fk(Q,W),m&&Sm(Y,m)}},Nq=function(c,q,h,O,e,K,D,W,b,V,X,I){D&&(Cd(c,q.uDiffuse,O),W?Yk(c,q,e,K,h.uv,W,X,I):Yk(c),Hl(c,h.vs,D,q.aPosition),Hl(c,h.ns,b,q.aNormal),V?(Bg(c,h.is,V),$b(c,0,V.length)):ie(c,0,D.length/3),W?Uj(c,q,e):Uj(c))},ni=function(p,t){var a=p.s;if(t||(t=a(tm)),!t)return q;if(qc(t))return t;var s=kb[t];if(s)return s;if("text"===t){var R={amount:a("shape3d.text.amount"),size:a("shape3d.text.size"),font:a("shape3d.text.font"),style:a("shape3d.text.style"),weight:a("shape3d.text.weight"),fill:a("shape3d.text.fill"),curveSegments:a("shape3d.text.curveSegments"),spacing:a("shape3d.text.spacing")},x=p.gv.getShape3dText(p.data),Y=x;for(var Z in R)Y+="_"+(R[Z]===Q?"U":R[Z]);return p._cachedTextKey===Y?p._cachedTextGeometry:(p._cachedTextKey=Y,p._cachedTextGeometry=E.createTextGeometry(x,R))}var Z=t;if(Of[t]){var H=a("shape3d.side"),L=a("shape3d.side.from"),$=a("shape3d.side.to"),c=a(Ai),o=a(de);3>H?(H=0,L=0,$=0,c=!1,o=!1):((L==q||0>L)&&(L=0),($==q||$>H)&&($=H),0===L&&$===H&&(c=!1,o=!1)),Z+="-"+H+"-"+L+"-"+$+"-"+c+"-"+o}if(im[t]){var b=a(sl);Z+="-"+b}if(Bs[t]){var u=a(jj);Z+="-"+u}if("torus"===t){var y=a("shape3d.torus.radius");
0>y?y=0:y>.25&&(y=.25),Z+="-"+y}if(mk[t]){var m=a(Ci);Z+="-"+m}return s=Wn[Z],s||("box"===t?s=E.createBoxModel():Wd[t]?s=Wd[t](b,u):"sphere"===t?s=E.createSphereModel(H,L,$,c,o,m):t===_n?s=E.createCylinderModel(H,L,$,c,o,b,u):"cone"===t?s=E.createConeModel(H,L,$,c,o,u):"torus"===t&&(s=E.createTorusModel(H,L,$,c,o,y,m)),Wn[Z]=s),s},jk=function(){var H=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],n=["is","top_is","bottom_is","from_is","to_is"];return U=Or(es.substr(es.indexOf("^#")+2)),ck(E[Bf(Vr+H[15]+"n"+H[16])]())&&dh()?function(N){N&&!N._complete_&&(N._complete_=!0,N.vs&&ae(N.ns)&&(N.ns=$p(N.vs,N.is)),N.top_vs&&ae(N.top_ns)&&(N.top_ns=$p(N.top_vs,N.top_is)),N.bottom_vs&&ae(N.bottom_ns)&&(N.bottom_ns=$p(N.bottom_vs,N.bottom_is)),N.from_vs&&ae(N.from_ns)&&(N.from_ns=$p(N.from_vs,N.from_is)),N.to_vs&&ae(N.to_ns)&&(N.to_ns=$p(N.to_vs,N.to_is)),H.forEach(function(b){var v=N[b];Rn(v)&&(N[b]=new bp(v))}),n.forEach(function(D){var q=N[D];Rn(q)&&(N[D]=new Ae(q))}))}:void 0}(),Ee=function($,G){var j=$[G];Rn(j)&&($[G]=new bp(j))};Ij(Ie,{_25Q:function(E){E._16O=function(M,E,l,N,f,A,K,$,w){var k=this.info;if(k){var p,e,Y,J,_,Z,j=ns();if(Qf[E]?(p=k.p3,e=k.c1,Y=k.c2):nj[E]?(e=k.s1||k.c1,Y=k.s2||k.c2):(e=k.t1||k.c1,Y=k.t2||k.c2),p)Z=ws(E,Jp,l,N,$,w);else{var D=np(Y,e),G=Ip(e,Y);J=[0,-B(D[2],D[0]),L(D[1]/G)],_="zyx",p=[(e[0]+Y[0])/2,(e[1]+Y[1])/2,(e[2]+Y[2])/2],Z=ws(E,[G,0,0],l,N,$,w)}return Fg(j,Z,p,N,f,A,K,M,J,_)}return Lc},E._80o=function(G,h,Y){var k=this,m=k.shapeModel;if(m){var z=k.gv;Yr(z),Rh(z,k.data,m,k,k.getBodyColor(),Y)}},E.createLineModel=function(h,N,d,p,b){for(var O=this,_=O.s,v=Ze(h,N,_(Ci)),I=[],k=0;k<v.length;k++){var t=v[k],H=t.length;if(H>1){var i=t[0];I.push(i.x,i.y,i.z);for(var j=1;H-1>j;j++)i=t[j],I.push(i.x,i.y,i.z),I.push(i.x,i.y,i.z);i=t[H-1],I.push(i.x,i.y,i.z)}}var K,V,G,R=_(p+".color"),P=_(b),g=0;return P&&(V=_(b+".color"),K=_(b+".pattern"),g=_(b+".offset"),G=R),ec(O.gv,O.data,I,V||R,G?q:_(p+".gradient.color"),d,K||_(p+".pattern"),g,G),v},E.createTubeModel=function(z,G,R,f){for(var n=this,H=n.s,k=H("shape3d.side")||Xb,K=H("shape3d.start.angle"),p=H("shape3d.sweep.angle"),w=H(sl)?H("shape3d.top.cap"):q,l=H(jj)?H("shape3d.bottom.cap"):q,g="flat"===w,V="flat"===l,t=g&&(f?f.uv:H("shape3d.top.image")),b=V&&(f?f.uv:H("shape3d.bottom.image")),B=f?f.uv:H("shape3d.image"),J={vs:[],uv:B?[]:q,top_vs:g?[]:q,top_uv:t?[]:q,bottom_vs:V?[]:q,bottom_uv:b?[]:q},Z=Ze(z,G,H(Ci),R),a=0,i=Z.length;i>a;a++)Tb(J,Z[a],H(Se),R,k,K,p,w,l);if(f){var C=[];Ki(n.gv,n.data,J,n,n.getBodyColor(),[],f,C),C.length&&(Ck(f.vs,C),Ck(f.ns,$p(C)))}else n.shapeModel=J;return Z},E.getCache=function(){var t=this.info;if(t){var e=t.list;if(e){var y=t.cache;return y||(y=t.cache=Dm(e)),y}}return q}}});var tc=function(Y,j){for(var B,q=0,U=Y.length,f=0,t=U-1;t>=f;)if(q=l(f+(t-f)/2),B=Y[q].length-j,0>B)f=q+1;else{if(!(B>0)){t=q;break}t=q-1}q=t;var A=Y[q],m=A.point;return q===U-1||A.length===j||(m=(new Ll).subVectors(Y[q+1].point,m).normalize().multiplyScalar(j-A.length).add(m)),{point:m,tangent:A.tangent}},Dm=function(k){for(var Q,e,v=[],g=0,s=0;s<k.length;s++){for(var r=k[s],D=0;D<r.length;D++){Q=r[D],e&&(g+=e.distanceTo(Q));var y=new Ll,m=r[D+1];m?y.subVectors(m,Q):e?y.subVectors(Q,e):y.x=1,y.normalize(),v.push({point:Q,length:g,tangent:y}),e=Q}e=null}return v},Ze=function(X,t,m,c){m=m||sn;for(var z=[],Y=0,k=X.size();k>Y;Y++){var J=X.get(Y);z.push(new Ll(J.x,J.e||0,J.y))}rk(t)&&(t=t._as);for(var C,I,e,B,g,W=[],H=0,r=0,D=t?t.length:k;D>r;r++)if(g=t?t[r]:0===r?1:2,1===g)W.push(e=[]),e.push(z[H++]);else if(2===g||5===g)if(B=2===g?z[H++]:e[0],c){var y=t?t[r+1]:D>r+1?2:q;if(2===y||5===y){var K=e[e.length-1],x=2===y?z[H]:e[0],L=(new Ll).subVectors(K,B),$=(new Ll).subVectors(x,B),V=L.length(),Z=$.length();if(c>V/2&&c>Z/2)e.push(B);else for(L.multiplyScalar(f(c,V/2)/V).add(B),$.multiplyScalar(f(c,Z/2)/Z).add(B),C=new ug(L,B,$).getPoints(m),I=0;m>=I;I++)e.push(C[I])}else e.push(B)}else e.push(B);else if(3===g)for(C=new ug(e[e.length-1],z[H++],z[H++]).getPoints(m),I=1;m>=I;I++)e.push(C[I]);else if(4===g)for(C=new Ah(e[e.length-1],z[H++],z[H++],z[H++]).getPoints(m),I=1;m>=I;I++)e.push(C[I]);return W},hg=function(R){for(var g,q,L=new Ll,w=[],S=[],E=[],Z=0,X=R.length;X>Z;Z++)g=R[Z],q=R[Z+1],q?L.subVectors(q,g):L.subVectors(g,R[Z-1]),w.push(L.normalize().clone());var n,y,u,N,Y=new Ll,e=new Ll,U=new Yi,k=1e-4,F=Number.MAX_VALUE,i=w[0],l=S[0]=new Ll,j=E[0]=new Ll;for(y=C(i.x),u=C(i.y),N=C(i.z),F>=y&&(F=y,Y.set(1,0,0)),F>=u&&(F=u,Y.set(0,1,0)),F>=N&&Y.set(0,0,1),e.crossVectors(i,Y).normalize(),l.crossVectors(i,e),j.crossVectors(i,l),Z=1;X>Z;Z++)S[Z]=S[Z-1].clone(),E[Z]=E[Z-1].clone(),e.crossVectors(w[Z-1],w[Z]),e.length()>k&&(e.normalize(),n=d(ts(w[Z-1].dot(w[Z]),-1,1)),S[Z].applyMatrix4(U.makeRotationAxis(e,n))),E[Z].crossVectors(w[Z],S[Z]);return{B:E,T:w,N:S}},Tb=function(){var l=function(s){for(var E=1;E<arguments.length;E++){var b=arguments[E];s.push(b.x,b.y,b.z)}},j=function(c){for(var o=1;o<arguments.length;o++){var R=arguments[o].uv;c.push(R[0],R[1])}},L=function(Y,D,p,L,J){var G=-L*g(J),O=L*x(J);return new Ll(Y.x+G*p.x+O*D.x,Y.y+G*p.y+O*D.y,Y.z+G*p.z+O*D.z)},n=function(P,z,u,y,U,E,O,l){O=O||G;for(var m=[],W=O/U,V=0;U>=V;V++){var i=L(P,z,u,y,V*W+E);m.push(i),l!=q&&(i.uv=[l,V/U])}return m},F=function(I,O,U,b,d,X,o,s,J){J=J||G;var f=O?I.top_vs:I.bottom_vs;if(f)for(var $=O?I.top_uv:I.bottom_uv,F=J/o,r=0;o>r;r++){var T,V;O?(T=r*F+s,V=(r+1)*F+s):(V=r*F+s,T=(r+1)*F+s),l(f,L(U,b,d,X,T),L(U,b,d,X,V),U),$&&$.push(.5-.5*g(T),.5-.5*x(T),.5-.5*g(V),.5-.5*x(V),.5,.5)}};return function(W,r,G,b,h,e,i,m,c){var f=r.length;if(f>1){var x,H,E,Y,s,K,a,O=hg(r),M=O.T,w=O.N,C=O.B;"flat"===m&&F(W,!0,r[0],C[0],w[0],b,h,e,i),"flat"===c&&F(W,!1,r[f-1],C[f-1],w[f-1],b,h,e,i);var g,$,L=[],o=z(h/2),k="round"===m,u="round"===c,D=r[0],t=M[0],N=C[0],P=w[0],_=r[f-1],d=M[f-1],y=C[f-1],A=w[f-1];if(k){for(E=1;o>=E;E++)w.splice(0,0,P),C.splice(0,0,N),M.splice(0,0,t),$=-E/o*b,r.splice(0,0,t.clone().multiplyScalar($).add(D)),L[o-E]=Z(b*b-$*$);f+=o}if(u){for(E=1;o>=E;E++)w.push(A),C.push(y),M.push(d),$=E/o*b,r.push(d.clone().multiplyScalar($).add(_)),L[r.length-1]=Z(b*b-$*$);f+=o}if(W.uv){var J=0,U=0,I=[];for(G&&(J=G),s=r[0],I[0]=0,E=1;f>E;E++)Y=r[E],I[E]=s.distanceTo(Y),s=Y,G||(J+=I[E]);for(g=[],E=0;f>E;E++)U+=I[E],g[E]=J?U/J:0}for(E=0;f>E;E++){if(Y=r[E],K=C[E],a=w[E],x=n(Y,K,a,L[E]===Q?b:L[E],h,e,i,g?g[E]:q),H)for(var V=0;h>V;V++){var S=H[V],v=H[V+1]||H[0],B=x[V],X=x[V+1]||x[0];l(W.vs,v,S,B,B,X,v),W.uv&&j(W.uv,v,S,B,B,X,v)}H=x}}}}();Ij(E,{getLineLength:function(E){return E[E.length-1].length},getLineOffset:function(x,b){return tc(x,b)},getLineCacheInfo:function(I,u,n,F){return Dm(Ze(I,u,n,F))}});var Od=i.Light=function(){Pj(Od,this),this.s(Xi,X[Xi]),this.s(tm,"sphere"),this.s3(20,20,20)};Qd("Light",Mf,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(x,S,k){Od.superClass.onStyleChanged.apply(this,arguments),x===Xi&&this.s("shape3d.color",k)}});var aq=tp.Graph3dView=function(i,K){var e=this;e._attributes=K||E.graph3dViewAttributes,e._25I={},e._view=wk(1,e);var z=e._canvas=ld(e._view);z.addEventListener("webglcontextlost",function(R){R.preventDefault(),Rd(e),e._26I=q,e._1o.texture=q,e._35O=!0},!1),z.addEventListener("webglcontextrestored",function(){e._35O=!1,e.iv()},!1),e._34O={},e._33O={},e._wireframeIndexMap={},e._wireframeModelMap={},e._polylineIndexMap={},e._polylineIndexMap={},e._8O=[],e._7O=ns(),e._6O=ns(),e._1o=new Ab(e),e._30O=new ym(e),e._31O=new xo(e),e._32O=new Xm(e),e._33Q=!0,e._eye=ji(E.graph3dViewEye),e._center=ji(E.graph3dViewCenter),e._up=ji(E.graph3dViewUp),e._lightChanged=!1,e._59O=[],e._spots=[],e._dirs=[],e.dm(i?i:new Gi),e.setInteractors([new fp(e)])},Cs={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1};jn("Graph3dView",P,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",co,Pd,"firstPersonMode",Rm,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Mm,uq,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_devicePixelRatio:Q,_boundaries:Q,_moveStep:E.graph3dViewMoveStep,_rotateStep:E.graph3dViewRotateStep,_pannable:E.graph3dViewPannable,_rotatable:E.graph3dViewRotatable,_walkable:E.graph3dViewWalkable,_resettable:E.graph3dViewResettable,_zoomable:E.graph3dViewZoomable,_firstPersonMode:E.graph3dViewFirstPersonMode,_mouseRoamable:E.graph3dViewMouseRoamable,_gridVisible:E.graph3dViewGridVisible,_gridSize:E.graph3dViewGridSize,_gridGap:E.graph3dViewGridGap,_gridColor:E.graph3dViewGridColor,_originAxisVisible:E.graph3dViewOriginAxisVisible,_centerAxisVisible:E.graph3dViewCenterAxisVisible,_axisXColor:E.graph3dViewAxisXColor,_axisYColor:E.graph3dViewAxisYColor,_axisZColor:E.graph3dViewAxisZColor,_ortho:E.graph3dViewOrtho,_orthoWidth:E.graph3dViewOrthoWidth,_fovy:E.graph3dViewFovy,_near:E.graph3dViewNear,_far:E.graph3dViewFar,_headlightColor:E.graph3dViewHeadlightColor,_headlightIntensity:E.graph3dViewHeadlightIntensity,_headlightRange:E.graph3dViewHeadlightRange,_headlightDisabled:E.graph3dViewHeadlightDisabled,_rectSelectable:E.graph3dViewRectSelectable,_rectSelectBackground:E.graph3dViewRectSelectBackground,_editSizeColor:E.graph3dViewEditSizeColor,_autoMakeVisible:jo,_fogDisabled:E.graph3dViewFogDisabled,_fogColor:E.graph3dViewFogColor,_fogNear:E.graph3dViewFogNear,_fogFar:E.graph3dViewFogFar,_dashDisabled:E.graph3dViewDashDisabled,_batchColorDisabled:E.graph3dViewBatchColorDisabled,_batchBlendDisabled:E.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:E.graph3dViewBatchBrightnessDisabled,setEye:function(g,L,i){1===arguments.length&&(L=g[1],i=g[2],g=g[0]);var k=this._eye;k[0]=g,k[1]=L,k[2]=i,this.fp(Mm,q,k)},setCenter:function(w,C,h){1===arguments.length&&(C=w[1],h=w[2],w=w[0]);var S=this._center;S[0]=w,S[1]=C,S[2]=h,this.fp(uq,q,S)},setUp:function(n,P,T){1===arguments.length&&(P=n[1],T=n[2],n=n[0]);var A=this._up;A[0]=n,A[1]=P,A[2]=T,this.fp("up",q,A)},isTransparentMask:function(Q){return Q.s("transparent.mask")},getAspect:function(){var c=this,O=c._aspect;return O?O:c.getWidth()/c.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(s){var K=this,C=K._dataModel,W=K._selectionModel;C!==s&&(C&&(C.umm(K.handleDataModelChange,K),C.umd(K.handleDataPropertyChange,K),W||C.sm().ums(K.handleSelectionChange,K)),K._dataModel=s,s.mm(K.handleDataModelChange,K),s.md(K.handleDataPropertyChange,K),W?W._21I(s):s.sm().ms(K.handleSelectionChange,K),K.invalidateAll(!0),K.invalidateLight(),K.fp(Nn,C,s))},handleDataPropertyChange:function(K){var P=K.data;this.invalidateData(P),pb(P)&&"s:light.type"===K.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(K){var w=this,h=K.property;w.iv(),w._18Q=q,"eye"===h?w._33Q=!0:"devicePixelRatio"===h?w._42(q,w._devicePixelRatio||Zl):Cs[h]&&Rd(w)},_5O:function(w){var T=w._22Q();return T?new T(this,w):q},getData3dUI:function(P){var H=this._25I[P._id];return H===Q&&(H=this._5O(P),this._25I[P._id]=H),H},invalidateAll:function(A){var X=this;if(A){for(var D in X._25I){var v=X._25I[D];v&&v.dispose()}X._25I={},X.iv(),In(X)}else X.dm().each(function(A){X.invalidateData(A)})},invalidateSelection:function(){var w=this;w.sm().each(function(_){w.invalidateData(_)})},invalidateData:function(D){var c=this,j=c.getData3dUI(D);j&&(j.iv(),c.iv()),In(c,D)},getShape3dText:function(R){return R.getStyle("shape3d.text")||this.getLabel(R)},invalidateBatch:function(D){var L=this,q=L._33O,P=q[D],M=[],u={};if(P){P.ds.forEach(function(G){var P=L.getData3dUI(G);P&&P.iv(),delete L._34O[G._id],M.push(G._id)}),delete q[D];for(var j,R,V,Z,d,F,C,_,T,W=0;2>W;W++){var I=L[["_wireframeModelMap","_polylineModelMap"][W]],$=L[["_wireframeIndexMap","_polylineIndexMap"][W]];for(u={},_=0;_<M.length;_++){var z=$[M[_]];if(z){delete $[M[_]],T=z.batch,j=I[T];var x=z.begin,H=z.size,o=3*x,e=3*H,k=4*x,A=4*H;for(R=j.ds,V=j.vs,Z=j.cs,d=j.ps,F=j.ls,C=z.index,j.invalidate=!0,R[C]=Q,C=o;o+e>C;C++)V[C]=Q;for(C=k;k+A>C;C++)Z[C]=Q;for(C=k;k+A>C;C++)d[C]=Q;if(F)for(C=o;o+e>C;C++)F[C]=Q;u[T]=!0}}for(T in u){j=I[T],R=j.ds,V=j.vs,Z=j.cs,d=j.ps,F=j.ls;var c=[];for(C=0;C<R.length;C++)R[C]!==Q&&c.push(R[C]);if(0===c.length)delete I[T];else{for(j.ds=c,c=[],C=0;C<V.length;C++)V[C]!==Q&&c.push(V[C]);for(j.vs=c,c=[],C=0;C<Z.length;C++)Z[C]!==Q&&c.push(Z[C]);for(j.cs=c,c=[],C=0;C<d.length;C++)d[C]!==Q&&c.push(d[C]);if(j.ps=c,F){for(c=[],C=0;C<F.length;C++)F[C]!==Q&&c.push(F[C]);j.ls=c}}}}L.iv()}},handleDataModelChange:function(C){var Q=this,Z=C.kind,F=C.data;if("add"===Z)Q.invalidateData(F),Rf(F)&&F.getEdgeGroup()&&F.getEdgeGroup().eachSiblingEdge(Q.invalidateData,Q),pb(F)&&Q.invalidateLight();else if(Z===dm){var s=F._id,$=Q._25I[s];$&&($.dispose(),delete Q._25I[s],Q.iv()),F===Q._currentSubGraph&&Q.setCurrentSubGraph(q),In(Q,F),pb(F)&&Q.invalidateLight()}else Z===Hn&&(Q.invalidateAll(!0),Q.setCurrentSubGraph(q),In(Q),Q.invalidateLight())},toCanvas:function(Q){var N=this,b=N.getGL();if(N.validate(),Q){var v=b.getParameter(b.COLOR_CLEAR_VALUE);nn(b,Q)}N._42(q,1);var R=N.getWidth(),e=N.getHeight(),_=new Uint8Array(4*R*e),d=ld(),a=d.getContext("2d");b.readPixels(0,0,R,e,b.RGBA,b.UNSIGNED_BYTE,_),Pm(d,R,e,1);for(var V=a.getImageData(0,0,R,e),u=V.data,p=0;p<u.length;p+=4){var I=p/4,w=l(I/R),J=I-w*R;I=4*((e-1-w)*R+J),u[I]=_[p],u[I+1]=_[p+1],u[I+2]=_[p+2],u[I+3]=_[p+3]}return a.putImageData(V,0,0),Q&&nn(b,v),N._42(q,N._devicePixelRatio||Zl),d},toDataURL:function($,e){var d=this,l=d.getGL();if(d.validate(),$){var a=l.getParameter(l.COLOR_CLEAR_VALUE);nn(l,$)}d._42(q,1);var A=d._canvas.toDataURL(e||"image/png",1);return $&&nn(l,a),d._42(q,d._devicePixelRatio||Zl),A},getGL:function(){var d=this,G=d._26I,z=d._prg;if(!G)try{d._2O={},G=d._26I=d._canvas.getContext("webgl",d._attributes)||d._canvas.getContext("experimental-webgl",d._attributes),G._emptyTexture=id(G),d._buffer={vs:Zh(G),ns:Zh(G),is:Zh(G),uv:Zh(G),batchColor:Zh(G),batchBlend:Zh(G),batchBrightness:Zh(G),lineDistance:Zh(G)},d._1O=Lr(G);var Q=d._cube={vs:Zh(G),ns:Zh(G),is:Zh(G),uv:Zh(G)};Hl(G,Q.vs,Gh),Hl(G,Q.ns,Dc),Hl(G,Q.uv,fb),Bg(G,Q.is,Jc)}catch(K){}if(G&&!z){if(z=d._prg=G.createProgram(),!z)return q;var C=d._dirs.length,H=d._spots.length,J=d._59O.length,U=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uTransparent","uTexture","uSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];C&&U.push("uDirColor","uDirPosition"),H&&U.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotCenter"),J&&U.push("uPointColor","uPointRange","uPointPosition"),nn(G,[0,0,0,0]),G.clearDepth(1),G.enable(G.DEPTH_TEST),G.depthFunc(G.LEQUAL),G.enable(G.BLEND),G.blendFunc(G.SRC_ALPHA,G.ONE_MINUS_SRC_ALPHA),lo||(es=Or(es.substring(0,es.indexOf("^#"))),Vh=Or(Vh),lo=!0);var f=["#define MAX_DIR "+C,"#define MAX_SPOT "+H,"#define MAX_POINT "+J,d._fogDisabled?"":"#define FOG",d._dashDisabled?"":"#define DASH",d._batchColorDisabled?"":"#define BATCHCOLOR",d._batchBlendDisabled?"":"#define BATCHBLEND",d._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),x=rg(G,z,G.VERTEX_SHADER,es.replace("PREFIX",f)),g=rg(G,z,G.FRAGMENT_SHADER,Vh.replace("PREFIX",f));h?U.push("aPosition"):(z.aPosition=0,G.bindAttribLocation(z,0,"aPosition")),G.linkProgram(z),U.forEach(function(X){z[X]=/^u/.test(X)?G.getUniformLocation(z,X):G.getAttribLocation(z,X)}),G.useProgram(z),G.deleteShader(x),G.deleteShader(g)}return G},getBrightness:function(N){var e=N.s("brightness"),W=this.isSelected(N)?N.s("select.brightness"):q;return e==q?W:W==q?e:e*W},getWireframe:function(A){var l=A.s("wf.visible"),J=A.s("wf.width");return l===!0||J>0&&"selected"===l&&this.isSelected(A)?{color:A.s("wf.color"),width:J,"short":A.s("wf.short"),mat:A.s("wf.mat")}:void 0},getBodyColor:function(V){return V.s("body.color")},getMat:function(d){return d.getMat?d.getMat():d.s("mat")},getFaceMat:function(Q,l){return Q.getFaceMat?Q.getFaceMat(l):Q.s(l+".mat")},getFaceBlend:function($,Q){return $.s(Q+".blend")||$.s("all.blend")},getFaceColor:function(T,J){return T.s(J+".color")||T.s("all.color")},getFaceImage:function(J,V){return J.s(V+".image")||J.s("all.image")},getFaceDiscardSelectable:function(v,D){var g=v.s(D+".discard.selectable");return g==q?v.s("all.discard.selectable"):g},getFaceUv:function(W,A){return W.s(A+".uv")||W.s("all.uv")},getFaceUvOffset:function(R,K){return R.s(K+".uv.offset")||R.s("all.uv.offset")},getFaceUvScale:function(h,c){return h.s(c+".uv.scale")||h.s("all.uv.scale")},getFaceLight:function(V,t){var b=V.s(t+".light");return b==q?V.s("all.light"):b},getFaceVisible:function(v,M){var e=v.s(M+".visible");return e==q?v.s("all.visible"):e},getFaceOpacity:function(d,X){var T=d.s(X+".opacity");return T==q?d.s("all.opacity"):T},getFaceTransparent:function(S,f){var B=S.s(f+".transparent");return B==q?S.s("all.transparent"):B},getFaceReverseColor:function(o,N){return o.s(N+".reverse.color")||o.s("all.reverse.color")},getFaceReverseFlip:function(x,L){var $=x.s(L+".reverse.flip");return $==q?x.s("all.reverse.flip"):$},getFaceReverseCull:function(y,e){var v=y.s(e+".reverse.cull");return v==q?y.s("all.reverse.cull"):v},getTextureMap:function(){return this._2O},deleteTexture:function(X){var F=this,z=F._2O[X];z&&(delete F._2O[X],F.getGL().deleteTexture(z))},getTexture:function(d,N){if(!d)return q;var o=this,Q=o.getGL(),w=o._2O[d];if(!w){var x=fo(d);if(x)if(x.tagName){if(x.dynamic)return Lr(Q,x,o._1O);w=o._2O[d]=Lr(Q,x)}else{var X=Uh(x,N),K=yn(x,N);if(X>=1&&K>=1){var M=nd(X,K);return dn(M,x,0,0,X,K,N,o),M.restore(),Lr(Q,Xc,o._1O)}}}return w},redraw:function(){this.iv()},validateImpl:function(){var Y=this;if(Y._lightChanged){Y._lightChanged=!1;var T=[],a=[],q=[];Y.dm().each(function($){if(pb($)){var Y=$.s("light.type");Y===Ug?T.push($):Y===Eb?a.push($):Y===Gj&&q.push($)}}),(T.length!==Y._59O.length||a.length!==Y._spots.length||q.length!==Y._dirs.length)&&Rd(Y),Y._59O=T,Y._spots=a,Y._dirs=q}Y._42(),Y._1o.iv()},_42:function(Y,E){var k=this;if(!k._35O&&(!ue||Oe(ue))){var W,D;Y&&(Y instanceof Mf?D=Y:W=Y);var r=k._canvas,m=k.getWidth(),H=k.getHeight(),X=k.getGL(),A=k._prg;if(X){if(E?Y||Pm(r,m,H,E):(E=k._devicePixelRatio||Zl,Y||m===r.clientWidth&&H===r.clientHeight||Pm(r,m,H,E)),X.viewport(0,0,m*E,H*E),k._81O=q,X.clear(X.COLOR_BUFFER_BIT|X.DEPTH_BUFFER_BIT),Cd(X,A.uBrightness,1),Cd(X,A.uOpacity,1),Cd(X,A.uPartOpacity,1),X._picking=!!Y,Cd(X,A.uPick,!!Y),Cd(X,A.uTexture,!1),Cd(X,A.uFix,!1),Cd(X,A.uTransparent,!1),Cd(X,A.uBatchColor,!1),Cd(X,A.uBatchBlend,!1),Cd(X,A.uBatchBrightness,!1),Y||(Md(k,X,A),k._fogDisabled||(Cd(X,A.uFogColor,k._fogColor),Cd(X,A.uFogNear,k._fogNear),Cd(X,A.uFogFar,k._fogFar))),eq(X,A.aPosition),eq(X,A.aNormal),go(X,A.aUv),go(X,A.aBatchColor),go(X,A.aBatchBlend),go(X,A.aBatchBrightness),go(X,A.aLineDistance),Cd(X,A.uPMatrix,Jq(k)),Cd(X,A.uViewMatrix,tj(k,k._7O)),D){var O=X.getParameter(X.COLOR_CLEAR_VALUE);X.clearColor(0,0,0,0),X.disable(X.BLEND),go(X,A.aNormal),Hl(X,k._cube.vs,q,A.aPosition),Bg(X,k._cube.is),Mk(D,k,Ff,0),Mk(D,k,Fn,6),Mk(D,k,Gr,12),Mk(D,k,xn,18),Mk(D,k,nr,24),Mk(D,k,Xg,30),eq(X,A.aNormal),nn(X,O)}else if(W){W.value=2;var O=X.getParameter(X.COLOR_CLEAR_VALUE);X.clearColor(0,0,0,0),X.disable(X.BLEND),k._95I(X,A,W),El(k,W),sf(k,k._polylineModelMap,W),sf(k,k._wireframeModelMap,W),Cd(X,A.uTransparent,!0),k._95I(X,A,W,!0),El(k,W,!0),sf(k,k._polylineModelMap,W,!0),sf(k,k._wireframeModelMap,W,!0),Cd(X,A.uTransparent,!1),X.disable(X.DEPTH_TEST),k._30O._42(X,A,W),X.enable(X.DEPTH_TEST),nn(X,O)}else X.disable(X.BLEND),k.drawSky(X,A),k._31O._42(X,A),k._95I(X,A),El(k),sf(k,k._polylineModelMap),sf(k,k._wireframeModelMap),X.enable(X.BLEND),X.depthMask(!1),Cd(X,A.uTransparent,!0),k._95I(X,A,q,!0),El(k,q,!0),sf(k,k._polylineModelMap,q,!0),sf(k,k._wireframeModelMap,q,!0),Cd(X,A.uTransparent,!1),X.depthMask(!0),X.disable(X.BLEND),X.disable(X.DEPTH_TEST),k._32O._42(X,A),k._30O._42(X,A),X.enable(X.DEPTH_TEST);Hl(X,q),Bg(X,q),k._33Q=!1}}},_updateSkyBoxPosition:function(m){if(this._skyBox&&m&&"eye"===m.property){var E=m.newValue;this._skyBox.p3(E[0],E[1],E[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(F){this._skyBox=F,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),F&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(X,u,i){var s=this,t=s._skyBox;if(t){var J=s._headlightIntensity,L=Yg(s._headlightColor),u=s._prg;1!==J&&(L=[L[0]*J,L[1]*J,L[2]*J]),Cd(X,u.uHeadlightColor,[L[0],L[1],L[2],1]);var b=s.getData3dUI(t);b&&b._42(X,u,i,function(){return!0}),X.clear(X.DEPTH_BUFFER_BIT),Cd(X,u.uHeadlightColor,[L[0],L[1],L[2],s._headlightDisabled?1:0])}},_95I:function(W,s,A,t){function J(P){if(B.isVisible(P)&&(!j||T)){if(!A&&B.isTransparentMask(P))return;var _=B.getData3dUI(P);_&&_._42(W,s,A,e)}}var B=this,e=function(M){return t?M:!M};B.sky&&W.clear(W.DEPTH_BUFFER_BIT),B.dm().each(J)},getLogicalPoint:function(d){return Ud(d,this._canvas)},getHitFaceInfo:function(k){k.target&&(k=this.lp(k));var m=this.getDataInfoAt(k);if(m){var F=this._1o.face(m.data,gp(k.x,k.y));if(F)return{data:m.data,face:F}}return q},getDataAt:function(X){var i=this.getDataInfoAt(X);return i?i.data:q},getDataInfoAt:function(Q,t){return Q.target&&(Q=this.lp(Q)),this._1o.get(gp(Q.x,Q.y,t),!0)},getDatasInRect:function(v){return this._1o.get(v)},setEditable:function(Z){var D=this,K=D._editable;D._editable=Z,this.fp(Eq,K,Z)},isEditable:function(c){var z=this;return z._editable?Bj(c)?c.s("3d.editable")?z._editableFunc?z._editableFunc(c):!0:!1:!1:!1},isSelectable:function(U){return U.s("3d.selectable")&&this.sm().isSelectable(U)},isMovable:function(D){var p=this;return Rf(D)&&D.getStyle(Li)!==Ko?!1:D.s("3d.movable")?p._movableFunc?p._movableFunc(D):!0:!1},isSizeEditable:function(o){return Bj(o)?this._sizeEditableFunc?this._sizeEditableFunc(o):!0:!1},isRotationEditable:function(O){return Bj(O)&&O.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(O):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(t){this.setZoom(Wh,t)},zoomOut:function(g){this.setZoom(1/Wh,g)},setZoom:function(u,s){if(1!==u){var L=this;if(L._ortho)return L.setOrthoZoom(u,s),void 0;L._14o&&L._14o.stop(!0);var w=1/u,I=L._eye,$=L._center,Z=$[0]+(I[0]-$[0])*w-I[0],e=$[1]+(I[1]-$[1])*w-I[1],j=$[2]+(I[2]-$[2])*w-I[2];if(!(Ip(I,$)<L._moveStep&&1>w)){if(s=df(s)){var W=ji(I);return s.action=function(O){L.fi({kind:L._zooming?"betweenZoom":"beginZoom"}),L._zooming=1,I[0]=W[0]+Z*O,I[1]=W[1]+e*O,I[2]=W[2]+j*O,L.fp(Mm,q,I)},s._37o=function(){delete L._14o,delete L._zooming,L.fi({kind:"endZoom"}),L.onZoomEnded()},L._14o=Ao(s)}I[0]+=Z,I[1]+=e,I[2]+=j,L.fp(Mm,q,I)}}},setOrthoZoom:function(j,b){if(1!==j){var T=this;T._14o&&T._14o.stop(!0);var k=T._orthoWidth,p=k/j-k;if(!(k<T._moveStep&&j>1))return(b=df(b))?(b.action=function(H){T.fi({kind:T._zooming?"betweenZoom":"beginZoom"}),T._zooming=1,T.setOrthoWidth(k+p*H)},b._37o=function(){delete T._14o,delete T._zooming,T.fi({kind:"endZoom"}),T.onZoomEnded()},T._14o=Ao(b)):(T.setOrthoWidth(k/j),void 0)}},getPositionInfo:function(A){var I=this,J=I._eye,G=I._center,f=I.getAspect(),b=A?Pn(np(G,J,!0),np(A,J)):Ip(J,G);if(I._ortho){var k=I._orthoWidth;return{length:b,height:k/f,width:k}}var D=2*t(I._fovy/2)*b;return{length:b,height:D,width:D*f}},getCenterInfo:function(){var I=this;return I._81O||(I._81O=I.getPositionInfo()),ji(I._81O)},rotate:function(c,T,N,z){var i=this;if(c||T){z==q&&(z=i._firstPersonMode),i._88O&&i._88O.stop(!0);var U=i._center,a=i._eye,j=i.getCenterInfo().length,P=z?U:a,J=z?a:U,G=np(P,J),r=B(G[0],G[2]),K=B(Z(G[0]*G[0]+G[2]*G[2]),G[1]),m=z?uq:Mm;return z&&(T=-T),(N=df(N))?(N.action=function(W){i.fi({kind:i._rotating?"betweenRotate":"beginRotate"}),i._rotating=1;var F=r+c*W,C=K+T*W;C=eg(C),G[0]=j*x(C)*x(F),G[1]=j*g(C),G[2]=j*x(C)*g(F),P[0]=J[0]+G[0],P[1]=J[1]+G[1],P[2]=J[2]+G[2],i.fp(m,q,P)},N._37o=function(){delete i._88O,delete i._rotating,i.fi({kind:"endRotate"}),i.onRotateEnded()},i._88O=Ao(N)):(r+=c,K+=T,K=eg(K),G[0]=j*x(K)*x(r),G[1]=j*g(K),G[2]=j*x(K)*g(r),P[0]=J[0]+G[0],P[1]=J[1]+G[1],P[2]=J[2]+G[2],i.fp(m,q,P),void 0)}},pan:function(x,T,W,F){if(x||T){var p=this;F==q&&(F=p._firstPersonMode),p._89O&&p._89O.stop(!0);var f=tj(p),M=[f[0]*x,f[4]*x,f[8]*x],D=[f[1]*T,f[5]*T,f[9]*T],l=M[0]+D[0],S=M[1]+D[1],U=M[2]+D[2],K=p._center,C=p._eye;if(F){var L=yp(p.getBoundaries(),C[0],C[2],C[0]+l,C[2]+U,Z(l*l+U*U));l=L[0],U=L[1]}if(W=df(W)){var $=ji(C),s=ji(K);return W.action=function(g){p.fi({kind:p._panning?"betweenPan":"beginPan"}),p._panning=1,K[0]=s[0]+l*g,K[1]=s[1]+S*g,K[2]=s[2]+U*g,C[0]=$[0]+l*g,C[1]=$[1]+S*g,C[2]=$[2]+U*g,p.fp(Mm,q,C),p.fp(uq,q,K)},W._37o=function(){delete p._89O,delete p._panning,p.fi({kind:"endPan"}),p.onPanEnded()},p._89O=Ao(W)}K[0]+=l,K[1]+=S,K[2]+=U,C[0]+=l,C[1]+=S,C[2]+=U,p.fp(Mm,q,C),p.fp(uq,q,K)}},walk:function(h,a,T){if(h){var N=this;T==q&&(T=N._firstPersonMode),N._90O&&N._90O.stop(!0);var d=N._center,n=N._eye,r=np(d,n,!0);if(T){var L=yp(N.getBoundaries(),n[0],n[2],n[0]+r[0]*h,n[2]+r[2]*h,C(h));if(h=Ip(L),!h)return;r=[L[0]/h,0,L[1]/h]}if(a=df(a)){var e=ji(n),w=ji(d);return a.action=function(J){N.fi({kind:N._walking?"betweenWalk":"beginWalk"}),N._walking=1;var Y=h*J;n[0]=e[0]+r[0]*Y,n[1]=e[1]+r[1]*Y,n[2]=e[2]+r[2]*Y,d[0]=w[0]+r[0]*Y,d[1]=w[1]+r[1]*Y,d[2]=w[2]+r[2]*Y,N.fp(Mm,q,n),N.fp(uq,q,d)},a._37o=function(){delete N._90O,delete N._walking,N.fi({kind:"endWalk"}),N.onWalkEnded()},N._90O=Ao(a)}n[0]+=r[0]*h,n[1]+=r[1]*h,n[2]+=r[2]*h,d[0]+=r[0]*h,d[1]+=r[1]*h,d[2]+=r[2]*h,N.fp(Mm,q,n),N.fp(uq,q,d)}},handleScroll:function(u,V){u.preventDefault();var J=this,h=J._moveStep;J.isFirstPersonMode()?J.isPannable()&&J.pan(0,V>0?h:-h):J.isZoomable()&&J.setZoom(0>V?1/zp:zp)},handlePinch:function(U,g){this.isZoomable()&&this.setZoom(g>U?1/Zf:Zf)},reset:function(){this.setCenter(E.graph3dViewCenter),this.setEye(E.graph3dViewEye),this.setUp(E.graph3dViewUp)},moveSelection:function(y,_,z){var L,d=this,b=d.dm();b&&(L=b.getHistoryManager()),L&&L.beginInteraction(),Xp(this.sm().toSelection(this.isMovable,this),y,_,z),L&&L.endInteraction()},getMoveMode:function(z,y){var B=y.s("3d.move.mode");if(B)return B;var O="88",I="89",R="90";return Wi(z)||qn[O]&&qn[I]&&qn[R]?"xyz":qn[O]&&qn[I]?"xy":qn[O]&&qn[R]?"xz":qn[I]&&qn[R]?"yz":qn[O]?"x":qn[I]?"y":qn[R]?"z":"xz"},handleTick:function(){var o=this,b=!1,C=o._moveStep,v=C,m=!1,O=!0,k=o._rotateStep*(O?-1:1);if(o.isWalkable()||(v=0),o.isPannable()||(C=0),o.isRotatable()||(k=0),o._32Q){var s=(Bm()-o._32Q)/50;v*=s,C*=s,k*=s}o._31Q&&(Yq(o._31Q),delete o._31Q,delete o._32Q),Pe()&&(b=!0,o.pan(-C,0,m,O)),Nf()&&(b=!0,o.pan(C,0,m,O)),fj()&&(b=!0,Wi()?o.pan(0,C,m,O):o.walk(v,m,O)),To()&&(b=!0,Wi()?o.pan(0,-C,m,O):o.walk(-v,m,O)),Bn()&&(b=!0,o.rotate(-k,0,m,O)),fn()&&(b=!0,o.rotate(k,0,m,O)),Br()&&(b=!0,o.rotate(0,-k/2,m,O)),Dp()&&(b=!0,o.rotate(0,k/2,m,O)),b&&(o._32Q=Bm(),o._31Q=Ce(o.handleTick,o))},handleKeyDown:function(E){var $=this;!ki(E)&&Om[E.keyCode]?$.handleTick():uk(E)?$.selectAll():Ii(E)?$.handleDelete(E):Rb(E)&&this.isResettable()&&$.reset()},checkDoubleClickOnNote:function(j,g,K){var i=this;if(K===js){if(g.s("note.toggleable"))return g.s(ho,!g.s(ho)),i.fi({kind:"toggleNote",event:j,data:g,part:K}),!0}else if(K===pl&&g.s("note2.toggleable"))return g.s(Mr,!g.s(Mr)),i.fi({kind:"toggleNote2",event:j,data:g,part:K}),!0;return!1},checkDoubleClickOnRotation:function(m,g,C){return C===ko?(g.setRotationX(0),!0):C===Pb?(g.setRotationY(0),!0):C===nf?(g.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(S){var A=this,c=A.getWidth()/2,M=A.getHeight()/2,v=A._18Q;return v||(v=Jq(A),A._18Q=yl(v,v,tj(A))),S=Jm([S[0],S[1],S[2],1],v),{x:c+c*S[0]/S[3],y:M-M*S[1]/S[3]}},getHitPosition:function(W,B,d){var Z=this,f=Z.getWidth(),p=Z.getHeight(),E=W.target?Z.lp(W):W,t=E.x-f/2,b=E.y-p/2,$=Z.getCenterInfo(),e=tj(Z);B=B?B:[0,0,0],d=d?d:[0,1,0],t=t/f*$.width,b=-1*b/p*$.height;var X=[e[0]*t,e[4]*t,e[8]*t],s=[e[1]*b,e[5]*b,e[9]*b],D=[X[0]+s[0],X[1]+s[1],X[2]+s[2]],K=Z.getCenter(),F=Ye(Z,B,d,[D[0]+K[0],D[1]+K[1],D[2]+K[2]]);return F?F:[0,0,0]},getLineLength:function(v){this.validate();var k=this.getData3dUI(v);if(k&&k.getCache){var q=k.getCache();if(q)return q[q.length-1].length}return 0},getLineOffset:function(v,r){var B=this.getData3dUI(v);if(B&&B.getCache){var h=B.getCache();if(h)return tc(h,r)}return q},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var Cr=tp.Interactor=function(m){this.gv=m};jn("Interactor",P,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var fp=tp.DefaultInteractor=function(C){Pj(fp,this,[C])};jn("DefaultInteractor",Cr,{handle_contextmenu:function(Q){br(Q)},handle_mousewheel:function(X){this.gv.handleScroll(X,X.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this.gv.handleScroll(l,-l.detail)},handle_keydown:function(o){this.gv.handleKeyDown(o)},handle_mousedown:function(_){this.handle_touchstart(_)},handle_touchstart:function(V){br(V);var t=this,U=t.gv,s=vk(V),i=U.getDataInfoAt(V),z=i?i.data:q,K=i?i.part:q,_=U.sm(),u=Yn(V),I=Ed(V);U.setFocus(V)&&(t._62O=q,t._57I=q,z?ki(V)?_.co(z)?_.rs(z):_.as(z):_.co(z)||_.ss(z):s&&(ki(V)?U.isRectSelectable()&&(t._62O=Pi):t._57I=wo(V)),t._31Q&&(Yq(t._31Q),delete t._31Q,delete t._32Q),t._62O||(U.isFirstPersonMode()&&(Wi(V)||I>2?t._62O="pan":U.isMouseRoamable()||e?(t._62O="roaming",t.foward=u&&vk(V),t._32Q=Bm(),t._31Q=Ce(t.tick,t)):s||(t._62O="roaming")),t._62O||(s&&u&&Kr[K]?(t._62O=K,t.p3=z.p3()):s&&u&&Bj(z)&&U.isSelected(z)&&U.isMovable(z)?(t._62O="move",t.p3=z.p3(),t.movedata=z):e&&(I>2?t._62O="pan":2===I&&(t.dist=Em(V),t._62O="pinch")))),t.point=U.lp(V),Pr(t,V),hq(V)?U.handleDoubleClick(V,z,K):U.handleClick(V,z,K))},tick:function(){var V=this,q=V.gv,i=q._moveStep;V.point&&q.isWalkable()&&(V._32Q&&(i*=(Bm()-V._32Q)/50),q.walk(V.foward?i:-i),V._32Q=Bm(),V._31Q=Ce(V.tick,V))},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(J){var l=this._57I;l&&(Ip(l,wo(J))<=1&&this.gv.sm().cs(),this._57I=q)},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(h){var c,r,o=this,Y=o.gv,H=o._62O,l=o.point,D=Y.dm(),N=D.getHistoryManager(),s=Y.lp(h),P=s.x-l.x,L=s.y-l.y,k=-G*P/Y.getWidth(),O=-G*L/Y.getHeight();if("roaming"===H)o.rotate(h,k/2,O/2);else if(H===ko||H===Pb||H===nf)N&&!Y._86O&&N.beginInteraction(),Y.fi({kind:Y._86O?"betweenEditRotation":"beginEditRotation",event:h}),Y._86O=1,Y.sm().each(function(M){if(Bj(M)&&Y.isRotationEditable(M)){var U=C(k)>C(O)?k:O;H===ko?M.setRotationX(M.getRotationX()+U):H===Pb?M.setRotationY(M.getRotationY()+U):H===nf&&M.setRotationZ(M.getRotationZ()+U)}});else if("move"===H||Kr[H]){H===Tc||H===fi||H===md?(N&&!Y._87O&&N.beginInteraction(),Y.fi({kind:Y._87O?"betweenEditSize":"beginEditSize",event:h}),Y._87O=1):(N&&!Y._moving&&N.beginInteraction(),Y.fi({kind:Y._moving?"betweenMove":"beginMove",event:h}),Y._moving=1);var n,p=o.p3,a=Y.getPositionInfo(p),S=tj(Y);n=H===el?"x":H===Oo?"y":H===wq?"z":H===Tc?"sx":H===fi?"sy":H===md?"sz":Y.getMoveMode(h,o.movedata),P=P/Y.getWidth()*a.width,L=-1*L/Y.getHeight()*a.height;
var z,A,_=[S[0]*P,S[4]*P,S[8]*P],j=[S[1]*L,S[5]*L,S[9]*L],R=_[0]+j[0],u=_[1]+j[1],I=_[2]+j[2],d=[p[0]+R,p[1]+u,p[2]+I],y=np(Y.getEye(),d,!0);if("xyz"===n?(z=d,Y.moveSelection(R,u,I)):"xz"===n?(z=Ye(Y,p,[0,1,0],d),z&&Y.moveSelection(z[0]-p[0],0,z[2]-p[2])):"xy"===n?(z=Ye(Y,p,[0,0,1],d),z&&Y.moveSelection(z[0]-p[0],z[1]-p[1],0)):"yz"===n?(z=Ye(Y,p,[1,0,0],d),z&&Y.moveSelection(0,z[1]-p[1],z[2]-p[2])):"x"===n||"sx"===n?(y[0]=0,z=Ye(Y,p,y,d),z&&(A=z[0]-p[0],"x"===n?Y.moveSelection(A,0,0):Y.sm().each(function(W){Bj(W)&&Y.isSizeEditable(W)&&(c=M(Tl,W.getWidth()+A),r=c/W.getWidth(),W.setWidth(c),Wi(h)&&(W.setHeight(W.getHeight()*r),W.setTall(W.getTall()*r)))}))):"y"===n||"sy"===n?(y[1]=0,z=Ye(Y,p,y,d),z&&(A=z[1]-p[1],"y"===n?Y.moveSelection(0,A,0):Y.sm().each(function(e){Bj(e)&&Y.isSizeEditable(e)&&(c=M(Tl,e.getTall()+A),r=c/e.getTall(),e.setTall(c),Wi(h)&&(e.setHeight(e.getHeight()*r),e.setWidth(e.getWidth()*r)))}))):("z"===n||"sz"===n)&&(y[2]=0,z=Ye(Y,p,y,d),z&&(A=z[2]-p[2],"z"===n?Y.moveSelection(0,0,A):Y.sm().each(function(X){Bj(X)&&Y.isSizeEditable(X)&&(c=M(Tl,X.getHeight()+A),r=c/X.getHeight(),X.setHeight(c),Wi(h)&&(X.setTall(X.getTall()*r),X.setWidth(X.getWidth()*r)))}))),!z)return;o.p3=z}else if(H===Pi){var i=o.div;i||(i=o.div=ao(),gd(o.getView(),i),i.op=l,i.style.background=Y.getRectSelectBackground()),Y.fi({kind:Y._rectSelecting?"betweenRectSelect":"beginRectSelect",event:h}),Y._rectSelecting=1,i.rect=Yd(i.op,s),Mj(i,i.rect)}else if("pinch"===H&&2===Ed(h)){Y.fi({kind:Y._pinching?"betweenPinch":"beginPinch",event:h}),Y._pinching=1;var A=Em(h);Y.handlePinch(A,o.dist),o.dist=A}else"pan"===H||Wi(h)?o.pan(h,P,L):Y.isFirstPersonMode()||(vk(h)?o.rotate(h,k,O):(o.pan(h,P,0),Y.isWalkable()&&(Y.fi({kind:Y._walking?"betweenWalk":"beginWalk",event:h}),Y._walking=1,Y.walk(L/Y.getHeight()*Y.getCenterInfo().height))));o.point=s},pan:function(c,j,T){var R=this.gv;if(R.isPannable()){var P=R.getCenterInfo(),x=j/R.getWidth()*P.width,z=-1*T/R.getHeight()*P.height;R.fi({kind:R._panning?"betweenPan":"beginPan",event:c}),R._panning=1,R.pan(-x,-z)}},rotate:function(g,m,w){var f=this.gv;f.isRotatable()&&(f.fi({kind:f._rotating?"betweenRotate":"beginRotate",event:g}),f._rotating=1,f.rotate(m,w))},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(K){var C=this,I=C.gv,Z=I.dm(),J=Z.getHistoryManager(),l=C.div;if(l){var t=I.getDatasInRect(l.rect);if(!t.isEmpty()){var M=I.sm(),P=M.toSelection();t.each(function(V){M.co(V)?P.remove(V):P.add(V)}),M.ss(P)}Ad(l)}I._moving&&(delete I._moving,I.fi({kind:"endMove",event:K}),I.onMoveEnded(),J&&J.endInteraction()),I._panning&&(delete I._panning,I.fi({kind:"endPan",event:K}),I.onPanEnded()),I._rotating&&(delete I._rotating,I.fi({kind:"endRotate",event:K}),I.onRotateEnded()),I._86O&&(delete I._86O,I.fi({kind:"endEditRotation",event:K}),J&&J.endInteraction()),I._87O&&(delete I._87O,I.fi({kind:"endEditSize",event:K}),J&&J.endInteraction()),I._pinching&&(delete I._pinching,I.fi({kind:"endPinch",event:K}),I.onPinchEnded()),I._rectSelecting&&(delete I._rectSelecting,I.fi({kind:"endRectSelect",event:K}),I.onRectSelectEnded()),I._walking&&(delete I._walking,I.fi({kind:"endWalk",event:K}),I.onWalkEnded()),C.dist=C.point=C._62O=C.p3=C.movedata=C.div=C._57I=C._32Q=C._31Q=C.foward=q}});var Ab=function(j){this.gv=j};re(Ab,P,{_iv:!0,iv:function(){this._iv=!0},face:function(m,V){var F=this,I=F.gv.getGL();if(!I||!Bj(m))return q;var E=V.x,p=V.width,f=V.height,w=F.height-V.y-f,C=l(p/2),d=new Uint8Array(4*p*f),Y=0;for(F.iv(),F.validate(m),Hc(I,F.frame),I.readPixels(E,w,p,f,I.RGBA,I.UNSIGNED_BYTE,d),Hc(I,q),F.iv();C>=Y;Y++)for(var y=C-Y,R=C+Y,g=y;R>=g;g++)for(var D=y;R>=D;D++)if(g===y||g===R||D===y||D===R){var H=_j.m[d[4*(g*p+D)]];if(H)return H}},get:function(k,v){this.validate();var m=this,y=m.gv.getGL();if(!y)return q;var Z,x,z=k.x,F=k.width,p=k.height,_=m.height-k.y-p,$=l(F/2),B=new Uint8Array(4*F*p),J=0,s=B.length,T=v?q:new up,w=v?q:{};if(Hc(y,m.frame),y.readPixels(z,_,F,p,y.RGBA,y.UNSIGNED_BYTE,B),Hc(y,q),v){for(;$>=J;J++)for(var b=$-J,Q=$+J,M=b;Q>=M;M++)for(var r=b;Q>=r;r++)if((M===b||M===Q||r===b||r===Q)&&(Z=m.info(B,4*(M*F+r))))return Z}else for(;s>J;J+=4)Z=m.info(B,J),Z&&(x=Z.data,w[x._id]||(T.add(x),w[x._id]=x));return T},info:function(g,o){return this.colorMap[(g[o]<<24)+(g[o+1]<<16)+(g[o+2]<<8)+g[o+3]]},validate:function(G){var j=this,O=j.gv,b=O.getGL();if(b){var z=O.getWidth(),S=O.getHeight(),K=b.RGBA,$=b.TEXTURE_2D,k=b.RENDERBUFFER,o=b.FRAMEBUFFER;j.texture||(j.texture=Lr(b),j.render=b.createRenderbuffer(),j.frame=b.createFramebuffer()),(j.width!==z||j.height!==S)&&(kn(b,j.texture),b.texImage2D($,0,K,z,S,0,K,b.UNSIGNED_BYTE,q),Io(b,b.TEXTURE_MIN_FILTER,b.LINEAR),b.bindRenderbuffer(k,j.render),b.renderbufferStorage(k,b.DEPTH_COMPONENT16,z,S),Hc(b,j.frame),b.framebufferTexture2D(o,b.COLOR_ATTACHMENT0,$,j.texture,0),b.framebufferRenderbuffer(o,b.DEPTH_ATTACHMENT,k,j.render),kn(b,q),b.bindRenderbuffer(k,q),Hc(b,q),j.width=z,j.height=S),j._iv&&(j._iv=!1,Hc(b,j.frame),O._42(G||(j.colorMap={}),1),Hc(b,q))}}});var xo=function(I){this.gv=I};re(xo,P,{gap:0,size:0,_42:function(I,S){var e=this,E=e.gv,w=E._gridGap,O=E._gridSize;if(E._gridVisible){if(e.gap!==w||e.size!==O){for(var Y=[],U=E._gridSize/2,r=w*U,V=0;2*U+1>V;V++){var b=6*V,i=6*(2*U+1)+b;Y[b]=-r,Y[b+1]=0,Y[b+2]=-r+V*w,Y[b+3]=r,Y[b+4]=0,Y[b+5]=-r+V*w,Y[i]=-r+V*w,Y[i+1]=0,Y[i+2]=-r,Y[i+3]=-r+V*w,Y[i+4]=0,Y[i+5]=r}e.vs=new bp(Y),e.gap=w,e.size=O}Yr(E),xh(I,S),Yk(I),mr(I,S,1,E._gridColor,E._buffer.vs,e.vs),ie(I,0,e.vs.length/3,I.LINES),Uj(I),um(I,S)}else e.vs=e.gap=e.size=q}});var Xm=function(Z){this.gv=Z};re(Xm,P,{_42:function(E,L){var D=this.gv,t=D._buffer.vs,c=D._axisXColor,x=D._axisYColor,y=D._axisZColor,p=D._originAxisVisible,G=D._centerAxisVisible;if(p||G){var u=h?E.TRIANGLES:E.TRIANGLE_FAN,e=E.LINES;if(Yr(D),xh(E,L),Yk(E),p){var C=D.getCenterInfo(),m=f(C.width,C.height)/5,P=.8*m,W=.05*m;mr(E,L,1.5,c,t,new bp([0,0,0,m,0,0,P,W,0,P,0,W,P,-W,0,P,0,-W,P,W,0,0,0,0,0,m,0,W,P,0,0,P,W,-W,P,0,0,P,-W,W,P,0,0,0,0,0,0,m,W,0,P,0,W,P,-W,0,P,0,-W,P,W,0,P])),ie(E,0,2,e),ie(E,1,6,u),mr(E,L,q,x),ie(E,7,2,e),ie(E,8,6,u),mr(E,L,q,y),ie(E,14,2,e),ie(E,15,6,u)}if(G){var B=D._center,_=B[0],r=B[1],Q=B[2],C=D.getPositionInfo(B);m=f(C.width,C.height)/20,mr(E,L,1.5,c,t,new bp([_,r,Q,_+m,r,Q,_,r,Q,_,r+m,Q,_,r,Q,_,r,Q+m])),ie(E,0,2,e),mr(E,L,q,x),ie(E,2,2,e),mr(E,L,q,y),ie(E,4,2,e)}Uj(E),um(E,L)}}});var ym=function(i){this.gv=i},el="edit_tx",Oo="edit_ty",wq="edit_tz",ko="edit_rx",Pb="edit_ry",nf="edit_rz",Tc="edit_sx",fi="edit_sy",md="edit_sz",Kr={};Kr[el]=1,Kr[Oo]=1,Kr[wq]=1,Kr[ko]=1,Kr[Pb]=1,Kr[nf]=1,Kr[Tc]=1,Kr[fi]=1,Kr[md]=1,re(ym,P,{_42:function(T,E,A){var u=this,S=u.gv,n=S.sm().ld();if(S.isEditable(n)&&Bj(n)&&(!S.isFirstPersonMode()||!S.isMouseRoamable()&&!e)){Yr(S);var J,U,Z=S.isMovable(n),z=S.isRotationEditable(n),l=S.isSizeEditable(n),M=S._axisXColor,G=S._axisYColor,P=S._axisZColor,i=S._editSizeColor,O=S.getCenterInfo(),K=f(O.width,O.height)/10,D=K/(A?5:10),w=.7*K,F=.4*w,b=n.p3(),k=b[0],X=b[1],q=b[2];J=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],Z&&u._17O(T,E,n,A,el,M,J,[k,X-D,q,k+w,X-D,q,k+w,X,q,k+w,X,q,k,X,q,k,X-D,q,k,X-D,q+D,k+w,X-D,q+D,k+w,X-D,q,k+w,X-D,q,k,X-D,q,k,X-D,q+D]),U=k+w,l&&u._17O(T,E,n,A,Tc,i,J,[U,X-D,q,U+F,X-D,q,U+F,X,q,U+F,X,q,U,X,q,U,X-D,q,U,X-D,q+D,U+F,X-D,q+D,U+F,X-D,q,U+F,X-D,q,U,X-D,q,U,X-D,q+D]),U+=F,z&&u._17O(T,E,n,A,ko,M,J,[U,X-D,q,U+F,X-D,q,U+F,X,q,U+F,X,q,U,X,q,U,X-D,q,U,X-D,q+D,U+F,X-D,q+D,U+F,X-D,q,U+F,X-D,q,U,X-D,q,U,X-D,q+D]),J=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],Z&&u._17O(T,E,n,A,Oo,G,J,[k,X,q,k,X+w,q,k-D,X+w,q,k-D,X+w,q,k-D,X,q,k,X,q,k,X,q,k,X,q-D,k,X+w,q-D,k,X+w,q-D,k,X+w,q,k,X,q]),U=X+w,l&&u._17O(T,E,n,A,fi,i,J,[k,U,q,k,U+F,q,k-D,U+F,q,k-D,U+F,q,k-D,U,q,k,U,q,k,U,q,k,U,q-D,k,U+F,q-D,k,U+F,q-D,k,U+F,q,k,U,q]),U+=F,z&&u._17O(T,E,n,A,Pb,G,J,[k,U,q,k,U+F,q,k-D,U+F,q,k-D,U+F,q,k-D,U,q,k,U,q,k,U,q,k,U,q-D,k,U+F,q-D,k,U+F,q-D,k,U+F,q,k,U,q]),J=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],Z&&u._17O(T,E,n,A,wq,P,J,[k,X,q,k,X,q+w,k,X-D,q+w,k,X-D,q+w,k,X-D,q,k,X,q,k,X-D,q,k-D,X-D,q,k-D,X-D,q+w,k-D,X-D,q+w,k,X-D,q+w,k,X-D,q]),U=q+w,l&&u._17O(T,E,n,A,md,i,J,[k,X,U,k,X,U+F,k,X-D,U+F,k,X-D,U+F,k,X-D,U,k,X,U,k,X-D,U,k-D,X-D,U,k-D,X-D,U+F,k-D,X-D,U+F,k,X-D,U+F,k,X-D,U]),U+=F,z&&u._17O(T,E,n,A,nf,P,J,[k,X,U,k,X,U+F,k,X-D,U+F,k,X-D,U+F,k,X-D,U,k,X,U,k,X-D,U,k-D,X-D,U,k-D,X-D,U+F,k-D,X-D,U+F,k,X-D,U+F,k,X-D,U])}},_17O:function(J,M,k,K,r,S,t,d){var y=this.gv._buffer;wd(J,M,K,!0,k,r),Al(J,M,q,!0,q,!0,q,!1),Cd(J,M.uDiffuse,S),Hl(J,y.vs,new bp(d),M.aPosition),Hl(J,y.ns,new bp(t),M.aNormal),Yk(J),ie(J,0,12),Uj(J),Fk(J,M)}});var ob=function(o,F){this.gv=o,this.s=function(S,Z,T){return Z==q&&(Z=T),Z==q?F.getStyle(S):mj(Z,F,o)},this.data=F};re(ob,P,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(r,x,X,O){var P=this,C=P.data;if(!(C instanceof ye)){var N,w,n,o,U,_,B,b=P.gv,z=C._id,E=P.s("batch"),u=b._34O,K=b._33O,T=b.isSelectable(C),D=b.getBrightness(C),s=D!=q&&1!==D;if(P._iv){if(n=ph(u,K,C,E),P.validate(n,E?sk[E]||Hg:q),n&&(o=u[z],U=o.size=n.vs.length/3-o.begin,B=n.rs))for(D=s?D:1,_=0;U>_;_++)B.push(D);if(Bj(C)){var $=b.getWireframe(C);$&&rb(b,C,$)}P.labelInfo=P.label2Info=P.noteInfo=P.note2Info=P._38o=q,P._24O(or,"getLabel"),P._24O(Rg,"getLabel2"),P._26O(js,"getNote"),P._26O(pl,"getNote2"),P._15O(),P._iv=!1}s&&Cd(r,x.uBrightness,D),w=wd(r,x,X,T,C,gm),w&&(Nr(w,u[z],K),Nr(w,b._polylineIndexMap[z],b._polylineModelMap),Nr(w,b._wireframeIndexMap[z],b._wireframeModelMap)),u[z]||P._80o(r,x,O),b.isLabelVisible(C)&&((N=P.labelInfo)&&(wd(r,x,X,T,C,or),P._28O(N,or,O)),(N=P.label2Info)&&(wd(r,x,X,T,C,Rg),P._28O(N,Rg,O))),b.isNoteVisible(C)&&((N=P.noteInfo)&&(wd(r,x,X,T,C,js),P._29O(N,js,O)),(N=P.note2Info)&&(wd(r,x,X,T,C,pl),P._29O(N,pl,O))),(N=P._38o)&&P._99O(r,x,N,X,T,O),s&&Cd(r,x.uBrightness,1)}},validate:function(){},_16O:function(){return Lc},_80o:function(){},dispose:function(){},getBodyColor:function(t){var U=this.data,H=this.gv.getBodyColor(U);return H?H:t?U.getStyle(t):q},_24O:function(j,w){var x=this,V=x.data,e=x.gv,z=x.s,_=e[w](V);if(_!=q){var d=z(j+".scale"),C=z(j+".max"),m=x[j+"Info"]={label:_,textureScale:z(j+".texture.scale"),color:e[w+"Color"](V),font:z(j+".font"),align:z(j+".align"),background:e[w+"Background"](V)},c=m.rect=$o(m,_);C>0&&C<c.width&&(m.labelWidth=c.width,c.width=C),c.x=c.y=0,c.width*=d,c.height*=d,m.mat=x._16O(z(j+".autorotate"),z(j+".position"),c,z(j+".face"),z(j+".t3"),z(j+".r3"),z(j+".rotationMode"));var I=c.width/2,U=c.height/2;m.vs=new bp([-I,U,0,-I,-U,0,I,-U,0,I,U,0]),c.width/=d,c.height/=d}},_26O:function(s,l){var h=this,a=h.data,X=h.gv,j=h.s,J=X[l](a);if(J!=q){var i=j(s+".scale"),y=this[s+"Info"]={note:J,textureScale:j(s+".texture.scale"),expanded:j(s+".expanded"),font:j(s+".font"),color:j(s+".color"),align:j(s+".align"),borderWidth:j(s+".border.width"),borderColor:j(s+".border.color"),background:X[l+"Background"](a)};if(y.expanded){var w=j(s+".max"),R=$o(y,J);R.width+=6,R.height+=2,w>0&&w<R.width&&(y.labelWidth=R.width,R.width=w);var Y={x:-R.width/2,y:-8-R.height,width:R.width,height:R.height+8}}else Y={x:-6,y:-18,width:12,height:18};y.mat=h._16O(j(s+".autorotate"),j(s+".position"),q,j(s+".face"),j(s+".t3"),j(s+".r3"),j(s+".rotationMode")),y.rect=Y,1!==i&&(Y=ji(Y),Y.x*=i,Y.height*=i,Y.y=-Y.height,Y.width*=i);var z=Y.x,v=Y.y,b=Y.width,k=Y.height;y.vs=new bp([z,-v,0,z,-v-k,0,z+b,-v-k,0,z+b,-v,0])}},_28O:function(E,w,V){if(V(this.s(w+".transparent"))){var p=E.rect,L=E.textureScale,A=p.width*L,g=p.height*L;if(A>=1&&g>=1){var B=nd(A,g);1!==L&&(B.translate(B,p.x,p.y),B.scale(L,L),B.translate(B,-p.x,-p.y)),zk(B,E),B.restore(),je(this,w,E.mat,E.vs,!0)}}},_29O:function(C,q,X){if(X(this.s(q+".transparent"))){var f=C.rect,p=C.textureScale,r=f.x,y=f.y,d=f.width*p,z=f.height*p;if(d>=1&&z>=1){f.x=f.y=0;var R=nd(d,z);1!==p&&R.scale(p,p),_o(R,C),R.restore(),f.x=r,f.y=y,je(this,q,C.mat,C.vs,!1)}}},_99O:function(U,m,t,s,f,g){if(t){var $=this,e=$.gv,u=$.data,n=e._buffer,x=e._1O,V=t.icons;for(var N in V){var B=V[N],J=t.rects[N];if(J&&g(mj(B.transparent,u,e))){wd(U,m,s,f,u,N);var F=mj(B.shape3d,u,e),_=F?[F]:mj(B.names,u,e),G=_?_.length:0,p=mj(B.textureScale,u,e)||1,w=mj(B.light,u,e);w==q&&(w=F?!0:!1),Al(U,m,mj(B.blend,u,e),w,mj(B.opacity,u,e),mj(B.reverseFlip,u,e),mj(B.reverseColor,u,e),mj(B.reverseCull,u,e));for(var E=0;G>E;E++){var y=_[E],l=J[E];if(Tk($,l.mat),F)Rh(e,u,ni($,F),$);else{var k=fo(y);if(k){var z=l.width*p,o=l.height*p;if(z>=1&&o>=1){var M=nd(z,o);Sk(M,k,mj(B.stretch,u,e),0,0,z,o,u,e),M.restore(),Lr(U,Xc,x),Yk(U,m,x,mj(B.discardSelectable,u,e),n.uv,ah),Hl(U,n.vs,l.vs,m.aPosition),Hl(U,n.ns,zi,m.aNormal),Bg(U,n.is,Op),$b(U,0,Op.length),Uj(U,m,x)}}}Sm(e)}Fk(U,m)}}}}});var cd=function(B,j){Pj(cd,this,[B,j])};re(cd,ob,{_16O:function(l,U,Z,p,N,M,m,W,v){var Q=this.data,E=ws(U,Q.s3(),Z,p,W,v);return Fg(ns(),E,Q.p3(),p,N,M,m,l,Q.r3(),Q.getRotationMode())},clear:function(){var E=this;E.faceMat=E.mat=E.shapeModel=E.left=E.right=E.front=E.back=E.top=E.bottom=E.csg=q},validate:function(t,P){var Q=this,g=Q.gv,T=Q.data,a=ni(Q),x=Kk(T,g.getMat(T),a?Q.s("shape3d.scaleable"):!0);if(Q.clear(),t){var j=[];a?Ki(g,T,a,Q,Q.getBodyColor(),[x],t,j):(Bh(g,T,t,P,x,Ff,j,ib),Bh(g,T,t,P,x,Gr,j,ej),Bh(g,T,t,P,x,nr,j,Vd),Bh(g,T,t,P,x,Xg,j,Bo),Bh(g,T,t,P,x,Fn,j,qe),Bh(g,T,t,P,x,xn,j,An)),j.length&&(Ck(t.vs,j),Ck(t.ns,$p(j)))}else Q.mat=x,(Q.shapeModel=a)||(Q.vf(Ff),Q.vf(Gr),Q.vf(Fn),Q.vf(xn),Q.vf(nr),Q.vf(Xg))},vf:function(L){var K=this;if(K.gv.getFaceVisible(K.data,L)){var z=zl(K,L);return z.mat&&(K.faceMat=!0),z}},_80o:function(A,T,l){var x=this,P=x.gv,p=x.data,E=P._cube,B=x.shapeModel;Yr(P,x.mat),B?Rh(P,p,B,x,x.getBodyColor(),l):(Hl(A,E.vs,q,T.aPosition),Hl(A,E.ns,q,T.aNormal),Bg(A,E.is),x._18O(A,T,x.left,0,l),x._18O(A,T,x.front,6,l),x._18O(A,T,x.right,12,l),x._18O(A,T,x.back,18,l),x._18O(A,T,x.top,24,l),x._18O(A,T,x.bottom,30,l)),Sm(P),x.faceMat&&(x._18O(A,T,x.left,0,l,!0),x._18O(A,T,x.front,6,l,!0),x._18O(A,T,x.right,12,l,!0),x._18O(A,T,x.back,18,l,!0),x._18O(A,T,x.top,24,l,!0),x._18O(A,T,x.bottom,30,l,!0))},_18O:function(Q,Z,E,J,x,M){if(E){if(!x(E.transparent))return;if(M&&!E.mat||!M&&E.mat)return;M&&Yr(this.gv,E.mat);var N=this,n=N.data,X=N.gv,F=X.getTexture(E.texture,n),z=E.uv,b=E.uvScale,o=E.uvOffset,B=E.discardSelectable;if(F)if(z){for(var K=8*(J/6),h=0;8>h;h++)Nm[K+h]=z[h];Yk(Q,Z,F,B,X._buffer.uv,Nm,o,b)}else Yk(Q,Z,F,B,X._cube.uv,q,o,b);else Yk(Q);Al(Q,Z,E.blend,E.light,E.opacity,E.reverseFlip,E.reverseColor,E.reverseCull),Cd(Q,Z.uDiffuse,E.color),$b(Q,J,6),Fk(Q,Z),Uj(Q,Z,F),M&&Sm(X)}}});var Iq=function(f,R){Pj(Iq,this,[f,R])};re(Iq,ob,{_25Q:1,validate:function(l){var $=this,t=$.gv,L=$.data,F=$.s,B=F("edge.width"),e=L._40I,S=L._41I;if($.shapeModel=$.info=q,e&&S){var v,u,D,b,J,M,P,A,m,K,Z=L.isLooped(),r=F(Li),j=E.getEdgeType(r);if(j){var C=j(L,Hr($,t,L,Z,r),t,$._19Q);if(!C.points||C.points.isEmpty())return;M=$.info={},P=C.segments,J=C.points,A=J.size();for(var d=e.getElevation(),z=S.getElevation(),n=0;A>n;n++){var O=J.get(n);O.e==q&&(O.e=d+(z-d)*n/(A-1))}m=vl(J.get(0)),K=vl(J.get(A-1));var Q=A%2;0===Q?(M.c1=vl(J.get(A/2-1)),M.c2=vl(J.get(A/2))):M.p3=vl(J.get((A-Q)/2)),M.s1=m,M.s2=vl(J.get(1)),M.t1=vl(J.get(A-2)),M.t2=K}else{J=new up,M=$.info={};var V=F("edge.offset"),k=F("edge.center"),T=F("edge.source.t3"),h=F("edge.target.t3"),a=e.p3(),N=S.p3();if(T&&(a[0]+=T[0],a[1]+=T[1],a[2]+=T[2]),h&&(N[0]+=h[0],N[1]+=h[1],N[2]+=h[2]),r===Ko){P=F("edge.segments");var s=M.points=F(Sr)||zh;if(A=s.size()){m=vl(s.get(0)),K=vl(s.get(A-1)),!k&&V&&(D=np(m,a,!0),V=f(V,Ip(a,m)),a=[a[0]+D[0]*V,a[1]+D[1]*V,a[2]+D[2]*V],D=np(N,K,!0),V=f(V,Ip(K,N)),N=[N[0]-D[0]*V,N[1]-D[1]*V,N[2]-D[2]*V]);var Q=A%2;0===Q?(v=vl(s.get(A/2-1)),u=vl(s.get(A/2))):M.p3=vl(s.get((A-Q)/2)),M.s1=a,M.s2=m,M.t1=K,M.t2=N}else!k&&V&&(D=np(N,a,!0),b=Ip(a,N),V=am(V,b),a=[a[0]+D[0]*V,a[1]+D[1]*V,a[2]+D[2]*V],N=[N[0]-D[0]*V,N[1]-D[1]*V,N[2]-D[2]*V]),v=a,u=N;J.add({x:a[0],y:a[2],e:a[1]}),J.addAll(s),J.add({x:N[0],y:N[2],e:N[1]})}else{var o=Hr($,t,L,Z,r);if($._19Q||(o=-o),Z){var X=a[0],I=a[1],Y=a[2],H=e.getTall()/2+o;v=[X-o,I+H,Y],u=[X+o,I+H,Y],J.add({x:X-o,y:Y,e:I}),J.add({x:X-o,y:Y,e:I+H}),J.add({x:X+o,y:Y,e:I+H}),J.add({x:X+o,y:Y,e:I})}else{D=np(N,a,!0),b=Ip(a,N);var i={x:a[0],y:a[2]},g={x:N[0],y:N[2]},c=Jj(q,i,g,o),U=c.x-i.x,W=c.y-i.y;V=am(V,b),D[0]*=V,D[1]*=V,D[2]*=V,v=[a[0]+D[0]+U,a[1]+D[1],a[2]+D[2]+W],u=[N[0]-D[0]+U,N[1]-D[1],N[2]-D[2]+W],k?(J.add({x:a[0],y:a[2],e:a[1]}),J.add({x:v[0],y:v[2],e:v[1]}),J.add({x:u[0],y:u[2],e:u[1]}),J.add({x:N[0],y:N[2],e:N[1]})):(J.add({x:v[0],y:v[2],e:v[1]}),J.add({x:u[0],y:u[2],e:u[1]}))}}M.c1=v,M.c2=u}M.list=F(tm)===_n?$.createTubeModel(J,P,B/2,l):$.createLineModel(J,P,B,"edge","edge.dash")}}});var qd=function(Z,y){Pj(qd,this,[Z,y])};re(qd,cd,{_80o:function(w,i,r){var c=this,q=c.gv,T=c.shapeModel;Yr(q,c.mat),T?Rh(q,c.data,T,c,c.getBodyColor(),r):(Lk(c,w,i,c.left,r),Lk(c,w,i,c.front,r),Lk(c,w,i,c.right,r),Lk(c,w,i,c.back,r),Lk(c,w,i,c.top,r),Lk(c,w,i,c.bottom,r)),Sm(q)},validate:function(Z,v){var O,P,S=this,w=S.s,b=S.data,e=b.p3(),H=b._thickness/2,s=b.isClosePath(),F=b.getPoints(),l=b.getSegments(),J=w(Ci),i=Z&&Z.uv;if(S.clear(),0>H)P=S.shapeModel=Ni(F,l,w(sl),w(jj),J,w(Se),b.getTall(),b.getElevation(),s),w(ff)?w("shape3d.image")||delete P.uv:(delete P.vs,delete P.ns,delete P.uv),w("shape3d.top.image")||delete P.top_uv,w("shape3d.bottom.image")||delete P.bottom_uv;else if(w(tm)===_n)O=Dj(F,l,J,s),P=S.shapeModel={vs:[]},w("shape3d.image")&&(P.uv=[],P.sum=w(Se)||fs(O)||1,P.len=0),w(sl)&&!s&&(P.top_vs=[],w("shape3d.top.image")&&(P.top_uv=[])),w(jj)&&!s&&(P.bottom_vs=[],w("shape3d.bottom.image")&&(P.bottom_uv=[])),S._12O(O,H);else{var $,M,K,h,u,j,I,W,E,R;O=Dj(F,l,J,s),u=S.vf(Fn,i,!1,v),H&&(j=S.vf(xn,i,!1,v),I=s?q:S.vf(Ff,i,!1,v),W=s?q:S.vf(Gr,i,!1,v),E=S.vf(nr,i,!1,v),R=S.vf(Xg,i,!1,v)),H?S._12O(O,H):u&&O.forEach(function(W){if(h=W.length,h>0)for($=W[0],K=1;h>K;K++)M=W[K],S.addV(u.vs,$,M),$=M}),S._20Q(O),Z||(u&&(u.ns=$p(u.vs),Ee(u,"vs"),Ee(u,Be)),H&&(j&&(j.ns=$p(j.vs),Ee(j,"vs"),Ee(j,Be)),I&&(I.ns=$p(I.vs),Ee(I,"vs"),Ee(I,Be)),W&&(W.ns=$p(W.vs),Ee(W,"vs"),Ee(W,Be)),E&&(E.ns=$p(E.vs),Ee(E,"vs"),Ee(E,Be)),R&&(R.ns=$p(R.vs),Ee(R,"vs"),Ee(R,Be))))}var C=S.mat=ns();Cg(C,e),sp(C,b.r3(),b.getRotationMode()),Cg(C,Wo(e)),Z&&(hb(S,C,Z,P),S.clear())},_20Q:function(I){var r,o,U,i,z,x,v,w=this,S=w.front,e=w.back,y=w.top,V=w.bottom,K=S?S.tuv:q,c=e?e.tuv:q,g=y?y.tuv:q,$=V?V.tuv:q,l=0;(K||c||g||$)&&(r=w.s(Se)||fs(I)||1,I.forEach(function(c){if(o=c.length,o>0)for(x=c[0],U=1;o>U;U++)v=c[U],i=l/r,l+=Ip(x,v),z=l/r,w._14O(S,i,z),w._14O(e,1-z,1-i),w._14O(y,i,z),w._14O(V,i,z),x=v}))},_14O:function(B,G,z){if(B){var y=B.uv,V=B.tuv;if(V){if(y)var i=y[0]+(y[6]-y[0])*G,X=y[1]+(y[7]-y[1])*G,H=y[2]+(y[4]-y[2])*G,W=y[3]+(y[5]-y[3])*G,Q=y[2]+(y[4]-y[2])*z,t=y[3]+(y[5]-y[3])*z,v=y[0]+(y[6]-y[0])*z,F=y[1]+(y[7]-y[1])*z;else i=G,X=0,H=G,W=1,Q=z,t=1,v=z,F=0;V.push(H,W,Q,t,v,F,v,F,i,X,H,W)}}},_13O:function(n){var O=n.uv,C=n.tuv;C&&(O?C.push(O[2],O[3],O[4],O[5],O[6],O[7],O[6],O[7],O[0],O[1],O[2],O[3]):C.push(0,1,1,1,1,0,1,0,0,0,0,1))},_12O:function(F,d){var y,P,A,T,I,f=this;F.forEach(function(n){if(I=n.length,I>0)for(y={p:n[0],n:!0},T=1;I>T;T++)P=n[T],A=I-1>T?n[T+1]:q,f.addPoint(y,P,A,d,n)})},addPoint:function(u,l,T,F,f){var s,S,O,z,Q,Y,h,b,i,I=this,X=u.p,x=u.f,r=u.b,B=I.s("shape3d.side")||Xb,m=I.s("shape3d.start.angle"),W=I.s("shape3d.sweep.angle"),C=I.shapeModel,w=I.data.isClosePath();if(u.n&&(u.n=!1,x=w&&f.length>2?Jj(f[f.length-2],X,l,F):Jj(q,X,l,F),r=Ak(X,x),C?C.top_vs&&I._10O(r,x,B,m,W,C.top_vs,C.top_uv):(s=I.left)&&(I.addV(s.vs,r,x),I._13O(s))),S=T?Jj(X,l,T,F):w&&f.length>2?Jj(X,l,f[1],F):Jj(X,l,q,F),O=Ak(l,S),C){var v,J,H=C.vs,k=C.uv,P=C.sum;for(k&&(v=C.len/P,C.len+=Ip(X,l),J=C.len/P),Y=I._9O(r,x,B,m,W),h=I._9O(O,S,B,m,W),b=0;B>b;b++)i=b+1,Ck(H,Y[i]),Ck(H,h[b]),Ck(H,Y[b]),Ck(H,h[b]),Ck(H,Y[i]),Ck(H,h[i]),k&&(z=b/B,Q=i/B,k.push(v,Q,J,z,v,z,J,z,v,Q,J,Q));!T&&C.bottom_vs&&I._10O(O,S,B,m,W,C.bottom_vs,C.bottom_uv,!0)}else!T&&(s=I.right)&&(I.addV(s.vs,S,O),I._13O(s)),(s=I.front)&&I.addV(s.vs,x,S),(s=I.back)&&I.addV(s.vs,O,r),(s=I.top)&&I.addH(s.vs,x,S,O,r,!0),(s=I.bottom)&&I.addH(s.vs,r,O,S,x);u.p=l,u.f=S,u.b=O},_10O:function(I,C,X,Y,i,w,P,V){var D,L,J=this,s=J.data,S=J._9O(I,C,X,Y,i),z=(I.x+C.x)/2,l=(I.y+C.y)/2,b=s.getElevation(),O=0;for(O=0;X>O;O++)V?(Ck(w,S[O]),Ck(w,S[O+1])):(Ck(w,S[O+1]),Ck(w,S[O])),Ck(w,[z,b,l]),P&&(V?(D=G*(O+1)/X+Y,L=G*O/X+Y):(D=G*O/X+Y,L=G*(O+1)/X+Y),P.push(.5-.5*g(L),.5-.5*x(L),.5-.5*g(D),.5-.5*x(D),.5,.5))},_9O:function(j,p,R,f,q){var t,U,S=this,I=S.data,T=[],v=(j.x+p.x)/2,V=(j.y+p.y)/2,k=I.getTall()/2,m=I.getElevation(),W=0;for(q=q||G;R>=W;W++)t=q*W/R+f,U=g(t),T.push([v+(j.x-v)*U,m+k*x(t),V+(j.y-V)*U]);return T},addV:function(t,h,k){var s=h.x,i=h.y,r=k.x,p=k.y,X=this.data,U=X.getElevation(),f=X.getTall()/2;t.push(s,U-f,i,r,U-f,p,r,U+f,p,r,U+f,p,s,U+f,i,s,U-f,i)},addH:function(K,C,t,$,l,G){var n=this.data,J=n.getTall()/2,q=n.getElevation()+(G?J:-J);K.push(C.x,q,C.y,t.x,q,t.y,$.x,q,$.y,$.x,q,$.y,l.x,q,l.y,C.x,q,C.y)},vf:function(I,c,r,L){var l,n=this,W=n.gv.getFaceVisible(n.data,I);return(r||W)&&(l=zl(n,I,L),l.vs=[],l.tuv=W&&(l.texture||c)?[]:q,l.visible=W),l}});var lq=function(W,V){Pj(lq,this,[W,V])};re(lq,ob,{_25Q:1,validate:function(R){var Y=this,_=Y.data,H=Y.s,C=_.getPoints(),i=C.size();if(Y.shapeModel=Y.info=q,i>1){var E=Y.info={},z=_.getSegments(),X=_.getThickness(),B=vl(C.get(0)),e=vl(C.get(i-1)),J=i%2;0===J?(E.c1=vl(C.get(i/2-1)),E.c2=vl(C.get(i/2))):E.p3=vl(C.get((i-J)/2)),E.s1=B,E.s2=vl(C.get(1)),E.t1=vl(C.get(i-2)),E.t2=e,E.list=H(tm)===_n?Y.createTubeModel(C,z,X/2,R):Y.createLineModel(C,z,X,"shape.border","shape.dash")}}}),Ij(E,{accordionViewExpandIcon:xc(yg),accordionViewCollapseIcon:xc(yg,!0),accordionViewLabelColor:Oh,accordionViewLabelFont:fe,accordionViewTitleBackground:wg,accordionViewSelectBackground:yc,accordionViewSelectWidth:3,accordionViewSeparatorColor:Q,splitViewDividerSize:1,splitViewDividerBackground:wg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:on,rect:[2,2,12,12],background:yg}]},propertyViewLabelColor:ne,propertyViewLabelSelectColor:Oh,propertyViewLabelFont:fe,propertyViewExpandIcon:xc(to),propertyViewCollapseIcon:xc(to,!0),propertyViewBackground:gl,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:oi,propertyViewColumnLineColor:oi,propertyViewSelectBackground:yc,listViewLabelColor:ne,listViewLabelSelectColor:Oh,listViewLabelFont:fe,listViewRowLineVisible:!1,listViewRowLineColor:oi,listViewSelectBackground:yc,treeViewLabelColor:ne,treeViewLabelSelectColor:Oh,treeViewLabelFont:fe,treeViewExpandIcon:xc($k),treeViewCollapseIcon:xc($k,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:oi,treeViewSelectBackground:yc,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ne,tableViewLabelSelectColor:Oh,tableViewLabelFont:fe,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:oi,tableViewColumnLineColor:oi,tableViewSelectBackground:yc,treeTableViewLabelColor:ne,treeTableViewLabelSelectColor:Oh,treeTableViewLabelFont:fe,treeTableViewExpandIcon:xc($k),treeTableViewCollapseIcon:xc($k,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:oi,treeTableViewColumnLineColor:oi,treeTableViewSelectBackground:yc,tableHeaderLabelColor:ne,tableHeaderLabelFont:fe,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Zn,tableHeaderBackground:gl,tableHeaderMoveBackground:eh,tableHeaderInsertColor:yc,tableHeaderSortDescIcon:ic(to,!0),tableHeaderSortAscIcon:ic(to),tabViewTabGap:1,tabViewLabelColor:Oh,tabViewLabelFont:fe,tabViewTabBackground:wg,tabViewSelectWidth:3,tabViewSelectBackground:yc,tabViewMoveBackground:eh,tabViewInsertColor:yc,toolbarLabelColor:ne,toolbarLabelSelectColor:Oh,toolbarLabelFont:fe,toolbarBackground:gl,toolbarSelectBackground:yc,toolbarItemGap:8,toolbarSeparatorColor:Ej},!0);var Kh={translateX:1,sortColumn:1},Qp={sortable:1,sortOrder:1,sortFunc:1},Ro={focusData:1},$n={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},uo={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},al=function(P,f){f.add(P),P.hasChildren()&&P.eachChild(function(o){al(o,f)})},hc=function(M,x,H,b,T,Q,c,R,C,l,O){var F,N=H.getValueType(l),w=H.getAlign(l);if(H.getEnumValues(l)){var I=H.toEnumLabel(x,l),D=kd||0,s=0,z=Q,U=E.getTextSize(b,I).width;return F=fo(H.toEnumIcon(x,l)),F&&(s=Q+kd/2,"center"===w?s+=(R-(D+U))/2:"right"===w&&(s=s+R-(D+U)),We(M,F,s,c+C/2),z=s+kd/2),I!=q&&(F?Wp(M,I,b,T,z,c,R-(z-Q),C):Wp(M,I,b,T,Q,c,R,C,w)),void 0}return x=H.formatValue(x),x!=q?N===fc?(Kc(M,Q,c,R,C,x),void 0):N===Zp||!N&&$r(x)?(F=fo(x?jc:Ve),We(M,F,Q+R/2,c+C/2,l,O),void 0):(Wp(M,x,b,T,Q,c,R,C,w),void 0):void 0},tk=function(O,Q){var h=Q.view,J=h.getDataModel().getHistoryManager(),K=cs(O),c=Q.column||Q.property;J&&J.beginInteraction(),Q.editor=O,O.info=Q,h.setCurrentEditor(O),h.getView().insertBefore(K,h._79O),Mj(O,Q.editorRect),O.setFocus?O.setFocus():oj(O),O.commitValue=function(){O._17Q&&(O=O._17Q),h.setValue(Q.data,c,O.getValue?O.getValue():O.value),O.close&&O.close(),Ad(K)},c.onEditorCreated&&c.onEditorCreated(Q)},_m=function(J,M,G,X,R){var F=vb(J,G),C=M.value,P=M.view,u=R.getValueType(M.data);return F.onblur=F.onchange=function(){P.endEditing()},"input"===J?(C=R.formatValue(C),C!=q&&(F.value=C),F.onkeydown=function(l){mh(l)&&P.endEditing()},(u===Vr||u===Vq)&&F.addEventListener(Cn,E.numberListener,!1)):J===Pi&&X.forEach(function(g){var S=a.createElement("option");S.innerHTML=R.toEnumLabel(g),S.value=g,R.isEnumEqual(C,g)&&(S.selected=!0),gd(F,S)}),tk(F,M),F},Tp=i.widget={},Uf=function(I,X,R){re(v+".widget."+I,X,R)};Ij(Ie,{ms_value:function(q){q.getValue=function(s){var j=this.getItemById(s),z=j.element;return Gg(z)?z:z?z.getValue?z.getValue():z.value:j.selected},q.setValue=function(C,K){var f=this.getItemById(C),z=f.element;z&&!Gg(z)?z.setValue?z.setValue(K):z.value=K:$r(K)?(f.selected=K,this.iv()):(f.element=K,this.iv())},q.v=function(h,u){var f=this;if(2===arguments.length)f.setValue(h,u);else{if(!qc(h))return f.getValue(h);for(var O in h)f.setValue(O,h[O])}return f}},_46o:function(F){F._icon=q,F._accessType=q,F._valueType=q,F._editable=!1,F._batchEditable=!0,F._align=Ff,F._nullable=!0,F._emptiable=!1,F.setParent=Yb,F.formatValue=function(f){var o=this,G=o._valueType;return o.getEnumValues()?o.toEnumLabel(f):G===Zp?!!f:f!=q&&G===Vr?H(f):f},F.setEnum=function(h,S,s,F,t,V,z){var l=this;h&&!Rn(h)&&h.values&&(F=h.editable,s=h.icons,S=h.labels,t=h.strict,V=h.maxHeight,z=h.dropDownWidth,h=h.values),rk(h)&&(h=h._as),rk(S)&&(S=S._as),rk(s)&&(s=s._as),l._enumValues=h,l._enumLabels=S,l._enumIcons=s,l._enumEditable=F,l._enumStrict=t==q?!0:t,l._enumMaxHeight=V,l._enumDropDownWidth=z,h&&h.length&&wm(h[0])&&(l._valueType=Vq),l.fp("enum",!1,!0)},F.getEnumDropDownWidth=function(){return this._enumDropDownWidth},F.getEnumMaxHeight=function(){return this._enumMaxHeight},F.isEnumEditable=function(){return this._enumEditable},F.getEnumValues=function(){return this._enumValues},F.getEnumLabels=function(){return this._enumLabels},F.getEnumIcons=function(){return this._enumIcons},F.isEnumStrict=function(){return this._enumStrict},F.isEnumEqual=function($,b){return this._enumStrict?$===b:$==b},F.toEnumLabel=function(N,s){var G=this,k=G.getEnumValues(s),X=G.getEnumLabels(s);if(k&&X)for(var t=0;t<k.length;t++)if(G.isEnumEqual(N,k[t]))return X[t];return N},F.toEnumIcon=function(R,Z){var f=this,h=f.getEnumValues(Z),H=f.getEnumIcons(Z);if(h&&H)for(var C=0;C<h.length;C++)if(f.isEnumEqual(R,h[C]))return H[C];return Q}},_45o:function(J){J._87o=function(h,v,l,N,J,F){if(h){var p=this,C=p._90I,k=ao(1);p._columnLineVisible&&(J-=1),p._rowLineVisible&&(F-=1),0>=J||0>=F||(p._90I||(C=p._90I={}),C[v]||(C[v]=new up),Mj(k,p.tx()+l,p.ty()+N,J,F),gd(k,h),p._view.insertBefore(k,p._79O),h.onParentAdded&&h.onParentAdded(k),C[v].add(k))}},J._76o=function(){var O=this,A=O._90I;if(A){for(var R in A)A[R].each(function(R){Ad(R)});delete O._90I}},J._77o=function($){var w=this;if(w._90I){var Y=w._90I[$];Y&&(Y.each(function(K){Ad(K)}),delete w._90I[$])}}},_47o:function(j){j.getValue=function(Z,B){return B.getValue?B.getValue(Z,B,this):tg(Z,B.getAccessType(),B.getName())},j.setValue=function(o,v,k){if(v.isEmptiable(o)||""!==k||(k=Q),v.isNullable(o)||k!=q){var P=this,L=v.getName(o),U=v.getAccessType(o),D=v.getValueType(o);D===Vr&&Gg(k)?k=m(k):D===Vq&&Gg(k)?k=parseFloat(k):D===Zp&&Gg(k)&&(k="true"===k),P._batchEditable&&v._batchEditable&&P.isSelected(o)?P.sm().each(function(l){v.setValue?v.setValue(l,v,k,P):Jf(l,U,L,k)}):v.setValue?v.setValue(o,v,k,P):Jf(o,U,L,k)}},j.setCurrentEditor=function(N){this.endEditing(),this._currentEditor=N,this.redraw()},j.isEditing=function(X,W){var z=this,E=z._currentEditor;if(!E)return!1;if(W){var g=E.info;return g?(g.column||g.property)===W&&g.data===X:!1}return!0},j.endEditing=function(){var m=this,s=m._currentEditor,Q=m.getDataModel().getHistoryManager();s&&(delete m._currentEditor,s.commitValue&&s.commitValue(s.info),m.redraw(),Q&&Q.endInteraction())},j.beginEditing=function(b){this.endEditing();var Y=this,T=b.column||b.property;if(T.beginEditing)T.beginEditing(b);else{var W=b.data,p=b.value,o=Y.getSelectBackground(W),P=T.getEnumValues(W),t=T.getSlider(W),x=T.getColorPicker(W);if(t){var e=Kp(Tp.Slider,t);return e.setValue(p),e.getView().onblur=function(){Y.endEditing()},e.isInstant()&&(e.onValueChanged=function(){Y.setValue(W,T,e.getValue())}),tk(e,b),void 0}if(x||T.getValueType(W)===fc){var j=Kp(Tp.ColorPicker,x);return j.setValue(p),j.onClosed=function(){Y.endEditing()},j.isInstant()&&(j.onValueChanged=function(c,v){Y.setValue(W,T,v)}),tk(j,b),j.open(),void 0}if(P){if(Tp.ComboBox){var s=new Tp.ComboBox;s.setValue(p),s.setValues(P),s.setLabels(T.getEnumLabels(W)),s.setIcons(T.getEnumIcons(W)),s.setEditable(T.isEnumEditable(W)),s.setStrict(T.isEnumStrict(W)),s.setMaxHeight(T.getEnumMaxHeight(W)),s.setDropDownWidth(T.getEnumDropDownWidth(W)),s.onClosed=function(){Y.endEditing()},tk(s,b),s.open()}else _m(Pi,b,o,P,T);return}var d=T.getValueType(W);if(d===Zp||$r(p))return Y.setValue(W,T,!p),void 0;if(T.getItemEditor(W)){var N=Gq(T.getItemEditor(W)),K=new N(W,T,Y,b),X=K.getView();return X._17Q=K,K.setValue(p),Ne(X),tk(X,b),K.editBeginning&&K.editBeginning(),void 0}_m("input",b,o,q,T)}}},_44o:function(K){K.init=function(w){var v=this,O=v.th=new zm(w),B=v._view=wk(1,v);v.tv=v._tableView=w,gd(B,O.getView()),gd(B,w.getView()),O.mp(function(q){q.property===ri&&v.iv()}),v.iv()},K.getTableView=function(){return this.tv},K.getTableHeader=function(){return this.th},K.getDataModel=function(){return this.tv.dm()},K.getColumnModel=function(){return this.tv.getColumnModel()},K.setColumns=function(B){this.tv.setColumns(B)},K.addColumns=function(M){this.tv.addColumns(M)},K.endEditing=function(){this.tv.endEditing()},K.validateImpl=function(){var Z=this,u=Z.th,o=dp(u),C={x:0,y:0,width:Z.getWidth(),height:o};Mj(u,C),C.y=o,C.height=M(0,Z.getHeight()-o),Mj(Z.tv,C)}},ms_vs:function(F){F._41o=function(){return this._29I.height<this._59I},F._43o=function(){var F=this;F._41o()&&(F._58I||(u(function(){F._94O()},Yf),F.iv()),F._58I=new Date)},F._94O=function(){var r=this;if(r._58I){var N=new Date;N.getTime()-r._58I.getTime()>=Yf?(delete r._58I,r.iv()):u(function(){r._94O()},Yf)}},F._93I=function(){var D=this,c=D._27I;if(D._58I||!D._autoHideScrollBar){c||gd(D._79O,c=D._27I=ao());var Q=D._29I,g=Q.height,I=D._59I,m=D.getScrollBarSize(),X=Q.width-m-2,u=g*(-D.ty()/I),o=g*(g/I),a=c.style;I>g?(Vo>o&&(u=u+o/2-Vo/2,0>u&&(u=0),u+Vo>g&&(u=g-Vo),o=Vo),a.visibility=hd,a.background=D.getScrollBarColor(),a.borderRadius=m/2+jm,Mj(c,X,u,m,o)):a.visibility=cl}else c&&(c.style.visibility=cl)}},ms_hs:function(z){z._40o=function(){return this._29I.width<this._91I},z._42o=function(){var G=this;G._40o()&&(G._95O||(u(function(){G._94I()},Yf),G.iv()),G._95O=new Date)},z._94I=function(){var J=this;if(J._95O){var a=new Date;a.getTime()-J._95O.getTime()>=Yf?(delete J._95O,J.iv()):u(function(){J._94I()},Yf)}},z._92I=function(){var q=this,E=q._28I;if(q._95O||!q._autoHideScrollBar){E||gd(q._79O,E=q._28I=ao());
var o=q._29I,v=o.width,P=q._91I,p=q.getScrollBarSize(),D=o.height-p-2,r=v*(-q.tx()/P),A=v*(v/P),e=E.style;P>v?(Vo>A&&(r=r+A/2-Vo/2,0>r&&(r=0),r+Vo>v&&(r=v-Vo),A=Vo),e.visibility=hd,e.background=q.getScrollBarColor(),e.borderRadius=p/2+jm,Mj(E,r,D,A,p)):e.visibility=cl}else E&&(E.style.visibility=cl)}}}),sr(jc,Gk(16,16,[{type:wb,rect:[1,1,14,14],background:yc},{type:jp,rect:[1,1,14,14],width:1,color:Lo},{type:fl,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),sr(Ve,Gk(16,16,{type:jp,rect:[1,1,14,14],width:1,color:Lo})),sr(Hq,Gk(16,16,[{type:Zj,rect:[2,2,12,12],borderWidth:1,borderColor:Lo,background:"#FFF"},{type:Zj,rect:[4,4,8,8],background:yc}])),sr(Sq,Gk(16,16,{type:Zj,rect:[2,2,12,12],borderWidth:1,borderColor:Lo})),Ie._15Q=function(t){t._29I=Cm,t._59I=0,t._91I=0,t._5o=function(L){var W=this;W._30I=new up,W._rows=new up,W._rowMap={},W._31I=0,W._14I=0,W._view=wk(1,W),W._canvas=ld(W._view),gd(W._view,W._79O=ao()),W.dm(L?L:new Gi)},t.getCheckIcon=function(n){var d=this.sm(),l=d.co(n);return d.sg()?fo(l?Hq:Sq):fo(l?jc:Ve)},t.checkData=function(g){var h=this.sm(),s=h.co(g);h.sg()&&s||(this._32o=1,s?h.rs(g):h.as(g),delete this._32o)},t.getDataAt=function(r){r.target&&(r=this.lp(r));var L=l(r.y/this._rowHeight),E=this._rows;return 0>L||L>=E.size()?q:E.get(L)},t.onDataDoubleClicked=function(){},t.onDataClicked=function(){},t.adjustTranslateX=function(){return 0},t.adjustTranslateY=function(P){var b=this.getHeight()-this._59I;return b>P&&(P=b),P>0?0:H(P)},t.onPropertyChanged=function($){var A=this,y=$.property;$n[y]?A.ivm():Ro[y]||A.redraw(),y===cf?A._42o():y===rf&&A._43o()},t.getLabel=function(A){return A.toLabel()},t.getLabelFont=function(){return this._labelFont},t.getLabelColor=function(F){var f=this;if(f.isCheckMode()){if(f._focusData===F)return f._labelSelectColor}else if(f.isSelected(F))return f._labelSelectColor;return f._labelColor},t.getStartRowIndex=function(){return this._31I},t.getEndRowIndex=function(){return this._14I},t.getRowDatas=function(){return this._rows},t.getRowIndex=function(H){return this._rowMap[H._id]},t.getRowSize=function(){return this._rows.size()},t.getViewRect=function(){return ji(this._29I)},t.isVisible=function(q){return this._visibleFunc?this._visibleFunc(q):!0},t.getCurrentSortFunc=function(){return this._sortFunc},t.setDataModel=function(Q){var s=this,F=s._dataModel,i=s._selectionModel;F!==Q&&(F&&(F.umm(s.handleDataModelChange,s),F.umd(s.handleDataPropertyChange,s),F.umh(s.handleHierarchyChange,s),i||F.sm().ums(s.handleSelectionChange,s)),s._dataModel=Q,Q.mm(s.handleDataModelChange,s),Q.md(s.handleDataPropertyChange,s),Q.mh(s.handleHierarchyChange,s),i?i._21I(Q):Q.sm().ms(s.handleSelectionChange,s),s.fp("dataModel",F,Q))},t.validateModel=function(){var K=this;K._rows.clear(),K._rowMap={},K.buildChildren(K._dataModel._roots);var b=K._rows=K._rows.toList(K.isVisible,K),h=0,O=K.getCurrentSortFunc(),J=b.size();for(O&&b.sort(O);J>h;h++)K._rowMap[b.get(h)._id]=h},t.buildChildren=function(N){var o=this;N.each(function(z){o._rows.add(z),o.buildChildren(z._children)})},t.handleDataModelChange=function(){this.ivm()},t.handleDataPropertyChange=function(L){"parent"===L.property?this.ivm():this.invalidateData(L.data)},t.handleHierarchyChange=function(){this.ivm()},t.handleSelectionChange=function(N){N.datas.each(this.invalidateData,this),this.onSelectionChanged(N)},t.onSelectionChanged=function(r){var A=this,f=A.sm();!A.isAutoMakeVisible()||1!==f.size()||"set"!==r.kind&&"append"!==r.kind||A._32o||A.makeVisible(f.ld())},t.handleBackgroundClick=function(G){vk(G)&&!this.isCheckMode()&&this.sm().cs()},t.makeVisible=function(Y){Y&&(this._23I=Y,this.iv())},t.scrollToIndex=function(G){var x=this,X=x._29I,B=X.height,$=x._rowHeight,N=$*G;G>=0&&G<x._rows.size()&&B>0&&(N+$>X.y+B?x.ty(-N+B-$):N<X.y&&x.ty(-N))},t.autoScroll=function(y,_){var A=this,U=A._rowHeight,j=U,u=U/4,O=A._29I,Y=A.lp(y),P={x:A.tx(),y:A.ty()};return U>0&&O&&(Y.x-O.x<j?A.translate(u,0):O.x+O.width-Y.x<j&&A.translate(-u,0),Y.y-O.y<j?A.translate(0,u):O.y+O.height-Y.y<j&&A.translate(0,-u)),P.x=A.tx()-P.x,P.y=A.ty()-P.y,_&&(_.x+=P.x,_.y+=P.y),P},t.getTopRowOrderSelection=function(){var J=this.sm().getTopSelection(),X={},v=new up;return J.each(function(A){X[A._id]=A}),this._rows.each(function(k){X[k._id]&&v.add(k)}),v},t.getRowOrderSelection=function(){var D=new up;return this._rows.each(function(a){this.isSelected(a)&&D.add(a)},this),D},t.ivm=function(){this.invalidateModel()},t.invalidateModel=function(){var y=this;y._96I||(y._96I=1,y._32I=1,delete y._24I),y.iv()},t.redraw=function(){var i=this;i._32I||(i._32I=1,delete i._24I,i.iv())},t.invalidateData=function(r){var W=this;o?W.redraw():W._32I||(W._24I||(W._24I={}),W._24I[r._id]=r,W.iv())},t.getFocusData=function(){return this._focusData},t.setFocusDataById=function(P){this.setFocusData(this.dm().getDataById(P))},t.setFocusData=function(J){var I=this,B=I._focusData;B!==J&&(I._focusData=J,I.fp("focusData",B,J),B&&I.invalidateData(B),J&&(I.invalidateData(J),I.isAutoMakeVisible()&&I.makeVisible(J)))},t.drawRowBackground=function(N,A,i,I,d,D,k){var _=this,y=_.isCheckMode();(A===_._focusData&&y||i&&!y)&&Kc(N,I,d,D,k,_.getSelectBackground(A))},t.drawData=function(J,c,R){var w=this,Q=w._rowHeight,P=Q*R,l=w._29I,m=l.x,N=l.width;J.save(),J.beginPath(),J.rect(m,P,N,Q),J.clip(),w._87o(w.drawRow(J,c,w.isSelected(c),m,P,N,Q),R,m,P,N,Q),J.restore(),w._rowLineVisible&&Kc(J,m,P+Q-1,N,1,w._rowLineColor)},t._12I=function(u){var N=this,f=N._31I,K=N._29I,W=K.x,t=K.y,Y=K.width,G=K.height;for(u.beginPath(),u.rect(W,t,Y,G),u.clip(),u.clearRect(W,t,Y,G),N._76o(),N._93db(u);f<N._14I;f++)N.drawData(u,N._rows.get(f),f);N._92db(u)},t._13I=function(i){for(var h,t=this,F=t._rowHeight,C=t._29I,M=C.x,f=C.width,j=t._31I,b=t._30I;j<t._14I;j++)h=t._rows.get(j),t._24I[h._id]&&b.add({data:h,index:j});b.isEmpty()||(i.beginPath(),b.each(function(d){i.rect(M,d.index*F,f,F)}),i.clip(),b.each(function(n){i.clearRect(M,n.index*F,f,F)}),b.each(function(a){t._77o(a.index)}),t._93db(i),b.each(function(x){t.drawData(i,x.data,x.index)}),t._92db(i),b.clear())},t.validateImpl=function(){var E=this,s=E._canvas,b=E.getWidth(),a=E.getHeight(),D=E._rowHeight,K=E._32I;(b!==s.clientWidth||a!==s.clientHeight)&&(Pm(s,b,a),K=1);var J=j&&!T;E._96I&&!J&&E.validateModel();var e=E._29I,N={x:-E.tx(),y:-E.ty(),width:b,height:a},Y=E._rows.size(),p=Pg(s),L=E._23I;K||nq(N,e)||(K=1),E._29I=N,E._59I=Y*D,E._31I=l(N.y/D),E._14I=z((N.y+N.height)/D),E._31I<0&&(E._31I=0),E._14I>Y&&(E._14I=Y),E._99I&&K&&E._99I(),yr(p,E.tx(),E.ty(),1),K?E._12I(p):E._24I&&E._13I(p),E._93I(),E._92I(),p.restore(),E._32I=E._24I=E._96I=q,L&&(E.scrollToIndex(E.getRowIndex(L)),delete E._23I),E.tx(E.tx()),E.ty(E.ty())}},Ie._48o=function(K){K._rootVisible=!0,K._rootData=q,K._35o=function(){this._expandMap={},this._levelMap={}},K.validateModel=function(){var G=this,J=G._rootData;G._rows.clear(),G._levelMap={},G._rowMap={},G._currentLevel=0,J?G._rootVisible?G.isVisible(J)&&G.buildData(J):G.buildChildren(J):G.buildChildren(),delete G._currentLevel},K.buildData=function(j){var k=this,I=j._id,f=k._rows;k._rowMap[I]=f.size(),f.add(j),k._levelMap[I]=k._currentLevel,k.isExpanded(j)&&(k._currentLevel++,k.buildChildren(j),k._currentLevel--)},K.buildChildren=function(A){var M=this,d=A?A._children:M._dataModel._roots,Q=M.getCurrentSortFunc();Q&&M.isChildrenSortable(A)?d.toList(M.isVisible,M).sort(Q).each(M.buildData,M):d.each(function(Y){M.isVisible(Y)&&M.buildData(Y)})},K.getLevel=function(k){return this._levelMap[k._id]},K.getToggleIcon=function(C){var d=this,p=d._loader,j=d._collapseIcon;return p&&!p.isLoaded(C)?j:C.hasChildren()?d.isExpanded(C)?d._expandIcon:j:q},K.isCheckMode=function(){return this._checkMode!=q},K.isChildrenSortable=function(){return!0},K.handleDataModelChange=function(O){var f=this;O.kind===dm?delete f._expandMap[O.data._id]:O.kind===Hn&&(f._expandMap={}),f.ivm()},K.toggle=function(D){var d=this;d.isExpanded(D)?d.collapse(D):d.expand(D)},K.isExpanded=function(e){return 1===this._expandMap[e._id]},K.expand=function(F){var g=this,C=g._loader;g.isExpanded(F)||(C&&!C.isLoaded(F)&&C.load(F),g._expandMap[F._id]=1,g.ivm(),g.onExpanded(F))},K.onExpanded=function(){},K.collapse=function(j){var z=this;z.isExpanded(j)&&(delete z._expandMap[j._id],z.ivm(),z.onCollapsed(j))},K.onCollapsed=function(){},K.expandAll=function(){var Y=this;Y._dataModel.each(function(u){u.hasChildren()&&(Y._expandMap[u._id]=1)}),Y.ivm()},K.collapseAll=function(){this._expandMap={},this.ivm()},K.makeVisible=function(L){if(L){var H=this;if(!H._rootData||L.isDescendantOf(H._rootData)){for(var I=L._parent;I;)H.expand(I),I=I._parent;H._23I=L,H.iv()}}},K.checkData=function(c){var G,Y=this,Q=Y._checkMode,M=Y.sm(),v=M.co(c);if(!M.sg()||!v){if(Y._32o=1,Q===S)v?M.rs(c):M.as(c);else if(Q===iq)G=new up(c),G.addAll(c._children);else if("descendant"===Q)G=new up,al(c,G);else if("all"===Q&&(G=new up,al(c,G),!v))for(var q=c._parent;q;)G.add(q),q=q._parent;G&&(v?M.rs(G):M.as(G)),delete Y._32o}},K._97I=function(l,K,U,B,A,b,V){var Q=this,F=Q._indent,d=Q._levelMap[K._id],i=Q.getIconWidth(K),S=fo(Q.getToggleIcon(K));S?(B+=F*d,We(l,S,B+F/2,A+V/2,K,Q),B+=F):B+=F*(d+1),Q._checkMode&&(We(l,Q.getCheckIcon(K),B+F/2,A+V/2,K,Q),B+=F),Q.drawIcon(l,K,B,A,i,V),Q.drawLabel(l,K,B+i,A,V)}},Ie._14Q=function(e){e.getIcon=function(C){return C.getIcon()},e.getIconWidth=function(j){return this.getIcon(j)?this._indent:0},e.drawIcon=function(u,Z,b,W,z,A){if(z){var R=this,F=R.getBodyColor(Z),d=fo(R.getIcon(Z),F);d&&(A-=R.isRowLineVisible()?1:0,Sk(u,d,li,b,W,z,A,Z,R,F),bb(u,R.getBorderColor(Z),b,W,z,A))}},e.drawLabel=function(F,H,T,N,I){var R=this;Wp(F,R.getLabel(H),R.getLabelFont(H),R.getLabelColor(H),T,N,0,I)}},Ie._50o=function(O){O._98I=function(){var Z=this,y=Z._39o=new Gi;Z._60I=new up,y.mm(Z._17o,Z),y.md(Z._18o,Z),y.mh(Z._19o,Z)},O.setColumns=function(F){this._39o.clear(),this.addColumns(F)},O.addColumns=function(d){var A=this._39o;d.forEach(function(v){if(!(v instanceof Hd)){var o=Gq(v.className);v=Kp(o?o:Hd,v)}A.add(v)})},O.onColumnClicked=function(){},O.onCheckColumnClicked=function(){},O._3Q=function(Z){for(var r,w=0,g=this._60I,H=g.size();H>w;w++)if(r=g.get(w),r.column===Z)return r;return q},O.getColumnAt=function(z){var o=this._4Q(z);return o?o.column:q},O._4Q=function(g){for(var n=this,V=g.target?n.lp(g).x:g.x,j=n._60I,C=0;C<j.size();C++){var c=j.get(C),u=c.startX;if(V>=u&&V<u+c.column.getWidth())return c}return q},O.getToolTip=function(c){var J=this,B=J.getDataAt(c),h=J.getColumnAt(c);return B&&h?h.getToolTip(B,J):q},O.adjustTranslateX=function(O){var S=this.getWidth()-this._91I;return S>O&&(O=S),O>0?0:H(O)},O._99I=function(){var b=this,q=b._29I,T=b._60I;T.clear(),b._91I=0,b._39o._roots.each(function($){if($.isVisible()){var H=b._91I+$.getWidth();b._91I<=q.x+q.width&&H>=q.x&&T.add({column:$,startX:b._91I}),b._91I=H}})},O.drawData=function(Y,P,D){var Z=this,q=Z._rowHeight,Q=q*D,A=Z.isSelected(P),J=Z._29I,C=J.x,M=J.width;Z.drawRowBackground(Y,P,A,C,Q,M,q),Z._60I.each(function(p){var a=p.column,n=p.startX,w=a.getWidth();w>0&&!Z.isEditing(P,a)&&(Y.save(),Y.beginPath(),Y.rect(n,Q,w,q),Y.clip(),Z._87o(Z.drawCell(Y,P,A,a,n,Q,w,q),D,n,Q,w,q),Z._columnLineVisible&&Kc(Y,n+w-1,Q,1,q,Z._columnLineColor),Y.restore())}),Z._rowLineVisible&&Kc(Y,C,Q+q-1,M,1,Z._rowLineColor)},O.drawCell=function(N,$,m,x,M,E,v,n){var F=this;if(x.drawCell)return x.drawCell(N,$,m,x,M,E,v,n,F);var j=F.getValue($,x);hc(N,j,x,F.getLabelFont($,x,j),F.getLabelColor($,x,j),M,E,v,n,$,F)},O.getColumnModel=function(){return this._39o},O._17o=function(){this.redraw()},O._18o=function(W){var k=this;W.data===k._sortColumn&&Qp[W.property]?k.ivm():(k._42o(),k.redraw())},O._19o=function(){this.redraw()},O.getCurrentSortFunc=function(){var g=this,S=g._sortColumn;if(S&&S.isSortable()){var k=S.getSortFunc(),Z=_p===S.getSortOrder()?1:-1;return k||(k=zb),function(w,V){return k.call(g,g.getValue(w,S),g.getValue(V,S),w,V)*Z}}return g._sortFunc},O.isCellEditable=function(C,B){return B.isEditable()&&this.isEditable()},O._37O=function(F,C){if(vk(C))for(var W=this,h=W.lp(C),X=W._60I,w=W._rowHeight,j=W._29I,K=j.x,r=j.y,V=j.width,k=j.height,M=0;M<X.size();M++){var i=X.get(M),Y=i.startX,d=i.column,R=d.getWidth();if(d!==W._31o&&d!==W._4o&&W.isCellEditable(F,d,C)&&h.x>=Y&&h.x<Y+R){var J={x:Y,y:W.getRowIndex(F)*w,width:R,height:w},x={x:J.x+W.tx(),y:J.y+W.ty(),width:J.width,height:J.height},v=0,O=0;return J.x<K?v=J.x-K:J.x+J.width>K+V&&(v=J.x+J.width-K-V),v&&(W.tx(W.tx()-v),x.x-=v),J.y<r?O=J.y-r:J.y+w>r+k&&(O=J.y+w-r-k),O&&(W.ty(W.ty()-O),x.y-=O),W.beginEditing({data:F,column:d,value:W.getValue(F,d),event:C,rect:J,editorRect:x,view:W}),void 0}}}},Tp.BaseItemEditor=function(a,d,m,g){this._data=a,this._column=d,this._master=m,this._editInfo=g},Uf("BaseItemEditor",P,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var mq=i.Tab=function(){Pj(mq,this)};Qd("Tab",Mb,{ms_ac:["view","closable","disabled"],_icon:q,_closable:!1,_disabled:!1,setParent:Yb});var Hd=i.Column=function(){Pj(Hd,this)};Qd("Column",Mb,{_46o:1,ms_ac:["accessType","valueType",hd,Eq,Km,kk,"align",fc,"sortOrder",ik,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:_p,_sortFunc:q,_sortable:!0,_clickable:!0,setWidth:function(H){16>H&&(H=16);var A=this._width;this._width=H,this.fp(kk,A,H)},getToolTip:function(D,O){return this.formatValue(O.getValue(D,this))}});var rj=i.Property=function(){Pj(rj,this)};Qd("Property",Mb,{_46o:1,ms_ac:["accessType","valueType",Eq,Km,"categoryName",fc,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:q,getToolTip:function(e,U,b){var J=this;return U?J.formatValue(b.getValue(e,J)):b.getPropertyName(J)}}),Tp.AccordionView=function(){var h=this;h._20o={},h._21o=new up,h._10o=q,h._9o=q,h._11o=q,h._view=wk(0,h),h.iv()},Uf("AccordionView",P,{ms_v:1,ms_fire:1,ms_ac:[vf,Yj,"titleHeight",Xr,Sn,"titleBackground","selectWidth",os,"orientation","separatorColor"],_expandIcon:E.accordionViewExpandIcon,_collapseIcon:E.accordionViewCollapseIcon,_titleHeight:Vp,_labelColor:E.accordionViewLabelColor,_labelFont:E.accordionViewLabelFont,_titleBackground:E.accordionViewTitleBackground,_selectBackground:E.accordionViewSelectBackground,_selectWidth:E.accordionViewSelectWidth,_orientation:"v",_separatorColor:E.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function($,S,U,_){var b=this,V=ao();if(b._20o[$])throw $+" already exists";V.onmousedown=br,V.style.cursor=ee,V.addEventListener(e?Ik:ke,function(y){br(y)},!1),V.addEventListener(e?nk:Dr,function(h){br(h),vk(h)&&(b._10o===$?b.collapse():b.expand($))},!1),gd(b._view,V),b._20o[$]={content:S,div:V,canvas:ld(V),icon:_},b._21o.add($),U&&b.expand($),b.iv()},remove:function(r){var L=this,X=L._20o[r];X&&(Ad(X.div),delete L._20o[r],L._21o.remove(r),L.iv())},clear:function(){var $=this;$._20o={},$._21o.clear(),$.iv()},isExpanded:function(W){return this._10o===W},expand:function(w){var x=this;x._20o[w]&&x._10o!==w&&(x._10o=w,x.onExpanded(w),x.iv())},onExpanded:function(){},collapse:function(){var q=this;q._10o&&(q.onCollapsed(q._10o),delete q._10o,q.iv())},onCollapsed:function(){},initCanvas:function(h,i,r){Pm(h,i,r);var o=Pg(h);return yr(o,0,0,1),o.clearRect(0,0,i,r),o},drawTitle:function(N,H,q,D,I){var t=this,W=fo(I.icon),K=t.isExpanded(H),M=t._titleHeight,A=t._titleBackground,b=t._selectWidth,s=t._separatorColor,z=fo(K?t._expandIcon:t._collapseIcon),G=b+4;Kc(N,0,0,q,D,A),K&&b&&Kc(N,0,0,b,D,t._selectBackground),(K||t._21o.get(t._21o.size()-1)!==H)&&Kc(N,0,D-1,q,1,s?s:Kg(A)),W&&(We(N,W,G+Uh(W)/2,M/2),G+=Uh(W)+2),Wp(N,H,t.getLabelFont(H),t.getLabelColor(H),G,0,0,M),z&&We(N,z,q-Uh(z)/2-4,M/2)},validateImpl:function(){var g=this,Z=g._view,k=0,z=0,b=g.getWidth(),N=g.getHeight(),n=g._titleHeight,t=g._21o.size()*n,y=g._11o,S=g._9o;delete g._11o,delete g._9o,g._21o.each(function(F){var h,P,i=g._20o[F],a=i.content,m=g._10o===F;bd(g)?(Mj(i.div,k,0,n,N),h=g.initCanvas(i.canvas,n,N),_e(h,0,N),zq(h,-V),g.drawTitle(h,F,N,n,i),h.restore(),m?(P=M(0,b-t),a&&(g._11o=a,g._9o=cs(a),Mj(a,k+n,0,P,N)),k+=n+P):k+=n):(Mj(i.div,0,z,b,n),h=g.initCanvas(i.canvas,b,n),g.drawTitle(h,F,b,n,i),h.restore(),m?(P=M(0,N-t),a&&(g._11o=a,g._9o=cs(a),Mj(a,0,z+n,b,P)),z+=n+P):z+=n)});var u=g._9o;y&&y!==g._11o&&y.endEditing&&y.endEditing(),u&&u!==S&&gd(Z,u),S&&S!==u&&Ad(S)}}),Tp.SplitView=function(V,C,P,H){var r=this,B=r._dividerDiv=ao(),Y=r._60O=ld(),m=r._61O=ld(),u=Y.style,c=m.style;r._view=wk(1,r),gd(r._view,B),u.msTouchAction=Wr,u.pointerEvents=Wr,u.cursor=ee,c.msTouchAction=Wr,c.pointerEvents=Wr,c.cursor=ee,V&&r.setLeftView(V),C&&r.setRightView(C),P&&r.setOrientation(P),H!=q&&r.setPosition(H),r.setStatus(Vn),new Fr(r)},Uf("SplitView",P,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:E.splitViewDividerSize,_dividerBackground:E.splitViewDividerBackground,_dragOpacity:E.splitViewDragOpacity,_toggleIcon:E.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(f,m){var k=this,x=k._position;isNaN(f)||(m||(k._82O=0>f?-1:f>1?1:0),k._position=f,k.fp(xm,x,f))},getLeftView:function(){return this._leftView},setLeftView:function(o){var d=this,i=d._leftView,D=d._view;if(d._leftView!==o){if(i&&i!==d._rightView){var p=cs(i);p.parentNode===D&&Ad(p)}if(d._leftView=o,o){var X=cs(o);X.parentNode!==D&&D.insertBefore(X,d._dividerDiv)}d.fp("leftView",i,o)}},getRightView:function(){return this._rightView},setRightView:function(d){var O=this,U=O._rightView,_=O._view;if(O._rightView!==d){if(U&&U!==O._leftView){var l=cs(U);l.parentNode===_&&Ad(l)}if(O._rightView=d,d){var X=cs(d);X.parentNode!==_&&_.insertBefore(X,O._dividerDiv)}O.fp("rightView",U,d)}},validateImpl:function(){var o=this,u=o._draggable,g=o._position,p=o.getWidth(),K=o.getHeight(),c=o._dividerSize,n=o._dividerBackground,D=e?18:8,s=o._dividerDiv,F=o._82O,y=o._60O,i=o._61O,t=o._toggleIcon,T=o._status,k=s.style,j=null,O=e?20:4,E=t.comps[0];c>=D||0===c?o._coverDiv&&(Ad(o._coverDiv),delete o._coverDiv):o._coverDiv||(o._coverDiv=ao(),h&&(o._coverDiv.style.background=kc),gd(s,o._coverDiv)),o._togglable?y.parentNode||(gd(s,y),gd(s,i)):(Ad(y),Ad(i));var Y=o._coverDiv,P=o._leftView,q=o._rightView;if(bd(o)){if(c>p&&(c=p),T===Vn)if(1===F)var X=f(g,p),J=M(0,p-c-X);else-1===F?(J=f(-g,p),X=M(0,p-c-J)):(X=H((p-c)*g),J=M(0,p-c-X));else"cl"===T?(X=0,J=M(0,p-c)):"cr"===T&&(J=0,X=M(0,p-c));P&&Mj(P,0,0,X,K),q&&Mj(q,X+c,0,J,K),Mj(s,X,0,c,K),o._22o=X,Y&&(Mj(Y,c/2-D/2,0,D,K),Y.style.cursor=u?De:""),s.style.cursor=u?De:"";var d=s.clientHeight/2,v=s.clientWidth;Pm(y,v,v),Mj(y,0,d-v-O,v,v),j=Pg(y),yr(j,0,0,1),E.rotation=-V,dn(j,t,0,0,v,v),j.restore(),Pm(i,v,v),Mj(i,0,d+O,v,v),j=Pg(i),yr(j,0,0,1),E.rotation=V,dn(j,t,0,0,v,v),j.restore()}else{if(c>K&&(c=K),T===Vn)if(1===F)var z=f(g,K),w=M(0,K-c-z);else-1===F?(w=f(-g,K),z=M(0,K-c-w)):(z=H((K-c)*g),w=M(0,K-c-z));else"cl"===T?(z=0,w=M(0,K-c)):"cr"===T&&(w=0,z=M(0,K-c));P&&Mj(P,0,0,p,z),q&&Mj(q,0,z+c,p,w),Mj(s,0,z,p,c),o._22o=z,Y&&(Mj(Y,0,c/2-D/2,p,D),Y.style.cursor=u?Kn:""),k.cursor=u?Kn:"";var S=s.clientWidth/2,v=s.clientHeight;Pm(y,v,v),Mj(y,S-v-O,0,v,v),j=Pg(y),yr(j,0,0,1),E.rotation=0,dn(j,t,0,0,v,v),j.restore(),Pm(i,v,v),Mj(i,S+O,0,v,v),j=Pg(i),yr(j,0,0,1),E.rotation=A,dn(j,t,0,0,v,v),j.restore()}k.background=n}});var Fr=function(_){this.sv=_,this.addListeners()};re(Fr,P,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(d){var I=this,t=I.sv,K=t._dividerDiv,H=t._60O,j=t._61O,G=t._status,f=d.target;if(f===H)G===Vn?t.setStatus("cl"):"cr"===G&&t.setStatus(Vn);else if(f===j)G===Vn?t.setStatus("cr"):"cl"===G&&t.setStatus(Vn);else if(Yn(d)&&(f===K||f===t._coverDiv)&&(br(d),t.isDraggable())){t.getLeftView(),t.getRightView();var $=I.maskDiv=ao();if($.style.left=0,$.style.top=0,$.style.width=t.getWidth()+"px",$.style.height=t.getHeight()+"px",t.getView().appendChild($),!t.isContinuousLayout()){var x=I.resizeDiv=ao();x.style.left=K.style.left,x.style.top=K.style.top,x.style.width=K.style.width,x.style.height=K.style.height,x.style.opacity=t.getDragOpacity(),x.style.background=t.getDividerBackground(),gd(I.getView(),x)}I._lastAbsPosition=t._22o,I._86o=bd(t)?wo(d).x:wo(d).y,Pr(I,d)}},handleWindowTouchMove:function(Y){Yn(Y)&&this.update(Y,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(a){var e=this;e.update(a,!0),e.sv.setStatus(Vn),e.maskDiv&&Ad(e.maskDiv),e.resizeDiv&&Ad(e.resizeDiv),e.maskDiv=e.resizeDiv=q},handle_mousedown:function(o){vk(o)&&this.handle_touchstart(o)},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},update:function(N,C){var z=this,k=z.sv,a=bd(k)?k.getWidth():k.getHeight(),T=k._dividerSize,B=z._lastAbsPosition-z._86o;bd(k)?(B+=wo(N).x,B>a-T&&(B=a-T),0>B&&(B=0),z.resizeDiv&&(z.resizeDiv.style.left=B+jm)):(B+=wo(N).y,B>a-T&&(B=a-T),0>B&&(B=0),z.resizeDiv&&(z.resizeDiv.style.top=B+jm)),C&&a!==T&&(1===k._82O?k.setPosition(B,1):-1===k._82O?k.setPosition(B-a+T,1):k.setPosition(B/(a-T),1))}}),Tp.TabView=function(){var w=this,X=w._view=wk(1,w),R=w._91O=ao(1),q=w._tabModel=new Gi,V=q.sm(),l=w.invalidate;w._7o=new up,w._canvas=ld(R),gd(X,R),gd(X,w._92O=ao(1)),V.setSelectionMode(Hb),V.ms(l,w),q.mm(l,w),q.md(l,w),q.mh(l,w),new uj(w),w.iv()},Uf("TabView",P,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Xr,Sn,"tabBackground","selectWidth",os,"moveBackground","insertColor"],_tabPosition:nr,_tabHeight:Vp,_tabGap:E.tabViewTabGap,_labelColor:E.tabViewLabelColor,_labelFont:E.tabViewLabelFont,_tabBackground:E.tabViewTabBackground,_selectWidth:E.tabViewSelectWidth,_selectBackground:E.tabViewSelectBackground,_moveBackground:E.tabViewMoveBackground,_insertColor:E.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(z,$,n){var c=new mq,H=this._tabModel;return c.setName(z),c.setView($),H.add(c),n&&H.sm().ss(c),c},getLabel:function(c){return c.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(B){this._23o=B,this.iv()},get:function(H){var s=this,O=s._tabModel;if(wm(H))return O._roots.get(H);if(Gg(H)){var o;return O.each(function(X){H===s.getLabel(X)&&(o=X)}),o}return H instanceof mq?H:q},select:function(k){this._tabModel.sm().ss(this.get(k))},remove:function(p){var Z=this;if(p=Z.get(p)){var T=Z._tabModel,V=T._roots.indexOf(p);Z._tabModel.remove(p),Z._12Q(--V)}},getCurrentTab:function(){return this._8o},hideTabView:function(a,X){X.parentNode===this._92O&&(fm(X)?(X.style.display=gn,X._tab_=a):Ad(X),Ur())},showTabView:function(H,_){fm(_)&&(_.style.display="block",_._tab_=H),_.parentNode!==this._92O&&(gd(this._92O,_),Ur())},_24o:function(){var t,W=this,F=W._8o,m=W._9o,e=W._tabModel.sm().ld();e&&(t=cs(e.getView())),t!==m&&(m&&(F.getView()&&F.getView().endEditing&&F.getView().endEditing(),W.hideTabView(F,m)),t&&W.showTabView(e,t)),W._8o=e,W._9o=t,F!==e&&W.onTabChanged(F,e)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Z,f){this._12Q(--f)},_12Q:function(r){var y=this,E=y._tabModel,U=E.size();if(U&&!E.sm().ld()){r==q&&(r=0),r>=U&&(r=U-1),0>r&&(r=0);for(var X=r;X>=0;X--){var w=y.get(X);if(!w.isDisabled())return y.select(w),w}for(X=r+1;U>X;X++)if(w=y.get(X),!w.isDisabled())return y.select(w),w}},_9Q:function(g){var Z=4,A=fo(g.getIcon());A&&(Z+=Uh(A,g)+4);var a=this.getLabel(g);return a&&(Z+=wr(this.getLabelFont(g),a).width+4),g.isClosable()&&(Z+=10),Z},drawTab:function(G,K,B,m,n,U,f){var d,s=this,I=s._tabPosition,x=B+4,i=s._selectWidth,N=fo(K.getIcon()),T=K.isDisabled(),Y=s.getLabelColor(K),P=s.getLabelFont(K),r=s.getLabel(K),y=s._selectBackground,S=I===Ff+"-vertical",c=I===Gr+"-vertical";(S||c)&&(x=m+4),T&&(G.globalAlpha=pj),Kc(G,B,m,n,U,f),K===s._8o&&i&&(I===nr?Kc(G,B,m+U-i,n,i,y):I===Ff?Kc(G,B+n-i,m,i,U,y):I===Gr?Kc(G,B,m,i,U,y):S?Kc(G,B+n-i,m,i,U,y):c?Kc(G,B,m,i,U,y):Kc(G,B,m,n,i,y));var h=n/2;if(S&&(_e(G,h,m+U/2),zq(G,A),_e(G,-h,-m-U/2)),N){var R=yn(N,K),L=Uh(N,K);if(S||c){var M=B+n/2,O=x+R/2;_e(G,M,O),zq(G,V),_e(G,-M,-O),We(G,N,B+n/2,x+R/2,K,s),_e(G,M,O),zq(G,-V),_e(G,-M,-O),x+=R+4}else We(G,N,x+L/2,m+U/2,K,s),x+=L+4}return S||c?(_e(G,n/2,x+n/2),zq(G,V),_e(G,-n/2,-x-n/2),Wp(G,r,P,Y,B,x,U,n),_e(G,n/2,x+n/2),zq(G,-V),_e(G,-n/2,-x-n/2)):Wp(G,r,P,Y,x,m,n,U),S&&(_e(G,h,m+U/2),zq(G,-A),_e(G,-h,-m-U/2)),K.isClosable()&&(d=c?{x:B+n-12,y:m+U-12,width:12,height:12}:{x:B+n-12,y:m+2,width:12,height:12},this.drawCloseIcon(K,G,Y,d)),T&&(G.globalAlpha=1),d},drawCloseIcon:function(h,a,X,Y){var J=Y.x,k=Y.y;a.strokeStyle=X,a.lineWidth=1,a.beginPath(),a.moveTo(J+2,k+8),a.lineTo(J+8,k+2),a.moveTo(J+8,k+8),a.lineTo(J+2,k+2),a.stroke()},validateImpl:function(){var C=this;C._24o();var i,w=C._canvas,b=C._tabPosition,r=C._91O,N=C._92O,q=C._tabModel,t=C.getWidth(),v=C.getHeight(),z=C._tabHeight,S=C._7o,P=C._tabGap,L=b===nr,d=b===Ff,H=b===Gr,j=b===Ff+"-vertical",o=b===Gr+"-vertical",W=C._23o,V=0;if((d||H)&&q._roots.each(function(K){V=M(C._9Q(K),V)}),L?(Mj(r,0,0,t,z),i={x:0,y:z,width:t,height:M(0,v-z)}):d?(Mj(r,0,0,V,v),i={x:V,y:0,width:M(0,t-V),height:v}):H?(Mj(r,t-V,0,V,v),i={x:0,y:0,width:M(0,t-V),height:v}):j?(Mj(r,0,0,z,v),i={x:z,y:0,width:M(0,t-z),height:v}):o?(Mj(r,t-z,0,z,v),i={x:0,y:0,width:M(0,t-z),height:v}):(Mj(r,0,v-z,t,z),i={x:0,y:0,width:t,height:M(0,v-z)}),Mj(N,i),j||o){C._9o&&(i.x=0,Mj(C._8o.getView(),i)),Pm(w,z,v);var Q=Pg(w),a=0;if(yr(Q,0,C.ty(),1),Q.clearRect(0,0,z,v),S.clear(),q._roots.each(function(U){var A,F=C._9Q(U);W&&W.tab===U||(A=C.drawTab(Q,U,0,a,z,F,C._tabBackground)),S.add({_75o:A,tab:U,startY:a,endY:a+F,height:F}),a+=F+P}),C._23Q=M(0,a-P),W){var D=W.position;C.drawTab(Q,W.tab,0,W.startY,z,W.height,C._moveBackground),Kc(Q,0,D,z,1,C._insertColor)}Q.restore(),C.ty(C.ty())}else if(d||H){C._9o&&(i.x=0,Mj(C._8o.getView(),i)),Pm(w,V,v);var Q=Pg(w),a=0;if(yr(Q,0,C.ty(),1),Q.clearRect(0,0,V,v),S.clear(),q._roots.each(function(O){var H;W&&W.tab===O||(H=C.drawTab(Q,O,0,a,V,z,C._tabBackground)),S.add({_75o:H,tab:O,startY:a,endY:a+z,height:z}),a+=z+P}),C._23Q=M(0,a-P),W){var D=W.position;C.drawTab(Q,W.tab,0,W.startY,V,W.height,C._moveBackground),Kc(Q,0,D,V,1,C._insertColor)}Q.restore(),C.ty(C.ty())}else{C._9o&&(i.y=0,Mj(C._8o.getView(),i)),Pm(w,t,z);var Q=Pg(w),E=0;if(yr(Q,C.tx(),0,1),Q.clearRect(0,0,t,z),S.clear(),q._roots.each(function(y){var O,h=C._9Q(y);W&&W.tab===y||(O=C.drawTab(Q,y,E,0,h,z,C._tabBackground)),S.add({_75o:O,tab:y,startX:E,endX:E+h,width:h}),E+=h+P}),C._64I=M(0,E-P),W){var D=W.position;C.drawTab(Q,W.tab,W.startX,0,W.width,z,C._moveBackground),ag(Q,C._insertColor,D,0,z)}Q.restore(),C.tx(C.tx())}for(var B=[],Z=N.children,Y=0;Y<Z.length;Y++){var f=Z[Y],K=f._tab_;K&&!q.contains(K)&&B.push(f)}B.forEach(function(Y){N.removeChild(Y)})}});var uj=function(a){this.tv=a,this.addListeners()};re(uj,P,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(M){this.handleScroll(M,10*-M.detail)},handleScroll:function(z,S){br(z);var $=this.tv,j=$._tabPosition;!$._40o()||j!==nr&&j!==Xg||$.tx(this.tv.tx()+S),!$._41o()||j!==Ff&&j!==Gr&&j!==Ff+"-vertical"&&j!==Gr+"-vertical"||$.ty(this.tv.ty()+S)},_8Q:function(K){var x,l,H=this.tv,v=H._tabPosition,z=H._7o;if(v===nr||v===Xg){var G=H.lp(K).x;for(x=0;x<z.size();x++)if(l=z.get(x),l.startX<=G&&G<=l.endX)return l}else if(v===Ff||v===Gr||v===Ff+"-vertical"||v===Gr+"-vertical"){var w=H.lp(K).y;for(x=0;x<z.size();x++)if(l=z.get(x),l.startY<=w&&w<=l.endY)return l}return q},isClickable:function(S){var s=this.tv,v=s._tabPosition,w=this._73o=this._8Q(S);return!s._40o()||v!==nr&&v!==Xg?!s._41o()||v!==Ff&&v!==Gr&&v!==Ff+"-vertical"&&v!==Gr+"-vertical"?w&&(!w.tab.isDisabled()||s.isMovable()):!0:!0},handle_mousemove:function(B){var V=this;Cc?V._74o=V._8Q(B):V.getView().style.cursor=V.isClickable(B)?ee:""},handle_mousedown:function(X){this.handle_mousemove(X),this.handle_touchstart(X)},handle_touchstart:function(z){var V=this,C=V.tv,K=C._tabPosition;br(z),V.isClickable(z)&&(K===nr||K===Xg?(V.x=wo(z).x,V.lp=C.lp(z),V.tx=C.tx()):(V.y=wo(z).y,V.lp=C.lp(z),V.ty=C.ty()),Pr(V,z))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function($){var A,T=this,z=T.tv,j=z._tabPosition,Y=T._73o;if(j===nr||j===Xg){if(A=wo($).x-T.x,!T._25o&&!T.moving&&C(A)>2&&(z._40o()&&!ki($)?T._25o=1:Y&&z.isMovable()&&(T.moving=1)),T._25o)z.tx(T.tx+A);else if(T.moving){var G=T.lp.x+A,E=z._tabGap/2;z._7o.each(function(d){var y=d.endX,b=G-d.startX<y-G;G>=d.startX&&y>=G&&z._7Q({tab:Y.tab,startX:Y.startX+A,width:Y.width,front:b,insertTab:d.tab,position:b?M(0,d.startX-E):f(z._64I,y+E)})})}}else if(A=wo($).y-T.y,!T._25o&&!T.moving&&C(A)>2&&(z._41o()&&!ki($)?T._25o=1:Y&&z.isMovable()&&(T.moving=1)),T._25o)z.ty(T.ty+A);else if(T.moving){var o=T.lp.y+A,E=z._tabGap/2;z._7o.each(function(p){var m=p.endY,S=o-p.startY<m-o;o>=p.startY&&m>=o&&z._7Q({tab:Y.tab,startY:Y.startY+A,height:Y.height,front:S,insertTab:p.tab,position:S?M(0,p.startY-E):f(z._23Q,m+E)})})}},handleWindowMouseUp:function(V){this.handleWindowTouchEnd(V)},handleWindowTouchEnd:function(){var L=this,o=L.tv,b=o._tabPosition,X=o.getTabModel(),U=X._roots,A=L._73o;if(L.moving){var d=o._23o;if(d&&d.insertTab!==d.tab){var g=d.tab,F=U.remove(g),p=U.indexOf(d.insertTab);p>=0&&(d.front||p++,p<=U.size()&&(U.add(g,p),X._38I(g,F,p)))}o._7Q(q),delete L.moving}else if(!L._25o&&A){g=A.tab;var y=L._74o;if(!y||y.tab===g)if(!g.isDisabled()&&vg(A._75o,L.lp)){var Q=function(){var f=U.indexOf(g);X.remove(g),o.onTabClosed(g,f)};o.onTabClosing(g,Q)&&Q()}else g.isDisabled()||o._8o===g||X.sm().ss(g)}L._25o=L._73o=L._74o=b===nr||b===Xg?L.x=L.lp=L.tx=q:L.y=L.lp=L.ty=q}}),Tp.PropertyView=function(O){var p=this;p._view=wk(1,p),p._canvas=ld(p._view),gd(p._view,p._79O=ao()),p._rows=new up,p._28o=new up,p._26o={},p._26Q={};var e=p._propertyModel=new Gi,V=p.ivm;e.mm(V,p),e.md(V,p),e.mh(V,p),p.dm(O?O:new Gi),new xf(p)},Uf("PropertyView",P,{ms_ac:[Xr,mb,Sn,Eq,Km,"categorizable",Fc,ik,Rm,vf,Yj,wl,Yl,us,"selectRowIndex",os,"background",jg,rs,bg,Jo,gf],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Cm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:kd,_background:E.propertyViewBackground,_expandIcon:E.propertyViewExpandIcon,_collapseIcon:E.propertyViewCollapseIcon,_scrollBarColor:Sj,_scrollBarSize:cr,_autoHideScrollBar:cb,_selectBackground:E.propertyViewSelectBackground,_rowHeight:Ef,_rowLineVisible:E.propertyViewRowLineVisible,_rowLineColor:E.propertyViewRowLineColor,_10I:.5,_columnLineVisible:E.propertyViewColumnLineVisible,_columnLineColor:E.propertyViewColumnLineColor,_labelColor:E.propertyViewLabelColor,_labelSelectColor:E.propertyViewLabelSelectColor,_labelFont:E.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(e){0>e&&(e=0),e>1&&(e=1);var N=this,r=N._10I;N._10I=e,N.fp("columnPosition",r,e)},getPropertyName:function(e){return e.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(j,n,o){return o===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(V,Z){return Z===this._selectRowIndex?this._labelSelectColor:V.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(V){var x=this.getHeight()-this._59I;return x>V&&(V=x),V>0?0:H(V)
},isExpanded:function(R){if(!R)return!0;var d=this._26o[R];return d?d.isExpanded:!(this._26Q[R]===!1)},toggle:function(M){var F=this;F.isExpanded(M)?F.collapse(M):F.expand(M)},expandAll:function(){this.validate();for(var K in this._26o)this.expand(K)},expand:function(G){if(G&&G!==gn){var w=this,B=w._26o[G];B&&!B.isExpanded&&(B.isExpanded=!0,w.onExpanded(G),w.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var G in this._26o)this.collapse(G)},collapse:function($){if($&&$!==gn){var A=this,v=A._26o[$];v&&v.isExpanded&&(v.isExpanded=!1,A.onCollapsed($),A.ivm())}},onCollapsed:function(){},getCategoryName:function(c){if(!this.isCategorizable())return gn;var u=c.getCategoryName();return u?u:gn},getPropertyModel:function(){return this._propertyModel},setDataModel:function(i){var E=this,V=E._dataModel;V!==i&&(V&&(V.umd(E.handlePropertyChange,E),E._selectionModel||V.sm().ums(E.ivm,E)),E._dataModel=i,i.md(E.handlePropertyChange,E),E._selectionModel?E._selectionModel._21I(i):i.sm().ms(E.ivm,E),E.fp(Nn,V,i))},isVisible:function(T){return this._visibleFunc?this._visibleFunc(T):!0},onPropertyChanged:function(y){var W=this,l=y.property;uo[l]?W.ivm():W.iv(),l===rf&&W._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:zh},handlePropertyChange:function(u){this._27o===u.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var x=this;x._96I||(x.setSelectRowIndex(-1),x._96I=1,x.iv())},redraw:function(){this.iv()},validateModel:function(){var i=this,G=i._rows,Z=i._28o,q={},z=new up,R=i._27o;i.updateCurrentData(),R!==i._27o&&i.endEditing(),G.clear(),Z.clear(),i.getRawProperties().each(function(L){if(i.isVisible(L)){z.add(L);var m=i.getCategoryName(L);q[m]||(Z.add(m,m===gn?0:Q),q[m]={isExpanded:i.isExpanded(m),properties:new up})}}),i._sortFunc&&z.sort(i._sortFunc);for(var d in i._26o)i._26Q[d]=i.isExpanded(d);i._26o=q,Z.each(function(t){t!==gn&&G.add(t);var D=q[t];D.isExpanded&&z.each(function(A){i.getCategoryName(A)===t&&(D.properties.add(A),G.add({property:A,data:i._27o}))},i)})},validateImpl:function(){var e=this;e._76o(),e._96I&&(e.validateModel(),delete e._96I);var S=e._canvas,X=e.getWidth(),F=e.getHeight(),u=-e.ty(),B=e._rowHeight,g=e._indent,j=X-g,A=e._rows,T=A.size(),I=e._9I=g+j*e._10I,$=e._59I=T*B;Pm(S,X,F),e._29I={x:0,y:u,width:X,height:F},e._31I=l(u/B),e._14I=z((u+F)/B),e._31I<0&&(e._31I=0),e._14I>T&&(e._14I=T);var G,O=Pg(S),f=e._background;yr(O,0,-u,1),O.beginPath(),O.rect(0,u,X,F),O.clip(),O.clearRect(0,u,X,F),e._93db(O),f&&Kc(O,0,0,g,$,f);for(var h=e._31I;h<e._14I;h++){var k=A.get(h),u=B*h;if(Gg(k))f&&Kc(O,g,u,j,B,f),G=fo(e.isExpanded(k)?e._expandIcon:e._collapseIcon),G&&Sk(O,G,li,0,u,g,B),O.save(),O.beginPath(),O.rect(g,u,j,B),O.clip(),e.drawCategoryName(O,k,h,g,u,j,B),O.restore();else{var M=k.property,N=k.data,G=fo(M.getIcon()),J=e._selectRowIndex===h?e.getSelectBackground():q;if(G&&Sk(O,G,li,0,u,g,B),J&&Kc(O,g,u,j,B,J),O.save(),O.beginPath(),O.rect(g,u,I-g,B),O.clip(),e.drawPropertyName(O,M,h,g,u,I-g,B),O.restore(),!e.isEditing(N,M)){var x=I+1,Q=X-I-1;O.save(),O.beginPath(),O.rect(x,u,Q,B),O.clip(),e._87o(e.drawPropertyValue(O,M,e.getValue(N,M),h,x,u,Q,B,N),h,x,u,Q,B),O.restore()}}e._rowLineVisible&&Kc(O,g,u+B-1,j,1,e._rowLineColor)}e._columnLineVisible&&(Kc(O,I,0,1,$,e._columnLineColor),Kc(O,X-1,0,1,$)),e._92db(O),e._93I(),O.restore(),e.ty(e.ty())},drawCategoryName:function(x,r,a,S,c,q,V){Wp(x,r,this.getCategoryFont(r),this.getCategoryColor(r),S,c,q,V)},drawPropertyName:function(O,C,Y,S,d,e,I){return C.drawPropertyName?(C.drawPropertyName(O,C,Y,S,d,e,I,this),void 0):(Wp(O,this.getPropertyName(C),this.getPropertyFont(C,Y),this.getPropertyColor(C,Y),S,d,e,I),void 0)},drawPropertyValue:function(v,W,m,w,D,I,e,y,z){return W.drawPropertyValue?W.drawPropertyValue(v,W,m,w,D,I,e,y,z,this):(hc(v,m,W,this.getLabelFont(W,m,w),this.getLabelColor(W,m,w),D,I,e,y,z,this),void 0)},isPropertyEditable:function(u){return u.isEditable()&&this.isEditable()},setProperties:function(G){this._propertyModel.clear(),this.addProperties(G)},addProperties:function(M){if(M){var N=this._propertyModel;M.forEach(function(E){if(!(E instanceof rj)){var S=Gq(E.className);E=Kp(S?S:rj,E)}N.add(E)})}},getRowIndexAt:function(C){var w=this,u=l(w.lp(C).y/w._rowHeight);return u>=0&&u<w._rows.size()?u:-1},getPropertyAt:function(B){var e=this,$=e.getRowIndexAt(B);return $>=0?e._rows.get($).property:q},getToolTip:function(x){var S=this,a=S.getPropertyAt(x),J=S._27o;return a&&J?a.getToolTip(J,S._9I<S.lp(x).x,S):q}});var xf=function(R){this.pv=R,this.addListeners()};re(xf,P,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(b){this.getView().style.cursor=b},clear:function(){var c=this;c._62O=c.cp=c.ty=c.p=q,c.setCursor(S)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(r){var $=this,f=$.pv;br(r),f.setFocus(r)&&(vk(r)?($.cp=wo(r),$.ty=f.ty(),$.p=f.getColumnPosition(),$.handle_touchmove(r)):f.setSelectRowIndex(f.getRowIndexAt(r)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(T){var O=this;if(O.cp&&!O._62O){var P=O.pv,g=P.lp(T),u=g.x,w=g.y,M=P._indent,n=P.getRowIndexAt(T),I=P._9I;if(n>=0){var K=P._rowHeight,z=K*n,L=P._rows.get(n),y=L.property;if(Gg(L))fo(P.isExpanded(L)?P._expandIcon:P._collapseIcon)&&u>=0&&M>=u&&w>=z&&z+K>=w?P.toggle(L):hq(T)&&P.toggle(L);else if(u>I&&P.isPropertyEditable(y,T)){var f={x:I+1,y:z,width:P.getWidth()-I-1,height:K},j={x:f.x+P.tx(),y:f.y+P.ty(),width:f.width,height:f.height},E=0,m=P._29I;f.y<m.y?E=f.y-m.y:f.y+K>m.y+m.height&&(E=f.y+K-m.y-m.height),E&&(P.ty(P.ty()-E),j.y-=E),P.beginEditing({data:L.data,property:y,value:P.getValue(L.data,y),event:T,rect:f,editorRect:j,view:P})}}P.setSelectRowIndex(n)}O.clear()},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(R){var c=this,x=c.pv,S=c.ty,X=c.cp,P=wo(R),C=c._62O;if("p"===C)x.setTranslateY(S+P.y-X.y);else if("c"===C){var L=x.getWidth()-x._indent;if(L>16){var E=c.p-(X.x-P.x)/L,t=16/L;t>E&&(E=t),E>1-t&&(E=1-t),x.setColumnPosition(E)}}else"s"===C&&x.setTranslateY(S+(X.y-P.y)*x._59I/x._29I.height)},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(L){if(!Cc&&vk(L)){var R=this,U=R.pv,E=C(U.lp(L).x-U._9I)<=(e?8:3);R.cp?R._62O||(E?(R._62O="c",Pr(R)):C(wo(L).y-R.cp.y)>=2&&(R._62O=R.isV(L)?"s":"p",Pr(R))):(E?R.setCursor(De):R.setCursor(S),R.isV(L)&&U._43o())}},isV:function(U){var x=this.pv,X=x._29I;return x._41o()&&X.x+X.width-x.lp(U).x<Jn},handle_mousewheel:function(d){this.handleScroll(d,d.wheelDelta/40)},handle_DOMMouseScroll:function(V){2===V.axis&&this.handleScroll(V,-V.detail)},handleScroll:function(I,s){var T=this.pv;br(I),T.endEditing(),T.translate(0,s*T.getRowHeight())},handle_keydown:function(T){var M=this.pv,G=M._rows.size(),F=M._selectRowIndex+(Br(T)?-1:1);(Br(T)||Dp(T))&&(0>F&&(F=0),F>=G&&(F=G-1),M.setSelectRowIndex(F))}}),Tp.ListView=function(Q){this._5o(Q),new is(this)},Uf("ListView",P,{ms_ac:[Xr,mb,Sn,jg,Fc,rs,bg,ik,Rm,wl,Yl,us,Pd,os],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:kd,_rowHeight:Ef,_rowLineVisible:E.listViewRowLineVisible,_rowLineColor:E.listViewRowLineColor,_scrollBarColor:Sj,_scrollBarSize:cr,_autoMakeVisible:jo,_autoHideScrollBar:cb,_selectBackground:E.listViewSelectBackground,_labelColor:E.listViewLabelColor,_labelSelectColor:E.listViewLabelSelectColor,_labelFont:E.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(o){var m=this,X=m._checkMode;m._checkMode=o,m.fp(bf,X,o)},drawRow:function(Y,S,X,C,I,F,d){var R=this,s=0,z=R._indent,G=R.getIconWidth(S);R.drawRowBackground(Y,S,X,C,I,F,d),R._checkMode&&(We(Y,R.getCheckIcon(S),s+z/2,I+d/2,S,R),s+=z),R.drawIcon(Y,S,s,I,G,d),R.drawLabel(Y,S,s+G,I,d)}});var is=function(A){this.list=A,this._lastSelectDataTime=Bm(),this.addListeners()};re(is,P,{ms_listener:1,getView:function(){return this.list._view},clear:function(U){var H=this,S=H.list;U&&"d"===H._62O&&!H.dragCancel&&S.handleDragAndDrop(U,"end"),S.draggingData&&(S.draggingData=null,S.redraw()),H.dragCancel=H._62O=H._isV=H._isH=H.cp=H.tx=H.ty=q},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(j){var i=this,V=i.list;if(br(j),V.setFocus(j)){var E=V.getDataAt(j);i.cp=wo(j),i.tx=V.tx(),i.ty=V.ty(),vk(j)?E&&V.handleDragAndDrop&&!i.isV(j)&&!i.isH(j)&&(V.draggingData=E,V.redraw(),V.handleDragAndDrop(j,"prepare")):(E&&i._33o(j,E),i.clear(j))}},handleWindowMouseUp:function(V){this.clear(V)},handleWindowTouchEnd:function(S){this.clear(S)},handle_mouseup:function(O){this.handle_touchend(O)},handle_touchend:function(T){var O=this,w=O.list;if(!O._isV&&!O._isH&&O.cp&&!O._62O){var A=w.getDataAt(T);A?(w.isCheckMode()?O._34o(T,A):O._33o(T,A),hq(T)?w.onDataDoubleClicked(A,T):w.onDataClicked(A,T)):w.handleBackgroundClick(T)}O.clear(T)},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(T){var w=this,B=w.list,j=w._62O,v=w.tx,E=w.ty,c=w.cp,G=wo(T),o=B._29I;"p"===j?B.setTranslate(v+G.x-c.x,E+G.y-c.y):"v"===j?B.ty(E+(c.y-G.y)*B._59I/o.height):"h"===j?B.tx(v+(c.x-G.x)*B._91I/o.width):"d"===j&&(w.dragCancel||B.handleDragAndDrop(T,"between"))},handle_mousemove:function(W){this.handle_touchmove(W)},handle_touchmove:function(A){if(!Cc&&vk(A)){var N=this,m=N.list;if(N._isV=N.isV(A),N._isH=N.isH(A),N.cp){if(!N._62O){if(Ip(wo(A),N.cp)<2)return;N._isV?N._62O="v":N._isH?N._62O="h":m.draggingData&&!this.dragCancel?(N._62O="d",m.handleDragAndDrop(A,"begin")):N._62O="p",N._62O&&"d"!==N._62O&&m.draggingData&&(m.draggingData=null,m.redraw()),Pr(N)}}else N._isV&&m._43o(),N._isH&&m._42o()}},isV:function(o){var e=this.list,v=e._29I;return e._41o()&&v.x+v.width-e.lp(o).x<Jn},isH:function(g){var j=this.list,$=j._29I;return j._40o()&&$.y+$.height-j.lp(g).y<Jn},handle_mousewheel:function(E){this.handleScroll(E,E.wheelDelta/40,E.wheelDelta!==E.wheelDeltaX)},handle_DOMMouseScroll:function(o){this.handleScroll(o,-o.detail,1)},handleScroll:function(e,B,Y){var j=this.list;br(e),j.endEditing&&j.endEditing(),Y&&j._41o()?j.translate(0,B*j.getRowHeight()):j._40o()&&j.translate(10*B,0)},handle_keydown:function(R){if(!E.isInput(R.target)){var D,$=this.list,e=$.sm(),S=$._rows,u=S.size();if(uk(R))$.selectAll();else if(Ii(R))$.handleDelete&&$.handleDelete(R);else if(hj(R))"d"!==this._62O||this.dragCancel||($.handleDragAndDrop(R,"cancel"),this.dragCancel=!0);else if(Rb(R))$.isCheckMode()&&(D=$.getFocusData(),D&&$.checkData(D));else if(Br(R)||Dp(R)){var G=$.isCheckMode();if(D=G?$.getFocusData():e.ld()){var g=$.getRowIndex(D);g>=0&&(Br(R)?0!==g&&(D=S.get(g-1),G?$.setFocusData(D):e.ss(D)):g!==u-1&&(D=S.get(g+1),G?$.setFocusData(D):e.ss(D)))}else u>0&&(D=S.get(0),G?$.setFocusData(D):e.ss(D))}}},_34o:function(O,W){var A=this.list,Y=A.lp(O).x;return Y>=0&&Y<=A._indent?(A.checkData(W),void 0):(A.setFocusData(W),void 0)},_33o:function(P,m){var X=this.list,T=X.sm(),G=T.ld();if(ki(P))X.isSelected(m)?T.rs(m):T.as(m);else if(Wi(P))if(G)for(var V=X.getRowIndex(G),B=X.getRowIndex(m);V!==B;)V+=B>V?1:-1,T.as(X._rows.get(V));else T.ss(m);else if(vk(P)){var H=Bm();if(T.contains(m)){var Q=H-this._lastSelectDataTime;X.handleDataDoubleSelect&&Q>500&&1500>Q&&X.handleDataDoubleSelect(P,m)}T.ss(m),this._lastSelectDataTime=H}else T.contains(m)||T.ss(m)}}),Tp.TreeView=function(y){var r=this;r._35o(),r._5o(y),new Tg(r)},Uf("TreeView",P,{ms_ac:[Xr,mb,Sn,"rootVisible",bf,"rootData",ik,Rm,wl,Yl,us,Fc,jg,rs,bg,vf,Yj,Pd,os,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:q,_indent:kd,_rowHeight:Ef,_rowLineVisible:E.treeViewRowLineVisible,_rowLineColor:E.treeViewRowLineColor,_scrollBarColor:Sj,_scrollBarSize:cr,_autoHideScrollBar:cb,_expandIcon:E.treeViewExpandIcon,_collapseIcon:E.treeViewCollapseIcon,_autoMakeVisible:jo,_selectBackground:E.treeViewSelectBackground,_labelColor:E.treeViewLabelColor,_labelSelectColor:E.treeViewLabelSelectColor,_labelFont:E.treeViewLabelFont,_doubleClickToToggle:E.treeViewDoubleClickToToggle,drawRow:function(Q,K,u,l,Y,P,r){var h=this;h.drawRowBackground(Q,K,u,l,Y,P,r),h._97I(Q,K,u,0,Y,P,r)},isOnToggleIcon:function(D){var m=this.getDataAt(D);if(m){var B=this.getIndent(),o=this.lp(D).x;if(fo(this.getToggleIcon(m))){var s=B*this.getLevel(m);if(o>=s&&s+B>=o)return!0}}return!1}});var Tg=function(K){Pj(Tg,this,[K])};re(Tg,is,{toggle:function(m,n,t,x){var $=this.list,V=$.lp(m).x;if(fo($.getToggleIcon(n))){var a=t*x;if(V>=a&&a+t>=V)return $.toggle(n),!0}return $.isDoubleClickToToggle()&&hq(m)?($.toggle(n),!0):!1},_34o:function(B,s){var S=this.list,w=S.lp(B).x,v=S._levelMap[s._id],T=S._indent,b=T*(v+1);return w>=b&&b+T>=w?(S.checkData(s),void 0):(this.toggle(B,s,T,v)||S.setFocusData(s),void 0)},_33o:function(U,H){var J=this,P=J.list;J.toggle(U,H,P._indent,P.getLevel(H))||Tg.superClass._33o.call(J,U,H)},handle_keydown:function(f){if(Bn(f)||fn(f)){var G=this.list,t=G._rows,$=G.isCheckMode(),S=G.sm(),I=$?G.getFocusData():S.ld();I?I.hasChildren()&&(Bn(f)?G.collapse(I):G.expand(I)):t.size()>0&&(I=t.get(0),$?G.setFocusData(I):S.ss(I))}else Tg.superClass.handle_keydown.call(this,f)}});var Cq=Tp.TableView=function(Q){this._98I(),this._5o(Q),new Hf(this)};Uf("TableView",P,{ms_ac:[Xr,mb,Sn,"sortMode",Eq,Km,jg,rs,bg,Jo,gf,"sortColumn",ik,Rm,wl,Yl,us,Pd,os],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ur,_editable:!0,_batchEditable:!1,_rowHeight:Ef,_rowLineVisible:E.tableViewRowLineVisible,_rowLineColor:E.tableViewRowLineColor,_columnLineVisible:E.tableViewColumnLineVisible,_columnLineColor:E.tableViewColumnLineColor,_scrollBarColor:Sj,_scrollBarSize:cr,_autoHideScrollBar:cb,_autoMakeVisible:jo,_selectBackground:E.tableViewSelectBackground,_labelColor:E.tableViewLabelColor,_labelSelectColor:E.tableViewLabelSelectColor,_labelFont:E.tableViewLabelFont,getCheckColumn:function(){var Q=this;if(!Q._31o){var e=Q._31o=new Hd;e.setEditable(!0),e.setWidth(40),e.getValue=Q.getCheckColumValue,e.drawCell=Q.drawCheckColumnCell}return Q._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(k){var Y=this,T=Y._39o,a=Y.getCheckColumn();k!==Y.isCheckMode()&&(k?T.add(a,0):T.remove(a),Y.fp(bf,!k,k))},getCheckColumValue:function(U,r,s){return s.isSelected(U)},drawCheckColumnCell:function(t,b,Z,S,g,E,D,l,w){We(t,w.getCheckIcon(b),g+D/2,E+l/2,b,w)}});var Hf=function(P){Pj(Hf,this,[P])};re(Hf,is,{_34o:function(o,S){var z=this.list,T=z._31o;if(z.isCellEditable(S,T,o)){var y=z._3Q(T),w=z.lp(o).x;if(y&&w>=y.startX&&w<y.startX+T.getWidth())return z.checkData(S),void 0}z.setFocusData(S),z._37O(S,o)},_33o:function(A,u){Hf.superClass._33o.apply(this,arguments),this.list._37O(u,A)}});var Hk=Tp.TreeTableView=function(E){var $=this,z=$._4o=new Hd;$._35o(),$._98I(),$._5o(E),z.setDisplayName("Name"),z.setEditable(!0),z.setWidth(180),z.drawCell=lm,z.getValue=Yp,$._39o.add(z),new kp($)},lm=function(e,g,i,y,F,N,d,D,s){s._97I(e,g,i,F,N,d,D)},Yp=function(u,j,f){return f.getLabel(u)};Uf("TreeTableView",P,{ms_ac:[Xr,mb,Sn,"sortMode",Eq,Km,Fc,bf,"rootData","rootVisible",ik,Rm,"sortColumn",vf,Yj,wl,Yl,us,Pd,bg,jg,rs,Jo,gf,os,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ur,_checkMode:q,_editable:!0,_batchEditable:!1,_indent:kd,_rowHeight:Ef,_rowLineVisible:E.treeTableViewRowLineVisible,_rowLineColor:E.treeTableViewRowLineColor,_columnLineVisible:E.treeTableViewColumnLineVisible,_columnLineColor:E.treeTableViewColumnLineColor,_expandIcon:E.treeTableViewExpandIcon,_collapseIcon:E.treeTableViewCollapseIcon,_scrollBarColor:Sj,_scrollBarSize:cr,_autoHideScrollBar:cb,_autoMakeVisible:jo,_selectBackground:E.treeTableViewSelectBackground,_labelColor:E.treeTableViewLabelColor,_labelSelectColor:E.treeTableViewLabelSelectColor,_labelFont:E.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var kp=function(B){Pj(kp,this,[B])};re(kp,is,{_34o:function(V,g){var s=this.list,Q=s._4o,O=s._3Q(Q),d=s.lp(V).x;if(O){var Y=s._indent,S=O.startX+Y*s.getLevel(g);if(fo(s.getToggleIcon(g))&&d>=S&&S+Y>=d)return s.toggle(g),void 0;if(s.isCellEditable(g,Q)&&(S+=Y,d>=S&&S+Y>=d))return s.checkData(g),void 0}s.setFocusData(g),s._37O(g,V)},_33o:function(O,q){var R=this.list,l=R.lp(O).x;if(fo(R.getToggleIcon(q))){var W=R._3Q(R._4o);if(W){var I=R._indent,m=W.startX+I*R.getLevel(q);if(l>=m&&m+I>=l)return R.toggle(q),void 0}}kp.superClass._33o.apply(this,arguments),R._37O(q,O)}});var zm=Tp.TableHeader=function(S){var s=this,Q=s._view=wk(1,s),W=s._39o=S.getColumnModel(),x=s.iv;s.tv=s._tableView=S,s._60I=new up,s._canvas=ld(Q),Q.style.background=E.tableHeaderBackground||"",Q.style.height=Pp+jm,W.mm(x,s),W.md(x,s),W.mh(x,s),S.mp(function(Q){Kh[Q.property]&&s.iv()},s),new pn(s),s.iv()};Uf("TableHeader",P,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Xr,Sn,Fc,"moveBackground","insertColor",Jo,gf,"resizable","movable"],_checkIcon:Ve,_movable:!0,_resizable:!0,_labelColor:E.tableHeaderLabelColor,_labelFont:E.tableHeaderLabelFont,_columnLineColor:E.tableHeaderColumnLineColor,_columnLineVisible:E.tableHeaderColumnLineVisible,_sortDescIcon:E.tableHeaderSortDescIcon,_sortAscIcon:E.tableHeaderSortAscIcon,_moveBackground:E.tableHeaderMoveBackground,_insertColor:E.tableHeaderInsertColor,_indent:kd,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(F){return F.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(E){return E.getColor()||this._labelColor},getLabelAlign:function(R){return R._align},onPropertyChanged:function(){this.iv()},_5Q:function(_){this._61I=_,this.iv()},getLogicalPoint:function(B){return Ud(B,this._canvas,this.tv.tx())},validateImpl:function(){var n=this,q=n._canvas,g=n.getWidth(),H=n.getHeight(),e=n.tv,w=n._60I,u=n._61I,J=-e.tx(),p=0;(g!==q.clientWidth||H!==q.clientHeight)&&Pm(q,g,H),w.clear(),n._39o._roots.each(function(W){if(W.isVisible()){var U=p+W.getWidth();J+g>=p&&U>=J&&w.add({column:W,startX:p}),p=U}});var U=Pg(q);if(yr(U,-J,0,1),U.beginPath(),U.rect(J,0,g,H),U.clip(),U.clearRect(J,0,g,H),w.each(function(k){var e=k.column,M=k.startX,m=e.getWidth();m>0&&(U.save(),U.beginPath(),U.rect(M,0,m,H),U.clip(),u&&u.column===e||n.drawColumn(U,e,M,0,m,H),n._columnLineVisible&&Kc(U,M+m-1,0,1,H,n._columnLineColor),U.restore())}),u){var i=u.column,p=u.startX,r=u.position,C=i.getWidth();U.save(),U.beginPath(),U.rect(p,0,C,H),U.clip(),U.fillStyle=n._moveBackground,U.fill(),n.drawColumn(U,i,p,0,C,H),U.restore(),ag(U,n._insertColor,r,0,H)}U.restore()},_6Q:function(_){var K=this.tv;return K._31o===_&&K.sm().getSelectionMode()===Uq},drawColumn:function(k,K,r,w,V,S){var $=this,_=$.tv,u=fo(K.getIcon()),P=$.getLabelAlign(K);if($._6Q(K)){var H=fo($._checkIcon);We(k,H,r+V/2,w+S/2,K,$)}else{var G=$.getLabel(K),Z=$.getLabelFont(K),J=$.getLabelColor(K),d=wr(Z,G).width,I=u?$._indent:0;P===Ff?(u&&Sk(k,u,li,r,w,I,S),Wp(k,G,Z,J,r+I,w,V,S,Ff)):P===Gr?(u&&Sk(k,u,li,r+V-d-I,w,I,S),Wp(k,G,Z,J,r,w,V,S,Gr)):(u&&Sk(k,u,li,r+(V-d-I)/2,w,I,S),Wp(k,G,Z,J,r+(V-d+I)/2,w,0,S,Ff))}if(K.isSortable()&&_.getSortColumn()===K&&(u=fo(K.getSortOrder()===_p?$._sortAscIcon:$._sortDescIcon))){var X=Uh(u,K)/2+2;We(k,u,P===Gr?r+X:r+V-X,w+S/2,K,_)}}});var pn=function(s){var P=this;P.th=s,P.tv=s._tableView,P.addListeners()};re(pn,P,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(a){this.getView().style.cursor=a},handle_mousemove:function(d){if(!Cc){var I=this;delete I._29o,I.setCursor(S);for(var r=I.th,l=r._60I,$=r.lp(d).x,W=l.size()-1;W>=0;W--){var Q=l.get(W),F=Q.column,t=Q.startX+F.getWidth();if(r.isResizable()&&C(t-$)<=(e?10:3))return I._29o=Q,I.setCursor(De),void 0;$>Q.startX&&t>$&&(I._29o=Q),(F.isClickable()||F.isSortable()||r.isMovable()||I.tv.getCheckColumn&&F===I.tv.getCheckColumn())&&$>Q.startX&&t>$&&I.setCursor(ee)}}},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(i){var N=this;br(i),N.tv.endEditing(),N.handle_mousemove(i),N._29o&&(N.x=wo(i).x,N.lx=N.th.lp(i).x,N.w=N._29o.column.getWidth(),Pr(N,i))},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(Y){var $=this,T=$.th,e=$.getView().style.cursor,x=$._29o,f=wo(Y).x-$.x;if($.resizing||$.moving||(e===De?$.resizing=1:T.isMovable()&&e===ee&&C(f)>2&&($.moving=1)),$.resizing)x.column.setWidth($.w+f);else if($.moving){var v=$.lx+f;T._60I.each(function(w){var L=w.startX,g=L+w.column.getWidth();if(v>=L&&g>=v){var o={column:x.column,startX:x.startX+f,front:g-v>v-L,insertColumn:w.column};o.position=o.front?L:g,T._5Q(o)}})}},_16Q:function(X,F){var H=this,P=H.tv,q=H.th,Z=q._checkIcon;if(q._6Q(X)){var K=fo(Z),_=H.lx,m=X.getWidth(),D=Uh(K,X);if(_>=F+m/2-D&&F+m/2+D>=_){q.setCheckIcon(Z===jc?Ve:jc);var x=P.sm(),I=P._rows;return Z===jc?x.rs(I):x.ss(I),P.onCheckColumnClicked(X),!0}}return!1},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(o){var $=this,Z=$.tv,s=$.th,g=$._29o;if($.moving){var X=s._61I;if(X&&X.insertColumn!==X.column){var D=X.column,K=Z.getColumnModel()._roots,M=K.remove(D),L=K.indexOf(X.insertColumn);L>=0&&(X.front||L++,L<=K.size()&&(K.add(D,L),Z.getColumnModel()._38I(D,M,L)))}s._5Q(q),delete $.moving}else if(!$.resizing&&g){D=g.column;var F=s.lp(o).x,B=g.startX,z=!0;if(s.onColumnClicked){var T=s.onColumnClicked(D,o,B);T===!1&&(z=!1)}if(z&&F>=B&&F<=B+D.getWidth()&&!$._16Q(D,B)){if(D.isSortable()){var G=Z.getSortMode(),V=D.getSortOrder();G===ur?Z.getSortColumn()===D?(V===xi&&Z.setSortColumn(q),D.setSortOrder(V===_p?xi:_p)):Z.setSortColumn(D):"bistate"===G&&(Z.getSortColumn()===D?D.setSortOrder(V===_p?xi:_p):Z.setSortColumn(D))}Z.onColumnClicked(D,o,B)}}$._29o=$.resizing=$.x=$.lx=$.w=q}}),Tp.TablePane=function(K){this.init(new Cq(K))},Uf("TablePane",P,{ms_v:1,_44o:1}),Tp.TreeTablePane=function(V){this.init(new Hk(V))},Uf("TreeTablePane",P,{ms_v:1,_44o:1}),Tp.Toolbar=function(p){var Q=this,d=Q._view=wk(1,Q),C=d.style;C.background=E.toolbarBackground||"",C.height=Vp+jm,Q._canvas=ld(d),Q._30o=new up,Q._90I=new up,Q.setItems(p||[]),d.handleGroupSelectedChanged=function(f){if(f.isSelected()){var e=f.getGroupId();null!=e&&Q._items.forEach(function(S){var R=S.element;R&&R!==f&&R.setSelected&&R.getGroupId&&R.getGroupId()===e&&R.setSelected(!1)})}},new Yh(Q)},Uf("Toolbar",P,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Og,Xr,Sn,mb,os,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:E.toolbarLabelColor,_labelSelectColor:E.toolbarLabelSelectColor,_labelFont:E.toolbarLabelFont,_selectBackground:E.toolbarSelectBackground,_itemGap:E.toolbarItemGap,_separatorColor:E.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(w){var o=this.getItemInfoAt(w);return o?o.item.toolTip:q},getLabelColor:function(e){return e&&e.selected&&e.type!==jc&&e.type!==Vb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(E){this.iv(),E.property===Og&&this._items.forEach(function(H){bh(H)})},redraw:function(){this.iv()},addItem:function(w,T){var m=this._items;T==q?m.push(w):m.splice(T,0,w),this.fp(Og,q,m)},removeItem:function(H){if(H)for(var Q=this._items,i=0;i<Q.length;i++)H===Q[i]&&(Q.splice(i,1),this.fp(Og,q,Q))},removeItemById:function(U){if(U!=q)for(var M=this._items,W=0;W<M.length;W++)if(U===M[W].id){var T=M.splice(W,1)[0];return this.fp(Og,q,M),T}},getItemById:function(k){if(k!=q)for(var w=this._items,s=0;s<w.length;s++){var n=w[s];if(k===n.id)return n}},setItemVisible:function(A,C){var x=this.getItemById(A);x&&(x.visible=C)},getItemInfos:function(){return this._30o},getItemInfoAt:function(j){var v=this,_=0,a=v._30o,K=v.lp(j),P=K.x,M=K.y;if(M>=0&&M<=v.getHeight())for(;_<a.size();_++){var N=a.get(_);if(N.startX<=P&&P<=N.endX)return N}return q},drawItem:function(x,M,Q,P,p){if(M.visible===!1)return 0;if(Xo(M.visible)&&!M.visible())return 0;var u=this,J=M.disabled;J&&(x.globalAlpha=pj);var e=u.drawItemImpl(x,M,Q,P,p),F=u._itemGap;return J&&(x.globalAlpha=1),this._currentItem!==M||"separator"===M||M.separator===!0||M.unfocusable||bb(x,u._separatorColor,Q-F/2,0,e+F,P),e},drawItemImpl:function(H,h,c,Z,w){var M=this,V=M._view,d=M._itemGap,T=Z/2,t=h.type,a=h.element,G=h.label;Gg(a)&&(G=a,a=q);var l,I=M.getLabelFont(h),N=M.getLabelColor(h),A=h.selected,L=fo(h.icon),K=Uh(L,h),U=0,S=K+(G?wr(I,G).width:0);if("separator"===h||h.separator===!0)return ag(H,M._separatorColor,c,Z/4,T),1;if(a){L&&We(H,L,c+K/2,T,h,M),Wp(H,G,I,N,c+K,0,0,Z);var x=cs(a);w||M._90I.add(x),x.parentNode!==V&&gd(V,x),a.iv&&a.iv(),a.validate&&a.validate();var J=x.getBoundingClientRect(),y=J.width,f=x.style;return Ne(x),f.left=M.tx()+c+S+jm,f.top=(Z-J.height)/2+jm,S+y}return t===Vb?l=fo(A?Hq:Sq):t===jc&&(l=fo(A?jc:Ve)),l?(U=Uh(l,h),We(H,l,c+U/2,T,h,M),c+=U,S+=U):A&&Kc(H,c-d/2,0,S+d,Z,M.getSelectBackground(h)),L&&We(H,L,c+K/2,T,h,M),Wp(H,G,I,N,c+K,0,0,Z),S},validateImpl:function(){var Y=this,a=Y._canvas,R=Y.getWidth(),L=Y.getHeight(),u=Y._30o,Q=Y._items;Pm(a,R,L);var t=Pg(a),d=Y._itemGap,E=d/2;yr(t,Y.tx(),0,1),t.clearRect(0,0,R,L);var e=Y._90I;Y._90I=new up,u.clear(),Q.forEach(function(z){var h=Y.drawItem(t,z,E,L);u.add({item:z,startX:E,endX:E+h,width:h}),h&&(E+=h+d)}),e.each(function(y){Y._90I.contains(y)||Ad(y)});var N=Y._64I;Y._64I=M(0,E),t.restore(),Y._stickToRight?(Y._65O=0,t=Pg(a),E=R-Y._64I+d,yr(t,0,0,1),t.clearRect(0,0,R,L),u.clear(),Q.forEach(function(A){var g=Y.drawItem(t,A,E,L,!0);u.add({item:A,startX:E,endX:E+g,width:g}),g&&(E+=g+d)}),t.restore()):Y.tx(Y.tx()),N!==Y._64I&&Y.onSumWidthChanged(N,Y._64I)},onSumWidthChanged:function(){},handleClick:function(u,R){var Z=this,p=u.type,o=u.action,$=u.groupId,y=u.selected;u.disabled||($!=q?y||(u.selected=!0,this._items.forEach(function(A){A.groupId===$&&u!==A&&(A.selected=!1)}),o&&u.action(u,Z,R)):p===jc||"toggle"===p?(u.selected=!y,o&&u.action(u,Z,R)):o&&u.action(u,Z,R)),Ur(),Z.iv()}});var Yh=function(T){this.tb=T,this.addListeners()};re(Yh,P,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(J){this.handleScroll(J,10*(J.wheelDelta/40))},handle_DOMMouseScroll:function(t){this.handleScroll(t,10*-t.detail)},handleScroll:function(Q,d){br(Q);var x=this.tb;x.isScrollable()&&!x._stickToRight&&(x.tx(x.tx()+d),ef())},handle_mousemove:function(Q){var _=this;Cc||_.setItem(Q)},handle_mouseout:function(n){var w=this;n.target===w.getView()?w.tb.setCurrentItem(q):w.handle_mousemove(n)},handle_mousedown:function($){this.handle_mousemove($),this.handle_touchstart($)},handle_touchstart:function(J){var K=this,y=K.tb,_=J.target;vk(J)&&(_===K.getView()||_===y._canvas)&&(br(J),y.setFocus(J)&&(this.setItem(J,!0),(y.isScrollable()||K.info&&!K.info.item.disabled)&&(K.x=wo(J).x,K.tx=y.tx(),Pr(K,J))))},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(c){var I=this,o=I.tb;if(!o._stickToRight){var n=wo(c).x-I.x;!I._25o&&C(n)>2&&o.isScrollable()&&(I._25o=1),I._25o&&o.tx(I.tx+n)}},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(w){var C=this,x=C.tb,G=C.info,h=C.tb.getItemInfoAt(w);if(!C._25o&&G){var L=G.item;h&&h.item===L&&x.handleClick(L,w)}C._25o=C.x=C.tx=q,C.setItem()},setItem:function(S,U){var O=this,Q=O.tb,K=O.info=S?Q.getItemInfoAt(S):q,j=K?K.item:q;Q.setCurrentItem(j),U&&j&&Xo(j.onDown)&&j.onDown(S)}}),Tp.BorderPane=function(){this._view=wk(1,this),this.iv()},Uf("BorderPane",P,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(t,z){this._12o("leftView",t),z!=q&&this.setLeftWidth(z)},getRightView:function(){return this._rightView},setRightView:function(d,Y){this._12o("rightView",d),Y!=q&&this.setRightWidth(Y)},getTopView:function(){return this._topView},setTopView:function(Q,v){this._12o("topView",Q),v!=q&&this.setTopHeight(v)},getBottomView:function(){return this._bottomView},setBottomView:function(r,j){this._12o("bottomView",r),j!=q&&this.setBottomHeight(j)},getCenterView:function(){return this._centerView},setCenterView:function(r){this._12o("centerView",r)},_12o:function(t,m){var j=this,W="_"+t,S=j._view,$=j[W];$!==m&&($&&($.getView?Ad($.getView()):Ad($)),j[W]=m,m&&(m.getView?gd(S,m.getView(),1):gd(S,m,1)),j.fp(t,$,m))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var c=this,o=c._topView,t=c._bottomView,V=c._leftView,W=c._rightView,$=c._centerView,h=c.getWidth(),R=c.getHeight(),u=0,I=0,x=h,n=R,e=0,g=0,s=0,U=0;o&&(e=c._topHeight==q?dp(o):c._topHeight,I=e),t&&(g=c._bottomHeight==q?dp(t):c._bottomHeight,n=R-g),V&&(s=c._leftWidth==q?td(V):c._leftWidth,u=s),W&&(U=c._rightWidth==q?td(W):c._rightWidth,x=h-U);var F=M(0,x-u),Z=M(0,n-I);o&&Mj(o,0,0,h,e),t&&Mj(t,0,n,h,g),V&&Mj(V,0,I,s,Z),W&&Mj(W,x,I,U,Z),$&&Mj($,u,I,F,Z)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);